<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session a08bf946-4e27-44f0-aecc-c70853e250aa (2026-01-21 07:52Z) -->

# 專案頁面資料載入問題 (2026-01-21 07:52Z)

_**User**_

@pass/main-260121.log 請根據紀錄檔和分析專案程式碼，找出為何專案從設定驗面點選回到專案頁面後都無法正常呈現資料，而一直在轉圈圈 loading 中？

---

_**Agent (model default, mode Agent)**_


分析日誌與程式碼，找出專案頁面從設定頁返回後持續 loading 的原因。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: d:\_Code\_GitHub\eigent-260119\pass\main-260121.log</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "專案頁面載入資料 loading 狀態管理",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 46,
            "column": 65
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\n\tconst {t} = useTranslation()\n\tconst navigate = useNavigate();\n  const [deleteCallback, setDeleteCallback] = useState&lt;() =&gt; void&gt;(() =&gt; {});\n\tconst { chatStore, projectStore } = useChatStoreAdapter();\n\tif (!chatStore || !projectStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\tconst { history_type, setHistoryType } = useGlobalStore();\n\tconst [historyTasks, setHistoryTasks] = useState&lt;any[]&gt;([]);\n\tconst [deleteModalOpen, setDeleteModalOpen] = useState(false);\n\tconst [curHistoryId, setCurHistoryId] = useState(\"\");\n\tconst [deleteProjectModalOpen, setDeleteProjectModalOpen] = useState(false);\n\tconst [curProjectId, setCurProjectId] = useState(\"\");\n\tconst [refreshTrigger, setRefreshTrigger] = useState(0);\n\tconst [projectDeleteCallback, setProjectDeleteCallback] = useState&lt;(() =&gt; Promise&lt;void&gt;) | null&gt;(null);\n\tconst agentMap = {\n\t\tdeveloper_agent:\n,\n\t};\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "\tconst {t} = useTranslation()",
            "lineNumber": 51
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 52
          },
          {
            "text": "  const [deleteCallback, setDeleteCallback] = useState&lt;() =&gt; void&gt;(() =&gt; {});",
            "lineNumber": 53
          },
          {
            "text": "\tconst { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 54
          },
          {
            "text": "\tif (!chatStore || !projectStore) {",
            "lineNumber": 55
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 56
          },
          {
            "text": "\t}",
            "lineNumber": 57
          },
          {
            "text": "\tconst { history_type, setHistoryType } = useGlobalStore();",
            "lineNumber": 58
          },
          {
            "text": "\tconst [historyTasks, setHistoryTasks] = useState&lt;any[]&gt;([]);",
            "lineNumber": 59
          },
          {
            "text": "\tconst [deleteModalOpen, setDeleteModalOpen] = useState(false);",
            "lineNumber": 60
          },
          {
            "text": "\tconst [curHistoryId, setCurHistoryId] = useState(\"\");",
            "lineNumber": 61
          },
          {
            "text": "\tconst [deleteProjectModalOpen, setDeleteProjectModalOpen] = useState(false);",
            "lineNumber": 62
          },
          {
            "text": "\tconst [curProjectId, setCurProjectId] = useState(\"\");",
            "lineNumber": 63
          },
          {
            "text": "\tconst [refreshTrigger, setRefreshTrigger] = useState(0);",
            "lineNumber": 64
          },
          {
            "text": "\tconst [projectDeleteCallback, setProjectDeleteCallback] = useState&lt;(() =&gt; Promise&lt;void&gt;) | null&gt;(null);",
            "lineNumber": 65
          },
          {
            "text": "\tconst agentMap = {",
            "lineNumber": 66
          },
          {
            "text": "\t\tdeveloper_agent:",
            "lineNumber": 67
          },
          {
            "text": ",",
            "lineNumber": 110
          },
          {
            "text": "\t};",
            "lineNumber": 111
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.36585330963134766
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\Layout\\index.tsx",
        "range": {
          "startPosition": {
            "line": 13,
            "column": 31
          },
          "endPosition": {
            "line": 105,
            "column": 1
          }
        },
        "contents": " \"@/hooks/useChatStoreAdapter\";\n\nconst Layout = () =&gt; {\n\tconst { initState, isFirstLaunch, setIsFirstLaunch, setInitState } = useAuthStore();\n\tconst [noticeOpen, setNoticeOpen] = useState(false);\n\n\t//Get Chatstore for the active project's task\n\tconst { chatStore } = useChatStoreAdapter();\n\tif (!chatStore) {\n\t\tconsole.log(chatStore);\n\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\n\tconst {\n\t\tinstallationState,\n\t\tlatestLog,\n\t\terror,\n\t\tbackendError,\n\t\tisInstalling,\n\t\tshouldShowInstallScreen,\n\t\tretryInstallation,\n\t\tretryBackend,\n\t} = useInstallationUI();\n\n\tuseInstallationSetup();\n\n\tuseEffect(() =&gt; {\n\t\tconst handleBeforeClose = () =&gt; {\n\t\t\tconst currentStatus = chatStore.tasks[chatStore.activeTaskId as string]?.status;\n\t\t\tif([\"running\", \"pause\"].includes(currentStatus)) {\n\t\t\t\tsetNoticeOpen(true);\n\t\t\t} else {\n\t\t\t\twindow.electronAPI.closeWindow(true);\n\t\t\t}\n\t\t};\n\n\t\twindow.ipcRenderer.on(\"before-close\", handleBeforeClose);\n\n\t\treturn () =&gt; {\n\t\t\twindow.ipcRenderer.removeAllListeners(\"before-close\");\n\t\t};\n\t}, [chatStore.tasks, chatStore.activeTaskId]);\n\n\t// Determine what to show based on states\n\tconst shouldShowOnboarding = initState === \"done\" &amp;&amp; isFirstLaunch &amp;&amp; !isInstalling;\n\n\tconst actualShouldShowInstallScreen = shouldShowInstallScreen || initState !== 'done' || installationState === 'waiting-backend';\n\tconst shouldShowMainContent = !actualShouldShowInstallScreen;\n\n\treturn (\n\t\t&lt;div className=\"h-full flex flex-col relative overflow-hidden\"&gt;\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": " \"@/hooks/useChatStoreAdapter\";",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "const Layout = () =&gt; {",
            "lineNumber": 16
          },
          {
            "text": "\tconst { initState, isFirstLaunch, setIsFirstLaunch, setInitState } = useAuthStore();",
            "lineNumber": 17
          },
          {
            "text": "\tconst [noticeOpen, setNoticeOpen] = useState(false);",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "\t//Get Chatstore for the active project's task",
            "lineNumber": 20
          },
          {
            "text": "\tconst { chatStore } = useChatStoreAdapter();",
            "lineNumber": 21
          },
          {
            "text": "\tif (!chatStore) {",
            "lineNumber": 22
          },
          {
            "text": "\t\tconsole.log(chatStore);",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 25
          },
          {
            "text": "\t}",
            "lineNumber": 26
          },
          {
            "lineNumber": 27
          },
          {
            "text": "\tconst {",
            "lineNumber": 28
          },
          {
            "text": "\t\tinstallationState,",
            "lineNumber": 29
          },
          {
            "text": "\t\tlatestLog,",
            "lineNumber": 30
          },
          {
            "text": "\t\terror,",
            "lineNumber": 31
          },
          {
            "text": "\t\tbackendError,",
            "lineNumber": 32
          },
          {
            "text": "\t\tisInstalling,",
            "lineNumber": 33
          },
          {
            "text": "\t\tshouldShowInstallScreen,",
            "lineNumber": 34
          },
          {
            "text": "\t\tretryInstallation,",
            "lineNumber": 35
          },
          {
            "text": "\t\tretryBackend,",
            "lineNumber": 36
          },
          {
            "text": "\t} = useInstallationUI();",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "\tuseInstallationSetup();",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 41
          },
          {
            "text": "\t\tconst handleBeforeClose = () =&gt; {",
            "lineNumber": 42
          },
          {
            "text": "\t\t\tconst currentStatus = chatStore.tasks[chatStore.activeTaskId as string]?.status;",
            "lineNumber": 43
          },
          {
            "text": "\t\t\tif([\"running\", \"pause\"].includes(currentStatus)) {",
            "lineNumber": 44
          },
          {
            "text": "\t\t\t\tsetNoticeOpen(true);",
            "lineNumber": 45
          },
          {
            "text": "\t\t\t} else {",
            "lineNumber": 46
          },
          {
            "text": "\t\t\t\twindow.electronAPI.closeWindow(true);",
            "lineNumber": 47
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 48
          },
          {
            "text": "\t\t};",
            "lineNumber": 49
          },
          {
            "lineNumber": 50
          },
          {
            "text": "\t\twindow.ipcRenderer.on(\"before-close\", handleBeforeClose);",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "\t\treturn () =&gt; {",
            "lineNumber": 53
          },
          {
            "text": "\t\t\twindow.ipcRenderer.removeAllListeners(\"before-close\");",
            "lineNumber": 54
          },
          {
            "text": "\t\t};",
            "lineNumber": 55
          },
          {
            "text": "\t}, [chatStore.tasks, chatStore.activeTaskId]);",
            "lineNumber": 56
          },
          {
            "lineNumber": 57
          },
          {
            "text": "\t// Determine what to show based on states",
            "lineNumber": 58
          },
          {
            "text": "\tconst shouldShowOnboarding = initState === \"done\" &amp;&amp; isFirstLaunch &amp;&amp; !isInstalling;",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "\tconst actualShouldShowInstallScreen = shouldShowInstallScreen || initState !== 'done' || installationState === 'waiting-backend';",
            "lineNumber": 61
          },
          {
            "text": "\tconst shouldShowMainContent = !actualShouldShowInstallScreen;",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "\treturn (",
            "lineNumber": 64
          },
          {
            "text": "\t\t&lt;div className=\"h-full flex flex-col relative overflow-hidden\"&gt;",
            "lineNumber": 65
          },
          {
            "text": ";",
            "lineNumber": 106
          }
        ]
      },
      "score": 0.30424654483795166
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\GroupedHistoryView\\index.tsx",
        "range": {
          "startPosition": {
            "line": 30
          },
          "endPosition": {
            "line": 431,
            "column": 1
          }
        },
        "contents": "export default function GroupedHistoryView({\n  searchValue = \"\",\n  onTaskSelect,\n  onTaskDelete,\n  onTaskShare,\n  activeTaskId,\n  refreshTrigger,\n  ongoingTasks = {},\n  onOngoingTaskClick,\n  onOngoingTaskPause,\n  onOngoingTaskResume,\n  onOngoingTaskDelete,\n  onProjectEdit,\n  onProjectDelete\n}: GroupedHistoryViewProps) {\n\n\n  // Filter projects based on search value\n  const filteredProjects = projects.filter(project =&gt; {\n    if (!searchValue) return true;\n    \n    // Check if project name matches\n    if (project.project_name?.toLowerCase().includes(searchValue.toLowerCase())) {\n      return true;\n    }\n    \n    // Check if any task in the project matches\n    return project.tasks.some(task =&gt;\n      task.question?.toLowerCase().includes(searchValue.toLowerCase())\n    );\n  });\n\n  // Get all projects from projectStore and find empty ones\n  const allProjectsFromStore = projectStore.getAllProjects();\n  const emptyProjects = allProjectsFromStore.filter(project =&gt; projectStore.isEmptyProject(project));\n  \n  // Convert empty projects from projectStore format to ProjectGroup format\n  const emptyProjectGroups: ProjectGroupType[] = emptyProjects.map(project =&gt; ({\n    project_id: project.id,\n    project_name: project.name,\n    total_tokens: 0,\n    task_count: 0,\n    latest_task_date: new Date(project.updatedAt).toISOString(),\n    last_prompt: \"\",\n    tasks: [],\n    total_completed_tasks: 0,\n    total_ongoing_tasks: 0,\n    average_tokens_per_task: 0\n  }));\n  \n  // Combine filtered projects with empty projects from store\n  const allProjects = [...emptyProjectGroups, ...filteredProjects];\n\n  if (loading) {\n    return (\n      &lt;div className=\"flex items-center justify-center p-8\"&gt;\n        &lt;Loader2 className=\"w-6 h-6 animate-spin text-icon-secondary\" /&gt;\n        &lt;span className=\"ml-2 text-text-secondary\"&gt;{t(\"layout.loading\")}&lt;/span&gt;\n      &lt;/div&gt;\n    );\n  }\n\n  if (filteredProjects.length === 0)\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 31,
                "column": 1
              },
              "endPosition": {
                "line": 31,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 31,
                "column": 16
              },
              "endPosition": {
                "line": 46,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function GroupedHistoryView({",
            "lineNumber": 31,
            "isSignature": true
          },
          {
            "text": "  searchValue = \"\",",
            "lineNumber": 32,
            "isSignature": true
          },
          {
            "text": "  onTaskSelect,",
            "lineNumber": 33,
            "isSignature": true
          },
          {
            "text": "  onTaskDelete,",
            "lineNumber": 34,
            "isSignature": true
          },
          {
            "text": "  onTaskShare,",
            "lineNumber": 35,
            "isSignature": true
          },
          {
            "text": "  activeTaskId,",
            "lineNumber": 36,
            "isSignature": true
          },
          {
            "text": "  refreshTrigger,",
            "lineNumber": 37,
            "isSignature": true
          },
          {
            "text": "  ongoingTasks = {},",
            "lineNumber": 38,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskClick,",
            "lineNumber": 39,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskPause,",
            "lineNumber": 40,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskResume,",
            "lineNumber": 41,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskDelete,",
            "lineNumber": 42,
            "isSignature": true
          },
          {
            "text": "  onProjectEdit,",
            "lineNumber": 43,
            "isSignature": true
          },
          {
            "text": "  onProjectDelete",
            "lineNumber": 44,
            "isSignature": true
          },
          {
            "text": "}: GroupedHistoryViewProps) {",
            "lineNumber": 45,
            "isSignature": true
          },
          {
            "lineNumber": 188
          },
          {
            "lineNumber": 189
          },
          {
            "text": "  // Filter projects based on search value",
            "lineNumber": 190
          },
          {
            "text": "  const filteredProjects = projects.filter(project =&gt; {",
            "lineNumber": 191
          },
          {
            "text": "    if (!searchValue) return true;",
            "lineNumber": 192
          },
          {
            "text": "    ",
            "lineNumber": 193
          },
          {
            "text": "    // Check if project name matches",
            "lineNumber": 194
          },
          {
            "text": "    if (project.project_name?.toLowerCase().includes(searchValue.toLowerCase())) {",
            "lineNumber": 195
          },
          {
            "text": "      return true;",
            "lineNumber": 196
          },
          {
            "text": "    }",
            "lineNumber": 197
          },
          {
            "text": "    ",
            "lineNumber": 198
          },
          {
            "text": "    // Check if any task in the project matches",
            "lineNumber": 199
          },
          {
            "text": "    return project.tasks.some(task =&gt;",
            "lineNumber": 200
          },
          {
            "text": "      task.question?.toLowerCase().includes(searchValue.toLowerCase())",
            "lineNumber": 201
          },
          {
            "text": "    );",
            "lineNumber": 202
          },
          {
            "text": "  });",
            "lineNumber": 203
          },
          {
            "lineNumber": 204
          },
          {
            "text": "  // Get all projects from projectStore and find empty ones",
            "lineNumber": 205
          },
          {
            "text": "  const allProjectsFromStore = projectStore.getAllProjects();",
            "lineNumber": 206
          },
          {
            "text": "  const emptyProjects = allProjectsFromStore.filter(project =&gt; projectStore.isEmptyProject(project));",
            "lineNumber": 207
          },
          {
            "text": "  ",
            "lineNumber": 208
          },
          {
            "text": "  // Convert empty projects from projectStore format to ProjectGroup format",
            "lineNumber": 209
          },
          {
            "text": "  const emptyProjectGroups: ProjectGroupType[] = emptyProjects.map(project =&gt; ({",
            "lineNumber": 210
          },
          {
            "text": "    project_id: project.id,",
            "lineNumber": 211
          },
          {
            "text": "    project_name: project.name,",
            "lineNumber": 212
          },
          {
            "text": "    total_tokens: 0,",
            "lineNumber": 213
          },
          {
            "text": "    task_count: 0,",
            "lineNumber": 214
          },
          {
            "text": "    latest_task_date: new Date(project.updatedAt).toISOString(),",
            "lineNumber": 215
          },
          {
            "text": "    last_prompt: \"\",",
            "lineNumber": 216
          },
          {
            "text": "    tasks: [],",
            "lineNumber": 217
          },
          {
            "text": "    total_completed_tasks: 0,",
            "lineNumber": 218
          },
          {
            "text": "    total_ongoing_tasks: 0,",
            "lineNumber": 219
          },
          {
            "text": "    average_tokens_per_task: 0",
            "lineNumber": 220
          },
          {
            "text": "  }));",
            "lineNumber": 221
          },
          {
            "text": "  ",
            "lineNumber": 222
          },
          {
            "text": "  // Combine filtered projects with empty projects from store",
            "lineNumber": 223
          },
          {
            "text": "  const allProjects = [...emptyProjectGroups, ...filteredProjects];",
            "lineNumber": 224
          },
          {
            "lineNumber": 225
          },
          {
            "text": "  if (loading) {",
            "lineNumber": 226
          },
          {
            "text": "    return (",
            "lineNumber": 227
          },
          {
            "text": "      &lt;div className=\"flex items-center justify-center p-8\"&gt;",
            "lineNumber": 228
          },
          {
            "text": "        &lt;Loader2 className=\"w-6 h-6 animate-spin text-icon-secondary\" /&gt;",
            "lineNumber": 229
          },
          {
            "text": "        &lt;span className=\"ml-2 text-text-secondary\"&gt;{t(\"layout.loading\")}&lt;/span&gt;",
            "lineNumber": 230
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 231
          },
          {
            "text": "    );",
            "lineNumber": 232
          },
          {
            "text": "  }",
            "lineNumber": 233
          },
          {
            "lineNumber": 234
          },
          {
            "text": "  if (filteredProjects.length === 0)",
            "lineNumber": 235
          },
          {
            "text": "}",
            "lineNumber": 432,
            "isSignature": true
          }
        ]
      },
      "score": 0.2927812337875366
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\routers\\index.tsx",
        "range": {
          "startPosition": {
            "column": 50
          },
          "endPosition": {
            "line": 66,
            "column": 1
          }
        },
        "contents": "import { Routes, Route, Navigate, Outlet } from \"react-router-dom\";\nimport { useAuthStore } from \"@/store/authStore\";\n\nimport Layout from \"@/components/Layout\";\n// Lazy load page components\nconst Login = lazy(() =&gt; import(\"@/pages/Login\"));\nconst Signup = lazy(() =&gt; import(\"@/pages/SignUp\"));\nconst Home = lazy(() =&gt; import(\"@/pages/Home\"));\nconst History = lazy(() =&gt; import(\"@/pages/History\"));\nconst NotFound = lazy(() =&gt; import(\"@/pages/NotFound\"));\n\n// Route guard: Check if user is logged in\nconst ProtectedRoute = () =&gt; {\n\tconst [loading, setLoading] = useState(false);\n\tconst [isAuthenticated, setIsAuthenticated] = useState(false);\n\tconst [initialized, setInitialized] = useState(false);\n\n\tconst { token, localProxyValue, logout } = useAuthStore();\n\tuseEffect(() =&gt; {\n\t\t// Check VITE_USE_LOCAL_PROXY value on app startup\n\t\tif (token) {\n\t\t\tconst currentProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;\n\t\t\tconst storedProxyValue = localProxyValue;\n\t\t\t\n\t\t\t// If stored value exists and differs from current, logout\n\t\t\tif (storedProxyValue !== null &amp;&amp; storedProxyValue !== currentProxyValue) {\n\t\t\t\tconsole.warn('VITE_USE_LOCAL_PROXY value changed, logging out user');\n\t\t\t\tlogout();\n\t\t\t\tsetIsAuthenticated(false);\n\t\t\t\tsetLoading(false);\n\t\t\t\tsetInitialized(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\tsetIsAuthenticated(!!token);\n\t\tsetLoading(false);\n\t\tsetInitialized(true);\n\t}, [token, localProxyValue, logout]);\n\t\n\tif (loading || !initialized) {\n\t\treturn (\n\t\t\t&lt;div className=\"flex items-center justify-center h-screen\"&gt;\n\t\t\t\t&lt;div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"&gt;&lt;/div&gt;\n\t\t\t&lt;/div&gt;\n\t\t);\n\t}\n\treturn isAuthenticated ? &lt;Outlet /&gt; : &lt;Navigate to=\"/login\" replace /&gt;;\n};\n\n// Main route configuration\nconst AppRoutes = () =&gt;\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { Routes, Route, Navigate, Outlet } from \"react-router-dom\";",
            "lineNumber": 2
          },
          {
            "text": "import { useAuthStore } from \"@/store/authStore\";",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "import Layout from \"@/components/Layout\";",
            "lineNumber": 5
          },
          {
            "text": "// Lazy load page components",
            "lineNumber": 6
          },
          {
            "text": "const Login = lazy(() =&gt; import(\"@/pages/Login\"));",
            "lineNumber": 7
          },
          {
            "text": "const Signup = lazy(() =&gt; import(\"@/pages/SignUp\"));",
            "lineNumber": 8
          },
          {
            "text": "const Home = lazy(() =&gt; import(\"@/pages/Home\"));",
            "lineNumber": 9
          },
          {
            "text": "const History = lazy(() =&gt; import(\"@/pages/History\"));",
            "lineNumber": 10
          },
          {
            "text": "const NotFound = lazy(() =&gt; import(\"@/pages/NotFound\"));",
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "// Route guard: Check if user is logged in",
            "lineNumber": 13
          },
          {
            "text": "const ProtectedRoute = () =&gt; {",
            "lineNumber": 14
          },
          {
            "text": "\tconst [loading, setLoading] = useState(false);",
            "lineNumber": 15
          },
          {
            "text": "\tconst [isAuthenticated, setIsAuthenticated] = useState(false);",
            "lineNumber": 16
          },
          {
            "text": "\tconst [initialized, setInitialized] = useState(false);",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "\tconst { token, localProxyValue, logout } = useAuthStore();",
            "lineNumber": 19
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 20
          },
          {
            "text": "\t\t// Check VITE_USE_LOCAL_PROXY value on app startup",
            "lineNumber": 21
          },
          {
            "text": "\t\tif (token) {",
            "lineNumber": 22
          },
          {
            "text": "\t\t\tconst currentProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;",
            "lineNumber": 23
          },
          {
            "text": "\t\t\tconst storedProxyValue = localProxyValue;",
            "lineNumber": 24
          },
          {
            "text": "\t\t\t",
            "lineNumber": 25
          },
          {
            "text": "\t\t\t// If stored value exists and differs from current, logout",
            "lineNumber": 26
          },
          {
            "text": "\t\t\tif (storedProxyValue !== null &amp;&amp; storedProxyValue !== currentProxyValue) {",
            "lineNumber": 27
          },
          {
            "text": "\t\t\t\tconsole.warn('VITE_USE_LOCAL_PROXY value changed, logging out user');",
            "lineNumber": 28
          },
          {
            "text": "\t\t\t\tlogout();",
            "lineNumber": 29
          },
          {
            "text": "\t\t\t\tsetIsAuthenticated(false);",
            "lineNumber": 30
          },
          {
            "text": "\t\t\t\tsetLoading(false);",
            "lineNumber": 31
          },
          {
            "text": "\t\t\t\tsetInitialized(true);",
            "lineNumber": 32
          },
          {
            "text": "\t\t\t\treturn;",
            "lineNumber": 33
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 34
          },
          {
            "text": "\t\t}",
            "lineNumber": 35
          },
          {
            "text": "\t\t",
            "lineNumber": 36
          },
          {
            "text": "\t\tsetIsAuthenticated(!!token);",
            "lineNumber": 37
          },
          {
            "text": "\t\tsetLoading(false);",
            "lineNumber": 38
          },
          {
            "text": "\t\tsetInitialized(true);",
            "lineNumber": 39
          },
          {
            "text": "\t}, [token, localProxyValue, logout]);",
            "lineNumber": 40
          },
          {
            "text": "\t",
            "lineNumber": 41
          },
          {
            "text": "\tif (loading || !initialized) {",
            "lineNumber": 42
          },
          {
            "text": "\t\treturn (",
            "lineNumber": 43
          },
          {
            "text": "\t\t\t&lt;div className=\"flex items-center justify-center h-screen\"&gt;",
            "lineNumber": 44
          },
          {
            "text": "\t\t\t\t&lt;div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"&gt;&lt;/div&gt;",
            "lineNumber": 45
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 46
          },
          {
            "text": "\t\t);",
            "lineNumber": 47
          },
          {
            "text": "\t}",
            "lineNumber": 48
          },
          {
            "text": "\treturn isAuthenticated ? &lt;Outlet /&gt; : &lt;Navigate to=\"/login\" replace /&gt;;",
            "lineNumber": 49
          },
          {
            "text": "};",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "// Main route configuration",
            "lineNumber": 52
          },
          {
            "text": "const AppRoutes = () =&gt;",
            "lineNumber": 53
          },
          {
            "text": ";",
            "lineNumber": 67
          }
        ]
      },
      "score": 0.28410816192626953
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 49
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\nconst handleProjectDelete = \n\n\t\tsetDeleteProjectModalOpen(true);\n\t};\n\n\tconst confirmProjectDelete = async () =&gt; {\n\t\tconst projectId = curProjectId;\n\t\tif (!projectId || !projectDeleteCallback) return;\n\t\t\n\t\ttry {\n\t\t\t// Execute the deletion callback provided by GroupedHistoryView\n\t\t\tawait projectDeleteCallback();\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Failed to delete project:\", error);\n\t\t} finally {\n\t\t\tsetCurProjectId(\"\");\n\t\t\tsetProjectDeleteCallback(null);\n\t\t\tsetDeleteProjectModalOpen(false);\n\t\t}\n\t};\n\n\tconst handleShare = async (taskId: string) =&gt; {\n\t\tshare(taskId);\n\t};\n\n\tconst handleReplay = async (taskId: string, question: string) =&gt; {\n\t\tchatStore.replay(taskId, question, 0);\n\t\tnavigate({ pathname: \"/\" });\n\t};\n\n\tconst handleSetActive = (taskId: string, question: string) =&gt; {\n\t\tconst task = chatStore.tasks[taskId];\n\t\tif (task) {\n\t\t\t// if there is a record, display the result\n\t\t\tchatStore.setActiveTaskId(taskId);\n\t\t\tnavigate(&#96;/&#96;);\n\t\t} else {\n\t\t\t// if there is no record, execute replay\n\t\t\thandleReplay(taskId, question);\n\t\t}\n\t};\n\n\tconst handleTakeControl = (type: \"pause\" | \"resume\", taskId: string) =&gt; {\n\t\tif (type === \"pause\") {\n\t\t\tlet { taskTime, elapsed } = chatStore.tasks[taskId];\n\n\t\t\tconst now = Date.now();\n\t\t\telapsed += now - taskTime;\n\t\t\tchatStore.setElapsed(taskId, elapsed);\n\t\t\tchatStore.setTaskTime(taskId, 0);\n\t\t} else {\n\t\t\tchatStore.setTaskTime(taskId, Date.now());\n\t\t}\n\t\tfetchPut(&#96;/task/${taskId}/take-control&#96;, {\n\t\t\taction: type,\n\t\t});\n\t\tif (type === \"pause\") {\n\t\t\tchatStore.setStatus(taskId, \"pause\");\n\t\t} else {\n\t\t\tchatStore.setStatus(taskId, \"running\");\n\t\t}\n\t};\n\n\n\tuseEffect(() =&gt; {\n\t\tfetchHistoryTasks(setHistoryTasks);\n\t}, []);\n\n\t// Feature flag to hide table view without deleting code\n\tconst TABLE_VIEW_ENABLED = false;\n\n\treturn\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 50,
                "column": 1
              },
              "endPosition": {
                "line": 50,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 50,
                "column": 16
              },
              "endPosition": {
                "line": 51,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "const handleProjectDelete = ",
            "lineNumber": 172
          },
          {
            "lineNumber": 174
          },
          {
            "text": "\t\tsetDeleteProjectModalOpen(true);",
            "lineNumber": 175
          },
          {
            "text": "\t};",
            "lineNumber": 176
          },
          {
            "lineNumber": 177
          },
          {
            "text": "\tconst confirmProjectDelete = async () =&gt; {",
            "lineNumber": 178
          },
          {
            "text": "\t\tconst projectId = curProjectId;",
            "lineNumber": 179
          },
          {
            "text": "\t\tif (!projectId || !projectDeleteCallback) return;",
            "lineNumber": 180
          },
          {
            "text": "\t\t",
            "lineNumber": 181
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 182
          },
          {
            "text": "\t\t\t// Execute the deletion callback provided by GroupedHistoryView",
            "lineNumber": 183
          },
          {
            "text": "\t\t\tawait projectDeleteCallback();",
            "lineNumber": 184
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 185
          },
          {
            "text": "\t\t\tconsole.error(\"Failed to delete project:\", error);",
            "lineNumber": 186
          },
          {
            "text": "\t\t} finally {",
            "lineNumber": 187
          },
          {
            "text": "\t\t\tsetCurProjectId(\"\");",
            "lineNumber": 188
          },
          {
            "text": "\t\t\tsetProjectDeleteCallback(null);",
            "lineNumber": 189
          },
          {
            "text": "\t\t\tsetDeleteProjectModalOpen(false);",
            "lineNumber": 190
          },
          {
            "text": "\t\t}",
            "lineNumber": 191
          },
          {
            "text": "\t};",
            "lineNumber": 192
          },
          {
            "lineNumber": 193
          },
          {
            "text": "\tconst handleShare = async (taskId: string) =&gt; {",
            "lineNumber": 194
          },
          {
            "text": "\t\tshare(taskId);",
            "lineNumber": 195
          },
          {
            "text": "\t};",
            "lineNumber": 196
          },
          {
            "lineNumber": 197
          },
          {
            "text": "\tconst handleReplay = async (taskId: string, question: string) =&gt; {",
            "lineNumber": 198
          },
          {
            "text": "\t\tchatStore.replay(taskId, question, 0);",
            "lineNumber": 199
          },
          {
            "text": "\t\tnavigate({ pathname: \"/\" });",
            "lineNumber": 200
          },
          {
            "text": "\t};",
            "lineNumber": 201
          },
          {
            "lineNumber": 202
          },
          {
            "text": "\tconst handleSetActive = (taskId: string, question: string) =&gt; {",
            "lineNumber": 203
          },
          {
            "text": "\t\tconst task = chatStore.tasks[taskId];",
            "lineNumber": 204
          },
          {
            "text": "\t\tif (task) {",
            "lineNumber": 205
          },
          {
            "text": "\t\t\t// if there is a record, display the result",
            "lineNumber": 206
          },
          {
            "text": "\t\t\tchatStore.setActiveTaskId(taskId);",
            "lineNumber": 207
          },
          {
            "text": "\t\t\tnavigate(&#96;/&#96;);",
            "lineNumber": 208
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 209
          },
          {
            "text": "\t\t\t// if there is no record, execute replay",
            "lineNumber": 210
          },
          {
            "text": "\t\t\thandleReplay(taskId, question);",
            "lineNumber": 211
          },
          {
            "text": "\t\t}",
            "lineNumber": 212
          },
          {
            "text": "\t};",
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "\tconst handleTakeControl = (type: \"pause\" | \"resume\", taskId: string) =&gt; {",
            "lineNumber": 215
          },
          {
            "text": "\t\tif (type === \"pause\") {",
            "lineNumber": 216
          },
          {
            "text": "\t\t\tlet { taskTime, elapsed } = chatStore.tasks[taskId];",
            "lineNumber": 217
          },
          {
            "lineNumber": 218
          },
          {
            "text": "\t\t\tconst now = Date.now();",
            "lineNumber": 219
          },
          {
            "text": "\t\t\telapsed += now - taskTime;",
            "lineNumber": 220
          },
          {
            "text": "\t\t\tchatStore.setElapsed(taskId, elapsed);",
            "lineNumber": 221
          },
          {
            "text": "\t\t\tchatStore.setTaskTime(taskId, 0);",
            "lineNumber": 222
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 223
          },
          {
            "text": "\t\t\tchatStore.setTaskTime(taskId, Date.now());",
            "lineNumber": 224
          },
          {
            "text": "\t\t}",
            "lineNumber": 225
          },
          {
            "text": "\t\tfetchPut(&#96;/task/${taskId}/take-control&#96;, {",
            "lineNumber": 226
          },
          {
            "text": "\t\t\taction: type,",
            "lineNumber": 227
          },
          {
            "text": "\t\t});",
            "lineNumber": 228
          },
          {
            "text": "\t\tif (type === \"pause\") {",
            "lineNumber": 229
          },
          {
            "text": "\t\t\tchatStore.setStatus(taskId, \"pause\");",
            "lineNumber": 230
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 231
          },
          {
            "text": "\t\t\tchatStore.setStatus(taskId, \"running\");",
            "lineNumber": 232
          },
          {
            "text": "\t\t}",
            "lineNumber": 233
          },
          {
            "text": "\t};",
            "lineNumber": 234
          },
          {
            "lineNumber": 235
          },
          {
            "lineNumber": 236
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 237
          },
          {
            "text": "\t\tfetchHistoryTasks(setHistoryTasks);",
            "lineNumber": 238
          },
          {
            "text": "\t}, []);",
            "lineNumber": 239
          },
          {
            "lineNumber": 240
          },
          {
            "text": "\t// Feature flag to hide table view without deleting code",
            "lineNumber": 241
          },
          {
            "text": "\tconst TABLE_VIEW_ENABLED = false;",
            "lineNumber": 242
          },
          {
            "lineNumber": 243
          },
          {
            "text": "\treturn",
            "lineNumber": 244
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.27956265211105347
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\Folder\\index.tsx",
        "range": {
          "startPosition": {
            "line": 154,
            "column": 1
          },
          "endPosition": {
            "line": 621,
            "column": 1
          }
        },
        "contents": "export default function Folder({ data }: { data?: Agent }) {\n  //Get Chatstore for the active project's task\n  const { chatStore, projectStore } = useChatStoreAdapter();\n  if (!chatStore) {\n    return &lt;div&gt;Loading...&lt;/div&gt;;\n  }\n\n  const authStore = useAuthStore();\n  const { t } = useTranslation();\n  const [selectedFile, setSelectedFile] = useState&lt;FileInfo | null&gt;(null);\n  const [loading, setLoading] = useState(false);\n\n  const selectedFileChange = (file: FileInfo, isShowSourceCode?: boolean) =&gt; {\n    if (file.type === 'zip') {\n      // if file is remote, don't call reveal-in-folder\n      if (file.isRemote) {\n        downloadByBrowser(file.path);\n        return;\n      }\n      window.ipcRenderer.invoke('reveal-in-folder', file.path);\n      return;\n    }\n    // Don't open folders in preview - they are handled by expand/collapse\n    if (file.isFolder) {\n      return;\n    }\n    setSelectedFile(file);\n    setLoading(true);\n    console.log('file', JSON.parse(JSON.stringify(file)));\n\n    // For PDF files, use data URL instead of custom protocol\n    if (file.type === 'pdf') {\n      window.ipcRenderer\n        .invoke('read-file-dataurl', file.path)\n        .then((dataUrl: string) =&gt; {\n          setSelectedFile({ ...file, content: dataUrl });\n          chatStore.setSelectedFile(chatStore.activeTaskId as string, file);\n          setLoading(false);\n        })\n        .catch((error) =&gt; {\n          console.error('read-file-dataurl error:', error);\n          setLoading(false);\n        });\n      return;\n    }\n\n    // all other files call open-file interface, the backend handles download and parsing\n    window.ipcRenderer\n      .invoke('open-file', file.type, file.path, isShowSourceCode)\n      .then((res) =&gt; {\n        setSelectedFile({ ...file, content: res });\n        chatStore.setSelectedFile(chatStore.activeTaskId as string, file);\n        setLoading(false);\n      })\n      .catch((error) =&gt; {\n        console.error('open-file error:', error);\n        setLoading(false);\n      });\n  };\n\n  const [isShowSourceCode, setIsShowSourceCode] = useState;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function Folder({ data }: { data?: Agent }) {",
            "lineNumber": 157,
            "isSignature": true
          },
          {
            "text": "  //Get Chatstore for the active project's task",
            "lineNumber": 158
          },
          {
            "text": "  const { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 159
          },
          {
            "text": "  if (!chatStore) {",
            "lineNumber": 160
          },
          {
            "text": "    return &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 161
          },
          {
            "text": "  }",
            "lineNumber": 162
          },
          {
            "lineNumber": 163
          },
          {
            "text": "  const authStore = useAuthStore();",
            "lineNumber": 164
          },
          {
            "text": "  const { t } = useTranslation();",
            "lineNumber": 165
          },
          {
            "text": "  const [selectedFile, setSelectedFile] = useState&lt;FileInfo | null&gt;(null);",
            "lineNumber": 166
          },
          {
            "text": "  const [loading, setLoading] = useState(false);",
            "lineNumber": 167
          },
          {
            "lineNumber": 168
          },
          {
            "text": "  const selectedFileChange = (file: FileInfo, isShowSourceCode?: boolean) =&gt; {",
            "lineNumber": 169
          },
          {
            "text": "    if (file.type === 'zip') {",
            "lineNumber": 170
          },
          {
            "text": "      // if file is remote, don't call reveal-in-folder",
            "lineNumber": 171
          },
          {
            "text": "      if (file.isRemote) {",
            "lineNumber": 172
          },
          {
            "text": "        downloadByBrowser(file.path);",
            "lineNumber": 173
          },
          {
            "text": "        return;",
            "lineNumber": 174
          },
          {
            "text": "      }",
            "lineNumber": 175
          },
          {
            "text": "      window.ipcRenderer.invoke('reveal-in-folder', file.path);",
            "lineNumber": 176
          },
          {
            "text": "      return;",
            "lineNumber": 177
          },
          {
            "text": "    }",
            "lineNumber": 178
          },
          {
            "text": "    // Don't open folders in preview - they are handled by expand/collapse",
            "lineNumber": 179
          },
          {
            "text": "    if (file.isFolder) {",
            "lineNumber": 180
          },
          {
            "text": "      return;",
            "lineNumber": 181
          },
          {
            "text": "    }",
            "lineNumber": 182
          },
          {
            "text": "    setSelectedFile(file);",
            "lineNumber": 183
          },
          {
            "text": "    setLoading(true);",
            "lineNumber": 184
          },
          {
            "text": "    console.log('file', JSON.parse(JSON.stringify(file)));",
            "lineNumber": 185
          },
          {
            "lineNumber": 186
          },
          {
            "text": "    // For PDF files, use data URL instead of custom protocol",
            "lineNumber": 187
          },
          {
            "text": "    if (file.type === 'pdf') {",
            "lineNumber": 188
          },
          {
            "text": "      window.ipcRenderer",
            "lineNumber": 189
          },
          {
            "text": "        .invoke('read-file-dataurl', file.path)",
            "lineNumber": 190
          },
          {
            "text": "        .then((dataUrl: string) =&gt; {",
            "lineNumber": 191
          },
          {
            "text": "          setSelectedFile({ ...file, content: dataUrl });",
            "lineNumber": 192
          },
          {
            "text": "          chatStore.setSelectedFile(chatStore.activeTaskId as string, file);",
            "lineNumber": 193
          },
          {
            "text": "          setLoading(false);",
            "lineNumber": 194
          },
          {
            "text": "        })",
            "lineNumber": 195
          },
          {
            "text": "        .catch((error) =&gt; {",
            "lineNumber": 196
          },
          {
            "text": "          console.error('read-file-dataurl error:', error);",
            "lineNumber": 197
          },
          {
            "text": "          setLoading(false);",
            "lineNumber": 198
          },
          {
            "text": "        });",
            "lineNumber": 199
          },
          {
            "text": "      return;",
            "lineNumber": 200
          },
          {
            "text": "    }",
            "lineNumber": 201
          },
          {
            "lineNumber": 202
          },
          {
            "text": "    // all other files call open-file interface, the backend handles download and parsing",
            "lineNumber": 203
          },
          {
            "text": "    window.ipcRenderer",
            "lineNumber": 204
          },
          {
            "text": "      .invoke('open-file', file.type, file.path, isShowSourceCode)",
            "lineNumber": 205
          },
          {
            "text": "      .then((res) =&gt; {",
            "lineNumber": 206
          },
          {
            "text": "        setSelectedFile({ ...file, content: res });",
            "lineNumber": 207
          },
          {
            "text": "        chatStore.setSelectedFile(chatStore.activeTaskId as string, file);",
            "lineNumber": 208
          },
          {
            "text": "        setLoading(false);",
            "lineNumber": 209
          },
          {
            "text": "      })",
            "lineNumber": 210
          },
          {
            "text": "      .catch((error) =&gt; {",
            "lineNumber": 211
          },
          {
            "text": "        console.error('open-file error:', error);",
            "lineNumber": 212
          },
          {
            "text": "        setLoading(false);",
            "lineNumber": 213
          },
          {
            "text": "      });",
            "lineNumber": 214
          },
          {
            "text": "  };",
            "lineNumber": 215
          },
          {
            "lineNumber": 216
          },
          {
            "text": "  const [isShowSourceCode, setIsShowSourceCode] = useState;",
            "lineNumber": 217
          },
          {
            "text": "}",
            "lineNumber": 622,
            "isSignature": true
          }
        ]
      },
      "score": 0.27740970253944397
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "column": 44
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "import useChatStoreAdapter from \"@/hooks/useChatStoreAdapter\";\nimport { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n\tCodeXml,\n\tFileText,\n\tGlobe,\n\tList,\n\tTable,\n\tImage,\n\tBird,\n\tBot,\n\tCirclePause,\n\tEllipsis,\n\tTrash2,\n\tShare,\n\tCirclePlay,\n} from \"lucide-react\";\nimport folderIcon from \"@/assets/Folder-1.svg\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Button } from \"@/components/ui/button\";\nimport { useGlobalStore } from \"@/store/globalStore\";\nimport {\n\tTooltip,\n\tTooltipContent,\n\tTooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport {\n\tPopover,\n\tPopoverContent,\n\tPopoverTrigger,\n\tPopoverClose,\n} from \"@/components/ui/popover\";\nimport {\n\tfetchPut,\n\tproxyFetchDelete,\n\tproxyFetchGet,\n} from \"@/api/http\";\nimport { getAuthStore } from \"@/store/authStore\";\nimport { ProjectGroup as ProjectGroupType } from \"@/types/history\";\nimport { Tag } from \"@/components/ui/tag\";\nimport { share } from \"@/lib/share\";\nimport { useTranslation } from \"react-i18next\";\nimport AlertDialog from \"@/components/ui/alertDialog\";\nimport { fetchHistoryTasks } from \"@/service/historyApi\";\nimport GroupedHistoryView from \"@/components/GroupedHistoryView\";\n\n\nexport default function Project() {\n\tconst {t} = useTranslation()\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import useChatStoreAdapter from \"@/hooks/useChatStoreAdapter\";",
            "lineNumber": 2
          },
          {
            "text": "import { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";",
            "lineNumber": 3
          },
          {
            "text": "import {",
            "lineNumber": 4
          },
          {
            "text": "\tCodeXml,",
            "lineNumber": 5
          },
          {
            "text": "\tFileText,",
            "lineNumber": 6
          },
          {
            "text": "\tGlobe,",
            "lineNumber": 7
          },
          {
            "text": "\tList,",
            "lineNumber": 8
          },
          {
            "text": "\tTable,",
            "lineNumber": 9
          },
          {
            "text": "\tImage,",
            "lineNumber": 10
          },
          {
            "text": "\tBird,",
            "lineNumber": 11
          },
          {
            "text": "\tBot,",
            "lineNumber": 12
          },
          {
            "text": "\tCirclePause,",
            "lineNumber": 13
          },
          {
            "text": "\tEllipsis,",
            "lineNumber": 14
          },
          {
            "text": "\tTrash2,",
            "lineNumber": 15
          },
          {
            "text": "\tShare,",
            "lineNumber": 16
          },
          {
            "text": "\tCirclePlay,",
            "lineNumber": 17
          },
          {
            "text": "} from \"lucide-react\";",
            "lineNumber": 18
          },
          {
            "text": "import folderIcon from \"@/assets/Folder-1.svg\";",
            "lineNumber": 19
          },
          {
            "text": "import { Progress } from \"@/components/ui/progress\";",
            "lineNumber": 20
          },
          {
            "text": "import { useNavigate } from \"react-router-dom\";",
            "lineNumber": 21
          },
          {
            "text": "import { Button } from \"@/components/ui/button\";",
            "lineNumber": 22
          },
          {
            "text": "import { useGlobalStore } from \"@/store/globalStore\";",
            "lineNumber": 23
          },
          {
            "text": "import {",
            "lineNumber": 24
          },
          {
            "text": "\tTooltip,",
            "lineNumber": 25
          },
          {
            "text": "\tTooltipContent,",
            "lineNumber": 26
          },
          {
            "text": "\tTooltipTrigger,",
            "lineNumber": 27
          },
          {
            "text": "} from \"@/components/ui/tooltip\";",
            "lineNumber": 28
          },
          {
            "text": "import {",
            "lineNumber": 29
          },
          {
            "text": "\tPopover,",
            "lineNumber": 30
          },
          {
            "text": "\tPopoverContent,",
            "lineNumber": 31
          },
          {
            "text": "\tPopoverTrigger,",
            "lineNumber": 32
          },
          {
            "text": "\tPopoverClose,",
            "lineNumber": 33
          },
          {
            "text": "} from \"@/components/ui/popover\";",
            "lineNumber": 34
          },
          {
            "text": "import {",
            "lineNumber": 35
          },
          {
            "text": "\tfetchPut,",
            "lineNumber": 36
          },
          {
            "text": "\tproxyFetchDelete,",
            "lineNumber": 37
          },
          {
            "text": "\tproxyFetchGet,",
            "lineNumber": 38
          },
          {
            "text": "} from \"@/api/http\";",
            "lineNumber": 39
          },
          {
            "text": "import { getAuthStore } from \"@/store/authStore\";",
            "lineNumber": 40
          },
          {
            "text": "import { ProjectGroup as ProjectGroupType } from \"@/types/history\";",
            "lineNumber": 41
          },
          {
            "text": "import { Tag } from \"@/components/ui/tag\";",
            "lineNumber": 42
          },
          {
            "text": "import { share } from \"@/lib/share\";",
            "lineNumber": 43
          },
          {
            "text": "import { useTranslation } from \"react-i18next\";",
            "lineNumber": 44
          },
          {
            "text": "import AlertDialog from \"@/components/ui/alertDialog\";",
            "lineNumber": 45
          },
          {
            "text": "import { fetchHistoryTasks } from \"@/service/historyApi\";",
            "lineNumber": 46
          },
          {
            "text": "import GroupedHistoryView from \"@/components/GroupedHistoryView\";",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "lineNumber": 49
          },
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "\tconst {t} = useTranslation()",
            "lineNumber": 51
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.26574090123176575
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 49
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\n\n\n      &lt;div className=\"flex w-full\"&gt;\n      &lt;div className=\"flex flex-col px-6 py-8 max-w-[900px] min-h-[calc(100vh-86px)] mx-auto w-full items-start justify-start\"&gt;\n        &lt;GroupedHistoryView\n          onTaskSelect={handleSetActive}\n          onTaskDelete={handleDelete}\n          onTaskShare={handleShare}\n          activeTaskId={chatStore.activeTaskId || undefined}\n          ongoingTasks={chatStore.tasks}\n          onOngoingTaskClick={(taskId) =&gt; {\n            chatStore.setActiveTaskId(taskId);\n            navigate(&#96;/&#96;);\n          }}\n          onOngoingTaskPause={(taskId) =&gt; handleTakeControl(\"pause\", taskId)}\n          onOngoingTaskResume={(taskId) =&gt; handleTakeControl(\"resume\", taskId)}\n          onOngoingTaskDelete={(taskId) =&gt; handleDelete(taskId)}\n          onProjectDelete={handleProjectDelete}\n          refreshTrigger={refreshTrigger}\n        /&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n  );\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 50,
                "column": 1
              },
              "endPosition": {
                "line": 50,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 50,
                "column": 16
              },
              "endPosition": {
                "line": 51,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "lineNumber": 277
          },
          {
            "lineNumber": 278
          },
          {
            "text": "      &lt;div className=\"flex w-full\"&gt;",
            "lineNumber": 279
          },
          {
            "text": "      &lt;div className=\"flex flex-col px-6 py-8 max-w-[900px] min-h-[calc(100vh-86px)] mx-auto w-full items-start justify-start\"&gt;",
            "lineNumber": 280
          },
          {
            "text": "        &lt;GroupedHistoryView",
            "lineNumber": 281
          },
          {
            "text": "          onTaskSelect={handleSetActive}",
            "lineNumber": 282
          },
          {
            "text": "          onTaskDelete={handleDelete}",
            "lineNumber": 283
          },
          {
            "text": "          onTaskShare={handleShare}",
            "lineNumber": 284
          },
          {
            "text": "          activeTaskId={chatStore.activeTaskId || undefined}",
            "lineNumber": 285
          },
          {
            "text": "          ongoingTasks={chatStore.tasks}",
            "lineNumber": 286
          },
          {
            "text": "          onOngoingTaskClick={(taskId) =&gt; {",
            "lineNumber": 287
          },
          {
            "text": "            chatStore.setActiveTaskId(taskId);",
            "lineNumber": 288
          },
          {
            "text": "            navigate(&#96;/&#96;);",
            "lineNumber": 289
          },
          {
            "text": "          }}",
            "lineNumber": 290
          },
          {
            "text": "          onOngoingTaskPause={(taskId) =&gt; handleTakeControl(\"pause\", taskId)}",
            "lineNumber": 291
          },
          {
            "text": "          onOngoingTaskResume={(taskId) =&gt; handleTakeControl(\"resume\", taskId)}",
            "lineNumber": 292
          },
          {
            "text": "          onOngoingTaskDelete={(taskId) =&gt; handleDelete(taskId)}",
            "lineNumber": 293
          },
          {
            "text": "          onProjectDelete={handleProjectDelete}",
            "lineNumber": 294
          },
          {
            "text": "          refreshTrigger={refreshTrigger}",
            "lineNumber": 295
          },
          {
            "text": "        /&gt;",
            "lineNumber": 296
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 297
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 298
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 299
          },
          {
            "text": "  );",
            "lineNumber": 300
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.264968603849411
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\n\n\n  // Check if any chat store in the project has messages\n  const hasAnyMessages = useMemo(() =&gt; {\n    // First check current active chat store\n    if (chatStore.activeTaskId &amp;&amp; chatStore.tasks[chatStore.activeTaskId]) {\n      const activeTask = chatStore.tasks[chatStore.activeTaskId];\n      if (\n        (activeTask.messages &amp;&amp; activeTask.messages.length &gt; 0) ||\n        activeTask.hasMessages\n      ) {\n        return true;\n      }\n    }\n\n    // Then check all other chat stores in the project\n    return getAllChatStoresMemoized.some(({ chatStore: store }) =&gt; {\n      const state = store.getState();\n      return (\n        state.activeTaskId &amp;&amp;\n        state.tasks[state.activeTaskId] &amp;&amp;\n        (state.tasks[state.activeTaskId].messages.length &gt; 0 ||\n          state.tasks[state.activeTaskId].hasMessages)\n      );\n    });\n  }, [chatStore, getAllChatStoresMemoized]);\n\n  const isTaskBusy = useMemo(() =&gt; {\n    if (!chatStore.activeTaskId || !chatStore.tasks[chatStore.activeTaskId])\n      return false;\n    const task = chatStore.tasks[chatStore.activeTaskId];\n    return (\n      // running or paused\n      task.status === 'running' ||\n      task.status === 'pause' ||\n      // splitting phase\n      task.messages.some((m) =&gt; m.step === 'to_sub_tasks' &amp;&amp; !m.isConfirm) ||\n      // skeleton/computing phase\n      (!task.messages.find((m) =&gt; m.step === 'to_sub_tasks') &amp;&amp;\n        !task.hasWaitComfirm &amp;&amp;\n        task.messages.length &gt; 0) ||\n      task.isTakeControl\n    );\n  }, [chatStore.activeTaskId, chatStore.tasks]);\n\n  const isInputDisabled = useMemo(() =&gt; {\n    if\n  }\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 854
          },
          {
            "lineNumber": 855
          },
          {
            "text": "  // Check if any chat store in the project has messages",
            "lineNumber": 856
          },
          {
            "text": "  const hasAnyMessages = useMemo(() =&gt; {",
            "lineNumber": 857
          },
          {
            "text": "    // First check current active chat store",
            "lineNumber": 858
          },
          {
            "text": "    if (chatStore.activeTaskId &amp;&amp; chatStore.tasks[chatStore.activeTaskId]) {",
            "lineNumber": 859
          },
          {
            "text": "      const activeTask = chatStore.tasks[chatStore.activeTaskId];",
            "lineNumber": 860
          },
          {
            "text": "      if (",
            "lineNumber": 861
          },
          {
            "text": "        (activeTask.messages &amp;&amp; activeTask.messages.length &gt; 0) ||",
            "lineNumber": 862
          },
          {
            "text": "        activeTask.hasMessages",
            "lineNumber": 863
          },
          {
            "text": "      ) {",
            "lineNumber": 864
          },
          {
            "text": "        return true;",
            "lineNumber": 865
          },
          {
            "text": "      }",
            "lineNumber": 866
          },
          {
            "text": "    }",
            "lineNumber": 867
          },
          {
            "lineNumber": 868
          },
          {
            "text": "    // Then check all other chat stores in the project",
            "lineNumber": 869
          },
          {
            "text": "    return getAllChatStoresMemoized.some(({ chatStore: store }) =&gt; {",
            "lineNumber": 870
          },
          {
            "text": "      const state = store.getState();",
            "lineNumber": 871
          },
          {
            "text": "      return (",
            "lineNumber": 872
          },
          {
            "text": "        state.activeTaskId &amp;&amp;",
            "lineNumber": 873
          },
          {
            "text": "        state.tasks[state.activeTaskId] &amp;&amp;",
            "lineNumber": 874
          },
          {
            "text": "        (state.tasks[state.activeTaskId].messages.length &gt; 0 ||",
            "lineNumber": 875
          },
          {
            "text": "          state.tasks[state.activeTaskId].hasMessages)",
            "lineNumber": 876
          },
          {
            "text": "      );",
            "lineNumber": 877
          },
          {
            "text": "    });",
            "lineNumber": 878
          },
          {
            "text": "  }, [chatStore, getAllChatStoresMemoized]);",
            "lineNumber": 879
          },
          {
            "lineNumber": 880
          },
          {
            "text": "  const isTaskBusy = useMemo(() =&gt; {",
            "lineNumber": 881
          },
          {
            "text": "    if (!chatStore.activeTaskId || !chatStore.tasks[chatStore.activeTaskId])",
            "lineNumber": 882
          },
          {
            "text": "      return false;",
            "lineNumber": 883
          },
          {
            "text": "    const task = chatStore.tasks[chatStore.activeTaskId];",
            "lineNumber": 884
          },
          {
            "text": "    return (",
            "lineNumber": 885
          },
          {
            "text": "      // running or paused",
            "lineNumber": 886
          },
          {
            "text": "      task.status === 'running' ||",
            "lineNumber": 887
          },
          {
            "text": "      task.status === 'pause' ||",
            "lineNumber": 888
          },
          {
            "text": "      // splitting phase",
            "lineNumber": 889
          },
          {
            "text": "      task.messages.some((m) =&gt; m.step === 'to_sub_tasks' &amp;&amp; !m.isConfirm) ||",
            "lineNumber": 890
          },
          {
            "text": "      // skeleton/computing phase",
            "lineNumber": 891
          },
          {
            "text": "      (!task.messages.find((m) =&gt; m.step === 'to_sub_tasks') &amp;&amp;",
            "lineNumber": 892
          },
          {
            "text": "        !task.hasWaitComfirm &amp;&amp;",
            "lineNumber": 893
          },
          {
            "text": "        task.messages.length &gt; 0) ||",
            "lineNumber": 894
          },
          {
            "text": "      task.isTakeControl",
            "lineNumber": 895
          },
          {
            "text": "    );",
            "lineNumber": 896
          },
          {
            "text": "  }, [chatStore.activeTaskId, chatStore.tasks]);",
            "lineNumber": 897
          },
          {
            "lineNumber": 898
          },
          {
            "text": "  const isInputDisabled = useMemo(() =&gt; {",
            "lineNumber": 899
          },
          {
            "text": "    if",
            "lineNumber": 900
          },
          {
            "text": "  }",
            "lineNumber": 917
          },
          {
            "text": ";",
            "lineNumber": 924
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.26221323013305664
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\ProjectChatContainer.tsx",
        "range": {
          "startPosition": {
            "line": 12
          },
          "endPosition": {
            "line": 176,
            "column": 2
          }
        },
        "contents": "export const ProjectChatContainer: React.FC&lt;ProjectChatContainerProps&gt; = \n() =&gt; {\n() =&gt; {\n\n      }\n    };\n  }, []);\n\n  return (\n    &lt;div \n      ref={containerRef}\n      className={&#96;flex-1 relative z-10 flex flex-col mt-sm overflow-y-auto scrollbar ${className}&#96;}\n    &gt;\n      &lt;AnimatePresence mode=\"popLayout\"&gt;\n        {chatStores.map(({ chatId, chatStore }) =&gt; {\n          const chatState = chatStore.getState();\n          const activeTaskId = chatState.activeTaskId;\n          \n          if (!activeTaskId || !chatState.tasks[activeTaskId]) {\n            return null;\n          }\n\n          const task = chatState.tasks[activeTaskId];\n          const messages = task.messages || [];\n          \n          // Only render if there are actual user messages (not just empty or system messages)\n          const hasUserMessages = messages.some((msg: any) =&gt; msg.role === 'user' &amp;&amp; msg.content);\n          \n          if (!hasUserMessages) {\n            return null;\n          }\n\n          return (\n            &lt;ProjectSection\n              key={chatId}\n              chatId={chatId}\n              chatStore={chatStore}\n              activeQueryId={activeQueryId}\n              onQueryActive={setActiveQueryId}\n              // onPauseResume={onPauseResume}  // Commented out - temporary not needed\n              onSkip={onSkip}\n              isPauseResumeLoading={isPauseResumeLoading}\n            /&gt;\n          );\n        })}\n      &lt;/AnimatePresence&gt;\n    &lt;/div&gt;\n  );\n};",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 13,
                "column": 1
              },
              "endPosition": {
                "line": 13,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 13,
                "column": 8
              },
              "endPosition": {
                "line": 13,
                "column": 14
              }
            },
            {
              "startPosition": {
                "line": 13,
                "column": 14
              },
              "endPosition": {
                "line": 13,
                "column": 74
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export const ProjectChatContainer: React.FC&lt;ProjectChatContainerProps&gt; = ",
            "lineNumber": 13
          },
          {
            "text": "() =&gt; {",
            "lineNumber": 108
          },
          {
            "text": "() =&gt; {",
            "lineNumber": 129
          },
          {
            "lineNumber": 132
          },
          {
            "text": "      }",
            "lineNumber": 133
          },
          {
            "text": "    };",
            "lineNumber": 134
          },
          {
            "text": "  }, []);",
            "lineNumber": 135
          },
          {
            "lineNumber": 136
          },
          {
            "text": "  return (",
            "lineNumber": 137
          },
          {
            "text": "    &lt;div ",
            "lineNumber": 138
          },
          {
            "text": "      ref={containerRef}",
            "lineNumber": 139
          },
          {
            "text": "      className={&#96;flex-1 relative z-10 flex flex-col mt-sm overflow-y-auto scrollbar ${className}&#96;}",
            "lineNumber": 140
          },
          {
            "text": "    &gt;",
            "lineNumber": 141
          },
          {
            "text": "      &lt;AnimatePresence mode=\"popLayout\"&gt;",
            "lineNumber": 142
          },
          {
            "text": "        {chatStores.map(({ chatId, chatStore }) =&gt; {",
            "lineNumber": 143
          },
          {
            "text": "          const chatState = chatStore.getState();",
            "lineNumber": 144
          },
          {
            "text": "          const activeTaskId = chatState.activeTaskId;",
            "lineNumber": 145
          },
          {
            "text": "          ",
            "lineNumber": 146
          },
          {
            "text": "          if (!activeTaskId || !chatState.tasks[activeTaskId]) {",
            "lineNumber": 147
          },
          {
            "text": "            return null;",
            "lineNumber": 148
          },
          {
            "text": "          }",
            "lineNumber": 149
          },
          {
            "lineNumber": 150
          },
          {
            "text": "          const task = chatState.tasks[activeTaskId];",
            "lineNumber": 151
          },
          {
            "text": "          const messages = task.messages || [];",
            "lineNumber": 152
          },
          {
            "text": "          ",
            "lineNumber": 153
          },
          {
            "text": "          // Only render if there are actual user messages (not just empty or system messages)",
            "lineNumber": 154
          },
          {
            "text": "          const hasUserMessages = messages.some((msg: any) =&gt; msg.role === 'user' &amp;&amp; msg.content);",
            "lineNumber": 155
          },
          {
            "text": "          ",
            "lineNumber": 156
          },
          {
            "text": "          if (!hasUserMessages) {",
            "lineNumber": 157
          },
          {
            "text": "            return null;",
            "lineNumber": 158
          },
          {
            "text": "          }",
            "lineNumber": 159
          },
          {
            "lineNumber": 160
          },
          {
            "text": "          return (",
            "lineNumber": 161
          },
          {
            "text": "            &lt;ProjectSection",
            "lineNumber": 162
          },
          {
            "text": "              key={chatId}",
            "lineNumber": 163
          },
          {
            "text": "              chatId={chatId}",
            "lineNumber": 164
          },
          {
            "text": "              chatStore={chatStore}",
            "lineNumber": 165
          },
          {
            "text": "              activeQueryId={activeQueryId}",
            "lineNumber": 166
          },
          {
            "text": "              onQueryActive={setActiveQueryId}",
            "lineNumber": 167
          },
          {
            "text": "              // onPauseResume={onPauseResume}  // Commented out - temporary not needed",
            "lineNumber": 168
          },
          {
            "text": "              onSkip={onSkip}",
            "lineNumber": 169
          },
          {
            "text": "              isPauseResumeLoading={isPauseResumeLoading}",
            "lineNumber": 170
          },
          {
            "text": "            /&gt;",
            "lineNumber": 171
          },
          {
            "text": "          );",
            "lineNumber": 172
          },
          {
            "text": "        })}",
            "lineNumber": 173
          },
          {
            "text": "      &lt;/AnimatePresence&gt;",
            "lineNumber": 174
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 175
          },
          {
            "text": "  );",
            "lineNumber": 176
          },
          {
            "text": "};",
            "lineNumber": 177
          }
        ]
      },
      "score": 0.26178911328315735
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\ProjectSection.tsx",
        "range": {
          "startPosition": {
            "line": 14,
            "column": 1
          },
          "endPosition": {
            "line": 115,
            "column": 1
          }
        },
        "contents": "export const ProjectSection = React.forwardRef&lt;HTMLDivElement, ProjectSectionProps&gt;(({\n  chatId,\n  chatStore,\n  activeQueryId,\n  onQueryActive,\n  // onPauseResume,  // Commented out - temporary not needed\n  onSkip,\n  isPauseResumeLoading\n}, ref) =&gt; {\n  // Subscribe to store changes with throttling to prevent excessive re-renders\n  const [chatState, setChatState] = React.useState(() =&gt; chatStore.getState());\n\n  React.useEffect(() =&gt; {\n    let timeoutId: NodeJS.Timeout | null = null;\n    let latestState: any = null;\n\n    const unsubscribe = chatStore.subscribe((state) =&gt; {\n      latestState = state;\n\n      // Throttle updates to max once per 100ms\n      if (!timeoutId) {\n        timeoutId = setTimeout(() =&gt; {\n          if (latestState) {\n            setChatState(latestState);\n          }\n          timeoutId = null;\n        }, 100);\n      }\n    });\n\n    return () =&gt; {\n      unsubscribe();\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n        // Apply final state on cleanup\n        if (latestState) {\n          setChatState(latestState);\n        }\n      }\n    };\n  }, [chatStore]);\n\n  const activeTaskId = chatState.activeTaskId;\n\n  if (!activeTaskId || !chatState.tasks[activeTaskId]) {\n    return null;\n  }\n\n  const task = chatState.tasks[activeTaskId];\n  const messages = task.messages || [];\n\n  // Create a stable key based on messages content to prevent excessive re-renders\n  const lastMessage = messages[messages.length - 1];\n  const messagesKey = React.useMemo(() =&gt; {\n    // Only re-compute when message count or last message changes\n    return &#96;${messages.length}-${lastMessage?.id || ''}-${lastMessage?.content?.length || 0}&#96;;\n  }, [messages.length, lastMessage?.id, lastMessage?.content?.length]);\n\n  // Memoize grouping to prevent re-creating objects on every render\n  const queryGroups = React.useMemo(() =&gt; {\n    return groupMessagesByQuery(messages);\n  }, [messagesKey]);\n\n  return (\n    &lt;motion.div\n      ref={ref}\n};",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export const ProjectSection = React.forwardRef&lt;HTMLDivElement, ProjectSectionProps&gt;(({",
            "lineNumber": 17
          },
          {
            "text": "  chatId,",
            "lineNumber": 18
          },
          {
            "text": "  chatStore,",
            "lineNumber": 19
          },
          {
            "text": "  activeQueryId,",
            "lineNumber": 20
          },
          {
            "text": "  onQueryActive,",
            "lineNumber": 21
          },
          {
            "text": "  // onPauseResume,  // Commented out - temporary not needed",
            "lineNumber": 22
          },
          {
            "text": "  onSkip,",
            "lineNumber": 23
          },
          {
            "text": "  isPauseResumeLoading",
            "lineNumber": 24
          },
          {
            "text": "}, ref) =&gt; {",
            "lineNumber": 25
          },
          {
            "text": "  // Subscribe to store changes with throttling to prevent excessive re-renders",
            "lineNumber": 26
          },
          {
            "text": "  const [chatState, setChatState] = React.useState(() =&gt; chatStore.getState());",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "  React.useEffect(() =&gt; {",
            "lineNumber": 29
          },
          {
            "text": "    let timeoutId: NodeJS.Timeout | null = null;",
            "lineNumber": 30
          },
          {
            "text": "    let latestState: any = null;",
            "lineNumber": 31
          },
          {
            "lineNumber": 32
          },
          {
            "text": "    const unsubscribe = chatStore.subscribe((state) =&gt; {",
            "lineNumber": 33
          },
          {
            "text": "      latestState = state;",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "      // Throttle updates to max once per 100ms",
            "lineNumber": 36
          },
          {
            "text": "      if (!timeoutId) {",
            "lineNumber": 37
          },
          {
            "text": "        timeoutId = setTimeout(() =&gt; {",
            "lineNumber": 38
          },
          {
            "text": "          if (latestState) {",
            "lineNumber": 39
          },
          {
            "text": "            setChatState(latestState);",
            "lineNumber": 40
          },
          {
            "text": "          }",
            "lineNumber": 41
          },
          {
            "text": "          timeoutId = null;",
            "lineNumber": 42
          },
          {
            "text": "        }, 100);",
            "lineNumber": 43
          },
          {
            "text": "      }",
            "lineNumber": 44
          },
          {
            "text": "    });",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "    return () =&gt; {",
            "lineNumber": 47
          },
          {
            "text": "      unsubscribe();",
            "lineNumber": 48
          },
          {
            "text": "      if (timeoutId) {",
            "lineNumber": 49
          },
          {
            "text": "        clearTimeout(timeoutId);",
            "lineNumber": 50
          },
          {
            "text": "        // Apply final state on cleanup",
            "lineNumber": 51
          },
          {
            "text": "        if (latestState) {",
            "lineNumber": 52
          },
          {
            "text": "          setChatState(latestState);",
            "lineNumber": 53
          },
          {
            "text": "        }",
            "lineNumber": 54
          },
          {
            "text": "      }",
            "lineNumber": 55
          },
          {
            "text": "    };",
            "lineNumber": 56
          },
          {
            "text": "  }, [chatStore]);",
            "lineNumber": 57
          },
          {
            "lineNumber": 58
          },
          {
            "text": "  const activeTaskId = chatState.activeTaskId;",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "  if (!activeTaskId || !chatState.tasks[activeTaskId]) {",
            "lineNumber": 61
          },
          {
            "text": "    return null;",
            "lineNumber": 62
          },
          {
            "text": "  }",
            "lineNumber": 63
          },
          {
            "lineNumber": 64
          },
          {
            "text": "  const task = chatState.tasks[activeTaskId];",
            "lineNumber": 65
          },
          {
            "text": "  const messages = task.messages || [];",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "  // Create a stable key based on messages content to prevent excessive re-renders",
            "lineNumber": 68
          },
          {
            "text": "  const lastMessage = messages[messages.length - 1];",
            "lineNumber": 69
          },
          {
            "text": "  const messagesKey = React.useMemo(() =&gt; {",
            "lineNumber": 70
          },
          {
            "text": "    // Only re-compute when message count or last message changes",
            "lineNumber": 71
          },
          {
            "text": "    return &#96;${messages.length}-${lastMessage?.id || ''}-${lastMessage?.content?.length || 0}&#96;;",
            "lineNumber": 72
          },
          {
            "text": "  }, [messages.length, lastMessage?.id, lastMessage?.content?.length]);",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "  // Memoize grouping to prevent re-creating objects on every render",
            "lineNumber": 75
          },
          {
            "text": "  const queryGroups = React.useMemo(() =&gt; {",
            "lineNumber": 76
          },
          {
            "text": "    return groupMessagesByQuery(messages);",
            "lineNumber": 77
          },
          {
            "text": "  }, [messagesKey]);",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "  return (",
            "lineNumber": 80
          },
          {
            "text": "    &lt;motion.div",
            "lineNumber": 81
          },
          {
            "text": "      ref={ref}",
            "lineNumber": 82
          },
          {
            "text": "};",
            "lineNumber": 116
          }
        ]
      },
      "score": 0.2617727518081665
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "column": 74
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "import {\n  fetchPost,\n  proxyFetchPut,\n  fetchPut,\n  fetchDelete,\n  proxyFetchDelete,\n} from '@/api/http';\nimport BottomBox from './BottomBox';\nimport { ProjectChatContainer } from './ProjectChatContainer';\nimport { TriangleAlert, Square, SquareCheckBig } from 'lucide-react';\nimport { generateUniqueId } from '@/lib';\nimport { proxyFetchGet } from '@/api/http';\nimport { useNavigate, useSearchParams, useLocation } from 'react-router-dom';\nimport { useAuthStore } from '@/store/authStore';\nimport { useTranslation } from 'react-i18next';\nimport { toast } from 'sonner';\nimport useChatStoreAdapter from '@/hooks/useChatStoreAdapter';\nimport { replayActiveTask } from '@/lib';\n\nexport default function ChatBox(): JSX.Element {\n  const [message, setMessage] = useState&lt;string&gt;('');\n\n  //Get Chatstore for the active project's task\n  const { chatStore, projectStore } = useChatStoreAdapter();\n  if (!chatStore) {\n    return &lt;div&gt;Loading...&lt;/div&gt;;\n  }\n\n  const { t } = useTranslation();\n  const textareaRef = useRef&lt;HTMLTextAreaElement&gt;(null);\n  const scrollContainerRef = useRef&lt;HTMLDivElement&gt;(null);\n  const [privacy, setPrivacy] = useState&lt;any&gt;(false);\n  const [isPrivacyLoaded, setIsPrivacyLoaded] = useState&lt;boolean&gt;(false);\n  const [hasSearchKey, setHasSearchKey] = useState&lt;any&gt;(false);\n  const [hasModel, setHasModel] = useState&lt;any&gt;(false);\n  const [isConfigLoaded, setIsConfigLoaded] = useState&lt;boolean&gt;(false);\n  const scrollTimeoutRef = useRef&lt;NodeJS.Timeout | null&gt;(null);\n  // const [privacyDialogOpen, setPrivacyDialogOpen] = useState(false);\n  const { modelType } = useAuthStore();\n  const [useCloudModelInDev, setUseCloudModelInDev] = useState(false);\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  // Shared function to check model configuration\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import {",
            "lineNumber": 2
          },
          {
            "text": "  fetchPost,",
            "lineNumber": 3
          },
          {
            "text": "  proxyFetchPut,",
            "lineNumber": 4
          },
          {
            "text": "  fetchPut,",
            "lineNumber": 5
          },
          {
            "text": "  fetchDelete,",
            "lineNumber": 6
          },
          {
            "text": "  proxyFetchDelete,",
            "lineNumber": 7
          },
          {
            "text": "} from '@/api/http';",
            "lineNumber": 8
          },
          {
            "text": "import BottomBox from './BottomBox';",
            "lineNumber": 9
          },
          {
            "text": "import { ProjectChatContainer } from './ProjectChatContainer';",
            "lineNumber": 10
          },
          {
            "text": "import { TriangleAlert, Square, SquareCheckBig } from 'lucide-react';",
            "lineNumber": 11
          },
          {
            "text": "import { generateUniqueId } from '@/lib';",
            "lineNumber": 12
          },
          {
            "text": "import { proxyFetchGet } from '@/api/http';",
            "lineNumber": 13
          },
          {
            "text": "import { useNavigate, useSearchParams, useLocation } from 'react-router-dom';",
            "lineNumber": 14
          },
          {
            "text": "import { useAuthStore } from '@/store/authStore';",
            "lineNumber": 15
          },
          {
            "text": "import { useTranslation } from 'react-i18next';",
            "lineNumber": 16
          },
          {
            "text": "import { toast } from 'sonner';",
            "lineNumber": 17
          },
          {
            "text": "import useChatStoreAdapter from '@/hooks/useChatStoreAdapter';",
            "lineNumber": 18
          },
          {
            "text": "import { replayActiveTask } from '@/lib';",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "  const [message, setMessage] = useState&lt;string&gt;('');",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "  //Get Chatstore for the active project's task",
            "lineNumber": 24
          },
          {
            "text": "  const { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 25
          },
          {
            "text": "  if (!chatStore) {",
            "lineNumber": 26
          },
          {
            "text": "    return &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 27
          },
          {
            "text": "  }",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "  const { t } = useTranslation();",
            "lineNumber": 30
          },
          {
            "text": "  const textareaRef = useRef&lt;HTMLTextAreaElement&gt;(null);",
            "lineNumber": 31
          },
          {
            "text": "  const scrollContainerRef = useRef&lt;HTMLDivElement&gt;(null);",
            "lineNumber": 32
          },
          {
            "text": "  const [privacy, setPrivacy] = useState&lt;any&gt;(false);",
            "lineNumber": 33
          },
          {
            "text": "  const [isPrivacyLoaded, setIsPrivacyLoaded] = useState&lt;boolean&gt;(false);",
            "lineNumber": 34
          },
          {
            "text": "  const [hasSearchKey, setHasSearchKey] = useState&lt;any&gt;(false);",
            "lineNumber": 35
          },
          {
            "text": "  const [hasModel, setHasModel] = useState&lt;any&gt;(false);",
            "lineNumber": 36
          },
          {
            "text": "  const [isConfigLoaded, setIsConfigLoaded] = useState&lt;boolean&gt;(false);",
            "lineNumber": 37
          },
          {
            "text": "  const scrollTimeoutRef = useRef&lt;NodeJS.Timeout | null&gt;(null);",
            "lineNumber": 38
          },
          {
            "text": "  // const [privacyDialogOpen, setPrivacyDialogOpen] = useState(false);",
            "lineNumber": 39
          },
          {
            "text": "  const { modelType } = useAuthStore();",
            "lineNumber": 40
          },
          {
            "text": "  const [useCloudModelInDev, setUseCloudModelInDev] = useState(false);",
            "lineNumber": 41
          },
          {
            "text": "  const location = useLocation();",
            "lineNumber": 42
          },
          {
            "text": "  const navigate = useNavigate();",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "  // Shared function to check model configuration",
            "lineNumber": 45
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.26101720333099365
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\ProjectSection.tsx",
        "range": {
          "startPosition": {
            "line": 16
          },
          "endPosition": {
            "line": 118,
            "column": 46
          }
        },
        "contents": "export const ProjectSection = ({\n  chatId,\n  chatStore,\n  activeQueryId,\n  onQueryActive,\n  // onPauseResume,  // Commented out - temporary not needed\n  onSkip,\n  isPauseResumeLoading\n}, ref) =&gt; {\nconst queryGroups = () =&gt; {\n\n  }, [messagesKey]);\n\n  return (\n    &lt;motion.div\n      ref={ref}\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: -20 }}\n      transition={{ duration: 0.3 }}\n      className=\"relative mb-8\"\n    &gt;\n      {/* User Query Groups */}\n      &lt;div className=\"space-y-0\"&gt;\n        {queryGroups.map((group, index) =&gt; (\n          &lt;UserQueryGroup\n            key={&#96;${chatId}-${group.queryId}&#96;}\n            chatId={chatId}\n            chatStore={chatStore}\n            queryGroup={group}\n            isActive={activeQueryId === group.queryId}\n            onQueryActive={onQueryActive}\n            index={index}\n          /&gt;\n        ))}\n      &lt;/div&gt;\n\n      {/* Floating Action Button - positioned at project level */}\n      {activeTaskId &amp;&amp; (\n        &lt;FloatingAction\n          status={task.status}\n          // onPause={onPauseResume}  // Commented out - temporary not needed\n          // onResume={onPauseResume}  // Commented out - temporary not needed\n          onSkip={onSkip}\n          loading={isPauseResumeLoading}\n        /&gt;\n      )}\n    &lt;/motion.div&gt;\n  );\n});\n\n// Add display name for better debugging\nProjectSection.displayName = 'ProjectSection';",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 17,
                "column": 1
              },
              "endPosition": {
                "line": 17,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 17,
                "column": 8
              },
              "endPosition": {
                "line": 17,
                "column": 14
              }
            },
            {
              "startPosition": {
                "line": 17,
                "column": 14
              },
              "endPosition": {
                "line": 17,
                "column": 31
              }
            },
            {
              "startPosition": {
                "line": 17,
                "column": 85
              },
              "endPosition": {
                "line": 26,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export const ProjectSection = ({",
            "lineNumber": 17
          },
          {
            "text": "  chatId,",
            "lineNumber": 18
          },
          {
            "text": "  chatStore,",
            "lineNumber": 19
          },
          {
            "text": "  activeQueryId,",
            "lineNumber": 20
          },
          {
            "text": "  onQueryActive,",
            "lineNumber": 21
          },
          {
            "text": "  // onPauseResume,  // Commented out - temporary not needed",
            "lineNumber": 22
          },
          {
            "text": "  onSkip,",
            "lineNumber": 23
          },
          {
            "text": "  isPauseResumeLoading",
            "lineNumber": 24
          },
          {
            "text": "}, ref) =&gt; {",
            "lineNumber": 25
          },
          {
            "text": "const queryGroups = () =&gt; {",
            "lineNumber": 76
          },
          {
            "lineNumber": 77
          },
          {
            "text": "  }, [messagesKey]);",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "  return (",
            "lineNumber": 80
          },
          {
            "text": "    &lt;motion.div",
            "lineNumber": 81
          },
          {
            "text": "      ref={ref}",
            "lineNumber": 82
          },
          {
            "text": "      initial={{ opacity: 0, y: 20 }}",
            "lineNumber": 83
          },
          {
            "text": "      animate={{ opacity: 1, y: 0 }}",
            "lineNumber": 84
          },
          {
            "text": "      exit={{ opacity: 0, y: -20 }}",
            "lineNumber": 85
          },
          {
            "text": "      transition={{ duration: 0.3 }}",
            "lineNumber": 86
          },
          {
            "text": "      className=\"relative mb-8\"",
            "lineNumber": 87
          },
          {
            "text": "    &gt;",
            "lineNumber": 88
          },
          {
            "text": "      {/* User Query Groups */}",
            "lineNumber": 89
          },
          {
            "text": "      &lt;div className=\"space-y-0\"&gt;",
            "lineNumber": 90
          },
          {
            "text": "        {queryGroups.map((group, index) =&gt; (",
            "lineNumber": 91
          },
          {
            "text": "          &lt;UserQueryGroup",
            "lineNumber": 92
          },
          {
            "text": "            key={&#96;${chatId}-${group.queryId}&#96;}",
            "lineNumber": 93
          },
          {
            "text": "            chatId={chatId}",
            "lineNumber": 94
          },
          {
            "text": "            chatStore={chatStore}",
            "lineNumber": 95
          },
          {
            "text": "            queryGroup={group}",
            "lineNumber": 96
          },
          {
            "text": "            isActive={activeQueryId === group.queryId}",
            "lineNumber": 97
          },
          {
            "text": "            onQueryActive={onQueryActive}",
            "lineNumber": 98
          },
          {
            "text": "            index={index}",
            "lineNumber": 99
          },
          {
            "text": "          /&gt;",
            "lineNumber": 100
          },
          {
            "text": "        ))}",
            "lineNumber": 101
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 102
          },
          {
            "lineNumber": 103
          },
          {
            "text": "      {/* Floating Action Button - positioned at project level */}",
            "lineNumber": 104
          },
          {
            "text": "      {activeTaskId &amp;&amp; (",
            "lineNumber": 105
          },
          {
            "text": "        &lt;FloatingAction",
            "lineNumber": 106
          },
          {
            "text": "          status={task.status}",
            "lineNumber": 107
          },
          {
            "text": "          // onPause={onPauseResume}  // Commented out - temporary not needed",
            "lineNumber": 108
          },
          {
            "text": "          // onResume={onPauseResume}  // Commented out - temporary not needed",
            "lineNumber": 109
          },
          {
            "text": "          onSkip={onSkip}",
            "lineNumber": 110
          },
          {
            "text": "          loading={isPauseResumeLoading}",
            "lineNumber": 111
          },
          {
            "text": "        /&gt;",
            "lineNumber": 112
          },
          {
            "text": "      )}",
            "lineNumber": 113
          },
          {
            "text": "    &lt;/motion.div&gt;",
            "lineNumber": 114
          },
          {
            "text": "  );",
            "lineNumber": 115
          },
          {
            "text": "});",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "// Add display name for better debugging",
            "lineNumber": 118
          },
          {
            "text": "ProjectSection.displayName = 'ProjectSection';",
            "lineNumber": 119
          }
        ]
      },
      "score": 0.2518810033798218
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\n\"&gt;\n      {hasAnyMessages ? (\n        &lt;div className=\"w-full h-full flex-1 flex flex-col\"&gt;\n          {/* New Project Chat Container */}\n          &lt;ProjectChatContainer\n            // onPauseResume={handlePauseResume}  // Commented out - temporary not needed\n            onSkip={handleSkip}\n            isPauseResumeLoading={isPauseResumeLoading}\n          /&gt;\n          {chatStore.activeTaskId &amp;&amp; (\n            &lt;BottomBox\n              state={getBottomBoxState()}\n              queuedMessages={\n                isTaskBusy\n                  ? []\n                  : projectStore\n                      .getProjectById(projectStore.activeProjectId || '')\n                      ?.queuedMessages?.map((m) =&gt; ({\n                        id: m.task_id,\n                        content: m.content,\n                        timestamp: m.timestamp,\n                      })) || []\n              }\n              onRemoveQueuedMessage={(id) =&gt; handleRemoveTaskQueue(id)}\n              subtitle={\n                getBottomBoxState() === 'confirm'\n                  ? (() =&gt; {\n                      // Find the last message where role is \"user\"\n                      const messages =\n                        chatStore.tasks[chatStore.activeTaskId]?.messages || [];\n                      const lastUserMessage = messages\n                        .slice()\n                        .reverse()\n                        .find((msg) =&gt; msg.role === 'user');\n                      return (\n                        lastUserMessage?.content ||\n                        chatStore.tasks[chatStore.activeTaskId]?.summaryTask\n                      );\n                    })()\n                  : chatStore.tasks[chatStore.activeTaskId]?.summaryTask\n              }\n              onStartTask={() =&gt; handleConfirmTask()}\n              onEdit={handleEditQuery}\n              tokens={chatStore.tasks[chatStore.activeTaskId]?.tokens || 0}\n              taskTime={taskTime}\n              taskStatus={chatStore.tasks[chatStore.activeTaskId]?.status}\n              onReplay={handleReplay}\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "\"&gt;",
            "lineNumber": 927
          },
          {
            "text": "      {hasAnyMessages ? (",
            "lineNumber": 928
          },
          {
            "text": "        &lt;div className=\"w-full h-full flex-1 flex flex-col\"&gt;",
            "lineNumber": 929
          },
          {
            "text": "          {/* New Project Chat Container */}",
            "lineNumber": 930
          },
          {
            "text": "          &lt;ProjectChatContainer",
            "lineNumber": 931
          },
          {
            "text": "            // onPauseResume={handlePauseResume}  // Commented out - temporary not needed",
            "lineNumber": 932
          },
          {
            "text": "            onSkip={handleSkip}",
            "lineNumber": 933
          },
          {
            "text": "            isPauseResumeLoading={isPauseResumeLoading}",
            "lineNumber": 934
          },
          {
            "text": "          /&gt;",
            "lineNumber": 935
          },
          {
            "text": "          {chatStore.activeTaskId &amp;&amp; (",
            "lineNumber": 936
          },
          {
            "text": "            &lt;BottomBox",
            "lineNumber": 937
          },
          {
            "text": "              state={getBottomBoxState()}",
            "lineNumber": 938
          },
          {
            "text": "              queuedMessages={",
            "lineNumber": 939
          },
          {
            "text": "                isTaskBusy",
            "lineNumber": 940
          },
          {
            "text": "                  ? []",
            "lineNumber": 941
          },
          {
            "text": "                  : projectStore",
            "lineNumber": 942
          },
          {
            "text": "                      .getProjectById(projectStore.activeProjectId || '')",
            "lineNumber": 943
          },
          {
            "text": "                      ?.queuedMessages?.map((m) =&gt; ({",
            "lineNumber": 944
          },
          {
            "text": "                        id: m.task_id,",
            "lineNumber": 945
          },
          {
            "text": "                        content: m.content,",
            "lineNumber": 946
          },
          {
            "text": "                        timestamp: m.timestamp,",
            "lineNumber": 947
          },
          {
            "text": "                      })) || []",
            "lineNumber": 948
          },
          {
            "text": "              }",
            "lineNumber": 949
          },
          {
            "text": "              onRemoveQueuedMessage={(id) =&gt; handleRemoveTaskQueue(id)}",
            "lineNumber": 950
          },
          {
            "text": "              subtitle={",
            "lineNumber": 951
          },
          {
            "text": "                getBottomBoxState() === 'confirm'",
            "lineNumber": 952
          },
          {
            "text": "                  ? (() =&gt; {",
            "lineNumber": 953
          },
          {
            "text": "                      // Find the last message where role is \"user\"",
            "lineNumber": 954
          },
          {
            "text": "                      const messages =",
            "lineNumber": 955
          },
          {
            "text": "                        chatStore.tasks[chatStore.activeTaskId]?.messages || [];",
            "lineNumber": 956
          },
          {
            "text": "                      const lastUserMessage = messages",
            "lineNumber": 957
          },
          {
            "text": "                        .slice()",
            "lineNumber": 958
          },
          {
            "text": "                        .reverse()",
            "lineNumber": 959
          },
          {
            "text": "                        .find((msg) =&gt; msg.role === 'user');",
            "lineNumber": 960
          },
          {
            "text": "                      return (",
            "lineNumber": 961
          },
          {
            "text": "                        lastUserMessage?.content ||",
            "lineNumber": 962
          },
          {
            "text": "                        chatStore.tasks[chatStore.activeTaskId]?.summaryTask",
            "lineNumber": 963
          },
          {
            "text": "                      );",
            "lineNumber": 964
          },
          {
            "text": "                    })()",
            "lineNumber": 965
          },
          {
            "text": "                  : chatStore.tasks[chatStore.activeTaskId]?.summaryTask",
            "lineNumber": 966
          },
          {
            "text": "              }",
            "lineNumber": 967
          },
          {
            "text": "              onStartTask={() =&gt; handleConfirmTask()}",
            "lineNumber": 968
          },
          {
            "text": "              onEdit={handleEditQuery}",
            "lineNumber": 969
          },
          {
            "text": "              tokens={chatStore.tasks[chatStore.activeTaskId]?.tokens || 0}",
            "lineNumber": 970
          },
          {
            "text": "              taskTime={taskTime}",
            "lineNumber": 971
          },
          {
            "text": "              taskStatus={chatStore.tasks[chatStore.activeTaskId]?.status}",
            "lineNumber": 972
          },
          {
            "text": "              onReplay={handleReplay}",
            "lineNumber": 973
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.2492748498916626
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\GroupedHistoryView\\index.tsx",
        "range": {
          "startPosition": {
            "line": 28,
            "column": 1
          },
          "endPosition": {
            "line": 431,
            "column": 1
          }
        },
        "contents": "export default function GroupedHistoryView({\n  searchValue = \"\",\n  onTaskSelect,\n  onTaskDelete,\n  onTaskShare,\n  activeTaskId,\n  refreshTrigger,\n  ongoingTasks = {},\n  onOngoingTaskClick,\n  onOngoingTaskPause,\n  onOngoingTaskResume,\n  onOngoingTaskDelete,\n  onProjectEdit,\n  onProjectDelete\n}: GroupedHistoryViewProps) {\n  const { t } = useTranslation();\n  const [projects, setProjects] = useState&lt;ProjectGroupType[]&gt;([]);\n  const [loading, setLoading] = useState(true);\n  const { history_type, setHistoryType } = useGlobalStore();\n  const projectStore = useProjectStore();\n  \n  // Default to list view if not set\n  const viewType = history_type || \"list\";\n\n  const loadProjects = async () =&gt; {\n    setLoading(true);\n    try {\n      await fetchGroupedHistoryTasks(setProjects);\n    } catch (error) {\n      console.error(\"Failed to load grouped projects:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const onDelete = (historyId: string ) =&gt; {\n    try {\n      onTaskDelete(historyId, () =&gt; {\n        setProjects(prevProjects =&gt; {\n          // Create new project objects instead of mutating existing ones\n          return prevProjects.map(project =&gt; {\n            const filteredTasks = project.tasks.filter(task =&gt; String(task.id) !== historyId);\n            return {\n              ...project,\n              tasks: filteredTasks,\n              task_count: filteredTasks.length,\n              total_tokens: filteredTasks.reduce((sum, task) =&gt; sum + (task.tokens || 0), 0)\n            };\n          }).filter(project =&gt; project.tasks.length &gt; 0);\n        });\n      });\n    } catch (error) {\n      console.error(\"Failed to delete task:\", error);\n    }\n  }\n\n  const handleProjectEdit = (projectId: string) =&gt; {\n    if (onProjectEdit) {\n      onProjectEdit(projectId);\n    } else {\n      console.log(\"Edit project:\", projectId);\n      // TODO: Implement project edit functionality\n    }\n  }\n\n  const handleProjectDelete = (projectId: string) =&gt;\n\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function GroupedHistoryView({",
            "lineNumber": 31,
            "isSignature": true
          },
          {
            "text": "  searchValue = \"\",",
            "lineNumber": 32,
            "isSignature": true
          },
          {
            "text": "  onTaskSelect,",
            "lineNumber": 33,
            "isSignature": true
          },
          {
            "text": "  onTaskDelete,",
            "lineNumber": 34,
            "isSignature": true
          },
          {
            "text": "  onTaskShare,",
            "lineNumber": 35,
            "isSignature": true
          },
          {
            "text": "  activeTaskId,",
            "lineNumber": 36,
            "isSignature": true
          },
          {
            "text": "  refreshTrigger,",
            "lineNumber": 37,
            "isSignature": true
          },
          {
            "text": "  ongoingTasks = {},",
            "lineNumber": 38,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskClick,",
            "lineNumber": 39,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskPause,",
            "lineNumber": 40,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskResume,",
            "lineNumber": 41,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskDelete,",
            "lineNumber": 42,
            "isSignature": true
          },
          {
            "text": "  onProjectEdit,",
            "lineNumber": 43,
            "isSignature": true
          },
          {
            "text": "  onProjectDelete",
            "lineNumber": 44,
            "isSignature": true
          },
          {
            "text": "}: GroupedHistoryViewProps) {",
            "lineNumber": 45,
            "isSignature": true
          },
          {
            "text": "  const { t } = useTranslation();",
            "lineNumber": 46
          },
          {
            "text": "  const [projects, setProjects] = useState&lt;ProjectGroupType[]&gt;([]);",
            "lineNumber": 47
          },
          {
            "text": "  const [loading, setLoading] = useState(true);",
            "lineNumber": 48
          },
          {
            "text": "  const { history_type, setHistoryType } = useGlobalStore();",
            "lineNumber": 49
          },
          {
            "text": "  const projectStore = useProjectStore();",
            "lineNumber": 50
          },
          {
            "text": "  ",
            "lineNumber": 51
          },
          {
            "text": "  // Default to list view if not set",
            "lineNumber": 52
          },
          {
            "text": "  const viewType = history_type || \"list\";",
            "lineNumber": 53
          },
          {
            "lineNumber": 54
          },
          {
            "text": "  const loadProjects = async () =&gt; {",
            "lineNumber": 55
          },
          {
            "text": "    setLoading(true);",
            "lineNumber": 56
          },
          {
            "text": "    try {",
            "lineNumber": 57
          },
          {
            "text": "      await fetchGroupedHistoryTasks(setProjects);",
            "lineNumber": 58
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 59
          },
          {
            "text": "      console.error(\"Failed to load grouped projects:\", error);",
            "lineNumber": 60
          },
          {
            "text": "    } finally {",
            "lineNumber": 61
          },
          {
            "text": "      setLoading(false);",
            "lineNumber": 62
          },
          {
            "text": "    }",
            "lineNumber": 63
          },
          {
            "text": "  };",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "  const onDelete = (historyId: string ) =&gt; {",
            "lineNumber": 66
          },
          {
            "text": "    try {",
            "lineNumber": 67
          },
          {
            "text": "      onTaskDelete(historyId, () =&gt; {",
            "lineNumber": 68
          },
          {
            "text": "        setProjects(prevProjects =&gt; {",
            "lineNumber": 69
          },
          {
            "text": "          // Create new project objects instead of mutating existing ones",
            "lineNumber": 70
          },
          {
            "text": "          return prevProjects.map(project =&gt; {",
            "lineNumber": 71
          },
          {
            "text": "            const filteredTasks = project.tasks.filter(task =&gt; String(task.id) !== historyId);",
            "lineNumber": 72
          },
          {
            "text": "            return {",
            "lineNumber": 73
          },
          {
            "text": "              ...project,",
            "lineNumber": 74
          },
          {
            "text": "              tasks: filteredTasks,",
            "lineNumber": 75
          },
          {
            "text": "              task_count: filteredTasks.length,",
            "lineNumber": 76
          },
          {
            "text": "              total_tokens: filteredTasks.reduce((sum, task) =&gt; sum + (task.tokens || 0), 0)",
            "lineNumber": 77
          },
          {
            "text": "            };",
            "lineNumber": 78
          },
          {
            "text": "          }).filter(project =&gt; project.tasks.length &gt; 0);",
            "lineNumber": 79
          },
          {
            "text": "        });",
            "lineNumber": 80
          },
          {
            "text": "      });",
            "lineNumber": 81
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 82
          },
          {
            "text": "      console.error(\"Failed to delete task:\", error);",
            "lineNumber": 83
          },
          {
            "text": "    }",
            "lineNumber": 84
          },
          {
            "text": "  }",
            "lineNumber": 85
          },
          {
            "lineNumber": 86
          },
          {
            "text": "  const handleProjectEdit = (projectId: string) =&gt; {",
            "lineNumber": 87
          },
          {
            "text": "    if (onProjectEdit) {",
            "lineNumber": 88
          },
          {
            "text": "      onProjectEdit(projectId);",
            "lineNumber": 89
          },
          {
            "text": "    } else {",
            "lineNumber": 90
          },
          {
            "text": "      console.log(\"Edit project:\", projectId);",
            "lineNumber": 91
          },
          {
            "text": "      // TODO: Implement project edit functionality",
            "lineNumber": 92
          },
          {
            "text": "    }",
            "lineNumber": 93
          },
          {
            "text": "  }",
            "lineNumber": 94
          },
          {
            "lineNumber": 95
          },
          {
            "text": "  const handleProjectDelete = (projectId: string) =&gt;",
            "lineNumber": 96
          },
          {
            "lineNumber": 155
          },
          {
            "text": "}",
            "lineNumber": 432,
            "isSignature": true
          }
        ]
      },
      "score": 0.2390919029712677
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Home.tsx",
        "range": {
          "startPosition": {
            "line": 18,
            "column": 43
          },
          "endPosition": {
            "line": 294,
            "column": 1
          }
        },
        "contents": "export default function Home() {\n\tconst { toggle } = useSidebarStore();\n\t//Get Chatstore for the active project's task\n\tconst { chatStore, projectStore } = useChatStoreAdapter();\n\tif (!chatStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\t\n\tconst [activeWebviewId, setActiveWebviewId] = useState&lt;string | null&gt;(null);\n\n\t// Add webview-show listener in useEffect with cleanup\n\tuseEffect(() =&gt; {\n\t\tconst handleWebviewShow = (_event: any, id: string) =&gt; {\n\t\t\tsetActiveWebviewId(id);\n\t\t};\n\n\t\twindow.ipcRenderer?.on(\"webview-show\", handleWebviewShow);\n\n\t\t// Cleanup: remove listener on unmount\n\t\treturn () =&gt; {\n\t\t\twindow.ipcRenderer?.off(\"webview-show\", handleWebviewShow);\n\t\t};\n\t}, []); // Empty dependency array means this only runs once\n\n\tuseEffect(() =&gt; {\n\t\tlet taskAssigning = [\n\t\t\t...(chatStore.tasks[chatStore.activeTaskId as string]?.taskAssigning ||\n\t\t\t\t[]),\n\t\t];\n\t\tlet webviews: { id: string; agent_id: string; index: number }[] = [];\n\t\ttaskAssigning.map((item) =&gt; {\n\t\t\tif (item.type === \"browser_agent\") {\n\t\t\t\titem.activeWebviewIds?.map((webview, index) =&gt; {\n\t\t\t\t\twebviews.push({ ...webview, agent_id: item.agent_id, index });\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif (taskAssigning.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (webviews.length === 0) {\n\t\t\tconst browserAgent = taskAssigning.find(agent =&gt; agent.type === 'browser_agent');\n\t\t\tif (browserAgent &amp;&amp; browserAgent.activeWebviewIds &amp;&amp; browserAgent.activeWebviewIds.length &gt; 0) {\n\t\t\t\tbrowserAgent.activeWebviewIds.forEach((webview, index) =&gt; {\n\t\t\t\t\twebviews.push({ ...webview, agent_id: browserAgent.agent_id, index });\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (webviews.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// capture webview\n\t\tconst captureWebview = async () =&gt;\n;\n\t}\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function Home() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "\tconst { toggle } = useSidebarStore();",
            "lineNumber": 22
          },
          {
            "text": "\t//Get Chatstore for the active project's task",
            "lineNumber": 23
          },
          {
            "text": "\tconst { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 24
          },
          {
            "text": "\tif (!chatStore) {",
            "lineNumber": 25
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 26
          },
          {
            "text": "\t}",
            "lineNumber": 27
          },
          {
            "text": "\t",
            "lineNumber": 28
          },
          {
            "text": "\tconst [activeWebviewId, setActiveWebviewId] = useState&lt;string | null&gt;(null);",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "\t// Add webview-show listener in useEffect with cleanup",
            "lineNumber": 31
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 32
          },
          {
            "text": "\t\tconst handleWebviewShow = (_event: any, id: string) =&gt; {",
            "lineNumber": 33
          },
          {
            "text": "\t\t\tsetActiveWebviewId(id);",
            "lineNumber": 34
          },
          {
            "text": "\t\t};",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "\t\twindow.ipcRenderer?.on(\"webview-show\", handleWebviewShow);",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "\t\t// Cleanup: remove listener on unmount",
            "lineNumber": 39
          },
          {
            "text": "\t\treturn () =&gt; {",
            "lineNumber": 40
          },
          {
            "text": "\t\t\twindow.ipcRenderer?.off(\"webview-show\", handleWebviewShow);",
            "lineNumber": 41
          },
          {
            "text": "\t\t};",
            "lineNumber": 42
          },
          {
            "text": "\t}, []); // Empty dependency array means this only runs once",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 45
          },
          {
            "text": "\t\tlet taskAssigning = [",
            "lineNumber": 46
          },
          {
            "text": "\t\t\t...(chatStore.tasks[chatStore.activeTaskId as string]?.taskAssigning ||",
            "lineNumber": 47
          },
          {
            "text": "\t\t\t\t[]),",
            "lineNumber": 48
          },
          {
            "text": "\t\t];",
            "lineNumber": 49
          },
          {
            "text": "\t\tlet webviews: { id: string; agent_id: string; index: number }[] = [];",
            "lineNumber": 50
          },
          {
            "text": "\t\ttaskAssigning.map((item) =&gt; {",
            "lineNumber": 51
          },
          {
            "text": "\t\t\tif (item.type === \"browser_agent\") {",
            "lineNumber": 52
          },
          {
            "text": "\t\t\t\titem.activeWebviewIds?.map((webview, index) =&gt; {",
            "lineNumber": 53
          },
          {
            "text": "\t\t\t\t\twebviews.push({ ...webview, agent_id: item.agent_id, index });",
            "lineNumber": 54
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 55
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 56
          },
          {
            "text": "\t\t});",
            "lineNumber": 57
          },
          {
            "lineNumber": 58
          },
          {
            "text": "\t\tif (taskAssigning.length === 0) {",
            "lineNumber": 59
          },
          {
            "text": "\t\t\treturn;",
            "lineNumber": 60
          },
          {
            "text": "\t\t}",
            "lineNumber": 61
          },
          {
            "text": "\t\t",
            "lineNumber": 62
          },
          {
            "text": "\t\tif (webviews.length === 0) {",
            "lineNumber": 63
          },
          {
            "text": "\t\t\tconst browserAgent = taskAssigning.find(agent =&gt; agent.type === 'browser_agent');",
            "lineNumber": 64
          },
          {
            "text": "\t\t\tif (browserAgent &amp;&amp; browserAgent.activeWebviewIds &amp;&amp; browserAgent.activeWebviewIds.length &gt; 0) {",
            "lineNumber": 65
          },
          {
            "text": "\t\t\t\tbrowserAgent.activeWebviewIds.forEach((webview, index) =&gt; {",
            "lineNumber": 66
          },
          {
            "text": "\t\t\t\t\twebviews.push({ ...webview, agent_id: browserAgent.agent_id, index });",
            "lineNumber": 67
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 68
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 69
          },
          {
            "text": "\t\t}",
            "lineNumber": 70
          },
          {
            "text": "\t\t",
            "lineNumber": 71
          },
          {
            "text": "\t\tif (webviews.length === 0) {",
            "lineNumber": 72
          },
          {
            "text": "\t\t\treturn;",
            "lineNumber": 73
          },
          {
            "text": "\t\t}",
            "lineNumber": 74
          },
          {
            "lineNumber": 75
          },
          {
            "text": "\t\t// capture webview",
            "lineNumber": 76
          },
          {
            "text": "\t\tconst captureWebview = async () =&gt;",
            "lineNumber": 77
          },
          {
            "text": ";",
            "lineNumber": 137
          },
          {
            "text": "\t}",
            "lineNumber": 153
          },
          {
            "text": "}",
            "lineNumber": 295,
            "isSignature": true
          }
        ]
      },
      "score": 0.2389356940984726
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\Folder\\index.tsx",
        "range": {
          "startPosition": {
            "line": 156
          },
          "endPosition": {
            "line": 621,
            "column": 1
          }
        },
        "contents": "export default function Folder({ data }: { data?: Agent }) {\nconst [expandedFolders, setExpandedFolders] = (\n    new Set()\n  );\n\n  const toggleFolder = (folderPath: string) =&gt; {\n    setExpandedFolders((prev) =&gt; {\n      const newSet = new Set(prev);\n      if (newSet.has(folderPath)) {\n        newSet.delete(folderPath);\n      } else {\n        newSet.add(folderPath);\n      }\n      return newSet;\n    });\n  };\n\n  const [fileGroups, setFileGroups] = useState&lt;\n    {\n      folder: string;\n      files: FileInfo[];\n    }[]\n  &gt;([\n    {\n      folder: 'Reports',\n      files: [],\n    },\n  ]);\n\n  const hasFetchedRemote = useRef(false);\n\n  // Reset hasFetchedRemote when activeTaskId changes\n  useEffect(() =&gt; {\n    hasFetchedRemote.current = false;\n  }, [chatStore.activeTaskId]);\n\n  useEffect(() =&gt; {\n    const setFileList = async () =&gt; {\n      let res = null;\n      res = await window.ipcRenderer.invoke(\n        'get-project-file-list',\n        authStore.email,\n        projectStore.activeProjectId as string\n      );\n      let tree: any = null;\n      if (\n        (res &amp;&amp; res.length &gt; 0) ||\n        import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n      ) {\n        tree = buildFileTree(res || []);\n      } else {\n        if (!hasFetchedRemote.current) {\n          //TODO(file): rename endpoint to use project_id\n          res = await proxyFetchGet('/api/chat/files', {\n            task_id: projectStore.activeProjectId as string,\n          });\n          hasFetchedRemote.current = true;\n        }\n        console.log('res', res);\n        if (res) {\n          res = res.map((item: any) =&gt; {\n            return {\n              name: item.filename,\n              type: item.filename.split('.')[1],\n              path: item.url,\n              isRemote: true,\n            };\n          });\n          tree = buildFileTree(res || []);\n        }\n      }\n      setFileTree(tree);\n      // Keep the old structure for compatibility\n      setFileGroups((prev) =&gt; {\n        const chatStoreSelectedFile =\n          chatStore.tasks[chatStore.activeTaskId as string];\n      }\n;\n  }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 157,
                "column": 1
              },
              "endPosition": {
                "line": 157,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 157,
                "column": 16
              },
              "endPosition": {
                "line": 158,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Folder({ data }: { data?: Agent }) {",
            "lineNumber": 157,
            "isSignature": true
          },
          {
            "text": "const [expandedFolders, setExpandedFolders] = (",
            "lineNumber": 278
          },
          {
            "text": "    new Set()",
            "lineNumber": 279
          },
          {
            "text": "  );",
            "lineNumber": 280
          },
          {
            "lineNumber": 281
          },
          {
            "text": "  const toggleFolder = (folderPath: string) =&gt; {",
            "lineNumber": 282
          },
          {
            "text": "    setExpandedFolders((prev) =&gt; {",
            "lineNumber": 283
          },
          {
            "text": "      const newSet = new Set(prev);",
            "lineNumber": 284
          },
          {
            "text": "      if (newSet.has(folderPath)) {",
            "lineNumber": 285
          },
          {
            "text": "        newSet.delete(folderPath);",
            "lineNumber": 286
          },
          {
            "text": "      } else {",
            "lineNumber": 287
          },
          {
            "text": "        newSet.add(folderPath);",
            "lineNumber": 288
          },
          {
            "text": "      }",
            "lineNumber": 289
          },
          {
            "text": "      return newSet;",
            "lineNumber": 290
          },
          {
            "text": "    });",
            "lineNumber": 291
          },
          {
            "text": "  };",
            "lineNumber": 292
          },
          {
            "lineNumber": 293
          },
          {
            "text": "  const [fileGroups, setFileGroups] = useState&lt;",
            "lineNumber": 294
          },
          {
            "text": "    {",
            "lineNumber": 295
          },
          {
            "text": "      folder: string;",
            "lineNumber": 296
          },
          {
            "text": "      files: FileInfo[];",
            "lineNumber": 297
          },
          {
            "text": "    }[]",
            "lineNumber": 298
          },
          {
            "text": "  &gt;([",
            "lineNumber": 299
          },
          {
            "text": "    {",
            "lineNumber": 300
          },
          {
            "text": "      folder: 'Reports',",
            "lineNumber": 301
          },
          {
            "text": "      files: [],",
            "lineNumber": 302
          },
          {
            "text": "    },",
            "lineNumber": 303
          },
          {
            "text": "  ]);",
            "lineNumber": 304
          },
          {
            "lineNumber": 305
          },
          {
            "text": "  const hasFetchedRemote = useRef(false);",
            "lineNumber": 306
          },
          {
            "lineNumber": 307
          },
          {
            "text": "  // Reset hasFetchedRemote when activeTaskId changes",
            "lineNumber": 308
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 309
          },
          {
            "text": "    hasFetchedRemote.current = false;",
            "lineNumber": 310
          },
          {
            "text": "  }, [chatStore.activeTaskId]);",
            "lineNumber": 311
          },
          {
            "lineNumber": 312
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 313
          },
          {
            "text": "    const setFileList = async () =&gt; {",
            "lineNumber": 314
          },
          {
            "text": "      let res = null;",
            "lineNumber": 315
          },
          {
            "text": "      res = await window.ipcRenderer.invoke(",
            "lineNumber": 316
          },
          {
            "text": "        'get-project-file-list',",
            "lineNumber": 317
          },
          {
            "text": "        authStore.email,",
            "lineNumber": 318
          },
          {
            "text": "        projectStore.activeProjectId as string",
            "lineNumber": 319
          },
          {
            "text": "      );",
            "lineNumber": 320
          },
          {
            "text": "      let tree: any = null;",
            "lineNumber": 321
          },
          {
            "text": "      if (",
            "lineNumber": 322
          },
          {
            "text": "        (res &amp;&amp; res.length &gt; 0) ||",
            "lineNumber": 323
          },
          {
            "text": "        import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 324
          },
          {
            "text": "      ) {",
            "lineNumber": 325
          },
          {
            "text": "        tree = buildFileTree(res || []);",
            "lineNumber": 326
          },
          {
            "text": "      } else {",
            "lineNumber": 327
          },
          {
            "text": "        if (!hasFetchedRemote.current) {",
            "lineNumber": 328
          },
          {
            "text": "          //TODO(file): rename endpoint to use project_id",
            "lineNumber": 329
          },
          {
            "text": "          res = await proxyFetchGet('/api/chat/files', {",
            "lineNumber": 330
          },
          {
            "text": "            task_id: projectStore.activeProjectId as string,",
            "lineNumber": 331
          },
          {
            "text": "          });",
            "lineNumber": 332
          },
          {
            "text": "          hasFetchedRemote.current = true;",
            "lineNumber": 333
          },
          {
            "text": "        }",
            "lineNumber": 334
          },
          {
            "text": "        console.log('res', res);",
            "lineNumber": 335
          },
          {
            "text": "        if (res) {",
            "lineNumber": 336
          },
          {
            "text": "          res = res.map((item: any) =&gt; {",
            "lineNumber": 337
          },
          {
            "text": "            return {",
            "lineNumber": 338
          },
          {
            "text": "              name: item.filename,",
            "lineNumber": 339
          },
          {
            "text": "              type: item.filename.split('.')[1],",
            "lineNumber": 340
          },
          {
            "text": "              path: item.url,",
            "lineNumber": 341
          },
          {
            "text": "              isRemote: true,",
            "lineNumber": 342
          },
          {
            "text": "            };",
            "lineNumber": 343
          },
          {
            "text": "          });",
            "lineNumber": 344
          },
          {
            "text": "          tree = buildFileTree(res || []);",
            "lineNumber": 345
          },
          {
            "text": "        }",
            "lineNumber": 346
          },
          {
            "text": "      }",
            "lineNumber": 347
          },
          {
            "text": "      setFileTree(tree);",
            "lineNumber": 348
          },
          {
            "text": "      // Keep the old structure for compatibility",
            "lineNumber": 349
          },
          {
            "text": "      setFileGroups((prev) =&gt; {",
            "lineNumber": 350
          },
          {
            "text": "        const chatStoreSelectedFile =",
            "lineNumber": 351
          },
          {
            "text": "          chatStore.tasks[chatStore.activeTaskId as string];",
            "lineNumber": 352
          },
          {
            "text": "      }",
            "lineNumber": 369
          },
          {
            "text": ";",
            "lineNumber": 370
          },
          {
            "text": "  }",
            "lineNumber": 372
          },
          {
            "text": "}",
            "lineNumber": 622,
            "isSignature": true
          }
        ]
      },
      "score": 0.2386302351951599
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\MCPMarket.tsx",
        "range": {
          "startPosition": {
            "line": 77
          },
          "endPosition": {
            "line": 411,
            "column": 1
          }
        },
        "contents": "export default function MCPMarket({ onBack, keyword: externalKeyword }: MCPMarketProps) {\n\n);\n\n\t// load data\n\tconst loadData = useCallback(\n\t\tasync (pageNum: number, kw: string, catId?: number, pageSize = 20) =&gt; {\n\t\t\tsetIsLoading(true);\n\t\t\tsetError(\"\");\n\t\t\ttry {\n\t\t\t\tconst params: any = { page: pageNum, size: pageSize, keyword: kw };\n\t\t\t\tif (catId) params.category_id = catId;\n\t\t\t\tconst res = await proxyFetchGet(\"/api/mcps\", params);\n\t\t\t\tif (res &amp;&amp; Array.isArray(res.items)) {\n\t\t\t\t\t// frontend deduplication\n\t\t\t\t\tconst all: MCPItem[] =\n\t\t\t\t\t\tpageNum === 1 ? res.items : [...items, ...res.items];\n\t\t\t\t\tconst unique: MCPItem[] = Array.from(\n\t\t\t\t\t\tnew Map(all.map((i: MCPItem) =&gt; [i.id, i])).values()\n\t\t\t\t\t);\n\t\t\t\t\tsetItems(unique);\n\t\t\t\t\tsetHasMore(res.items.length === pageSize);\n\t\t\t\t} else {\n\t\t\t\t\tif (pageNum === 1) setItems([]);\n\t\t\t\t\tsetHasMore(false);\n\t\t\t\t}\n\t\t\t} catch (err: any) {\n\t\t\t\tsetError(err?.message || \"Load failed\");\n\t\t\t} finally {\n\t\t\t\tsetIsLoading(false);\n\t\t\t}\n\t\t},\n\t\t[items]\n\t);\n\n\tuseEffect(() =&gt; {\n\t\tsetPage(1);\n\t\tloadData(1, debouncedKeyword, effectiveCategoryId);\n\t\t// eslint-disable-next-line\n\t}, [debouncedKeyword, effectiveCategoryId]);\n\n\tuseEffect(() =&gt; {\n\t\tif (page &gt; 1) loadData(page, debouncedKeyword, effectiveCategoryId);\n\t\t// eslint-disable-next-line\n\t}, [page]);\n\n\tuseEffect(() =&gt; {\n\t\tif (!hasMore || isLoading) return;\n\t\tconst node = loader.current;\n\t\tif (!node) return;\n\t\tconst observer = new window.IntersectionObserver(\n\t\t\t(entries) =&gt; {\n\t\t\t\tif (entries[0].isIntersecting) {\n\t\t\t\t\tsetPage((p) =&gt; (isLoading || !hasMore ? p : p + 1));\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ root: null, rootMargin: \"0px\", threshold: 0.1 }\n\t\t);\n\t\tobserver.observe(node);\n\t\treturn () =&gt; {\n\t\t\tobserver.disconnect();\n\t\t};\n\t}, [hasMore, isLoading]);\n\n\tconst checkEnv = (id: number) =&gt; {\n\t\tconst mcp = items.find((mcp) =&gt; mcp.id === id);\n\t\tif (mcp &amp;&amp; Object.keys(mcp?.install_command?.env || {}).length &gt; 0) {\n\t\t\tsetActiveMcp(mcp);\n\t\t\tsetShowEnvConfig(true);\n\t\t} else {\n\t\t\tinstallMcp(id);\n\t\t}\n\t};\n\tconst onConnect = (mcp: MCPItem) =&gt; {\n\t\tconsole.log(mcp);\n\t\tsetItems((prev) =&gt;\n\t\t\tprev.map\n\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 78,
                "column": 1
              },
              "endPosition": {
                "line": 78,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 78,
                "column": 16
              },
              "endPosition": {
                "line": 79,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function MCPMarket({ onBack, keyword: externalKeyword }: MCPMarketProps) {",
            "lineNumber": 78,
            "isSignature": true
          },
          {
            "lineNumber": 120
          },
          {
            "text": ");",
            "lineNumber": 126
          },
          {
            "lineNumber": 127
          },
          {
            "text": "\t// load data",
            "lineNumber": 128
          },
          {
            "text": "\tconst loadData = useCallback(",
            "lineNumber": 129
          },
          {
            "text": "\t\tasync (pageNum: number, kw: string, catId?: number, pageSize = 20) =&gt; {",
            "lineNumber": 130
          },
          {
            "text": "\t\t\tsetIsLoading(true);",
            "lineNumber": 131
          },
          {
            "text": "\t\t\tsetError(\"\");",
            "lineNumber": 132
          },
          {
            "text": "\t\t\ttry {",
            "lineNumber": 133
          },
          {
            "text": "\t\t\t\tconst params: any = { page: pageNum, size: pageSize, keyword: kw };",
            "lineNumber": 134
          },
          {
            "text": "\t\t\t\tif (catId) params.category_id = catId;",
            "lineNumber": 135
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet(\"/api/mcps\", params);",
            "lineNumber": 136
          },
          {
            "text": "\t\t\t\tif (res &amp;&amp; Array.isArray(res.items)) {",
            "lineNumber": 137
          },
          {
            "text": "\t\t\t\t\t// frontend deduplication",
            "lineNumber": 138
          },
          {
            "text": "\t\t\t\t\tconst all: MCPItem[] =",
            "lineNumber": 139
          },
          {
            "text": "\t\t\t\t\t\tpageNum === 1 ? res.items : [...items, ...res.items];",
            "lineNumber": 140
          },
          {
            "text": "\t\t\t\t\tconst unique: MCPItem[] = Array.from(",
            "lineNumber": 141
          },
          {
            "text": "\t\t\t\t\t\tnew Map(all.map((i: MCPItem) =&gt; [i.id, i])).values()",
            "lineNumber": 142
          },
          {
            "text": "\t\t\t\t\t);",
            "lineNumber": 143
          },
          {
            "text": "\t\t\t\t\tsetItems(unique);",
            "lineNumber": 144
          },
          {
            "text": "\t\t\t\t\tsetHasMore(res.items.length === pageSize);",
            "lineNumber": 145
          },
          {
            "text": "\t\t\t\t} else {",
            "lineNumber": 146
          },
          {
            "text": "\t\t\t\t\tif (pageNum === 1) setItems([]);",
            "lineNumber": 147
          },
          {
            "text": "\t\t\t\t\tsetHasMore(false);",
            "lineNumber": 148
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 149
          },
          {
            "text": "\t\t\t} catch (err: any) {",
            "lineNumber": 150
          },
          {
            "text": "\t\t\t\tsetError(err?.message || \"Load failed\");",
            "lineNumber": 151
          },
          {
            "text": "\t\t\t} finally {",
            "lineNumber": 152
          },
          {
            "text": "\t\t\t\tsetIsLoading(false);",
            "lineNumber": 153
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 154
          },
          {
            "text": "\t\t},",
            "lineNumber": 155
          },
          {
            "text": "\t\t[items]",
            "lineNumber": 156
          },
          {
            "text": "\t);",
            "lineNumber": 157
          },
          {
            "lineNumber": 158
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 159
          },
          {
            "text": "\t\tsetPage(1);",
            "lineNumber": 160
          },
          {
            "text": "\t\tloadData(1, debouncedKeyword, effectiveCategoryId);",
            "lineNumber": 161
          },
          {
            "text": "\t\t// eslint-disable-next-line",
            "lineNumber": 162
          },
          {
            "text": "\t}, [debouncedKeyword, effectiveCategoryId]);",
            "lineNumber": 163
          },
          {
            "lineNumber": 164
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 165
          },
          {
            "text": "\t\tif (page &gt; 1) loadData(page, debouncedKeyword, effectiveCategoryId);",
            "lineNumber": 166
          },
          {
            "text": "\t\t// eslint-disable-next-line",
            "lineNumber": 167
          },
          {
            "text": "\t}, [page]);",
            "lineNumber": 168
          },
          {
            "lineNumber": 169
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 170
          },
          {
            "text": "\t\tif (!hasMore || isLoading) return;",
            "lineNumber": 171
          },
          {
            "text": "\t\tconst node = loader.current;",
            "lineNumber": 172
          },
          {
            "text": "\t\tif (!node) return;",
            "lineNumber": 173
          },
          {
            "text": "\t\tconst observer = new window.IntersectionObserver(",
            "lineNumber": 174
          },
          {
            "text": "\t\t\t(entries) =&gt; {",
            "lineNumber": 175
          },
          {
            "text": "\t\t\t\tif (entries[0].isIntersecting) {",
            "lineNumber": 176
          },
          {
            "text": "\t\t\t\t\tsetPage((p) =&gt; (isLoading || !hasMore ? p : p + 1));",
            "lineNumber": 177
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 178
          },
          {
            "text": "\t\t\t},",
            "lineNumber": 179
          },
          {
            "text": "\t\t\t{ root: null, rootMargin: \"0px\", threshold: 0.1 }",
            "lineNumber": 180
          },
          {
            "text": "\t\t);",
            "lineNumber": 181
          },
          {
            "text": "\t\tobserver.observe(node);",
            "lineNumber": 182
          },
          {
            "text": "\t\treturn () =&gt; {",
            "lineNumber": 183
          },
          {
            "text": "\t\t\tobserver.disconnect();",
            "lineNumber": 184
          },
          {
            "text": "\t\t};",
            "lineNumber": 185
          },
          {
            "text": "\t}, [hasMore, isLoading]);",
            "lineNumber": 186
          },
          {
            "lineNumber": 187
          },
          {
            "text": "\tconst checkEnv = (id: number) =&gt; {",
            "lineNumber": 188
          },
          {
            "text": "\t\tconst mcp = items.find((mcp) =&gt; mcp.id === id);",
            "lineNumber": 189
          },
          {
            "text": "\t\tif (mcp &amp;&amp; Object.keys(mcp?.install_command?.env || {}).length &gt; 0) {",
            "lineNumber": 190
          },
          {
            "text": "\t\t\tsetActiveMcp(mcp);",
            "lineNumber": 191
          },
          {
            "text": "\t\t\tsetShowEnvConfig(true);",
            "lineNumber": 192
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 193
          },
          {
            "text": "\t\t\tinstallMcp(id);",
            "lineNumber": 194
          },
          {
            "text": "\t\t}",
            "lineNumber": 195
          },
          {
            "text": "\t};",
            "lineNumber": 196
          },
          {
            "text": "\tconst onConnect = (mcp: MCPItem) =&gt; {",
            "lineNumber": 197
          },
          {
            "text": "\t\tconsole.log(mcp);",
            "lineNumber": 198
          },
          {
            "text": "\t\tsetItems((prev) =&gt;",
            "lineNumber": 199
          },
          {
            "text": "\t\t\tprev.map",
            "lineNumber": 200
          },
          {
            "lineNumber": 201
          },
          {
            "text": ";",
            "lineNumber": 204
          },
          {
            "text": "}",
            "lineNumber": 412,
            "isSignature": true
          }
        ]
      },
      "score": 0.23851829767227173
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\n\n\n  // Task time tracking\n  const [taskTime, setTaskTime] = useState(\n    chatStore.getFormattedTaskTime(chatStore.activeTaskId as string)\n  );\n  useEffect(() =&gt; {\n    const interval = setInterval(() =&gt; {\n      if (chatStore.activeTaskId) {\n        setTaskTime(chatStore.getFormattedTaskTime(chatStore.activeTaskId));\n      }\n    }, 500);\n    return () =&gt; clearInterval(interval);\n  }, [chatStore.activeTaskId]);\n\n  // Determine BottomBox state\n  const getBottomBoxState = () =&gt; {\n    if (!chatStore.activeTaskId) return 'input';\n    const task = chatStore.tasks[chatStore.activeTaskId];\n\n    // Queued messages no longer change BottomBox state; QueuedBox renders independently\n\n    // Check for any to_sub_tasks message (confirmed or not)\n    const anyToSubTasksMessage = task.messages.find(\n      (m) =&gt; m.step === 'to_sub_tasks'\n    );\n    const toSubTasksMessage = task.messages.find(\n      (m) =&gt; m.step === 'to_sub_tasks' &amp;&amp; !m.isConfirm\n    );\n\n    // Determine if we're in the \"splitting in progress\" phase (skeleton visible)\n    // Only show splitting if there's NO to_sub_tasks message yet (not even confirmed)\n    const isSkeletonPhase =\n      (task.status !== 'finished' &amp;&amp;\n        !anyToSubTasksMessage &amp;&amp;\n        !task.hasWaitComfirm &amp;&amp;\n        task.messages.length &gt; 0) ||\n      (task.isTakeControl &amp;&amp; !anyToSubTasksMessage);\n    if (isSkeletonPhase) {\n      return 'splitting';\n    }\n\n    // After splitting completes and TaskCard is awaiting user confirmation,\n    // the Task becomes 'pending' and we show the confirm state.\n    if (\n      toSubTasksMessage &amp;&amp;\n      !toSubTasksMessage.isConfirm &amp;&amp;\n      task.status === 'pending'\n    ) {\n      return 'confirm';\n    }\n\n    // If subtasks exist but not yet confirmed while task is still running, keep showing splitting\n    if (toSubTasksMessage &amp;&amp; !toSubTasksMessage.isConfirm) {\n      return 'splitting';\n    }\n\n    // Check task status\n    if\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 695
          },
          {
            "lineNumber": 696
          },
          {
            "text": "  // Task time tracking",
            "lineNumber": 697
          },
          {
            "text": "  const [taskTime, setTaskTime] = useState(",
            "lineNumber": 698
          },
          {
            "text": "    chatStore.getFormattedTaskTime(chatStore.activeTaskId as string)",
            "lineNumber": 699
          },
          {
            "text": "  );",
            "lineNumber": 700
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 701
          },
          {
            "text": "    const interval = setInterval(() =&gt; {",
            "lineNumber": 702
          },
          {
            "text": "      if (chatStore.activeTaskId) {",
            "lineNumber": 703
          },
          {
            "text": "        setTaskTime(chatStore.getFormattedTaskTime(chatStore.activeTaskId));",
            "lineNumber": 704
          },
          {
            "text": "      }",
            "lineNumber": 705
          },
          {
            "text": "    }, 500);",
            "lineNumber": 706
          },
          {
            "text": "    return () =&gt; clearInterval(interval);",
            "lineNumber": 707
          },
          {
            "text": "  }, [chatStore.activeTaskId]);",
            "lineNumber": 708
          },
          {
            "lineNumber": 709
          },
          {
            "text": "  // Determine BottomBox state",
            "lineNumber": 710
          },
          {
            "text": "  const getBottomBoxState = () =&gt; {",
            "lineNumber": 711
          },
          {
            "text": "    if (!chatStore.activeTaskId) return 'input';",
            "lineNumber": 712
          },
          {
            "text": "    const task = chatStore.tasks[chatStore.activeTaskId];",
            "lineNumber": 713
          },
          {
            "lineNumber": 714
          },
          {
            "text": "    // Queued messages no longer change BottomBox state; QueuedBox renders independently",
            "lineNumber": 715
          },
          {
            "lineNumber": 716
          },
          {
            "text": "    // Check for any to_sub_tasks message (confirmed or not)",
            "lineNumber": 717
          },
          {
            "text": "    const anyToSubTasksMessage = task.messages.find(",
            "lineNumber": 718
          },
          {
            "text": "      (m) =&gt; m.step === 'to_sub_tasks'",
            "lineNumber": 719
          },
          {
            "text": "    );",
            "lineNumber": 720
          },
          {
            "text": "    const toSubTasksMessage = task.messages.find(",
            "lineNumber": 721
          },
          {
            "text": "      (m) =&gt; m.step === 'to_sub_tasks' &amp;&amp; !m.isConfirm",
            "lineNumber": 722
          },
          {
            "text": "    );",
            "lineNumber": 723
          },
          {
            "lineNumber": 724
          },
          {
            "text": "    // Determine if we're in the \"splitting in progress\" phase (skeleton visible)",
            "lineNumber": 725
          },
          {
            "text": "    // Only show splitting if there's NO to_sub_tasks message yet (not even confirmed)",
            "lineNumber": 726
          },
          {
            "text": "    const isSkeletonPhase =",
            "lineNumber": 727
          },
          {
            "text": "      (task.status !== 'finished' &amp;&amp;",
            "lineNumber": 728
          },
          {
            "text": "        !anyToSubTasksMessage &amp;&amp;",
            "lineNumber": 729
          },
          {
            "text": "        !task.hasWaitComfirm &amp;&amp;",
            "lineNumber": 730
          },
          {
            "text": "        task.messages.length &gt; 0) ||",
            "lineNumber": 731
          },
          {
            "text": "      (task.isTakeControl &amp;&amp; !anyToSubTasksMessage);",
            "lineNumber": 732
          },
          {
            "text": "    if (isSkeletonPhase) {",
            "lineNumber": 733
          },
          {
            "text": "      return 'splitting';",
            "lineNumber": 734
          },
          {
            "text": "    }",
            "lineNumber": 735
          },
          {
            "lineNumber": 736
          },
          {
            "text": "    // After splitting completes and TaskCard is awaiting user confirmation,",
            "lineNumber": 737
          },
          {
            "text": "    // the Task becomes 'pending' and we show the confirm state.",
            "lineNumber": 738
          },
          {
            "text": "    if (",
            "lineNumber": 739
          },
          {
            "text": "      toSubTasksMessage &amp;&amp;",
            "lineNumber": 740
          },
          {
            "text": "      !toSubTasksMessage.isConfirm &amp;&amp;",
            "lineNumber": 741
          },
          {
            "text": "      task.status === 'pending'",
            "lineNumber": 742
          },
          {
            "text": "    ) {",
            "lineNumber": 743
          },
          {
            "text": "      return 'confirm';",
            "lineNumber": 744
          },
          {
            "text": "    }",
            "lineNumber": 745
          },
          {
            "lineNumber": 746
          },
          {
            "text": "    // If subtasks exist but not yet confirmed while task is still running, keep showing splitting",
            "lineNumber": 747
          },
          {
            "text": "    if (toSubTasksMessage &amp;&amp; !toSubTasksMessage.isConfirm) {",
            "lineNumber": 748
          },
          {
            "text": "      return 'splitting';",
            "lineNumber": 749
          },
          {
            "text": "    }",
            "lineNumber": 750
          },
          {
            "lineNumber": 751
          },
          {
            "text": "    // Check task status",
            "lineNumber": 752
          },
          {
            "text": "    if",
            "lineNumber": 753
          },
          {
            "text": ";",
            "lineNumber": 762
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.2336532026529312
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\ProjectChatContainer.tsx",
        "range": {
          "startPosition": {
            "column": 72
          },
          "endPosition": {
            "line": 176,
            "column": 1
          }
        },
        "contents": "import { motion, AnimatePresence } from 'framer-motion';\nimport { ProjectSection } from './ProjectSection';\nimport useChatStoreAdapter from '@/hooks/useChatStoreAdapter';\n\ninterface ProjectChatContainerProps {\n  className?: string;\n  // onPauseResume: () =&gt; void;  // Commented out - temporary not needed\n  onSkip: () =&gt; void;\n  isPauseResumeLoading: boolean;\n}\n\nexport const ProjectChatContainer: React.FC&lt;ProjectChatContainerProps&gt; = (\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { motion, AnimatePresence } from 'framer-motion';",
            "lineNumber": 2
          },
          {
            "text": "import { ProjectSection } from './ProjectSection';",
            "lineNumber": 3
          },
          {
            "text": "import useChatStoreAdapter from '@/hooks/useChatStoreAdapter';",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "interface ProjectChatContainerProps {",
            "lineNumber": 6,
            "isSignature": true
          },
          {
            "text": "  className?: string;",
            "lineNumber": 7
          },
          {
            "text": "  // onPauseResume: () =&gt; void;  // Commented out - temporary not needed",
            "lineNumber": 8
          },
          {
            "text": "  onSkip: () =&gt; void;",
            "lineNumber": 9
          },
          {
            "text": "  isPauseResumeLoading: boolean;",
            "lineNumber": 10,
            "isSignature": true
          },
          {
            "text": "}",
            "lineNumber": 11,
            "isSignature": true
          },
          {
            "lineNumber": 12
          },
          {
            "text": "export const ProjectChatContainer: React.FC&lt;ProjectChatContainerProps&gt; = (",
            "lineNumber": 13
          },
          {
            "text": ";",
            "lineNumber": 177
          }
        ]
      },
      "score": 0.23355764150619507
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\TaskBox\\TaskCard.tsx",
        "range": {
          "startPosition": {
            "line": 38,
            "column": 1
          },
          "endPosition": {
            "line": 446,
            "column": 1
          }
        },
        "contents": "export function TaskCard({\n\ttaskInfo,\n\ttaskType,\n\ttaskRunning,\n\tprogressValue,\n\tsummaryTask,\n\tonAddTask,\n\tonUpdateTask,\n\tonDeleteTask,\n\tclickable = true,\n\tchatId,\n}: TaskCardProps) {\n\tconst { t } = useTranslation();\n\tconst [isExpanded, setIsExpanded] = useState(true);\n\tconst contentRef = useRef&lt;HTMLDivElement&gt;(null);\n\tconst [contentHeight, setContentHeight] = useState&lt;number | \"auto\"&gt;(\"auto\");\n\n\t//Get Chatstore and ProjectStore for the active project's task\n\tconst { chatStore, projectStore } = useChatStoreAdapter();\n\tif (!chatStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\t\n\n\tconst [selectedState, setSelectedState] = useState&lt;TaskStateType&gt;(\"all\");\n\tconst [filterTasks, setFilterTasks] = useState&lt;any[]&gt;([]);\n\tuseEffect(() =&gt; {\n\t\tconst tasks = taskRunning || [];\n\n\t\tif (selectedState === \"all\") {\n\t\t\tsetFilterTasks(tasks);\n\t\t} else {\n\t\t\tconst newFiltered = tasks.filter((task) =&gt; {\n\t\t\t\tswitch (selectedState) {\n\t\t\t\t\tcase \"done\":\n\t\t\t\t\t\treturn task.status === \"completed\" &amp;&amp; !task.reAssignTo;\n\t\t\t\t\tcase \"ongoing\":\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\ttask.status !== \"failed\" &amp;&amp;\n\t\t\t\t\t\t\ttask.status !== \"completed\" &amp;&amp;\n\t\t\t\t\t\t\ttask.status !== \"skipped\" &amp;&amp;\n\t\t\t\t\t\t\ttask.status !== \"waiting\" &amp;&amp;\n\t\t\t\t\t\t\ttask.status !== \"\" \n\t\t\t\t\t\t);\n\t\t\t\t\tcase \"pending\":\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t(task.status === \"skipped\" ||\n\t\t\t\t\t\t\t\ttask.status === \"waiting\" ||\n\t\t\t\t\t\t\t\ttask.status === \"\") &amp;&amp;\n\t\t\t\t\t\t\t!task.reAssignTo\n\t\t\t\t\t\t);\n\t\t\t\t\tcase \"failed\":\n\t\t\t\t\t\treturn task.status === \"failed\";\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tsetFilterTasks(newFiltered);\n\t\t}\n\t}, [selectedState, taskInfo, taskRunning]);\n\n\tconst isAllTaskFinished = useMemo(() =&gt; {\n\t\treturn (\n\t\t\tchatStore.tasks[chatStore.activeTaskId as string].status === \"finished\"\n\t\t);\n\t}, [chatStore.tasks[chatStore.activeTaskId as string].status]);\n\n\tuseEffect(() =&gt; {\n\t\tif (\n\t\t\tchatStore.tasks[chatStore.activeTaskId as string]\n\t}\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export function TaskCard({",
            "lineNumber": 41,
            "isSignature": true
          },
          {
            "text": "\ttaskInfo,",
            "lineNumber": 42,
            "isSignature": true
          },
          {
            "text": "\ttaskType,",
            "lineNumber": 43,
            "isSignature": true
          },
          {
            "text": "\ttaskRunning,",
            "lineNumber": 44,
            "isSignature": true
          },
          {
            "text": "\tprogressValue,",
            "lineNumber": 45,
            "isSignature": true
          },
          {
            "text": "\tsummaryTask,",
            "lineNumber": 46,
            "isSignature": true
          },
          {
            "text": "\tonAddTask,",
            "lineNumber": 47,
            "isSignature": true
          },
          {
            "text": "\tonUpdateTask,",
            "lineNumber": 48,
            "isSignature": true
          },
          {
            "text": "\tonDeleteTask,",
            "lineNumber": 49,
            "isSignature": true
          },
          {
            "text": "\tclickable = true,",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "\tchatId,",
            "lineNumber": 51,
            "isSignature": true
          },
          {
            "text": "}: TaskCardProps) {",
            "lineNumber": 52,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 53
          },
          {
            "text": "\tconst [isExpanded, setIsExpanded] = useState(true);",
            "lineNumber": 54
          },
          {
            "text": "\tconst contentRef = useRef&lt;HTMLDivElement&gt;(null);",
            "lineNumber": 55
          },
          {
            "text": "\tconst [contentHeight, setContentHeight] = useState&lt;number | \"auto\"&gt;(\"auto\");",
            "lineNumber": 56
          },
          {
            "lineNumber": 57
          },
          {
            "text": "\t//Get Chatstore and ProjectStore for the active project's task",
            "lineNumber": 58
          },
          {
            "text": "\tconst { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 59
          },
          {
            "text": "\tif (!chatStore) {",
            "lineNumber": 60
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 61
          },
          {
            "text": "\t}",
            "lineNumber": 62
          },
          {
            "text": "\t",
            "lineNumber": 63
          },
          {
            "lineNumber": 64
          },
          {
            "text": "\tconst [selectedState, setSelectedState] = useState&lt;TaskStateType&gt;(\"all\");",
            "lineNumber": 65
          },
          {
            "text": "\tconst [filterTasks, setFilterTasks] = useState&lt;any[]&gt;([]);",
            "lineNumber": 66
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 67
          },
          {
            "text": "\t\tconst tasks = taskRunning || [];",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "\t\tif (selectedState === \"all\") {",
            "lineNumber": 70
          },
          {
            "text": "\t\t\tsetFilterTasks(tasks);",
            "lineNumber": 71
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 72
          },
          {
            "text": "\t\t\tconst newFiltered = tasks.filter((task) =&gt; {",
            "lineNumber": 73
          },
          {
            "text": "\t\t\t\tswitch (selectedState) {",
            "lineNumber": 74
          },
          {
            "text": "\t\t\t\t\tcase \"done\":",
            "lineNumber": 75
          },
          {
            "text": "\t\t\t\t\t\treturn task.status === \"completed\" &amp;&amp; !task.reAssignTo;",
            "lineNumber": 76
          },
          {
            "text": "\t\t\t\t\tcase \"ongoing\":",
            "lineNumber": 77
          },
          {
            "text": "\t\t\t\t\t\treturn (",
            "lineNumber": 78
          },
          {
            "text": "\t\t\t\t\t\t\ttask.status !== \"failed\" &amp;&amp;",
            "lineNumber": 79
          },
          {
            "text": "\t\t\t\t\t\t\ttask.status !== \"completed\" &amp;&amp;",
            "lineNumber": 80
          },
          {
            "text": "\t\t\t\t\t\t\ttask.status !== \"skipped\" &amp;&amp;",
            "lineNumber": 81
          },
          {
            "text": "\t\t\t\t\t\t\ttask.status !== \"waiting\" &amp;&amp;",
            "lineNumber": 82
          },
          {
            "text": "\t\t\t\t\t\t\ttask.status !== \"\" ",
            "lineNumber": 83
          },
          {
            "text": "\t\t\t\t\t\t);",
            "lineNumber": 84
          },
          {
            "text": "\t\t\t\t\tcase \"pending\":",
            "lineNumber": 85
          },
          {
            "text": "\t\t\t\t\t\treturn (",
            "lineNumber": 86
          },
          {
            "text": "\t\t\t\t\t\t\t(task.status === \"skipped\" ||",
            "lineNumber": 87
          },
          {
            "text": "\t\t\t\t\t\t\t\ttask.status === \"waiting\" ||",
            "lineNumber": 88
          },
          {
            "text": "\t\t\t\t\t\t\t\ttask.status === \"\") &amp;&amp;",
            "lineNumber": 89
          },
          {
            "text": "\t\t\t\t\t\t\t!task.reAssignTo",
            "lineNumber": 90
          },
          {
            "text": "\t\t\t\t\t\t);",
            "lineNumber": 91
          },
          {
            "text": "\t\t\t\t\tcase \"failed\":",
            "lineNumber": 92
          },
          {
            "text": "\t\t\t\t\t\treturn task.status === \"failed\";",
            "lineNumber": 93
          },
          {
            "text": "\t\t\t\t\tdefault:",
            "lineNumber": 94
          },
          {
            "text": "\t\t\t\t\t\treturn false;",
            "lineNumber": 95
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 96
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 97
          },
          {
            "text": "\t\t\tsetFilterTasks(newFiltered);",
            "lineNumber": 98
          },
          {
            "text": "\t\t}",
            "lineNumber": 99
          },
          {
            "text": "\t}, [selectedState, taskInfo, taskRunning]);",
            "lineNumber": 100
          },
          {
            "lineNumber": 101
          },
          {
            "text": "\tconst isAllTaskFinished = useMemo(() =&gt; {",
            "lineNumber": 102
          },
          {
            "text": "\t\treturn (",
            "lineNumber": 103
          },
          {
            "text": "\t\t\tchatStore.tasks[chatStore.activeTaskId as string].status === \"finished\"",
            "lineNumber": 104
          },
          {
            "text": "\t\t);",
            "lineNumber": 105
          },
          {
            "text": "\t}, [chatStore.tasks[chatStore.activeTaskId as string].status]);",
            "lineNumber": 106
          },
          {
            "lineNumber": 107
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 108
          },
          {
            "text": "\t\tif (",
            "lineNumber": 109
          },
          {
            "text": "\t\t\tchatStore.tasks[chatStore.activeTaskId as string]",
            "lineNumber": 110
          },
          {
            "text": "\t}",
            "lineNumber": 117
          },
          {
            "text": "}",
            "lineNumber": 447,
            "isSignature": true
          }
        ]
      },
      "score": 0.23344770073890686
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\TaskBox\\StreamingTaskList.tsx",
        "range": {
          "startPosition": {
            "line": 44,
            "column": 1
          },
          "endPosition": {
            "line": 119,
            "column": 1
          }
        },
        "contents": "export function StreamingTaskList({ streamingText }: StreamingTaskListProps) {\n\tconst { t } = useTranslation();\n\tconst { tasks, isStreaming } = useMemo(() =&gt; parseStreamingTasks(streamingText), [streamingText]);\n\n\tif (tasks.length === 0) {\n\t\t// Show a loading state when no tasks have been parsed yet\n\t\treturn (\n\t\t\t&lt;div className=\"w-full h-auto flex flex-col gap-2 pl-2 py-sm transition-all duration-300\"&gt;\n\t\t\t\t&lt;div className=\"w-full h-auto bg-task-surface backdrop-blur-[5px] rounded-xl py-sm relative overflow-hidden\"&gt;\n\t\t\t\t\t&lt;div className=\"absolute top-0 left-0 w-full bg-transparent\"&gt;\n\t\t\t\t\t\t&lt;Progress value={100} className=\"h-[2px] w-full\" /&gt;\n\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t&lt;div className=\"flex items-center gap-2 px-sm py-2\"&gt;\n\t\t\t\t\t\t&lt;LoaderCircle size={16} className=\"text-icon-information animate-spin\" /&gt;\n\t\t\t\t\t\t&lt;span className=\"text-sm text-text-secondary animate-pulse\"&gt;{t(\"layout.task-splitting\")}...&lt;/span&gt;\n\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t&lt;/div&gt;\n\t\t\t&lt;/div&gt;\n\t\t);\n\t}\n\n\treturn (\n\t\t&lt;div className=\"w-full h-auto flex flex-col gap-2 pl-2 py-sm transition-all duration-300\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export function StreamingTaskList({ streamingText }: StreamingTaskListProps) {",
            "lineNumber": 47,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 48
          },
          {
            "text": "\tconst { tasks, isStreaming } = useMemo(() =&gt; parseStreamingTasks(streamingText), [streamingText]);",
            "lineNumber": 49
          },
          {
            "lineNumber": 50
          },
          {
            "text": "\tif (tasks.length === 0) {",
            "lineNumber": 51
          },
          {
            "text": "\t\t// Show a loading state when no tasks have been parsed yet",
            "lineNumber": 52
          },
          {
            "text": "\t\treturn (",
            "lineNumber": 53
          },
          {
            "text": "\t\t\t&lt;div className=\"w-full h-auto flex flex-col gap-2 pl-2 py-sm transition-all duration-300\"&gt;",
            "lineNumber": 54
          },
          {
            "text": "\t\t\t\t&lt;div className=\"w-full h-auto bg-task-surface backdrop-blur-[5px] rounded-xl py-sm relative overflow-hidden\"&gt;",
            "lineNumber": 55
          },
          {
            "text": "\t\t\t\t\t&lt;div className=\"absolute top-0 left-0 w-full bg-transparent\"&gt;",
            "lineNumber": 56
          },
          {
            "text": "\t\t\t\t\t\t&lt;Progress value={100} className=\"h-[2px] w-full\" /&gt;",
            "lineNumber": 57
          },
          {
            "text": "\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 58
          },
          {
            "text": "\t\t\t\t\t&lt;div className=\"flex items-center gap-2 px-sm py-2\"&gt;",
            "lineNumber": 59
          },
          {
            "text": "\t\t\t\t\t\t&lt;LoaderCircle size={16} className=\"text-icon-information animate-spin\" /&gt;",
            "lineNumber": 60
          },
          {
            "text": "\t\t\t\t\t\t&lt;span className=\"text-sm text-text-secondary animate-pulse\"&gt;{t(\"layout.task-splitting\")}...&lt;/span&gt;",
            "lineNumber": 61
          },
          {
            "text": "\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 62
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 63
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 64
          },
          {
            "text": "\t\t);",
            "lineNumber": 65
          },
          {
            "text": "\t}",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "\treturn (",
            "lineNumber": 68
          },
          {
            "text": "\t\t&lt;div className=\"w-full h-auto flex flex-col gap-2 pl-2 py-sm transition-all duration-300",
            "lineNumber": 69
          },
          {
            "text": "}",
            "lineNumber": 120,
            "isSignature": true
          }
        ]
      },
      "score": 0.23107993602752686
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\Folder\\index.tsx",
        "range": {
          "startPosition": {
            "line": 156
          },
          "endPosition": {
            "line": 621,
            "column": 1
          }
        },
        "contents": "export default function Folder({ data }: { data?: Agent }) {\n (\n                  isShowSourceCode ? (\n                    &lt;&gt;{selectedFile.content}&lt;/&gt;\n                  ) : (\n                    &lt;HtmlRenderer selectedFile={selectedFile} /&gt;\n                  )\n                ) : selectedFile.type === 'zip' ? (\n                  &lt;div className=\"flex items-center justify-center h-full text-zinc-500\"&gt;\n                    &lt;div className=\"text-center\"&gt;\n                      &lt;FileText className=\"w-12 h-12 mx-auto mb-4 text-zinc-300\" /&gt;\n                      &lt;p className=\"text-sm\"&gt;\n                        {t('folder.zip-file-is-not-supported-yet')}\n                      &lt;/p&gt;\n                    &lt;/div&gt;\n                  &lt;/div&gt;\n                ) : [\n                    'png',\n                    'jpg',\n                    'jpeg',\n                    'gif',\n                    'bmp',\n                    'webp',\n                    'svg',\n                  ].includes(selectedFile.type.toLowerCase()) ? (\n                  &lt;div className=\"flex items-center justify-center h-full\"&gt;\n                    &lt;ImageLoader selectedFile={selectedFile} /&gt;\n                  &lt;/div&gt;\n                ) : (\n                  &lt;pre className=\"text-sm text-zinc-700 font-mono whitespace-pre-wrap break-words overflow-x-auto\"&gt;\n                    {selectedFile.content}\n                  &lt;/pre&gt;\n                )\n              ) : (\n                &lt;div className=\"flex items-center justify-center h-full\"&gt;\n                  &lt;div className=\"text-center\"&gt;\n                    &lt;div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"&gt;&lt;/div&gt;\n                    &lt;p className=\"text-sm text-zinc-500\"&gt;{t('chat.loading')}&lt;/p&gt;\n                  &lt;/div&gt;\n                &lt;/div&gt;\n              )\n            ) : (\n              &lt;div className=\"flex items-center justify-center h-full text-zinc-500\"&gt;\n                &lt;div className=\"text-center\"&gt;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 157,
                "column": 1
              },
              "endPosition": {
                "line": 157,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 157,
                "column": 16
              },
              "endPosition": {
                "line": 158,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Folder({ data }: { data?: Agent }) {",
            "lineNumber": 157,
            "isSignature": true
          },
          {
            "text": " (",
            "lineNumber": 567
          },
          {
            "text": "                  isShowSourceCode ? (",
            "lineNumber": 568
          },
          {
            "text": "                    &lt;&gt;{selectedFile.content}&lt;/&gt;",
            "lineNumber": 569
          },
          {
            "text": "                  ) : (",
            "lineNumber": 570
          },
          {
            "text": "                    &lt;HtmlRenderer selectedFile={selectedFile} /&gt;",
            "lineNumber": 571
          },
          {
            "text": "                  )",
            "lineNumber": 572
          },
          {
            "text": "                ) : selectedFile.type === 'zip' ? (",
            "lineNumber": 573
          },
          {
            "text": "                  &lt;div className=\"flex items-center justify-center h-full text-zinc-500\"&gt;",
            "lineNumber": 574
          },
          {
            "text": "                    &lt;div className=\"text-center\"&gt;",
            "lineNumber": 575
          },
          {
            "text": "                      &lt;FileText className=\"w-12 h-12 mx-auto mb-4 text-zinc-300\" /&gt;",
            "lineNumber": 576
          },
          {
            "text": "                      &lt;p className=\"text-sm\"&gt;",
            "lineNumber": 577
          },
          {
            "text": "                        {t('folder.zip-file-is-not-supported-yet')}",
            "lineNumber": 578
          },
          {
            "text": "                      &lt;/p&gt;",
            "lineNumber": 579
          },
          {
            "text": "                    &lt;/div&gt;",
            "lineNumber": 580
          },
          {
            "text": "                  &lt;/div&gt;",
            "lineNumber": 581
          },
          {
            "text": "                ) : [",
            "lineNumber": 582
          },
          {
            "text": "                    'png',",
            "lineNumber": 583
          },
          {
            "text": "                    'jpg',",
            "lineNumber": 584
          },
          {
            "text": "                    'jpeg',",
            "lineNumber": 585
          },
          {
            "text": "                    'gif',",
            "lineNumber": 586
          },
          {
            "text": "                    'bmp',",
            "lineNumber": 587
          },
          {
            "text": "                    'webp',",
            "lineNumber": 588
          },
          {
            "text": "                    'svg',",
            "lineNumber": 589
          },
          {
            "text": "                  ].includes(selectedFile.type.toLowerCase()) ? (",
            "lineNumber": 590
          },
          {
            "text": "                  &lt;div className=\"flex items-center justify-center h-full\"&gt;",
            "lineNumber": 591
          },
          {
            "text": "                    &lt;ImageLoader selectedFile={selectedFile} /&gt;",
            "lineNumber": 592
          },
          {
            "text": "                  &lt;/div&gt;",
            "lineNumber": 593
          },
          {
            "text": "                ) : (",
            "lineNumber": 594
          },
          {
            "text": "                  &lt;pre className=\"text-sm text-zinc-700 font-mono whitespace-pre-wrap break-words overflow-x-auto\"&gt;",
            "lineNumber": 595
          },
          {
            "text": "                    {selectedFile.content}",
            "lineNumber": 596
          },
          {
            "text": "                  &lt;/pre&gt;",
            "lineNumber": 597
          },
          {
            "text": "                )",
            "lineNumber": 598
          },
          {
            "text": "              ) : (",
            "lineNumber": 599
          },
          {
            "text": "                &lt;div className=\"flex items-center justify-center h-full\"&gt;",
            "lineNumber": 600
          },
          {
            "text": "                  &lt;div className=\"text-center\"&gt;",
            "lineNumber": 601
          },
          {
            "text": "                    &lt;div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"&gt;&lt;/div&gt;",
            "lineNumber": 602
          },
          {
            "text": "                    &lt;p className=\"text-sm text-zinc-500\"&gt;{t('chat.loading')}&lt;/p&gt;",
            "lineNumber": 603
          },
          {
            "text": "                  &lt;/div&gt;",
            "lineNumber": 604
          },
          {
            "text": "                &lt;/div&gt;",
            "lineNumber": 605
          },
          {
            "text": "              )",
            "lineNumber": 606
          },
          {
            "text": "            ) : (",
            "lineNumber": 607
          },
          {
            "text": "              &lt;div className=\"flex items-center justify-center h-full text-zinc-500\"&gt;",
            "lineNumber": 608
          },
          {
            "text": "                &lt;div className=\"text-center\"&gt;",
            "lineNumber": 609
          },
          {
            "text": "}",
            "lineNumber": 622,
            "isSignature": true
          }
        ]
      },
      "score": 0.2292553037405014
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\ProjectChatContainer.tsx",
        "range": {
          "startPosition": {
            "line": 10,
            "column": 1
          },
          "endPosition": {
            "line": 176,
            "column": 1
          }
        },
        "contents": "export const ProjectChatContainer: React.FC&lt;ProjectChatContainerProps&gt; = ({\n  className = \"\",\n  // onPauseResume,  // Commented out - temporary not needed\n  onSkip,\n  isPauseResumeLoading\n}) =&gt; {\n  const { projectStore, chatStore } = useChatStoreAdapter();\n  const containerRef = useRef&lt;HTMLDivElement&gt;(null);\n  const scrollTimeoutRef = useRef&lt;NodeJS.Timeout | null&gt;(null);\n  const [activeQueryId, setActiveQueryId] = useState&lt;string | null&gt;(null);\n  const [lastMessageCount, setLastMessageCount] = useState(0);\n\n  // Get all chat stores for the active project\n  const activeProjectId = projectStore.activeProjectId;\n  const chatStores = activeProjectId \n    ? projectStore.getAllChatStores(activeProjectId)\n    : [];\n\n  // Scroll to bottom function\n  const scrollToBottom = useCallback(() =&gt; {\n    if (containerRef.current) {\n      setTimeout(() =&gt; {\n        // Double check containerRef is still valid before scrolling\n        if (containerRef.current) {\n          containerRef.current.scrollTo({\n            top: containerRef.current.scrollHeight,\n            behavior: \"smooth\",\n          });\n        }\n      }, 100);\n    }\n  }, []);\n\n  // Monitor for new user messages and auto-scroll\n  useEffect(() =&gt; {\n    if (!chatStore || !activeProjectId) return;\n\n    const activeTaskId = chatStore.activeTaskId;\n    if (!activeTaskId) return;\n\n    const task = chatStore.tasks[activeTaskId];\n    if (!task) return;\n\n    const currentMessageCount = task.messages.length;\n    \n    // Check if a new user message was added\n    if (currentMessageCount &gt; lastMessageCount) {\n      const lastMessage = task.messages[task.messages.length - 1];\n      \n      // If the last message is from user, scroll to bottom\n      if (lastMessage &amp;&amp; lastMessage.role === 'user') {\n        scrollToBottom();\n      }\n    }\n    \n    setLastMessageCount(currentMessageCount);\n  }, [chatStore?.tasks[chatStore.activeTaskId as string]?.messages, lastMessageCount, scrollToBottom, activeProjectId]);\n\n  // Reset message count when active task changes\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export const ProjectChatContainer: React.FC&lt;ProjectChatContainerProps&gt; = ({",
            "lineNumber": 13
          },
          {
            "text": "  className = \"\",",
            "lineNumber": 14
          },
          {
            "text": "  // onPauseResume,  // Commented out - temporary not needed",
            "lineNumber": 15
          },
          {
            "text": "  onSkip,",
            "lineNumber": 16
          },
          {
            "text": "  isPauseResumeLoading",
            "lineNumber": 17
          },
          {
            "text": "}) =&gt; {",
            "lineNumber": 18
          },
          {
            "text": "  const { projectStore, chatStore } = useChatStoreAdapter();",
            "lineNumber": 19
          },
          {
            "text": "  const containerRef = useRef&lt;HTMLDivElement&gt;(null);",
            "lineNumber": 20
          },
          {
            "text": "  const scrollTimeoutRef = useRef&lt;NodeJS.Timeout | null&gt;(null);",
            "lineNumber": 21
          },
          {
            "text": "  const [activeQueryId, setActiveQueryId] = useState&lt;string | null&gt;(null);",
            "lineNumber": 22
          },
          {
            "text": "  const [lastMessageCount, setLastMessageCount] = useState(0);",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "  // Get all chat stores for the active project",
            "lineNumber": 25
          },
          {
            "text": "  const activeProjectId = projectStore.activeProjectId;",
            "lineNumber": 26
          },
          {
            "text": "  const chatStores = activeProjectId ",
            "lineNumber": 27
          },
          {
            "text": "    ? projectStore.getAllChatStores(activeProjectId)",
            "lineNumber": 28
          },
          {
            "text": "    : [];",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "  // Scroll to bottom function",
            "lineNumber": 31
          },
          {
            "text": "  const scrollToBottom = useCallback(() =&gt; {",
            "lineNumber": 32
          },
          {
            "text": "    if (containerRef.current) {",
            "lineNumber": 33
          },
          {
            "text": "      setTimeout(() =&gt; {",
            "lineNumber": 34
          },
          {
            "text": "        // Double check containerRef is still valid before scrolling",
            "lineNumber": 35
          },
          {
            "text": "        if (containerRef.current) {",
            "lineNumber": 36
          },
          {
            "text": "          containerRef.current.scrollTo({",
            "lineNumber": 37
          },
          {
            "text": "            top: containerRef.current.scrollHeight,",
            "lineNumber": 38
          },
          {
            "text": "            behavior: \"smooth\",",
            "lineNumber": 39
          },
          {
            "text": "          });",
            "lineNumber": 40
          },
          {
            "text": "        }",
            "lineNumber": 41
          },
          {
            "text": "      }, 100);",
            "lineNumber": 42
          },
          {
            "text": "    }",
            "lineNumber": 43
          },
          {
            "text": "  }, []);",
            "lineNumber": 44
          },
          {
            "lineNumber": 45
          },
          {
            "text": "  // Monitor for new user messages and auto-scroll",
            "lineNumber": 46
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 47
          },
          {
            "text": "    if (!chatStore || !activeProjectId) return;",
            "lineNumber": 48
          },
          {
            "lineNumber": 49
          },
          {
            "text": "    const activeTaskId = chatStore.activeTaskId;",
            "lineNumber": 50
          },
          {
            "text": "    if (!activeTaskId) return;",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "    const task = chatStore.tasks[activeTaskId];",
            "lineNumber": 53
          },
          {
            "text": "    if (!task) return;",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "    const currentMessageCount = task.messages.length;",
            "lineNumber": 56
          },
          {
            "text": "    ",
            "lineNumber": 57
          },
          {
            "text": "    // Check if a new user message was added",
            "lineNumber": 58
          },
          {
            "text": "    if (currentMessageCount &gt; lastMessageCount) {",
            "lineNumber": 59
          },
          {
            "text": "      const lastMessage = task.messages[task.messages.length - 1];",
            "lineNumber": 60
          },
          {
            "text": "      ",
            "lineNumber": 61
          },
          {
            "text": "      // If the last message is from user, scroll to bottom",
            "lineNumber": 62
          },
          {
            "text": "      if (lastMessage &amp;&amp; lastMessage.role === 'user') {",
            "lineNumber": 63
          },
          {
            "text": "        scrollToBottom();",
            "lineNumber": 64
          },
          {
            "text": "      }",
            "lineNumber": 65
          },
          {
            "text": "    }",
            "lineNumber": 66
          },
          {
            "text": "    ",
            "lineNumber": 67
          },
          {
            "text": "    setLastMessageCount(currentMessageCount);",
            "lineNumber": 68
          },
          {
            "text": "  }, [chatStore?.tasks[chatStore.activeTaskId as string]?.messages, lastMessageCount, scrollToBottom, activeProjectId]);",
            "lineNumber": 69
          },
          {
            "lineNumber": 70
          },
          {
            "text": "  // Reset message count when active task changes",
            "lineNumber": 71
          },
          {
            "text": ";",
            "lineNumber": 177
          }
        ]
      },
      "score": 0.22239629924297333
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "column": 152
          },
          "endPosition": {
            "line": 109,
            "column": 1
          }
        },
        "contents": ";\nimport { fetchEventSource } from '@microsoft/fetch-event-source';\nimport { createStore } from 'zustand';\nimport { generateUniqueId, uploadLog } from \"@/lib\";\nimport { FileText } from 'lucide-react';\nimport { getAuthStore, useWorkerList } from './authStore';\nimport { useProjectStore } from './projectStore';\nimport { showCreditsToast } from '@/components/Toast/creditsToast';\nimport { showStorageToast } from '@/components/Toast/storageToast';\nimport { toast } from 'sonner';\n\n\ninterface Task {\n\tmessages: Message[];\n\ttype: string;\n\tsummaryTask: string;\n\ttaskInfo: TaskInfo[];\n\tattaches: File[];\n\ttaskRunning: TaskInfo[];\n\ttaskAssigning: Agent[];\n\tfileList: FileInfo[];\n\twebViewUrls: { url: string, processTaskId: string }[]\n\tactiveAsk: string\n\taskList: Message[]\n\tprogressValue: number\n\tisPending: boolean\n\tactiveWorkSpace: string | null;\n\thasMessages: boolean;\n\tactiveAgent: string;\n\tstatus: 'running' | 'finished' | 'pending' | 'pause';\n\ttaskTime: number;\n\telapsed: number;\n\ttokens: number;\n\thasWaitComfirm: boolean;\n\tcotList: string[];\n\thasAddWorker: boolean\n\tnuwFileNum: number\n\tdelayTime: number\n\tselectedFile: FileInfo | null;\n\tsnapshots: any[];\n\tsnapshotsTemp: any[];\n\tisTakeControl: boolean;\n\tisTaskEdit: boolean;\n\tisContextExceeded?: boolean;\n\t// Streaming decompose text - stored separately to avoid frequent re-renders\n\tstreamingDecomposeText: string;\n}\n\nexport interface ChatStore {\n\tupdateCount: number;\n\tactiveTaskId: string | null\n;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": ";",
            "lineNumber": 1
          },
          {
            "text": "import { fetchEventSource } from '@microsoft/fetch-event-source';",
            "lineNumber": 2
          },
          {
            "text": "import { createStore } from 'zustand';",
            "lineNumber": 3
          },
          {
            "text": "import { generateUniqueId, uploadLog } from \"@/lib\";",
            "lineNumber": 4
          },
          {
            "text": "import { FileText } from 'lucide-react';",
            "lineNumber": 5
          },
          {
            "text": "import { getAuthStore, useWorkerList } from './authStore';",
            "lineNumber": 6
          },
          {
            "text": "import { useProjectStore } from './projectStore';",
            "lineNumber": 7
          },
          {
            "text": "import { showCreditsToast } from '@/components/Toast/creditsToast';",
            "lineNumber": 8
          },
          {
            "text": "import { showStorageToast } from '@/components/Toast/storageToast';",
            "lineNumber": 9
          },
          {
            "text": "import { toast } from 'sonner';",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "interface Task {",
            "lineNumber": 13,
            "isSignature": true
          },
          {
            "text": "\tmessages: Message[];",
            "lineNumber": 14
          },
          {
            "text": "\ttype: string;",
            "lineNumber": 15
          },
          {
            "text": "\tsummaryTask: string;",
            "lineNumber": 16
          },
          {
            "text": "\ttaskInfo: TaskInfo[];",
            "lineNumber": 17
          },
          {
            "text": "\tattaches: File[];",
            "lineNumber": 18
          },
          {
            "text": "\ttaskRunning: TaskInfo[];",
            "lineNumber": 19
          },
          {
            "text": "\ttaskAssigning: Agent[];",
            "lineNumber": 20
          },
          {
            "text": "\tfileList: FileInfo[];",
            "lineNumber": 21
          },
          {
            "text": "\twebViewUrls: { url: string, processTaskId: string }[]",
            "lineNumber": 22
          },
          {
            "text": "\tactiveAsk: string",
            "lineNumber": 23
          },
          {
            "text": "\taskList: Message[]",
            "lineNumber": 24
          },
          {
            "text": "\tprogressValue: number",
            "lineNumber": 25
          },
          {
            "text": "\tisPending: boolean",
            "lineNumber": 26
          },
          {
            "text": "\tactiveWorkSpace: string | null;",
            "lineNumber": 27
          },
          {
            "text": "\thasMessages: boolean;",
            "lineNumber": 28
          },
          {
            "text": "\tactiveAgent: string;",
            "lineNumber": 29
          },
          {
            "text": "\tstatus: 'running' | 'finished' | 'pending' | 'pause';",
            "lineNumber": 30
          },
          {
            "text": "\ttaskTime: number;",
            "lineNumber": 31
          },
          {
            "text": "\telapsed: number;",
            "lineNumber": 32
          },
          {
            "text": "\ttokens: number;",
            "lineNumber": 33
          },
          {
            "text": "\thasWaitComfirm: boolean;",
            "lineNumber": 34
          },
          {
            "text": "\tcotList: string[];",
            "lineNumber": 35
          },
          {
            "text": "\thasAddWorker: boolean",
            "lineNumber": 36
          },
          {
            "text": "\tnuwFileNum: number",
            "lineNumber": 37
          },
          {
            "text": "\tdelayTime: number",
            "lineNumber": 38
          },
          {
            "text": "\tselectedFile: FileInfo | null;",
            "lineNumber": 39
          },
          {
            "text": "\tsnapshots: any[];",
            "lineNumber": 40
          },
          {
            "text": "\tsnapshotsTemp: any[];",
            "lineNumber": 41
          },
          {
            "text": "\tisTakeControl: boolean;",
            "lineNumber": 42
          },
          {
            "text": "\tisTaskEdit: boolean;",
            "lineNumber": 43
          },
          {
            "text": "\tisContextExceeded?: boolean;",
            "lineNumber": 44
          },
          {
            "text": "\t// Streaming decompose text - stored separately to avoid frequent re-renders",
            "lineNumber": 45
          },
          {
            "text": "\tstreamingDecomposeText: string;",
            "lineNumber": 46,
            "isSignature": true
          },
          {
            "text": "}",
            "lineNumber": 47,
            "isSignature": true
          },
          {
            "lineNumber": 48
          },
          {
            "text": "export interface ChatStore {",
            "lineNumber": 49,
            "isSignature": true
          },
          {
            "text": "\tupdateCount: number;",
            "lineNumber": 50
          },
          {
            "text": "\tactiveTaskId: string | null",
            "lineNumber": 51
          },
          {
            "text": ";",
            "lineNumber": 109,
            "isSignature": true
          },
          {
            "text": "}",
            "lineNumber": 110,
            "isSignature": true
          }
        ]
      },
      "score": 0.22059069573879242
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "設定頁面返回專案頁面 navigation routing",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting.tsx",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 106,
            "column": 1
          }
        },
        "contents": "import { useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { Button } from \"@/components/ui/button\";\nimport VerticalNavigation, { type VerticalNavItem } from \"@/components/Navigation\";\nimport { useTranslation } from \"react-i18next\";\nimport useAppVersion from \"@/hooks/use-app-version\";\nimport vsersionLogo from \"@/assets/version-logo.png\";\nimport General from \"@/pages/Setting/General\";\nimport Privacy from \"@/pages/Setting/Privacy\";\nimport Models from \"@/pages/Setting/Models\";\nimport MCP from \"@/pages/Setting/MCP\";\nimport {\n\tX,\n\tCircleCheck,\n\tSettings,\n\tFingerprint,\n\tTextSelect,\n\tServer,\n} from \"lucide-react\";\n\nexport default function Setting() {\n\tconst navigate = useNavigate();\n\tconst location = useLocation();\n\tconst version = useAppVersion();\n\tconst { t } = useTranslation();\n\t// Setting menu configuration\n\tconst settingMenus = [\n\t\t{\n\t\t\tid: \"general\",\n\t\t\tname: t(\"setting.general\"),\n\t\t\ticon: Settings,\n\t\t\tpath: \"/setting/general\",\n\t\t},\n\t\t{\n\t\t\tid: \"privacy\",\n\t\t\tname: t(\"setting.privacy\"),\n\t\t\ticon: Fingerprint,\n\t\t\tpath: \"/setting/privacy\",\n\t\t},\n\t\t{\n\t\t\tid: \"models\",\n\t\t\tname: t(\"setting.models\"),\n\t\t\ticon: TextSelect,\n\t\t\tpath: \"/setting/models\",\n\t\t},\n\t];\n\t// Initialize tab from URL once, then manage locally without routing\n\tconst getCurrentTab = () =&gt; {\n\t\tconst path = location.pathname;\n\t\tconst tabFromUrl = path.split(\"/setting/\")[1] || \"general\";\n\t\treturn settingMenus.find((menu) =&gt; menu.id === tabFromUrl)?.id || \"general\";\n\t};\n\n\tconst [activeTab, setActiveTab] = useState(getCurrentTab);\n\n\t// Switch tabs locally (no navigation)\n\tconst handleTabChange = (tabId: string) =&gt; {\n\t\tsetActiveTab(tabId);\n\t};\n\n\t// Close settings page\n\tconst handleClose = () =&gt; {\n\t\tnavigate(\"/\");\n\t};\n\n\treturn (\n\t\t&lt;div className=\"max-w-[900px] h-auto px-4 m-auto flex flex-col py-4\"&gt;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { useState } from \"react\";",
            "lineNumber": 1
          },
          {
            "text": "import { useNavigate, useLocation } from \"react-router-dom\";",
            "lineNumber": 2
          },
          {
            "text": "import { Button } from \"@/components/ui/button\";",
            "lineNumber": 3
          },
          {
            "text": "import VerticalNavigation, { type VerticalNavItem } from \"@/components/Navigation\";",
            "lineNumber": 4
          },
          {
            "text": "import { useTranslation } from \"react-i18next\";",
            "lineNumber": 5
          },
          {
            "text": "import useAppVersion from \"@/hooks/use-app-version\";",
            "lineNumber": 6
          },
          {
            "text": "import vsersionLogo from \"@/assets/version-logo.png\";",
            "lineNumber": 7
          },
          {
            "text": "import General from \"@/pages/Setting/General\";",
            "lineNumber": 8
          },
          {
            "text": "import Privacy from \"@/pages/Setting/Privacy\";",
            "lineNumber": 9
          },
          {
            "text": "import Models from \"@/pages/Setting/Models\";",
            "lineNumber": 10
          },
          {
            "text": "import MCP from \"@/pages/Setting/MCP\";",
            "lineNumber": 11
          },
          {
            "text": "import {",
            "lineNumber": 12
          },
          {
            "text": "\tX,",
            "lineNumber": 13
          },
          {
            "text": "\tCircleCheck,",
            "lineNumber": 14
          },
          {
            "text": "\tSettings,",
            "lineNumber": 15
          },
          {
            "text": "\tFingerprint,",
            "lineNumber": 16
          },
          {
            "text": "\tTextSelect,",
            "lineNumber": 17
          },
          {
            "text": "\tServer,",
            "lineNumber": 18
          },
          {
            "text": "} from \"lucide-react\";",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "export default function Setting() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 22
          },
          {
            "text": "\tconst location = useLocation();",
            "lineNumber": 23
          },
          {
            "text": "\tconst version = useAppVersion();",
            "lineNumber": 24
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 25
          },
          {
            "text": "\t// Setting menu configuration",
            "lineNumber": 26
          },
          {
            "text": "\tconst settingMenus = [",
            "lineNumber": 27
          },
          {
            "text": "\t\t{",
            "lineNumber": 28
          },
          {
            "text": "\t\t\tid: \"general\",",
            "lineNumber": 29
          },
          {
            "text": "\t\t\tname: t(\"setting.general\"),",
            "lineNumber": 30
          },
          {
            "text": "\t\t\ticon: Settings,",
            "lineNumber": 31
          },
          {
            "text": "\t\t\tpath: \"/setting/general\",",
            "lineNumber": 32
          },
          {
            "text": "\t\t},",
            "lineNumber": 33
          },
          {
            "text": "\t\t{",
            "lineNumber": 34
          },
          {
            "text": "\t\t\tid: \"privacy\",",
            "lineNumber": 35
          },
          {
            "text": "\t\t\tname: t(\"setting.privacy\"),",
            "lineNumber": 36
          },
          {
            "text": "\t\t\ticon: Fingerprint,",
            "lineNumber": 37
          },
          {
            "text": "\t\t\tpath: \"/setting/privacy\",",
            "lineNumber": 38
          },
          {
            "text": "\t\t},",
            "lineNumber": 39
          },
          {
            "text": "\t\t{",
            "lineNumber": 40
          },
          {
            "text": "\t\t\tid: \"models\",",
            "lineNumber": 41
          },
          {
            "text": "\t\t\tname: t(\"setting.models\"),",
            "lineNumber": 42
          },
          {
            "text": "\t\t\ticon: TextSelect,",
            "lineNumber": 43
          },
          {
            "text": "\t\t\tpath: \"/setting/models\",",
            "lineNumber": 44
          },
          {
            "text": "\t\t},",
            "lineNumber": 45
          },
          {
            "text": "\t];",
            "lineNumber": 46
          },
          {
            "text": "\t// Initialize tab from URL once, then manage locally without routing",
            "lineNumber": 47
          },
          {
            "text": "\tconst getCurrentTab = () =&gt; {",
            "lineNumber": 48
          },
          {
            "text": "\t\tconst path = location.pathname;",
            "lineNumber": 49
          },
          {
            "text": "\t\tconst tabFromUrl = path.split(\"/setting/\")[1] || \"general\";",
            "lineNumber": 50
          },
          {
            "text": "\t\treturn settingMenus.find((menu) =&gt; menu.id === tabFromUrl)?.id || \"general\";",
            "lineNumber": 51
          },
          {
            "text": "\t};",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "\tconst [activeTab, setActiveTab] = useState(getCurrentTab);",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "\t// Switch tabs locally (no navigation)",
            "lineNumber": 56
          },
          {
            "text": "\tconst handleTabChange = (tabId: string) =&gt; {",
            "lineNumber": 57
          },
          {
            "text": "\t\tsetActiveTab(tabId);",
            "lineNumber": 58
          },
          {
            "text": "\t};",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "\t// Close settings page",
            "lineNumber": 61
          },
          {
            "text": "\tconst handleClose = () =&gt; {",
            "lineNumber": 62
          },
          {
            "text": "\t\tnavigate(\"/\");",
            "lineNumber": 63
          },
          {
            "text": "\t};",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "\treturn (",
            "lineNumber": 66
          },
          {
            "text": "\t\t&lt;div className=\"max-w-[900px] h-auto px-4 m-auto flex flex-col py-4\"&gt;",
            "lineNumber": 67
          },
          {
            "text": "}",
            "lineNumber": 107,
            "isSignature": true
          }
        ]
      },
      "score": 0.49184590578079224
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 106,
            "column": 1
          }
        },
        "contents": "export default function Setting() {\n\n\n\treturn (\n\t\t&lt;div className=\"max-w-[900px] h-auto px-4 m-auto flex flex-col py-4\"&gt;\n\t\t\t&lt;div className=\"w-full h-auto flex px-3\"&gt;\n\t\t\t\t\t&lt;div className=\"!w-[222px] flex-shrink-0 flex-grow-0 pt-md pr-4 flex flex-col sticky top-20 self-start\"&gt;\n\t\t\t\t\t\t&lt;VerticalNavigation\n\t\t\t\t\t\t\titems={settingMenus.map((menu) =&gt; {\n\t\t\t\t\t\t\t\tconst Icon = menu.icon;\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tvalue: menu.id,\n\t\t\t\t\t\t\t\t\tlabel: &lt;span className=\"text-sm font-bold leading-13\"&gt;{menu.name}&lt;/span&gt;,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}) as VerticalNavItem[]}\n\t\t\t\t\t\t\tvalue={activeTab}\n\t\t\t\t\t\t\tonValueChange={handleTabChange}\n\t\t\t\t\t\t\tclassName=\"w-full h-full flex-1 min-h-0 gap-0\"\n\t\t\t\t\t\t\tlistClassName=\"w-full h-full overflow-y-auto\"\n\t\t\t\t\t\t\tcontentClassName=\"hidden\"\n\t\t\t\t\t\t/&gt;\n\t\t\t\t\t\t&lt;div className=\"w-full mt-8 pt-4 pb-2 flex items-center justify-center border-[0px] border-t border-solid border-white-80% flex-shrink-0 flex-grow-0\"&gt;\n\t\t\t\t\t\t&lt;div className=\"flex items-center gap-1 leading-9\"&gt;\n\t\t\t\t\t\t\t&lt;img src={vsersionLogo} alt=\"version-logo\" className=\"h-6\" /&gt;\n\t\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t\t&lt;div className=\"px-sm py-0.5 bg-bg-surface-tertiary rounded-full gap-1 flex items-center justify-center\"&gt;\n\t\t\t\t\t\t\t&lt;CircleCheck className=\"w-4 h-4 text-bg-fill-success-primary\" /&gt;\n\t\t\t\t\t\t\t&lt;div className=\"text-primary text-xs font-bold leading-17\"&gt;\n\t\t\t\t\t\t\t\t{version}\n\t\t\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t&lt;/div&gt;\n\n\t\t\t\t&lt;div className=\"flex-1 flex flex-col w-full h-auto\"&gt;\n\t\t\t\t\t&lt;div className=\"flex flex-col gap-4 pb-md py-md\"&gt;\n\t\t\t\t\t\t{activeTab === \"general\" &amp;&amp; &lt;General /&gt;}\n\t\t\t\t\t\t{activeTab === \"privacy\" &amp;&amp; &lt;Privacy /&gt;}\n\t\t\t\t\t\t{activeTab === \"models\" &amp;&amp; &lt;Models /&gt;}\n\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t&lt;/div&gt;\n\t\t\t&lt;/div&gt;\n\t\t&lt;/div&gt;\n\t);\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Setting() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "\treturn (",
            "lineNumber": 66
          },
          {
            "text": "\t\t&lt;div className=\"max-w-[900px] h-auto px-4 m-auto flex flex-col py-4\"&gt;",
            "lineNumber": 67
          },
          {
            "text": "\t\t\t&lt;div className=\"w-full h-auto flex px-3\"&gt;",
            "lineNumber": 68
          },
          {
            "text": "\t\t\t\t\t&lt;div className=\"!w-[222px] flex-shrink-0 flex-grow-0 pt-md pr-4 flex flex-col sticky top-20 self-start\"&gt;",
            "lineNumber": 69
          },
          {
            "text": "\t\t\t\t\t\t&lt;VerticalNavigation",
            "lineNumber": 70
          },
          {
            "text": "\t\t\t\t\t\t\titems={settingMenus.map((menu) =&gt; {",
            "lineNumber": 71
          },
          {
            "text": "\t\t\t\t\t\t\t\tconst Icon = menu.icon;",
            "lineNumber": 72
          },
          {
            "text": "\t\t\t\t\t\t\t\treturn {",
            "lineNumber": 73
          },
          {
            "text": "\t\t\t\t\t\t\t\t\tvalue: menu.id,",
            "lineNumber": 74
          },
          {
            "text": "\t\t\t\t\t\t\t\t\tlabel: &lt;span className=\"text-sm font-bold leading-13\"&gt;{menu.name}&lt;/span&gt;,",
            "lineNumber": 75
          },
          {
            "text": "\t\t\t\t\t\t\t\t};",
            "lineNumber": 76
          },
          {
            "text": "\t\t\t\t\t\t\t}) as VerticalNavItem[]}",
            "lineNumber": 77
          },
          {
            "text": "\t\t\t\t\t\t\tvalue={activeTab}",
            "lineNumber": 78
          },
          {
            "text": "\t\t\t\t\t\t\tonValueChange={handleTabChange}",
            "lineNumber": 79
          },
          {
            "text": "\t\t\t\t\t\t\tclassName=\"w-full h-full flex-1 min-h-0 gap-0\"",
            "lineNumber": 80
          },
          {
            "text": "\t\t\t\t\t\t\tlistClassName=\"w-full h-full overflow-y-auto\"",
            "lineNumber": 81
          },
          {
            "text": "\t\t\t\t\t\t\tcontentClassName=\"hidden\"",
            "lineNumber": 82
          },
          {
            "text": "\t\t\t\t\t\t/&gt;",
            "lineNumber": 83
          },
          {
            "text": "\t\t\t\t\t\t&lt;div className=\"w-full mt-8 pt-4 pb-2 flex items-center justify-center border-[0px] border-t border-solid border-white-80% flex-shrink-0 flex-grow-0\"&gt;",
            "lineNumber": 84
          },
          {
            "text": "\t\t\t\t\t\t&lt;div className=\"flex items-center gap-1 leading-9\"&gt;",
            "lineNumber": 85
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;img src={vsersionLogo} alt=\"version-logo\" className=\"h-6\" /&gt;",
            "lineNumber": 86
          },
          {
            "text": "\t\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 87
          },
          {
            "text": "\t\t\t\t\t\t&lt;div className=\"px-sm py-0.5 bg-bg-surface-tertiary rounded-full gap-1 flex items-center justify-center\"&gt;",
            "lineNumber": 88
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;CircleCheck className=\"w-4 h-4 text-bg-fill-success-primary\" /&gt;",
            "lineNumber": 89
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;div className=\"text-primary text-xs font-bold leading-17\"&gt;",
            "lineNumber": 90
          },
          {
            "text": "\t\t\t\t\t\t\t\t{version}",
            "lineNumber": 91
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 92
          },
          {
            "text": "\t\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 93
          },
          {
            "text": "\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 94
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 95
          },
          {
            "lineNumber": 96
          },
          {
            "text": "\t\t\t\t&lt;div className=\"flex-1 flex flex-col w-full h-auto\"&gt;",
            "lineNumber": 97
          },
          {
            "text": "\t\t\t\t\t&lt;div className=\"flex flex-col gap-4 pb-md py-md\"&gt;",
            "lineNumber": 98
          },
          {
            "text": "\t\t\t\t\t\t{activeTab === \"general\" &amp;&amp; &lt;General /&gt;}",
            "lineNumber": 99
          },
          {
            "text": "\t\t\t\t\t\t{activeTab === \"privacy\" &amp;&amp; &lt;Privacy /&gt;}",
            "lineNumber": 100
          },
          {
            "text": "\t\t\t\t\t\t{activeTab === \"models\" &amp;&amp; &lt;Models /&gt;}",
            "lineNumber": 101
          },
          {
            "text": "\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 102
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 103
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 104
          },
          {
            "text": "\t\t&lt;/div&gt;",
            "lineNumber": 105
          },
          {
            "text": "\t);",
            "lineNumber": 106
          },
          {
            "text": "}",
            "lineNumber": 107,
            "isSignature": true
          }
        ]
      },
      "score": 0.3907274603843689
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\routers\\index.tsx",
        "range": {
          "startPosition": {
            "line": 49,
            "column": 2
          },
          "endPosition": {
            "line": 68,
            "column": 25
          }
        },
        "contents": "// Main route configuration\nconst AppRoutes = () =&gt; (\n\t&lt;Routes&gt;\n\t\t&lt;Route path=\"/login\" element={&lt;Login /&gt;} /&gt;\n\t\t&lt;Route path=\"/signup\" element={&lt;Signup /&gt;} /&gt;\n\t\t&lt;Route element={&lt;ProtectedRoute /&gt;}&gt;\n\t\t\t&lt;Route element={&lt;Layout /&gt;}&gt;\n\t\t\t\t&lt;Route path=\"/\" element={&lt;Home /&gt;} /&gt;\n\t\t\t\t&lt;Route path=\"/history\" element={&lt;History /&gt;} /&gt;\n\t\t\t\t&lt;Route path=\"/setting\" element={&lt;Navigate to=\"/history?tab=settings\" replace /&gt;} /&gt;\n\t\t\t\t&lt;Route path=\"/setting/*\" element={&lt;Navigate to=\"/history?tab=settings\" replace /&gt;} /&gt;\n\t\t\t&lt;/Route&gt;\n\t\t&lt;/Route&gt;\n\t\t&lt;Route path=\"*\" element={&lt;NotFound /&gt;} /&gt;\n\t&lt;/Routes&gt;\n);\n\nexport default AppRoutes;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// Main route configuration",
            "lineNumber": 52
          },
          {
            "text": "const AppRoutes = () =&gt; (",
            "lineNumber": 53
          },
          {
            "text": "\t&lt;Routes&gt;",
            "lineNumber": 54
          },
          {
            "text": "\t\t&lt;Route path=\"/login\" element={&lt;Login /&gt;} /&gt;",
            "lineNumber": 55
          },
          {
            "text": "\t\t&lt;Route path=\"/signup\" element={&lt;Signup /&gt;} /&gt;",
            "lineNumber": 56
          },
          {
            "text": "\t\t&lt;Route element={&lt;ProtectedRoute /&gt;}&gt;",
            "lineNumber": 57
          },
          {
            "text": "\t\t\t&lt;Route element={&lt;Layout /&gt;}&gt;",
            "lineNumber": 58
          },
          {
            "text": "\t\t\t\t&lt;Route path=\"/\" element={&lt;Home /&gt;} /&gt;",
            "lineNumber": 59
          },
          {
            "text": "\t\t\t\t&lt;Route path=\"/history\" element={&lt;History /&gt;} /&gt;",
            "lineNumber": 60
          },
          {
            "text": "\t\t\t\t&lt;Route path=\"/setting\" element={&lt;Navigate to=\"/history?tab=settings\" replace /&gt;} /&gt;",
            "lineNumber": 61
          },
          {
            "text": "\t\t\t\t&lt;Route path=\"/setting/*\" element={&lt;Navigate to=\"/history?tab=settings\" replace /&gt;} /&gt;",
            "lineNumber": 62
          },
          {
            "text": "\t\t\t&lt;/Route&gt;",
            "lineNumber": 63
          },
          {
            "text": "\t\t&lt;/Route&gt;",
            "lineNumber": 64
          },
          {
            "text": "\t\t&lt;Route path=\"*\" element={&lt;NotFound /&gt;} /&gt;",
            "lineNumber": 65
          },
          {
            "text": "\t&lt;/Routes&gt;",
            "lineNumber": 66
          },
          {
            "text": ");",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "export default AppRoutes;",
            "lineNumber": 69
          }
        ]
      },
      "score": 0.38992083072662354
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\History.tsx",
        "range": {
          "startPosition": {
            "line": 24
          },
          "endPosition": {
            "line": 140,
            "column": 1
          }
        },
        "contents": "export default function Home() {\n\n\t\t&lt;div\n\t\t\tclassName={&#96;sticky top-0 z-20 flex flex-col justify-between items-center bg-[#F9F8F6] px-20 pt-10 pb-4 border-border-disabled border-x-0 border-t-0 border-solid&#96;}\n\t\t&gt;\n\t\t\t\t&lt;div className=\"flex flex-row justify-between items-center w-full mx-auto\"&gt;\n\t\t\t\t&lt;div className=\"flex items-center gap-2\"&gt;\n\t\t\t \t &lt;MenuToggleGroup type=\"single\" value={activeTab} orientation=\"horizontal\" onValueChange={(v) =&gt; v &amp;&amp; setActiveTab(v as typeof activeTab)}&gt;\n\t\t\t  \t &lt;MenuToggleItem size=\"xs\" value=\"projects\" iconAnimateOnHover=\"wiggle\" icon={&lt;Sparkle/&gt;}&gt;{t(\"layout.projects\")}&lt;/MenuToggleItem&gt;\n\t\t\t\t\t &lt;MenuToggleItem size=\"xs\" value=\"mcp_tools\" iconAnimateOnHover=\"default\" icon={&lt;Hammer/&gt;}&gt;{t(\"layout.mcp-tools\")}&lt;/MenuToggleItem&gt;\n\t\t\t\t\t &lt;MenuToggleItem size=\"xs\" value=\"browser\" iconAnimateOnHover=\"default\" icon={&lt;Compass/&gt;}&gt;{t(\"layout.browser\")}&lt;/MenuToggleItem&gt;\n\t\t\t\t\t &lt;MenuToggleItem size=\"xs\" value=\"settings\" iconAnimateOnHover=\"default\" icon={&lt;Settings/&gt;}&gt;{t(\"layout.settings\")}&lt;/MenuToggleItem&gt;\n\t\t  \t &lt;/MenuToggleGroup&gt;\n\t\t\t\t&lt;/div&gt;\n\t\t  \t&lt;Button variant=\"primary\" size=\"sm\" onClick={createChat}&gt;\n\t\t\t\t&lt;Plus /&gt;\n\t\t\t\t{t(\"layout.new-project\")}\n\t\t  \t&lt;/Button&gt;\n\t\t\t&lt;/div&gt;\n\t\t  &lt;/div&gt;\n\t      {activeTab === \"projects\" &amp;&amp; &lt;Project /&gt;}\n\t      {activeTab === \"mcp_tools\" &amp;&amp; &lt;MCP /&gt;}\n\t      {activeTab === \"browser\" &amp;&amp; &lt;Browser /&gt;}\n\t\t\t\t{activeTab === \"settings\" &amp;&amp; &lt;Setting /&gt;}\n\t\t&lt;/div&gt;\n\t);\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 25,
                "column": 1
              },
              "endPosition": {
                "line": 25,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 25,
                "column": 16
              },
              "endPosition": {
                "line": 26,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Home() {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "lineNumber": 116
          },
          {
            "text": "\t\t&lt;div",
            "lineNumber": 117
          },
          {
            "text": "\t\t\tclassName={&#96;sticky top-0 z-20 flex flex-col justify-between items-center bg-[#F9F8F6] px-20 pt-10 pb-4 border-border-disabled border-x-0 border-t-0 border-solid&#96;}",
            "lineNumber": 118
          },
          {
            "text": "\t\t&gt;",
            "lineNumber": 119
          },
          {
            "text": "\t\t\t\t&lt;div className=\"flex flex-row justify-between items-center w-full mx-auto\"&gt;",
            "lineNumber": 120
          },
          {
            "text": "\t\t\t\t&lt;div className=\"flex items-center gap-2\"&gt;",
            "lineNumber": 121
          },
          {
            "text": "\t\t\t \t &lt;MenuToggleGroup type=\"single\" value={activeTab} orientation=\"horizontal\" onValueChange={(v) =&gt; v &amp;&amp; setActiveTab(v as typeof activeTab)}&gt;",
            "lineNumber": 122
          },
          {
            "text": "\t\t\t  \t &lt;MenuToggleItem size=\"xs\" value=\"projects\" iconAnimateOnHover=\"wiggle\" icon={&lt;Sparkle/&gt;}&gt;{t(\"layout.projects\")}&lt;/MenuToggleItem&gt;",
            "lineNumber": 123
          },
          {
            "text": "\t\t\t\t\t &lt;MenuToggleItem size=\"xs\" value=\"mcp_tools\" iconAnimateOnHover=\"default\" icon={&lt;Hammer/&gt;}&gt;{t(\"layout.mcp-tools\")}&lt;/MenuToggleItem&gt;",
            "lineNumber": 124
          },
          {
            "text": "\t\t\t\t\t &lt;MenuToggleItem size=\"xs\" value=\"browser\" iconAnimateOnHover=\"default\" icon={&lt;Compass/&gt;}&gt;{t(\"layout.browser\")}&lt;/MenuToggleItem&gt;",
            "lineNumber": 125
          },
          {
            "text": "\t\t\t\t\t &lt;MenuToggleItem size=\"xs\" value=\"settings\" iconAnimateOnHover=\"default\" icon={&lt;Settings/&gt;}&gt;{t(\"layout.settings\")}&lt;/MenuToggleItem&gt;",
            "lineNumber": 126
          },
          {
            "text": "\t\t  \t &lt;/MenuToggleGroup&gt;",
            "lineNumber": 127
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 128
          },
          {
            "text": "\t\t  \t&lt;Button variant=\"primary\" size=\"sm\" onClick={createChat}&gt;",
            "lineNumber": 129
          },
          {
            "text": "\t\t\t\t&lt;Plus /&gt;",
            "lineNumber": 130
          },
          {
            "text": "\t\t\t\t{t(\"layout.new-project\")}",
            "lineNumber": 131
          },
          {
            "text": "\t\t  \t&lt;/Button&gt;",
            "lineNumber": 132
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 133
          },
          {
            "text": "\t\t  &lt;/div&gt;",
            "lineNumber": 134
          },
          {
            "text": "\t      {activeTab === \"projects\" &amp;&amp; &lt;Project /&gt;}",
            "lineNumber": 135
          },
          {
            "text": "\t      {activeTab === \"mcp_tools\" &amp;&amp; &lt;MCP /&gt;}",
            "lineNumber": 136
          },
          {
            "text": "\t      {activeTab === \"browser\" &amp;&amp; &lt;Browser /&gt;}",
            "lineNumber": 137
          },
          {
            "text": "\t\t\t\t{activeTab === \"settings\" &amp;&amp; &lt;Setting /&gt;}",
            "lineNumber": 138
          },
          {
            "text": "\t\t&lt;/div&gt;",
            "lineNumber": 139
          },
          {
            "text": "\t);",
            "lineNumber": 140
          },
          {
            "text": "}",
            "lineNumber": 141,
            "isSignature": true
          }
        ]
      },
      "score": 0.37048935890197754
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\History.tsx",
        "range": {
          "startPosition": {
            "line": 20,
            "column": 64
          },
          "endPosition": {
            "line": 140,
            "column": 1
          }
        },
        "contents": "export default function Home() {\n\tconst { t } = useTranslation();\n\tconst navigate = useNavigate();\n\tconst [searchParams] = useSearchParams();\n\tconst { chatStore, projectStore } = useChatStoreAdapter();\n\tif (!chatStore || !projectStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n  const tabParam = searchParams.get(\"tab\") as \"projects\" | \"workers\" | \"trigger\" | \"settings\" | \"mcp_tools\" | \"browser\" | null;\n  const [activeTab, setActiveTab] = useState&lt;\"projects\" | \"workers\" | \"trigger\" | \"settings\" | \"mcp_tools\" | \"browser\"&gt;(tabParam || \"projects\");\n\n\tconst [deleteModalOpen, setDeleteModalOpen] = useState(false);\n  const scrollContainerRef = useRef&lt;HTMLDivElement | null&gt;(null);\n\tconst { username, email } = useAuthStore();\n\tconst displayName = username ?? email ?? \"\";\n\n\t// Sync activeTab with URL changes\n\tuseEffect(() =&gt; {\n\t\tconst tab = searchParams.get(\"tab\") as \"projects\" | \"workers\" | \"trigger\" | \"settings\" | \"mcp_tools\" | null;\n\t\tif (tab) {\n\t\t\tsetActiveTab(tab);\n\t\t}\n\t}, [searchParams]);\n\n\tconst formatWelcomeName = (raw: string): string =&gt; {\n\t\tif (!raw) return \"\";\n\t\tif (/^[^@]+@gmail\\.com$/i.test(raw)) {\n\t\t\tconst local = raw.split(\"@\")[0];\n\t\t\tconst pretty = local.replace(/[._-]+/g, \" \").trim();\n\t\t\treturn pretty\n\t\t\t\t.split(/\\s+/)\n\t\t\t\t.map(part =&gt; part.charAt(0).toUpperCase() + part.slice(1))\n\t\t\t\t.join(\" \");\n\t\t}\n\t\treturn raw;\n\t};\n\n\tconst welcomeName = formatWelcomeName(displayName);\n\n\tconst handleAnimationComplete = () =&gt; {\n\t\tconsole.log('All letters have animated!');\n\t};\n\n\tconst confirmDelete = () =&gt; {\n\t\tsetDeleteModalOpen(false);\n\t};\n\n\t// create task\n\tconst createChat = () =&gt; {\n\t\t//Handles refocusing id &amp; non duplicate logic internally\n\t\tprojectStore.createProject(\"new project\");\n\t\tnavigate(\"/\");\n\t};\n\n  useEffect(() =&gt; {\n\t\t// Update active tab when URL parameter changes\n\t}\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function Home() {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 26
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 27
          },
          {
            "text": "\tconst [searchParams] = useSearchParams();",
            "lineNumber": 28
          },
          {
            "text": "\tconst { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 29
          },
          {
            "text": "\tif (!chatStore || !projectStore) {",
            "lineNumber": 30
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 31
          },
          {
            "text": "\t}",
            "lineNumber": 32
          },
          {
            "text": "  const tabParam = searchParams.get(\"tab\") as \"projects\" | \"workers\" | \"trigger\" | \"settings\" | \"mcp_tools\" | \"browser\" | null;",
            "lineNumber": 33
          },
          {
            "text": "  const [activeTab, setActiveTab] = useState&lt;\"projects\" | \"workers\" | \"trigger\" | \"settings\" | \"mcp_tools\" | \"browser\"&gt;(tabParam || \"projects\");",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "\tconst [deleteModalOpen, setDeleteModalOpen] = useState(false);",
            "lineNumber": 36
          },
          {
            "text": "  const scrollContainerRef = useRef&lt;HTMLDivElement | null&gt;(null);",
            "lineNumber": 37
          },
          {
            "text": "\tconst { username, email } = useAuthStore();",
            "lineNumber": 38
          },
          {
            "text": "\tconst displayName = username ?? email ?? \"\";",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "\t// Sync activeTab with URL changes",
            "lineNumber": 41
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 42
          },
          {
            "text": "\t\tconst tab = searchParams.get(\"tab\") as \"projects\" | \"workers\" | \"trigger\" | \"settings\" | \"mcp_tools\" | null;",
            "lineNumber": 43
          },
          {
            "text": "\t\tif (tab) {",
            "lineNumber": 44
          },
          {
            "text": "\t\t\tsetActiveTab(tab);",
            "lineNumber": 45
          },
          {
            "text": "\t\t}",
            "lineNumber": 46
          },
          {
            "text": "\t}, [searchParams]);",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "\tconst formatWelcomeName = (raw: string): string =&gt; {",
            "lineNumber": 49
          },
          {
            "text": "\t\tif (!raw) return \"\";",
            "lineNumber": 50
          },
          {
            "text": "\t\tif (/^[^@]+@gmail\\.com$/i.test(raw)) {",
            "lineNumber": 51
          },
          {
            "text": "\t\t\tconst local = raw.split(\"@\")[0];",
            "lineNumber": 52
          },
          {
            "text": "\t\t\tconst pretty = local.replace(/[._-]+/g, \" \").trim();",
            "lineNumber": 53
          },
          {
            "text": "\t\t\treturn pretty",
            "lineNumber": 54
          },
          {
            "text": "\t\t\t\t.split(/\\s+/)",
            "lineNumber": 55
          },
          {
            "text": "\t\t\t\t.map(part =&gt; part.charAt(0).toUpperCase() + part.slice(1))",
            "lineNumber": 56
          },
          {
            "text": "\t\t\t\t.join(\" \");",
            "lineNumber": 57
          },
          {
            "text": "\t\t}",
            "lineNumber": 58
          },
          {
            "text": "\t\treturn raw;",
            "lineNumber": 59
          },
          {
            "text": "\t};",
            "lineNumber": 60
          },
          {
            "lineNumber": 61
          },
          {
            "text": "\tconst welcomeName = formatWelcomeName(displayName);",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "\tconst handleAnimationComplete = () =&gt; {",
            "lineNumber": 64
          },
          {
            "text": "\t\tconsole.log('All letters have animated!');",
            "lineNumber": 65
          },
          {
            "text": "\t};",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "\tconst confirmDelete = () =&gt; {",
            "lineNumber": 68
          },
          {
            "text": "\t\tsetDeleteModalOpen(false);",
            "lineNumber": 69
          },
          {
            "text": "\t};",
            "lineNumber": 70
          },
          {
            "lineNumber": 71
          },
          {
            "text": "\t// create task",
            "lineNumber": 72
          },
          {
            "text": "\tconst createChat = () =&gt; {",
            "lineNumber": 73
          },
          {
            "text": "\t\t//Handles refocusing id &amp; non duplicate logic internally",
            "lineNumber": 74
          },
          {
            "text": "\t\tprojectStore.createProject(\"new project\");",
            "lineNumber": 75
          },
          {
            "text": "\t\tnavigate(\"/\");",
            "lineNumber": 76
          },
          {
            "text": "\t};",
            "lineNumber": 77
          },
          {
            "lineNumber": 78
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 79
          },
          {
            "text": "\t\t// Update active tab when URL parameter changes",
            "lineNumber": 80
          },
          {
            "text": "\t}",
            "lineNumber": 86
          },
          {
            "text": "}",
            "lineNumber": 141,
            "isSignature": true
          }
        ]
      },
      "score": 0.325361430644989
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\History.tsx",
        "range": {
          "startPosition": {
            "column": 52
          },
          "endPosition": {
            "line": 140,
            "column": 1
          }
        },
        "contents": "import useChatStoreAdapter from \"@/hooks/useChatStoreAdapter\";\nimport { Plus } from \"lucide-react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTranslation } from \"react-i18next\";\nimport { useAuthStore } from \"@/store/authStore\";\nimport { MenuToggleGroup, MenuToggleItem } from \"@/components/MenuButton/MenuButton\";\nimport Project from \"@/pages/Dashboard/Project\";\nimport Trigger from \"@/pages/Dashboard/Trigger\";\nimport AlertDialog from \"@/components/ui/alertDialog\";\nimport { Settings } from \"@/components/animate-ui/icons/settings\";\nimport { Pin } from \"@/components/animate-ui/icons/pin\";\nimport { Compass } from \"@/components/animate-ui/icons/compass\";\nimport Setting from \"@/pages/Setting\";\nimport { cn } from \"@/lib/utils\";\nimport { Hammer } from \"@/components/animate-ui/icons/hammer\";\nimport MCP from \"./Setting/MCP\";\nimport Browser from \"./Dashboard/Browser\";\nimport WordCarousel from \"@/components/ui/WordCarousel\";\nimport { Sparkle } from \"@/components/animate-ui/icons/sparkle\";\n\n\n\nexport default function Home() {\n\tconst { t } = useTranslation();\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import useChatStoreAdapter from \"@/hooks/useChatStoreAdapter\";",
            "lineNumber": 2
          },
          {
            "text": "import { Plus } from \"lucide-react\";",
            "lineNumber": 3
          },
          {
            "text": "import { useNavigate, useSearchParams } from \"react-router-dom\";",
            "lineNumber": 4
          },
          {
            "text": "import { Button } from \"@/components/ui/button\";",
            "lineNumber": 5
          },
          {
            "text": "import { useTranslation } from \"react-i18next\";",
            "lineNumber": 6
          },
          {
            "text": "import { useAuthStore } from \"@/store/authStore\";",
            "lineNumber": 7
          },
          {
            "text": "import { MenuToggleGroup, MenuToggleItem } from \"@/components/MenuButton/MenuButton\";",
            "lineNumber": 8
          },
          {
            "text": "import Project from \"@/pages/Dashboard/Project\";",
            "lineNumber": 9
          },
          {
            "text": "import Trigger from \"@/pages/Dashboard/Trigger\";",
            "lineNumber": 10
          },
          {
            "text": "import AlertDialog from \"@/components/ui/alertDialog\";",
            "lineNumber": 11
          },
          {
            "text": "import { Settings } from \"@/components/animate-ui/icons/settings\";",
            "lineNumber": 12
          },
          {
            "text": "import { Pin } from \"@/components/animate-ui/icons/pin\";",
            "lineNumber": 13
          },
          {
            "text": "import { Compass } from \"@/components/animate-ui/icons/compass\";",
            "lineNumber": 14
          },
          {
            "text": "import Setting from \"@/pages/Setting\";",
            "lineNumber": 15
          },
          {
            "text": "import { cn } from \"@/lib/utils\";",
            "lineNumber": 16
          },
          {
            "text": "import { Hammer } from \"@/components/animate-ui/icons/hammer\";",
            "lineNumber": 17
          },
          {
            "text": "import MCP from \"./Setting/MCP\";",
            "lineNumber": 18
          },
          {
            "text": "import Browser from \"./Dashboard/Browser\";",
            "lineNumber": 19
          },
          {
            "text": "import WordCarousel from \"@/components/ui/WordCarousel\";",
            "lineNumber": 20
          },
          {
            "text": "import { Sparkle } from \"@/components/animate-ui/icons/sparkle\";",
            "lineNumber": 21
          },
          {
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "export default function Home() {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 26
          },
          {
            "text": "}",
            "lineNumber": 141,
            "isSignature": true
          }
        ]
      },
      "score": 0.3209869861602783
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\General.tsx",
        "range": {
          "startPosition": {
            "line": 29
          },
          "endPosition": {
            "line": 234,
            "column": 1
          }
        },
        "contents": "export default function SettingGeneral() {\n\n\n\tuseEffect(() =&gt; {\n\t\tconst platform = window.electronAPI.getPlatform();\n\t\tconsole.log(platform);\n\t\tif (platform === \"darwin\") {\n\t\t\tsetThemeList([\n\t\t\t\t{\n\t\t\t\t\timg: light,\n\t\t\t\t\tlabel: \"setting.light\",\n\t\t\t\t\tvalue: \"light\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\timg: transparent,\n\t\t\t\t\tlabel: \"setting.transparent\",\n\t\t\t\t\tvalue: \"transparent\",\n\t\t\t\t},\n\t\t\t]);\n\t\t} else {\n\t\t\tsetThemeList([\n\t\t\t\t{\n\t\t\t\t\timg: light,\n\t\t\t\t\tlabel: \"setting.light\",\n\t\t\t\t\tvalue: \"light\",\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\t}, []);\n\n\treturn (\n\t\t&lt;div className=\"space-y-8\"&gt;\n\t\t\t&lt;div className=\"px-6 py-4 bg-surface-secondary rounded-2xl\"&gt;\n\t\t\t\t&lt;div className=\"text-base font-bold leading-12 text-text-body\"&gt;\n\t\t\t\t\t{t(\"setting.account\")}\n\t\t\t\t&lt;/div&gt;\n\t\t\t\t&lt;div className=\"text-sm leading-13 mb-4\"&gt;\n\t\t\t\t\t{t(\"setting.you-are-currently-signed-in-with\", {\n\t\t\t\t\t\temail: authStore.email,\n\t\t\t\t\t})}\n\t\t\t\t&lt;/div&gt;\n\t\t\t\t&lt;div className=\"flex items-center gap-sm\"&gt;\n\t\t\t\t\t&lt;Button\n\t\t\t\t\t\tonClick={() =&gt; {\n\t\t\t\t\t\t\twindow.location.href = &#96;https://www.eigent.ai/dashboard?email=${authStore.email}&#96;;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\tsize=\"xs\"\n\t\t\t\t\t&gt;\n\t\t\t\t\t\t&lt;Settings className=\"w-4 h-4 text-button-primary-icon-default\" /&gt;\n\t\t\t\t\t\t{t(\"setting.manage\")}\n\t\t\t\t\t&lt;/Button&gt;\n\t\t\t\t\t&lt;Button\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\tsize=\"xs\"\n\t\t\t\t\t\tonClick={() =&gt; {\n\t\t\t\t\t\t\tchatStore.clearTasks();\n\n\t\t\t\t\t\t\tresetInstallation(); // Reset installation state for new account\n\t\t\t\t\t\t\tsetNeedsBackendRestart(true); // Mark that backend is restarting\n\n\t\t\t\t\t\t\tauthStore.logout();\n\t\t\t\t\t\t\tnavigate(\"/login\");\n\t\t\t\t\t\t}}\n\t\t\t\t\t&gt;\n\t\t\t\t\t\t&lt;LogOut className=\"w-4 h-4 text-button-tertiery-text-default\" /&gt;\n\t\t\t\t\t\t{t(\"setting.log-out\")}\n\t\t\t\t\t&lt;/Button&gt;\n\t\t\t\t&lt;/div&gt;\n\t\t\t&lt;/div&gt;\n\t\t\t&lt;div className=\"px-6 py-4 bg-surface-secondary rounded-2xl\"&gt;\n\t\t\t\t&lt;div className=\"text-base font-bold leading-12 text-text-primary\"&gt;\n\t\t\t\t\t{t(\"setting.language\")}\n\t\t\t\t&lt;/div&gt;\n\t\t\t\t&lt;div className=\"mt-md\"&gt;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 30,
                "column": 1
              },
              "endPosition": {
                "line": 30,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 30,
                "column": 16
              },
              "endPosition": {
                "line": 31,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function SettingGeneral() {",
            "lineNumber": 30,
            "isSignature": true
          },
          {
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 113
          },
          {
            "text": "\t\tconst platform = window.electronAPI.getPlatform();",
            "lineNumber": 114
          },
          {
            "text": "\t\tconsole.log(platform);",
            "lineNumber": 115
          },
          {
            "text": "\t\tif (platform === \"darwin\") {",
            "lineNumber": 116
          },
          {
            "text": "\t\t\tsetThemeList([",
            "lineNumber": 117
          },
          {
            "text": "\t\t\t\t{",
            "lineNumber": 118
          },
          {
            "text": "\t\t\t\t\timg: light,",
            "lineNumber": 119
          },
          {
            "text": "\t\t\t\t\tlabel: \"setting.light\",",
            "lineNumber": 120
          },
          {
            "text": "\t\t\t\t\tvalue: \"light\",",
            "lineNumber": 121
          },
          {
            "text": "\t\t\t\t},",
            "lineNumber": 122
          },
          {
            "text": "\t\t\t\t{",
            "lineNumber": 123
          },
          {
            "text": "\t\t\t\t\timg: transparent,",
            "lineNumber": 124
          },
          {
            "text": "\t\t\t\t\tlabel: \"setting.transparent\",",
            "lineNumber": 125
          },
          {
            "text": "\t\t\t\t\tvalue: \"transparent\",",
            "lineNumber": 126
          },
          {
            "text": "\t\t\t\t},",
            "lineNumber": 127
          },
          {
            "text": "\t\t\t]);",
            "lineNumber": 128
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 129
          },
          {
            "text": "\t\t\tsetThemeList([",
            "lineNumber": 130
          },
          {
            "text": "\t\t\t\t{",
            "lineNumber": 131
          },
          {
            "text": "\t\t\t\t\timg: light,",
            "lineNumber": 132
          },
          {
            "text": "\t\t\t\t\tlabel: \"setting.light\",",
            "lineNumber": 133
          },
          {
            "text": "\t\t\t\t\tvalue: \"light\",",
            "lineNumber": 134
          },
          {
            "text": "\t\t\t\t},",
            "lineNumber": 135
          },
          {
            "text": "\t\t\t]);",
            "lineNumber": 136
          },
          {
            "text": "\t\t}",
            "lineNumber": 137
          },
          {
            "text": "\t}, []);",
            "lineNumber": 138
          },
          {
            "lineNumber": 139
          },
          {
            "text": "\treturn (",
            "lineNumber": 140
          },
          {
            "text": "\t\t&lt;div className=\"space-y-8\"&gt;",
            "lineNumber": 141
          },
          {
            "text": "\t\t\t&lt;div className=\"px-6 py-4 bg-surface-secondary rounded-2xl\"&gt;",
            "lineNumber": 142
          },
          {
            "text": "\t\t\t\t&lt;div className=\"text-base font-bold leading-12 text-text-body\"&gt;",
            "lineNumber": 143
          },
          {
            "text": "\t\t\t\t\t{t(\"setting.account\")}",
            "lineNumber": 144
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 145
          },
          {
            "text": "\t\t\t\t&lt;div className=\"text-sm leading-13 mb-4\"&gt;",
            "lineNumber": 146
          },
          {
            "text": "\t\t\t\t\t{t(\"setting.you-are-currently-signed-in-with\", {",
            "lineNumber": 147
          },
          {
            "text": "\t\t\t\t\t\temail: authStore.email,",
            "lineNumber": 148
          },
          {
            "text": "\t\t\t\t\t})}",
            "lineNumber": 149
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 150
          },
          {
            "text": "\t\t\t\t&lt;div className=\"flex items-center gap-sm\"&gt;",
            "lineNumber": 151
          },
          {
            "text": "\t\t\t\t\t&lt;Button",
            "lineNumber": 152
          },
          {
            "text": "\t\t\t\t\t\tonClick={() =&gt; {",
            "lineNumber": 153
          },
          {
            "text": "\t\t\t\t\t\t\twindow.location.href = &#96;https://www.eigent.ai/dashboard?email=${authStore.email}&#96;;",
            "lineNumber": 154
          },
          {
            "text": "\t\t\t\t\t\t}}",
            "lineNumber": 155
          },
          {
            "text": "\t\t\t\t\t\tvariant=\"primary\"",
            "lineNumber": 156
          },
          {
            "text": "\t\t\t\t\t\tsize=\"xs\"",
            "lineNumber": 157
          },
          {
            "text": "\t\t\t\t\t&gt;",
            "lineNumber": 158
          },
          {
            "text": "\t\t\t\t\t\t&lt;Settings className=\"w-4 h-4 text-button-primary-icon-default\" /&gt;",
            "lineNumber": 159
          },
          {
            "text": "\t\t\t\t\t\t{t(\"setting.manage\")}",
            "lineNumber": 160
          },
          {
            "text": "\t\t\t\t\t&lt;/Button&gt;",
            "lineNumber": 161
          },
          {
            "text": "\t\t\t\t\t&lt;Button",
            "lineNumber": 162
          },
          {
            "text": "\t\t\t\t\t\tvariant=\"outline\"",
            "lineNumber": 163
          },
          {
            "text": "\t\t\t\t\t\tsize=\"xs\"",
            "lineNumber": 164
          },
          {
            "text": "\t\t\t\t\t\tonClick={() =&gt; {",
            "lineNumber": 165
          },
          {
            "text": "\t\t\t\t\t\t\tchatStore.clearTasks();",
            "lineNumber": 166
          },
          {
            "lineNumber": 167
          },
          {
            "text": "\t\t\t\t\t\t\tresetInstallation(); // Reset installation state for new account",
            "lineNumber": 168
          },
          {
            "text": "\t\t\t\t\t\t\tsetNeedsBackendRestart(true); // Mark that backend is restarting",
            "lineNumber": 169
          },
          {
            "lineNumber": 170
          },
          {
            "text": "\t\t\t\t\t\t\tauthStore.logout();",
            "lineNumber": 171
          },
          {
            "text": "\t\t\t\t\t\t\tnavigate(\"/login\");",
            "lineNumber": 172
          },
          {
            "text": "\t\t\t\t\t\t}}",
            "lineNumber": 173
          },
          {
            "text": "\t\t\t\t\t&gt;",
            "lineNumber": 174
          },
          {
            "text": "\t\t\t\t\t\t&lt;LogOut className=\"w-4 h-4 text-button-tertiery-text-default\" /&gt;",
            "lineNumber": 175
          },
          {
            "text": "\t\t\t\t\t\t{t(\"setting.log-out\")}",
            "lineNumber": 176
          },
          {
            "text": "\t\t\t\t\t&lt;/Button&gt;",
            "lineNumber": 177
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 178
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 179
          },
          {
            "text": "\t\t\t&lt;div className=\"px-6 py-4 bg-surface-secondary rounded-2xl\"&gt;",
            "lineNumber": 180
          },
          {
            "text": "\t\t\t\t&lt;div className=\"text-base font-bold leading-12 text-text-primary\"&gt;",
            "lineNumber": 181
          },
          {
            "text": "\t\t\t\t\t{t(\"setting.language\")}",
            "lineNumber": 182
          },
          {
            "text": "\t\t\t\t&lt;/div&gt;",
            "lineNumber": 183
          },
          {
            "text": "\t\t\t\t&lt;div className=\"mt-md\"&gt;",
            "lineNumber": 184
          },
          {
            "text": "}",
            "lineNumber": 235,
            "isSignature": true
          }
        ]
      },
      "score": 0.31444910168647766
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\routers\\index.tsx",
        "range": {
          "startPosition": {
            "column": 50
          },
          "endPosition": {
            "line": 66,
            "column": 1
          }
        },
        "contents": "import { Routes, Route, Navigate, Outlet } from \"react-router-dom\";\nimport { useAuthStore } from \"@/store/authStore\";\n\nimport Layout from \"@/components/Layout\";\n// Lazy load page components\nconst Login = lazy(() =&gt; import(\"@/pages/Login\"));\nconst Signup = lazy(() =&gt; import(\"@/pages/SignUp\"));\nconst Home = lazy(() =&gt; import(\"@/pages/Home\"));\nconst History = lazy(() =&gt; import(\"@/pages/History\"));\nconst NotFound = lazy(() =&gt; import(\"@/pages/NotFound\"));\n\n// Route guard: Check if user is logged in\nconst ProtectedRoute = () =&gt; {\n\tconst [loading, setLoading] = useState(false);\n\tconst [isAuthenticated, setIsAuthenticated] = useState(false);\n\tconst [initialized, setInitialized] = useState(false);\n\n\tconst { token, localProxyValue, logout } = useAuthStore();\n\tuseEffect(() =&gt; {\n\t\t// Check VITE_USE_LOCAL_PROXY value on app startup\n\t\tif (token) {\n\t\t\tconst currentProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;\n\t\t\tconst storedProxyValue = localProxyValue;\n\t\t\t\n\t\t\t// If stored value exists and differs from current, logout\n\t\t\tif (storedProxyValue !== null &amp;&amp; storedProxyValue !== currentProxyValue) {\n\t\t\t\tconsole.warn('VITE_USE_LOCAL_PROXY value changed, logging out user');\n\t\t\t\tlogout();\n\t\t\t\tsetIsAuthenticated(false);\n\t\t\t\tsetLoading(false);\n\t\t\t\tsetInitialized(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\tsetIsAuthenticated(!!token);\n\t\tsetLoading(false);\n\t\tsetInitialized(true);\n\t}, [token, localProxyValue, logout]);\n\t\n\tif (loading || !initialized) {\n\t\treturn (\n\t\t\t&lt;div className=\"flex items-center justify-center h-screen\"&gt;\n\t\t\t\t&lt;div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"&gt;&lt;/div&gt;\n\t\t\t&lt;/div&gt;\n\t\t);\n\t}\n\treturn isAuthenticated ? &lt;Outlet /&gt; : &lt;Navigate to=\"/login\" replace /&gt;;\n};\n\n// Main route configuration\nconst AppRoutes = () =&gt;\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { Routes, Route, Navigate, Outlet } from \"react-router-dom\";",
            "lineNumber": 2
          },
          {
            "text": "import { useAuthStore } from \"@/store/authStore\";",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "import Layout from \"@/components/Layout\";",
            "lineNumber": 5
          },
          {
            "text": "// Lazy load page components",
            "lineNumber": 6
          },
          {
            "text": "const Login = lazy(() =&gt; import(\"@/pages/Login\"));",
            "lineNumber": 7
          },
          {
            "text": "const Signup = lazy(() =&gt; import(\"@/pages/SignUp\"));",
            "lineNumber": 8
          },
          {
            "text": "const Home = lazy(() =&gt; import(\"@/pages/Home\"));",
            "lineNumber": 9
          },
          {
            "text": "const History = lazy(() =&gt; import(\"@/pages/History\"));",
            "lineNumber": 10
          },
          {
            "text": "const NotFound = lazy(() =&gt; import(\"@/pages/NotFound\"));",
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "// Route guard: Check if user is logged in",
            "lineNumber": 13
          },
          {
            "text": "const ProtectedRoute = () =&gt; {",
            "lineNumber": 14
          },
          {
            "text": "\tconst [loading, setLoading] = useState(false);",
            "lineNumber": 15
          },
          {
            "text": "\tconst [isAuthenticated, setIsAuthenticated] = useState(false);",
            "lineNumber": 16
          },
          {
            "text": "\tconst [initialized, setInitialized] = useState(false);",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "\tconst { token, localProxyValue, logout } = useAuthStore();",
            "lineNumber": 19
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 20
          },
          {
            "text": "\t\t// Check VITE_USE_LOCAL_PROXY value on app startup",
            "lineNumber": 21
          },
          {
            "text": "\t\tif (token) {",
            "lineNumber": 22
          },
          {
            "text": "\t\t\tconst currentProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;",
            "lineNumber": 23
          },
          {
            "text": "\t\t\tconst storedProxyValue = localProxyValue;",
            "lineNumber": 24
          },
          {
            "text": "\t\t\t",
            "lineNumber": 25
          },
          {
            "text": "\t\t\t// If stored value exists and differs from current, logout",
            "lineNumber": 26
          },
          {
            "text": "\t\t\tif (storedProxyValue !== null &amp;&amp; storedProxyValue !== currentProxyValue) {",
            "lineNumber": 27
          },
          {
            "text": "\t\t\t\tconsole.warn('VITE_USE_LOCAL_PROXY value changed, logging out user');",
            "lineNumber": 28
          },
          {
            "text": "\t\t\t\tlogout();",
            "lineNumber": 29
          },
          {
            "text": "\t\t\t\tsetIsAuthenticated(false);",
            "lineNumber": 30
          },
          {
            "text": "\t\t\t\tsetLoading(false);",
            "lineNumber": 31
          },
          {
            "text": "\t\t\t\tsetInitialized(true);",
            "lineNumber": 32
          },
          {
            "text": "\t\t\t\treturn;",
            "lineNumber": 33
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 34
          },
          {
            "text": "\t\t}",
            "lineNumber": 35
          },
          {
            "text": "\t\t",
            "lineNumber": 36
          },
          {
            "text": "\t\tsetIsAuthenticated(!!token);",
            "lineNumber": 37
          },
          {
            "text": "\t\tsetLoading(false);",
            "lineNumber": 38
          },
          {
            "text": "\t\tsetInitialized(true);",
            "lineNumber": 39
          },
          {
            "text": "\t}, [token, localProxyValue, logout]);",
            "lineNumber": 40
          },
          {
            "text": "\t",
            "lineNumber": 41
          },
          {
            "text": "\tif (loading || !initialized) {",
            "lineNumber": 42
          },
          {
            "text": "\t\treturn (",
            "lineNumber": 43
          },
          {
            "text": "\t\t\t&lt;div className=\"flex items-center justify-center h-screen\"&gt;",
            "lineNumber": 44
          },
          {
            "text": "\t\t\t\t&lt;div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"&gt;&lt;/div&gt;",
            "lineNumber": 45
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 46
          },
          {
            "text": "\t\t);",
            "lineNumber": 47
          },
          {
            "text": "\t}",
            "lineNumber": 48
          },
          {
            "text": "\treturn isAuthenticated ? &lt;Outlet /&gt; : &lt;Navigate to=\"/login\" replace /&gt;;",
            "lineNumber": 49
          },
          {
            "text": "};",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "// Main route configuration",
            "lineNumber": 52
          },
          {
            "text": "const AppRoutes = () =&gt;",
            "lineNumber": 53
          },
          {
            "text": ";",
            "lineNumber": 67
          }
        ]
      },
      "score": 0.29523760080337524
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\General.tsx",
        "range": {
          "startPosition": {
            "column": 48
          },
          "endPosition": {
            "line": 234,
            "column": 1
          }
        },
        "contents": "import { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { LogOut, Settings, Check } from \"lucide-react\";\nimport light from \"@/assets/light.png\";\nimport dark from \"@/assets/dark.png\";\nimport transparent from \"@/assets/transparent.png\";\nimport { useAuthStore } from \"@/store/authStore\";\nimport { useInstallationStore } from \"@/store/installationStore\";\nimport { useNavigate } from \"react-router-dom\";\nimport { proxyFetchPut, proxyFetchGet } from \"@/api/http\";\nimport { createRef, RefObject } from \"react\";\nimport { useEffect, useState } from \"react\";\nimport { useChatStore } from \"@/store/chatStore\";\nimport { LocaleEnum, switchLanguage } from \"@/i18n\";\nimport { useTranslation } from \"react-i18next\";\nimport { toast } from \"sonner\";\n\nimport {\n\tSelect,\n\tSelectContent,\n\tSelectGroup,\n\tSelectItem,\n\tSelectLabel,\n\tSelectTrigger,\n\tSelectValue,\n} from \"@/components/ui/select\";\nimport useChatStoreAdapter from \"@/hooks/useChatStoreAdapter\";\n\nexport default function SettingGeneral() {\n\tconst { t } = useTranslation();\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { Input } from \"@/components/ui/input\";",
            "lineNumber": 2
          },
          {
            "text": "import { Label } from \"@/components/ui/label\";",
            "lineNumber": 3
          },
          {
            "text": "import { LogOut, Settings, Check } from \"lucide-react\";",
            "lineNumber": 4
          },
          {
            "text": "import light from \"@/assets/light.png\";",
            "lineNumber": 5
          },
          {
            "text": "import dark from \"@/assets/dark.png\";",
            "lineNumber": 6
          },
          {
            "text": "import transparent from \"@/assets/transparent.png\";",
            "lineNumber": 7
          },
          {
            "text": "import { useAuthStore } from \"@/store/authStore\";",
            "lineNumber": 8
          },
          {
            "text": "import { useInstallationStore } from \"@/store/installationStore\";",
            "lineNumber": 9
          },
          {
            "text": "import { useNavigate } from \"react-router-dom\";",
            "lineNumber": 10
          },
          {
            "text": "import { proxyFetchPut, proxyFetchGet } from \"@/api/http\";",
            "lineNumber": 11
          },
          {
            "text": "import { createRef, RefObject } from \"react\";",
            "lineNumber": 12
          },
          {
            "text": "import { useEffect, useState } from \"react\";",
            "lineNumber": 13
          },
          {
            "text": "import { useChatStore } from \"@/store/chatStore\";",
            "lineNumber": 14
          },
          {
            "text": "import { LocaleEnum, switchLanguage } from \"@/i18n\";",
            "lineNumber": 15
          },
          {
            "text": "import { useTranslation } from \"react-i18next\";",
            "lineNumber": 16
          },
          {
            "text": "import { toast } from \"sonner\";",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "import {",
            "lineNumber": 19
          },
          {
            "text": "\tSelect,",
            "lineNumber": 20
          },
          {
            "text": "\tSelectContent,",
            "lineNumber": 21
          },
          {
            "text": "\tSelectGroup,",
            "lineNumber": 22
          },
          {
            "text": "\tSelectItem,",
            "lineNumber": 23
          },
          {
            "text": "\tSelectLabel,",
            "lineNumber": 24
          },
          {
            "text": "\tSelectTrigger,",
            "lineNumber": 25
          },
          {
            "text": "\tSelectValue,",
            "lineNumber": 26
          },
          {
            "text": "} from \"@/components/ui/select\";",
            "lineNumber": 27
          },
          {
            "text": "import useChatStoreAdapter from \"@/hooks/useChatStoreAdapter\";",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "export default function SettingGeneral() {",
            "lineNumber": 30,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 31
          },
          {
            "text": "}",
            "lineNumber": 235,
            "isSignature": true
          }
        ]
      },
      "score": 0.28770530223846436
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 49
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\nconst handleProjectDelete = \n\n\t\tsetDeleteProjectModalOpen(true);\n\t};\n\n\tconst confirmProjectDelete = async () =&gt; {\n\t\tconst projectId = curProjectId;\n\t\tif (!projectId || !projectDeleteCallback) return;\n\t\t\n\t\ttry {\n\t\t\t// Execute the deletion callback provided by GroupedHistoryView\n\t\t\tawait projectDeleteCallback();\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Failed to delete project:\", error);\n\t\t} finally {\n\t\t\tsetCurProjectId(\"\");\n\t\t\tsetProjectDeleteCallback(null);\n\t\t\tsetDeleteProjectModalOpen(false);\n\t\t}\n\t};\n\n\tconst handleShare = async (taskId: string) =&gt; {\n\t\tshare(taskId);\n\t};\n\n\tconst handleReplay = async (taskId: string, question: string) =&gt; {\n\t\tchatStore.replay(taskId, question, 0);\n\t\tnavigate({ pathname: \"/\" });\n\t};\n\n\tconst handleSetActive = (taskId: string, question: string) =&gt; {\n\t\tconst task = chatStore.tasks[taskId];\n\t\tif (task) {\n\t\t\t// if there is a record, display the result\n\t\t\tchatStore.setActiveTaskId(taskId);\n\t\t\tnavigate(&#96;/&#96;);\n\t\t} else {\n\t\t\t// if there is no record, execute replay\n\t\t\thandleReplay(taskId, question);\n\t\t}\n\t};\n\n\tconst handleTakeControl = (type: \"pause\" | \"resume\", taskId: string) =&gt; {\n\t\tif (type === \"pause\") {\n\t\t\tlet { taskTime, elapsed } = chatStore.tasks[taskId];\n\n\t\t\tconst now = Date.now();\n\t\t\telapsed += now - taskTime;\n\t\t\tchatStore.setElapsed(taskId, elapsed);\n\t\t\tchatStore.setTaskTime(taskId, 0);\n\t\t} else {\n\t\t\tchatStore.setTaskTime(taskId, Date.now());\n\t\t}\n\t\tfetchPut(&#96;/task/${taskId}/take-control&#96;, {\n\t\t\taction: type,\n\t\t});\n\t\tif (type === \"pause\") {\n\t\t\tchatStore.setStatus(taskId, \"pause\");\n\t\t} else {\n\t\t\tchatStore.setStatus(taskId, \"running\");\n\t\t}\n\t};\n\n\n\tuseEffect(() =&gt; {\n\t\tfetchHistoryTasks(setHistoryTasks);\n\t}, []);\n\n\t// Feature flag to hide table view without deleting code\n\tconst TABLE_VIEW_ENABLED = false;\n\n\treturn\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 50,
                "column": 1
              },
              "endPosition": {
                "line": 50,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 50,
                "column": 16
              },
              "endPosition": {
                "line": 51,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "const handleProjectDelete = ",
            "lineNumber": 172
          },
          {
            "lineNumber": 174
          },
          {
            "text": "\t\tsetDeleteProjectModalOpen(true);",
            "lineNumber": 175
          },
          {
            "text": "\t};",
            "lineNumber": 176
          },
          {
            "lineNumber": 177
          },
          {
            "text": "\tconst confirmProjectDelete = async () =&gt; {",
            "lineNumber": 178
          },
          {
            "text": "\t\tconst projectId = curProjectId;",
            "lineNumber": 179
          },
          {
            "text": "\t\tif (!projectId || !projectDeleteCallback) return;",
            "lineNumber": 180
          },
          {
            "text": "\t\t",
            "lineNumber": 181
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 182
          },
          {
            "text": "\t\t\t// Execute the deletion callback provided by GroupedHistoryView",
            "lineNumber": 183
          },
          {
            "text": "\t\t\tawait projectDeleteCallback();",
            "lineNumber": 184
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 185
          },
          {
            "text": "\t\t\tconsole.error(\"Failed to delete project:\", error);",
            "lineNumber": 186
          },
          {
            "text": "\t\t} finally {",
            "lineNumber": 187
          },
          {
            "text": "\t\t\tsetCurProjectId(\"\");",
            "lineNumber": 188
          },
          {
            "text": "\t\t\tsetProjectDeleteCallback(null);",
            "lineNumber": 189
          },
          {
            "text": "\t\t\tsetDeleteProjectModalOpen(false);",
            "lineNumber": 190
          },
          {
            "text": "\t\t}",
            "lineNumber": 191
          },
          {
            "text": "\t};",
            "lineNumber": 192
          },
          {
            "lineNumber": 193
          },
          {
            "text": "\tconst handleShare = async (taskId: string) =&gt; {",
            "lineNumber": 194
          },
          {
            "text": "\t\tshare(taskId);",
            "lineNumber": 195
          },
          {
            "text": "\t};",
            "lineNumber": 196
          },
          {
            "lineNumber": 197
          },
          {
            "text": "\tconst handleReplay = async (taskId: string, question: string) =&gt; {",
            "lineNumber": 198
          },
          {
            "text": "\t\tchatStore.replay(taskId, question, 0);",
            "lineNumber": 199
          },
          {
            "text": "\t\tnavigate({ pathname: \"/\" });",
            "lineNumber": 200
          },
          {
            "text": "\t};",
            "lineNumber": 201
          },
          {
            "lineNumber": 202
          },
          {
            "text": "\tconst handleSetActive = (taskId: string, question: string) =&gt; {",
            "lineNumber": 203
          },
          {
            "text": "\t\tconst task = chatStore.tasks[taskId];",
            "lineNumber": 204
          },
          {
            "text": "\t\tif (task) {",
            "lineNumber": 205
          },
          {
            "text": "\t\t\t// if there is a record, display the result",
            "lineNumber": 206
          },
          {
            "text": "\t\t\tchatStore.setActiveTaskId(taskId);",
            "lineNumber": 207
          },
          {
            "text": "\t\t\tnavigate(&#96;/&#96;);",
            "lineNumber": 208
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 209
          },
          {
            "text": "\t\t\t// if there is no record, execute replay",
            "lineNumber": 210
          },
          {
            "text": "\t\t\thandleReplay(taskId, question);",
            "lineNumber": 211
          },
          {
            "text": "\t\t}",
            "lineNumber": 212
          },
          {
            "text": "\t};",
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "\tconst handleTakeControl = (type: \"pause\" | \"resume\", taskId: string) =&gt; {",
            "lineNumber": 215
          },
          {
            "text": "\t\tif (type === \"pause\") {",
            "lineNumber": 216
          },
          {
            "text": "\t\t\tlet { taskTime, elapsed } = chatStore.tasks[taskId];",
            "lineNumber": 217
          },
          {
            "lineNumber": 218
          },
          {
            "text": "\t\t\tconst now = Date.now();",
            "lineNumber": 219
          },
          {
            "text": "\t\t\telapsed += now - taskTime;",
            "lineNumber": 220
          },
          {
            "text": "\t\t\tchatStore.setElapsed(taskId, elapsed);",
            "lineNumber": 221
          },
          {
            "text": "\t\t\tchatStore.setTaskTime(taskId, 0);",
            "lineNumber": 222
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 223
          },
          {
            "text": "\t\t\tchatStore.setTaskTime(taskId, Date.now());",
            "lineNumber": 224
          },
          {
            "text": "\t\t}",
            "lineNumber": 225
          },
          {
            "text": "\t\tfetchPut(&#96;/task/${taskId}/take-control&#96;, {",
            "lineNumber": 226
          },
          {
            "text": "\t\t\taction: type,",
            "lineNumber": 227
          },
          {
            "text": "\t\t});",
            "lineNumber": 228
          },
          {
            "text": "\t\tif (type === \"pause\") {",
            "lineNumber": 229
          },
          {
            "text": "\t\t\tchatStore.setStatus(taskId, \"pause\");",
            "lineNumber": 230
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 231
          },
          {
            "text": "\t\t\tchatStore.setStatus(taskId, \"running\");",
            "lineNumber": 232
          },
          {
            "text": "\t\t}",
            "lineNumber": 233
          },
          {
            "text": "\t};",
            "lineNumber": 234
          },
          {
            "lineNumber": 235
          },
          {
            "lineNumber": 236
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 237
          },
          {
            "text": "\t\tfetchHistoryTasks(setHistoryTasks);",
            "lineNumber": 238
          },
          {
            "text": "\t}, []);",
            "lineNumber": 239
          },
          {
            "lineNumber": 240
          },
          {
            "text": "\t// Feature flag to hide table view without deleting code",
            "lineNumber": 241
          },
          {
            "text": "\tconst TABLE_VIEW_ENABLED = false;",
            "lineNumber": 242
          },
          {
            "lineNumber": 243
          },
          {
            "text": "\treturn",
            "lineNumber": 244
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.28327929973602295
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\package\\@stackframe\\react\\dist\\esm\\components-page\\account-settings.js",
        "range": {
          "startPosition": {
            "line": 23,
            "column": 2
          },
          "endPosition": {
            "line": 108,
            "column": 1
          }
        },
        "contents": "function AccountSettings(props) {\n  const { t } = useTranslation();\n  const user = useUser({ or: \"redirect\" });\n  const teams = user.useTeams();\n  const stackApp = useStackApp();\n  const project = stackApp.useProject();\n  return /* @__PURE__ */ jsx(MaybeFullPage, { fullPage: !!props.fullPage, children: /* @__PURE__ */ jsx(\"div\", { className: \"self-stretch flex-grow w-full\", children: /* @__PURE__ */ jsx(\n    SidebarLayout,\n    {\n      items: [\n        {\n          title: t(\"My Profile\"),\n          type: \"item\",\n          id: \"profile\",\n          icon: /* @__PURE__ */ jsx(Icon, { name: \"Contact\" }),\n          content: /* @__PURE__ */ jsx(ProfilePage, {})\n        },\n        {\n          title: t(\"Emails &amp; Auth\"),\n          type: \"item\",\n          id: \"auth\",\n          icon: /* @__PURE__ */ jsx(Icon, { name: \"ShieldCheck\" }),\n          content: /* @__PURE__ */ jsx(Suspense, { fallback: /* @__PURE__ */ jsx(EmailsAndAuthPageSkeleton, {}), children: /* @__PURE__ */ jsx(EmailsAndAuthPage, {}) })\n        },\n        {\n          title: t(\"Active Sessions\"),\n          type: \"item\",\n          id: \"sessions\",\n          icon: /* @__PURE__ */ jsx(Icon, { name: \"Monitor\" }),\n          content: /* @__PURE__ */ jsx(Suspense, { fallback: /* @__PURE__ */ jsx(ActiveSessionsPageSkeleton, {}), children: /* @__PURE__ */ jsx(ActiveSessionsPage, {}) })\n        },\n        ...project.config.allowUserApiKeys ? [{\n          title: t(\"API Keys\"),\n          type: \"item\",\n          id: \"api-keys\",\n          icon: /* @__PURE__ */ jsx(Icon, { name: \"Key\" }),\n          content: /* @__PURE__ */ jsx(Suspense, { fallback: /* @__PURE__ */ jsx(ApiKeysPageSkeleton, {}), children: /* @__PURE__ */ jsx(ApiKeysPage, {}) })\n        }] : [],\n        {\n          title: t(\"Settings\"),\n          type: \"item\",\n          id: \"settings\",\n          icon: /* @__PURE__ */ jsx(Icon, { name: \"Settings\" }),\n          content: /* @__PURE__ */ jsx(SettingsPage, {})\n        },\n        ...props.extraItems?.map((item) =&gt; ({\n          title: item.title,\n)\n\n\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "function AccountSettings(props) {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "  const { t } = useTranslation();",
            "lineNumber": 26
          },
          {
            "text": "  const user = useUser({ or: \"redirect\" });",
            "lineNumber": 27
          },
          {
            "text": "  const teams = user.useTeams();",
            "lineNumber": 28
          },
          {
            "text": "  const stackApp = useStackApp();",
            "lineNumber": 29
          },
          {
            "text": "  const project = stackApp.useProject();",
            "lineNumber": 30
          },
          {
            "text": "  return /* @__PURE__ */ jsx(MaybeFullPage, { fullPage: !!props.fullPage, children: /* @__PURE__ */ jsx(\"div\", { className: \"self-stretch flex-grow w-full\", children: /* @__PURE__ */ jsx(",
            "lineNumber": 31
          },
          {
            "text": "    SidebarLayout,",
            "lineNumber": 32
          },
          {
            "text": "    {",
            "lineNumber": 33
          },
          {
            "text": "      items: [",
            "lineNumber": 34
          },
          {
            "text": "        {",
            "lineNumber": 35
          },
          {
            "text": "          title: t(\"My Profile\"),",
            "lineNumber": 36
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 37
          },
          {
            "text": "          id: \"profile\",",
            "lineNumber": 38
          },
          {
            "text": "          icon: /* @__PURE__ */ jsx(Icon, { name: \"Contact\" }),",
            "lineNumber": 39
          },
          {
            "text": "          content: /* @__PURE__ */ jsx(ProfilePage, {})",
            "lineNumber": 40
          },
          {
            "text": "        },",
            "lineNumber": 41
          },
          {
            "text": "        {",
            "lineNumber": 42
          },
          {
            "text": "          title: t(\"Emails &amp; Auth\"),",
            "lineNumber": 43
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 44
          },
          {
            "text": "          id: \"auth\",",
            "lineNumber": 45
          },
          {
            "text": "          icon: /* @__PURE__ */ jsx(Icon, { name: \"ShieldCheck\" }),",
            "lineNumber": 46
          },
          {
            "text": "          content: /* @__PURE__ */ jsx(Suspense, { fallback: /* @__PURE__ */ jsx(EmailsAndAuthPageSkeleton, {}), children: /* @__PURE__ */ jsx(EmailsAndAuthPage, {}) })",
            "lineNumber": 47
          },
          {
            "text": "        },",
            "lineNumber": 48
          },
          {
            "text": "        {",
            "lineNumber": 49
          },
          {
            "text": "          title: t(\"Active Sessions\"),",
            "lineNumber": 50
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 51
          },
          {
            "text": "          id: \"sessions\",",
            "lineNumber": 52
          },
          {
            "text": "          icon: /* @__PURE__ */ jsx(Icon, { name: \"Monitor\" }),",
            "lineNumber": 53
          },
          {
            "text": "          content: /* @__PURE__ */ jsx(Suspense, { fallback: /* @__PURE__ */ jsx(ActiveSessionsPageSkeleton, {}), children: /* @__PURE__ */ jsx(ActiveSessionsPage, {}) })",
            "lineNumber": 54
          },
          {
            "text": "        },",
            "lineNumber": 55
          },
          {
            "text": "        ...project.config.allowUserApiKeys ? [{",
            "lineNumber": 56
          },
          {
            "text": "          title: t(\"API Keys\"),",
            "lineNumber": 57
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 58
          },
          {
            "text": "          id: \"api-keys\",",
            "lineNumber": 59
          },
          {
            "text": "          icon: /* @__PURE__ */ jsx(Icon, { name: \"Key\" }),",
            "lineNumber": 60
          },
          {
            "text": "          content: /* @__PURE__ */ jsx(Suspense, { fallback: /* @__PURE__ */ jsx(ApiKeysPageSkeleton, {}), children: /* @__PURE__ */ jsx(ApiKeysPage, {}) })",
            "lineNumber": 61
          },
          {
            "text": "        }] : [],",
            "lineNumber": 62
          },
          {
            "text": "        {",
            "lineNumber": 63
          },
          {
            "text": "          title: t(\"Settings\"),",
            "lineNumber": 64
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 65
          },
          {
            "text": "          id: \"settings\",",
            "lineNumber": 66
          },
          {
            "text": "          icon: /* @__PURE__ */ jsx(Icon, { name: \"Settings\" }),",
            "lineNumber": 67
          },
          {
            "text": "          content: /* @__PURE__ */ jsx(SettingsPage, {})",
            "lineNumber": 68
          },
          {
            "text": "        },",
            "lineNumber": 69
          },
          {
            "text": "        ...props.extraItems?.map((item) =&gt; ({",
            "lineNumber": 70
          },
          {
            "text": "          title: item.title,",
            "lineNumber": 71
          },
          {
            "text": ")",
            "lineNumber": 84
          },
          {
            "lineNumber": 105
          },
          {
            "lineNumber": 108
          },
          {
            "text": "}",
            "lineNumber": 109,
            "isSignature": true
          }
        ]
      },
      "score": 0.2814207077026367
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\HistorySidebar\\index.tsx",
        "range": {
          "startPosition": {
            "line": 49
          },
          "endPosition": {
            "line": 515,
            "column": 1
          }
        },
        "contents": "export default function HistorySidebar() {\nconst \n;\n\n\tconst handleSetActive = (projectId: string, question: string, historyId: string) =&gt; {\n\t\tconst project = projectStore.getProjectById(projectId);\n\t\t//If project exists\n\t\tif (project) {\n\t\t\t// if there is record, show result\n\t\t\tprojectStore.setHistoryId(projectId, historyId);\n\t\t\tprojectStore.setActiveProject(projectId)\n\t\t\tnavigate(&#96;/&#96;);\n\t\t\tclose();\n\t\t} else {\n\t\t\t// if there is no record, execute replay\n\t\t\thandleReplay(projectId, question, historyId);\n\t\t}\n\t};\n\n\tuseLayoutEffect(() =&gt; {\n\t\tconst updateAnchor = () =&gt; {\n\t\t\tconst btn = document.getElementById(\"active-task-title-btn\");\n\t\t\tif (btn) {\n\t\t\t\tconst rect = btn.getBoundingClientRect();\n\t\t\t\tsetAnchorStyle({ left: rect.left, top: rect.bottom + 6 });\n\t\t\t}\n\t\t};\n\n\t\tif (isOpen) {\n\t\t\tupdateAnchor();\n\t\t\twindow.addEventListener(\"resize\", updateAnchor);\n\t\t}\n\n\t\treturn () =&gt; {\n\t\t\twindow.removeEventListener(\"resize\", updateAnchor);\n\t\t};\n\t}, [isOpen]);\n\n\treturn\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 50,
                "column": 1
              },
              "endPosition": {
                "line": 50,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 50,
                "column": 16
              },
              "endPosition": {
                "line": 51,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function HistorySidebar() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "const ",
            "lineNumber": 221
          },
          {
            "text": ";",
            "lineNumber": 224
          },
          {
            "lineNumber": 225
          },
          {
            "text": "\tconst handleSetActive = (projectId: string, question: string, historyId: string) =&gt; {",
            "lineNumber": 226
          },
          {
            "text": "\t\tconst project = projectStore.getProjectById(projectId);",
            "lineNumber": 227
          },
          {
            "text": "\t\t//If project exists",
            "lineNumber": 228
          },
          {
            "text": "\t\tif (project) {",
            "lineNumber": 229
          },
          {
            "text": "\t\t\t// if there is record, show result",
            "lineNumber": 230
          },
          {
            "text": "\t\t\tprojectStore.setHistoryId(projectId, historyId);",
            "lineNumber": 231
          },
          {
            "text": "\t\t\tprojectStore.setActiveProject(projectId)",
            "lineNumber": 232
          },
          {
            "text": "\t\t\tnavigate(&#96;/&#96;);",
            "lineNumber": 233
          },
          {
            "text": "\t\t\tclose();",
            "lineNumber": 234
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 235
          },
          {
            "text": "\t\t\t// if there is no record, execute replay",
            "lineNumber": 236
          },
          {
            "text": "\t\t\thandleReplay(projectId, question, historyId);",
            "lineNumber": 237
          },
          {
            "text": "\t\t}",
            "lineNumber": 238
          },
          {
            "text": "\t};",
            "lineNumber": 239
          },
          {
            "lineNumber": 240
          },
          {
            "text": "\tuseLayoutEffect(() =&gt; {",
            "lineNumber": 241
          },
          {
            "text": "\t\tconst updateAnchor = () =&gt; {",
            "lineNumber": 242
          },
          {
            "text": "\t\t\tconst btn = document.getElementById(\"active-task-title-btn\");",
            "lineNumber": 243
          },
          {
            "text": "\t\t\tif (btn) {",
            "lineNumber": 244
          },
          {
            "text": "\t\t\t\tconst rect = btn.getBoundingClientRect();",
            "lineNumber": 245
          },
          {
            "text": "\t\t\t\tsetAnchorStyle({ left: rect.left, top: rect.bottom + 6 });",
            "lineNumber": 246
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 247
          },
          {
            "text": "\t\t};",
            "lineNumber": 248
          },
          {
            "lineNumber": 249
          },
          {
            "text": "\t\tif (isOpen) {",
            "lineNumber": 250
          },
          {
            "text": "\t\t\tupdateAnchor();",
            "lineNumber": 251
          },
          {
            "text": "\t\t\twindow.addEventListener(\"resize\", updateAnchor);",
            "lineNumber": 252
          },
          {
            "text": "\t\t}",
            "lineNumber": 253
          },
          {
            "lineNumber": 254
          },
          {
            "text": "\t\treturn () =&gt; {",
            "lineNumber": 255
          },
          {
            "text": "\t\t\twindow.removeEventListener(\"resize\", updateAnchor);",
            "lineNumber": 256
          },
          {
            "text": "\t\t};",
            "lineNumber": 257
          },
          {
            "text": "\t}, [isOpen]);",
            "lineNumber": 258
          },
          {
            "lineNumber": 259
          },
          {
            "text": "\treturn",
            "lineNumber": 260
          },
          {
            "text": "}",
            "lineNumber": 516,
            "isSignature": true
          }
        ]
      },
      "score": 0.28130170702934265
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 46,
            "column": 65
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\n\tconst {t} = useTranslation()\n\tconst navigate = useNavigate();\n  const [deleteCallback, setDeleteCallback] = useState&lt;() =&gt; void&gt;(() =&gt; {});\n\tconst { chatStore, projectStore } = useChatStoreAdapter();\n\tif (!chatStore || !projectStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\tconst { history_type, setHistoryType } = useGlobalStore();\n\tconst [historyTasks, setHistoryTasks] = useState&lt;any[]&gt;([]);\n\tconst [deleteModalOpen, setDeleteModalOpen] = useState(false);\n\tconst [curHistoryId, setCurHistoryId] = useState(\"\");\n\tconst [deleteProjectModalOpen, setDeleteProjectModalOpen] = useState(false);\n\tconst [curProjectId, setCurProjectId] = useState(\"\");\n\tconst [refreshTrigger, setRefreshTrigger] = useState(0);\n\tconst [projectDeleteCallback, setProjectDeleteCallback] = useState&lt;(() =&gt; Promise&lt;void&gt;) | null&gt;(null);\n\tconst agentMap = {\n\t\tdeveloper_agent:\n,\n\t};\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "\tconst {t} = useTranslation()",
            "lineNumber": 51
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 52
          },
          {
            "text": "  const [deleteCallback, setDeleteCallback] = useState&lt;() =&gt; void&gt;(() =&gt; {});",
            "lineNumber": 53
          },
          {
            "text": "\tconst { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 54
          },
          {
            "text": "\tif (!chatStore || !projectStore) {",
            "lineNumber": 55
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 56
          },
          {
            "text": "\t}",
            "lineNumber": 57
          },
          {
            "text": "\tconst { history_type, setHistoryType } = useGlobalStore();",
            "lineNumber": 58
          },
          {
            "text": "\tconst [historyTasks, setHistoryTasks] = useState&lt;any[]&gt;([]);",
            "lineNumber": 59
          },
          {
            "text": "\tconst [deleteModalOpen, setDeleteModalOpen] = useState(false);",
            "lineNumber": 60
          },
          {
            "text": "\tconst [curHistoryId, setCurHistoryId] = useState(\"\");",
            "lineNumber": 61
          },
          {
            "text": "\tconst [deleteProjectModalOpen, setDeleteProjectModalOpen] = useState(false);",
            "lineNumber": 62
          },
          {
            "text": "\tconst [curProjectId, setCurProjectId] = useState(\"\");",
            "lineNumber": 63
          },
          {
            "text": "\tconst [refreshTrigger, setRefreshTrigger] = useState(0);",
            "lineNumber": 64
          },
          {
            "text": "\tconst [projectDeleteCallback, setProjectDeleteCallback] = useState&lt;(() =&gt; Promise&lt;void&gt;) | null&gt;(null);",
            "lineNumber": 65
          },
          {
            "text": "\tconst agentMap = {",
            "lineNumber": 66
          },
          {
            "text": "\t\tdeveloper_agent:",
            "lineNumber": 67
          },
          {
            "text": ",",
            "lineNumber": 110
          },
          {
            "text": "\t};",
            "lineNumber": 111
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.27814629673957825
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\TopBar\\index.tsx",
        "range": {
          "startPosition": {
            "line": 40
          },
          "endPosition": {
            "line": 421,
            "column": 1
          }
        },
        "contents": "function HeaderWin() {\n\n\n\treturn (\n\t\t&lt;div\n\t\t\tclassName=\"absolute top-0 left-0 right-0 flex !h-9 items-center justify-between pl-2 py-1 z-50 \"\n\t\t\tid=\"titlebar\"\n\t\t\tref={titlebarRef}\n\t\t&gt;\n\t\t\t{/* left */}\n\t\t\t&lt;div\n\t\t\t\tclassName={&#96;${\n\t\t\t\t\tplatform === \"darwin\" &amp;&amp; isFullscreen ? \"w-0\" : \"w-[70px]\"\n\t\t\t\t} flex items-center justify-center no-drag&#96;}\n\t\t\t&gt;\n\t\t\t\t{platform !== \"darwin\" &amp;&amp; &lt;span className=\"text-label-md text-text-heading font-bold\"&gt;Eigent&lt;/span&gt;}\n\t\t\t&lt;/div&gt;\n\n\t\t\t{/* center */}\n\t\t\t&lt;div className=\"title h-full flex-1 flex items-center justify-between drag\"&gt;\n\t\t\t\t&lt;div className=\"flex h-full items-center z-50 relative\"&gt;\n\t\t\t\t\t&lt;div className=\"flex-1 pt-1 pr-1 flex justify-start items-end\"&gt;\n\t\t\t\t\t&lt;Button\n\t\t\t\t\t\tonClick={() =&gt; navigate(\"/history\")}\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tclassName=\"no-drag p-0 h-6 w-6\"\n\t\t\t\t\t&gt;\n\t\t\t\t\t\t&lt;img className=\"w-6 h-6\" src={folderIcon} alt=\"folder-icon\" /&gt;\n\t\t\t\t\t&lt;/Button&gt;\n\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t{location.pathname === \"/history\" &amp;&amp; (\n\t\t\t\t\t\t&lt;div className=\"flex items-center mr-1\"&gt;\n\t\t\t\t\t\t\t&lt;Button\n\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\tsize=\"xs\"\n\t\t\t\t\t\t\t\tclassName=\"no-drag\"\n\t\t\t\t\t\t\t\tonClick={() =&gt; navigate(\"/\")}\n\t\t\t\t\t\t\t&gt;\n\t\t\t\t\t\t\t\t&lt;ChevronLeft className=\"w-4 h-4\" /&gt;\n\t\t\t\t\t\t\t&lt;/Button&gt;\n\t\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t)}\n\t\t\t\t\t{location.pathname !== \"/history\" &amp;&amp; (\n\t\t\t\t\t\t&lt;div className=\"flex items-center mr-1\"&gt;\n\t\t\t\t\t\t&lt;TooltipSimple content={t(\"layout.home\")} side=\"bottom\" align=\"center\"&gt;\n\t\t\t\t\t\t\t&lt;Button\n\t\t\t\t\t\t\t\t variant=\"ghost\"\n\t\t\t\t\t\t\t\t size=\"icon\"\n\t\t\t\t\t\t\t\t className=\"no-drag\"\n\t\t\t\t\t\t\t\t onClick={() =&gt; navigate(\"/history\")}\n\t\t\t\t\t\t\t\t\t&gt;\n\t\t\t\t\t\t\t\t\t&lt;House className=\"w-4 h-4\" /&gt;\n\t\t\t\t\t\t\t&lt;/Button&gt;\n\t\t\t\t\t\t&lt;/TooltipSimple&gt;\n\t\t\t\t\t\t&lt;Button\n\t\t\t\t\t\t\t variant=\"ghost\"\n\t\t\t\t\t\t\t size=\"icon\"\n\t\t\t\t\t\t\t className=\"no-drag\"\n\t\t\t\t\t\t\t onClick={createNewProject}\n\t\t\t\t\t\t\t\t\t&gt;\n\t\t\t\t\t\t\t\t&lt;TooltipSimple content={t(\"layout.new-project\")} side=\"bottom\" align=\"center\"&gt;\n\t\t\t\t\t\t\t\t\t&lt;Plus className=\"w-4 h-4\" /&gt;\n\t\t\t\t\t\t\t\t&lt;/TooltipSimple&gt;\n\t\t\t\t\t\t&lt;/Button&gt;\n\t\t\t\t\t\t&lt;/div&gt;\n\t\t\t\t\t)}\n\t\t\t\t\t{location.pathname !== \"/history\" &amp;&amp; (\n\t\t\t\t\t\t&lt;&gt;\n\t\t\t\t\t\t\t{activeTaskTitle === t(\"layout.new-project\") ?\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 41,
                "column": 1
              },
              "endPosition": {
                "line": 42,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "function HeaderWin() {",
            "lineNumber": 41,
            "isSignature": true
          },
          {
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "\treturn (",
            "lineNumber": 215
          },
          {
            "text": "\t\t&lt;div",
            "lineNumber": 216
          },
          {
            "text": "\t\t\tclassName=\"absolute top-0 left-0 right-0 flex !h-9 items-center justify-between pl-2 py-1 z-50 \"",
            "lineNumber": 217
          },
          {
            "text": "\t\t\tid=\"titlebar\"",
            "lineNumber": 218
          },
          {
            "text": "\t\t\tref={titlebarRef}",
            "lineNumber": 219
          },
          {
            "text": "\t\t&gt;",
            "lineNumber": 220
          },
          {
            "text": "\t\t\t{/* left */}",
            "lineNumber": 221
          },
          {
            "text": "\t\t\t&lt;div",
            "lineNumber": 222
          },
          {
            "text": "\t\t\t\tclassName={&#96;${",
            "lineNumber": 223
          },
          {
            "text": "\t\t\t\t\tplatform === \"darwin\" &amp;&amp; isFullscreen ? \"w-0\" : \"w-[70px]\"",
            "lineNumber": 224
          },
          {
            "text": "\t\t\t\t} flex items-center justify-center no-drag&#96;}",
            "lineNumber": 225
          },
          {
            "text": "\t\t\t&gt;",
            "lineNumber": 226
          },
          {
            "text": "\t\t\t\t{platform !== \"darwin\" &amp;&amp; &lt;span className=\"text-label-md text-text-heading font-bold\"&gt;Eigent&lt;/span&gt;}",
            "lineNumber": 227
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 228
          },
          {
            "lineNumber": 229
          },
          {
            "text": "\t\t\t{/* center */}",
            "lineNumber": 230
          },
          {
            "text": "\t\t\t&lt;div className=\"title h-full flex-1 flex items-center justify-between drag\"&gt;",
            "lineNumber": 231
          },
          {
            "text": "\t\t\t\t&lt;div className=\"flex h-full items-center z-50 relative\"&gt;",
            "lineNumber": 232
          },
          {
            "text": "\t\t\t\t\t&lt;div className=\"flex-1 pt-1 pr-1 flex justify-start items-end\"&gt;",
            "lineNumber": 233
          },
          {
            "text": "\t\t\t\t\t&lt;Button",
            "lineNumber": 234
          },
          {
            "text": "\t\t\t\t\t\tonClick={() =&gt; navigate(\"/history\")}",
            "lineNumber": 235
          },
          {
            "text": "\t\t\t\t\t\tvariant=\"ghost\"",
            "lineNumber": 236
          },
          {
            "text": "\t\t\t\t\t\tsize=\"icon\"",
            "lineNumber": 237
          },
          {
            "text": "\t\t\t\t\t\tclassName=\"no-drag p-0 h-6 w-6\"",
            "lineNumber": 238
          },
          {
            "text": "\t\t\t\t\t&gt;",
            "lineNumber": 239
          },
          {
            "text": "\t\t\t\t\t\t&lt;img className=\"w-6 h-6\" src={folderIcon} alt=\"folder-icon\" /&gt;",
            "lineNumber": 240
          },
          {
            "text": "\t\t\t\t\t&lt;/Button&gt;",
            "lineNumber": 241
          },
          {
            "text": "\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 242
          },
          {
            "text": "\t\t\t\t\t{location.pathname === \"/history\" &amp;&amp; (",
            "lineNumber": 243
          },
          {
            "text": "\t\t\t\t\t\t&lt;div className=\"flex items-center mr-1\"&gt;",
            "lineNumber": 244
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;Button",
            "lineNumber": 245
          },
          {
            "text": "\t\t\t\t\t\t\t\tvariant=\"ghost\"",
            "lineNumber": 246
          },
          {
            "text": "\t\t\t\t\t\t\t\tsize=\"xs\"",
            "lineNumber": 247
          },
          {
            "text": "\t\t\t\t\t\t\t\tclassName=\"no-drag\"",
            "lineNumber": 248
          },
          {
            "text": "\t\t\t\t\t\t\t\tonClick={() =&gt; navigate(\"/\")}",
            "lineNumber": 249
          },
          {
            "text": "\t\t\t\t\t\t\t&gt;",
            "lineNumber": 250
          },
          {
            "text": "\t\t\t\t\t\t\t\t&lt;ChevronLeft className=\"w-4 h-4\" /&gt;",
            "lineNumber": 251
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;/Button&gt;",
            "lineNumber": 252
          },
          {
            "text": "\t\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 253
          },
          {
            "text": "\t\t\t\t\t)}",
            "lineNumber": 254
          },
          {
            "text": "\t\t\t\t\t{location.pathname !== \"/history\" &amp;&amp; (",
            "lineNumber": 255
          },
          {
            "text": "\t\t\t\t\t\t&lt;div className=\"flex items-center mr-1\"&gt;",
            "lineNumber": 256
          },
          {
            "text": "\t\t\t\t\t\t&lt;TooltipSimple content={t(\"layout.home\")} side=\"bottom\" align=\"center\"&gt;",
            "lineNumber": 257
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;Button",
            "lineNumber": 258
          },
          {
            "text": "\t\t\t\t\t\t\t\t variant=\"ghost\"",
            "lineNumber": 259
          },
          {
            "text": "\t\t\t\t\t\t\t\t size=\"icon\"",
            "lineNumber": 260
          },
          {
            "text": "\t\t\t\t\t\t\t\t className=\"no-drag\"",
            "lineNumber": 261
          },
          {
            "text": "\t\t\t\t\t\t\t\t onClick={() =&gt; navigate(\"/history\")}",
            "lineNumber": 262
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t&gt;",
            "lineNumber": 263
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t&lt;House className=\"w-4 h-4\" /&gt;",
            "lineNumber": 264
          },
          {
            "text": "\t\t\t\t\t\t\t&lt;/Button&gt;",
            "lineNumber": 265
          },
          {
            "text": "\t\t\t\t\t\t&lt;/TooltipSimple&gt;",
            "lineNumber": 266
          },
          {
            "text": "\t\t\t\t\t\t&lt;Button",
            "lineNumber": 267
          },
          {
            "text": "\t\t\t\t\t\t\t variant=\"ghost\"",
            "lineNumber": 268
          },
          {
            "text": "\t\t\t\t\t\t\t size=\"icon\"",
            "lineNumber": 269
          },
          {
            "text": "\t\t\t\t\t\t\t className=\"no-drag\"",
            "lineNumber": 270
          },
          {
            "text": "\t\t\t\t\t\t\t onClick={createNewProject}",
            "lineNumber": 271
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t&gt;",
            "lineNumber": 272
          },
          {
            "text": "\t\t\t\t\t\t\t\t&lt;TooltipSimple content={t(\"layout.new-project\")} side=\"bottom\" align=\"center\"&gt;",
            "lineNumber": 273
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t&lt;Plus className=\"w-4 h-4\" /&gt;",
            "lineNumber": 274
          },
          {
            "text": "\t\t\t\t\t\t\t\t&lt;/TooltipSimple&gt;",
            "lineNumber": 275
          },
          {
            "text": "\t\t\t\t\t\t&lt;/Button&gt;",
            "lineNumber": 276
          },
          {
            "text": "\t\t\t\t\t\t&lt;/div&gt;",
            "lineNumber": 277
          },
          {
            "text": "\t\t\t\t\t)}",
            "lineNumber": 278
          },
          {
            "text": "\t\t\t\t\t{location.pathname !== \"/history\" &amp;&amp; (",
            "lineNumber": 279
          },
          {
            "text": "\t\t\t\t\t\t&lt;&gt;",
            "lineNumber": 280
          },
          {
            "text": "\t\t\t\t\t\t\t{activeTaskTitle === t(\"layout.new-project\") ?",
            "lineNumber": 281
          },
          {
            "text": "}",
            "lineNumber": 422,
            "isSignature": true
          }
        ]
      },
      "score": 0.27395015954971313
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 49
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\n\n\n      &lt;div className=\"flex w-full\"&gt;\n      &lt;div className=\"flex flex-col px-6 py-8 max-w-[900px] min-h-[calc(100vh-86px)] mx-auto w-full items-start justify-start\"&gt;\n        &lt;GroupedHistoryView\n          onTaskSelect={handleSetActive}\n          onTaskDelete={handleDelete}\n          onTaskShare={handleShare}\n          activeTaskId={chatStore.activeTaskId || undefined}\n          ongoingTasks={chatStore.tasks}\n          onOngoingTaskClick={(taskId) =&gt; {\n            chatStore.setActiveTaskId(taskId);\n            navigate(&#96;/&#96;);\n          }}\n          onOngoingTaskPause={(taskId) =&gt; handleTakeControl(\"pause\", taskId)}\n          onOngoingTaskResume={(taskId) =&gt; handleTakeControl(\"resume\", taskId)}\n          onOngoingTaskDelete={(taskId) =&gt; handleDelete(taskId)}\n          onProjectDelete={handleProjectDelete}\n          refreshTrigger={refreshTrigger}\n        /&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n  );\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 50,
                "column": 1
              },
              "endPosition": {
                "line": 50,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 50,
                "column": 16
              },
              "endPosition": {
                "line": 51,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "lineNumber": 277
          },
          {
            "lineNumber": 278
          },
          {
            "text": "      &lt;div className=\"flex w-full\"&gt;",
            "lineNumber": 279
          },
          {
            "text": "      &lt;div className=\"flex flex-col px-6 py-8 max-w-[900px] min-h-[calc(100vh-86px)] mx-auto w-full items-start justify-start\"&gt;",
            "lineNumber": 280
          },
          {
            "text": "        &lt;GroupedHistoryView",
            "lineNumber": 281
          },
          {
            "text": "          onTaskSelect={handleSetActive}",
            "lineNumber": 282
          },
          {
            "text": "          onTaskDelete={handleDelete}",
            "lineNumber": 283
          },
          {
            "text": "          onTaskShare={handleShare}",
            "lineNumber": 284
          },
          {
            "text": "          activeTaskId={chatStore.activeTaskId || undefined}",
            "lineNumber": 285
          },
          {
            "text": "          ongoingTasks={chatStore.tasks}",
            "lineNumber": 286
          },
          {
            "text": "          onOngoingTaskClick={(taskId) =&gt; {",
            "lineNumber": 287
          },
          {
            "text": "            chatStore.setActiveTaskId(taskId);",
            "lineNumber": 288
          },
          {
            "text": "            navigate(&#96;/&#96;);",
            "lineNumber": 289
          },
          {
            "text": "          }}",
            "lineNumber": 290
          },
          {
            "text": "          onOngoingTaskPause={(taskId) =&gt; handleTakeControl(\"pause\", taskId)}",
            "lineNumber": 291
          },
          {
            "text": "          onOngoingTaskResume={(taskId) =&gt; handleTakeControl(\"resume\", taskId)}",
            "lineNumber": 292
          },
          {
            "text": "          onOngoingTaskDelete={(taskId) =&gt; handleDelete(taskId)}",
            "lineNumber": 293
          },
          {
            "text": "          onProjectDelete={handleProjectDelete}",
            "lineNumber": 294
          },
          {
            "text": "          refreshTrigger={refreshTrigger}",
            "lineNumber": 295
          },
          {
            "text": "        /&gt;",
            "lineNumber": 296
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 297
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 298
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 299
          },
          {
            "text": "  );",
            "lineNumber": 300
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.2738032341003418
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\GroupedHistoryView\\ProjectGroup.tsx",
        "range": {
          "startPosition": {
            "line": 35,
            "column": 1
          },
          "endPosition": {
            "line": 405,
            "column": 1
          }
        },
        "contents": "export default function ProjectGroup({\n  project,\n  onTaskSelect,\n  onTaskDelete,\n  onTaskShare,\n  activeTaskId,\n  searchValue = \"\",\n  isOngoing = false,\n  onOngoingTaskPause,\n  onOngoingTaskResume,\n  onProjectEdit,\n  onProjectDelete,\n  onProjectRename,\n  viewMode = \"grid\"\n}: ProjectGroupProps) {\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const projectStore = useProjectStore();\n  const { chatStore } = useChatStoreAdapter();\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n\n  // Handler to navigate to project\n  const handleProjectClick = (e: React.MouseEvent) =&gt; {\n    // Don't trigger if clicking on interactive elements (buttons, dropdowns)\n    if ((e.target as HTMLElement).closest('button, [role=\"menuitem\"]')) {\n      return;\n    }\n    \n    // Check if project exists in store\n    const existingProject = projectStore.getProjectById(project.project_id);\n    \n    if (existingProject) {\n      // Project exists, just activate it and navigate\n      projectStore.setActiveProject(project.project_id);\n      navigate('/');\n    } else {\n      // Project doesn't exist, trigger replay to recreate it\n      // Get the first task's question and use the first task's ID as history ID\n      const firstTask = project.tasks?.[0];\n      if (firstTask) {\n        const question = firstTask.question || project.last_prompt || \"\";\n        const historyId = firstTask.id?.toString() || \"\";\n        const taskIdsList = [project.project_id];\n        \n        replayProject(projectStore, navigate, project.project_id, question, historyId, taskIdsList);\n      } else {\n        console.warn(\"No tasks found in project, cannot replay\");\n        // Fallback: try to set as active anyway (may create a new project)\n        projectStore.setActiveProject(project.project_id);\n        navigate('/');\n      }\n    }\n  };\n\n  // Filter tasks based on search value\n  const filteredTasks = project.tasks.filter\n;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function ProjectGroup({",
            "lineNumber": 38,
            "isSignature": true
          },
          {
            "text": "  project,",
            "lineNumber": 39,
            "isSignature": true
          },
          {
            "text": "  onTaskSelect,",
            "lineNumber": 40,
            "isSignature": true
          },
          {
            "text": "  onTaskDelete,",
            "lineNumber": 41,
            "isSignature": true
          },
          {
            "text": "  onTaskShare,",
            "lineNumber": 42,
            "isSignature": true
          },
          {
            "text": "  activeTaskId,",
            "lineNumber": 43,
            "isSignature": true
          },
          {
            "text": "  searchValue = \"\",",
            "lineNumber": 44,
            "isSignature": true
          },
          {
            "text": "  isOngoing = false,",
            "lineNumber": 45,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskPause,",
            "lineNumber": 46,
            "isSignature": true
          },
          {
            "text": "  onOngoingTaskResume,",
            "lineNumber": 47,
            "isSignature": true
          },
          {
            "text": "  onProjectEdit,",
            "lineNumber": 48,
            "isSignature": true
          },
          {
            "text": "  onProjectDelete,",
            "lineNumber": 49,
            "isSignature": true
          },
          {
            "text": "  onProjectRename,",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "text": "  viewMode = \"grid\"",
            "lineNumber": 51,
            "isSignature": true
          },
          {
            "text": "}: ProjectGroupProps) {",
            "lineNumber": 52,
            "isSignature": true
          },
          {
            "text": "  const { t } = useTranslation();",
            "lineNumber": 53
          },
          {
            "text": "  const navigate = useNavigate();",
            "lineNumber": 54
          },
          {
            "text": "  const projectStore = useProjectStore();",
            "lineNumber": 55
          },
          {
            "text": "  const { chatStore } = useChatStoreAdapter();",
            "lineNumber": 56
          },
          {
            "text": "  const [isExpanded, setIsExpanded] = useState(true);",
            "lineNumber": 57
          },
          {
            "text": "  const [isDialogOpen, setIsDialogOpen] = useState(false);",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "  // Handler to navigate to project",
            "lineNumber": 60
          },
          {
            "text": "  const handleProjectClick = (e: React.MouseEvent) =&gt; {",
            "lineNumber": 61
          },
          {
            "text": "    // Don't trigger if clicking on interactive elements (buttons, dropdowns)",
            "lineNumber": 62
          },
          {
            "text": "    if ((e.target as HTMLElement).closest('button, [role=\"menuitem\"]')) {",
            "lineNumber": 63
          },
          {
            "text": "      return;",
            "lineNumber": 64
          },
          {
            "text": "    }",
            "lineNumber": 65
          },
          {
            "text": "    ",
            "lineNumber": 66
          },
          {
            "text": "    // Check if project exists in store",
            "lineNumber": 67
          },
          {
            "text": "    const existingProject = projectStore.getProjectById(project.project_id);",
            "lineNumber": 68
          },
          {
            "text": "    ",
            "lineNumber": 69
          },
          {
            "text": "    if (existingProject) {",
            "lineNumber": 70
          },
          {
            "text": "      // Project exists, just activate it and navigate",
            "lineNumber": 71
          },
          {
            "text": "      projectStore.setActiveProject(project.project_id);",
            "lineNumber": 72
          },
          {
            "text": "      navigate('/');",
            "lineNumber": 73
          },
          {
            "text": "    } else {",
            "lineNumber": 74
          },
          {
            "text": "      // Project doesn't exist, trigger replay to recreate it",
            "lineNumber": 75
          },
          {
            "text": "      // Get the first task's question and use the first task's ID as history ID",
            "lineNumber": 76
          },
          {
            "text": "      const firstTask = project.tasks?.[0];",
            "lineNumber": 77
          },
          {
            "text": "      if (firstTask) {",
            "lineNumber": 78
          },
          {
            "text": "        const question = firstTask.question || project.last_prompt || \"\";",
            "lineNumber": 79
          },
          {
            "text": "        const historyId = firstTask.id?.toString() || \"\";",
            "lineNumber": 80
          },
          {
            "text": "        const taskIdsList = [project.project_id];",
            "lineNumber": 81
          },
          {
            "text": "        ",
            "lineNumber": 82
          },
          {
            "text": "        replayProject(projectStore, navigate, project.project_id, question, historyId, taskIdsList);",
            "lineNumber": 83
          },
          {
            "text": "      } else {",
            "lineNumber": 84
          },
          {
            "text": "        console.warn(\"No tasks found in project, cannot replay\");",
            "lineNumber": 85
          },
          {
            "text": "        // Fallback: try to set as active anyway (may create a new project)",
            "lineNumber": 86
          },
          {
            "text": "        projectStore.setActiveProject(project.project_id);",
            "lineNumber": 87
          },
          {
            "text": "        navigate('/');",
            "lineNumber": 88
          },
          {
            "text": "      }",
            "lineNumber": 89
          },
          {
            "text": "    }",
            "lineNumber": 90
          },
          {
            "text": "  };",
            "lineNumber": 91
          },
          {
            "lineNumber": 92
          },
          {
            "text": "  // Filter tasks based on search value",
            "lineNumber": 93
          },
          {
            "text": "  const filteredTasks = project.tasks.filter",
            "lineNumber": 94
          },
          {
            "text": ";",
            "lineNumber": 96
          },
          {
            "text": "}",
            "lineNumber": 406,
            "isSignature": true
          }
        ]
      },
      "score": 0.2696476876735687
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\SearchHistoryDialog.tsx",
        "range": {
          "startPosition": {
            "line": 35,
            "column": 30
          },
          "endPosition": {
            "line": 134,
            "column": 1
          }
        },
        "contents": " \"@/store/globalStore\";\n\nexport function SearchHistoryDialog() {\n\tconst {t} = useTranslation()\n\tconst [open, setOpen] = useState(false);\n\tconst [historyTasks, setHistoryTasks] = useState&lt;any[]&gt;([]);\n\tconst { history_type } = useGlobalStore();\n\t//Get Chatstore for the active project's task\n\tconst { chatStore, projectStore } = useChatStoreAdapter();\n\tif (!chatStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\t\n\tconst navigate = useNavigate();\n\tconst handleSetActive = (projectId: string, question: string, historyId: string) =&gt; {\n\t\tconst project = projectStore.getProjectById(projectId);\n\t\t//If project exists\n\t\tif (project) {\n\t\t\t// if there is record, show result\n\t\t\tprojectStore.setHistoryId(projectId, historyId);\n\t\t\tprojectStore.setActiveProject(projectId)\n\t\t\tnavigate(&#96;/&#96;);\n\t\t\tsetOpen(false);\n\t\t} else {\n\t\t\t// if there is no record, execute replay\n\t\t\thandleReplay(projectId, question, historyId);\n\t\t}\n\t};\n\n\tconst handleReplay = async (projectId: string, question: string, historyId: string) =&gt; {\n\t\tsetOpen(false);\n\t\tawait replayProject(projectStore, navigate, projectId, question, historyId);\n\t};\n\n\tconst handleDelete = (taskId: string) =&gt; {\n\t\t// TODO: Implement delete functionality similar to HistorySidebar\n\t\tconsole.log(\"Delete task:\", taskId);\n\t};\n\n\tconst handleShare = (taskId: string) =&gt; {\n\t\t// TODO: Implement share functionality similar to HistorySidebar\n\t\tconsole.log(\"Share task:\", taskId);\n\t};\n\n\tuseEffect(() =&gt; {\n\t\tfetchHistoryTasks(setHistoryTasks);\n\t}, []);\n\treturn (\n\t\t&lt;&gt;\n\t\t\t&lt;Button\n\t\t\t\tvariant=\"ghost\"\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": " \"@/store/globalStore\";",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "export function SearchHistoryDialog() {",
            "lineNumber": 38,
            "isSignature": true
          },
          {
            "text": "\tconst {t} = useTranslation()",
            "lineNumber": 39
          },
          {
            "text": "\tconst [open, setOpen] = useState(false);",
            "lineNumber": 40
          },
          {
            "text": "\tconst [historyTasks, setHistoryTasks] = useState&lt;any[]&gt;([]);",
            "lineNumber": 41
          },
          {
            "text": "\tconst { history_type } = useGlobalStore();",
            "lineNumber": 42
          },
          {
            "text": "\t//Get Chatstore for the active project's task",
            "lineNumber": 43
          },
          {
            "text": "\tconst { chatStore, projectStore } = useChatStoreAdapter();",
            "lineNumber": 44
          },
          {
            "text": "\tif (!chatStore) {",
            "lineNumber": 45
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 46
          },
          {
            "text": "\t}",
            "lineNumber": 47
          },
          {
            "text": "\t",
            "lineNumber": 48
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 49
          },
          {
            "text": "\tconst handleSetActive = (projectId: string, question: string, historyId: string) =&gt; {",
            "lineNumber": 50
          },
          {
            "text": "\t\tconst project = projectStore.getProjectById(projectId);",
            "lineNumber": 51
          },
          {
            "text": "\t\t//If project exists",
            "lineNumber": 52
          },
          {
            "text": "\t\tif (project) {",
            "lineNumber": 53
          },
          {
            "text": "\t\t\t// if there is record, show result",
            "lineNumber": 54
          },
          {
            "text": "\t\t\tprojectStore.setHistoryId(projectId, historyId);",
            "lineNumber": 55
          },
          {
            "text": "\t\t\tprojectStore.setActiveProject(projectId)",
            "lineNumber": 56
          },
          {
            "text": "\t\t\tnavigate(&#96;/&#96;);",
            "lineNumber": 57
          },
          {
            "text": "\t\t\tsetOpen(false);",
            "lineNumber": 58
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 59
          },
          {
            "text": "\t\t\t// if there is no record, execute replay",
            "lineNumber": 60
          },
          {
            "text": "\t\t\thandleReplay(projectId, question, historyId);",
            "lineNumber": 61
          },
          {
            "text": "\t\t}",
            "lineNumber": 62
          },
          {
            "text": "\t};",
            "lineNumber": 63
          },
          {
            "lineNumber": 64
          },
          {
            "text": "\tconst handleReplay = async (projectId: string, question: string, historyId: string) =&gt; {",
            "lineNumber": 65
          },
          {
            "text": "\t\tsetOpen(false);",
            "lineNumber": 66
          },
          {
            "text": "\t\tawait replayProject(projectStore, navigate, projectId, question, historyId);",
            "lineNumber": 67
          },
          {
            "text": "\t};",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "\tconst handleDelete = (taskId: string) =&gt; {",
            "lineNumber": 70
          },
          {
            "text": "\t\t// TODO: Implement delete functionality similar to HistorySidebar",
            "lineNumber": 71
          },
          {
            "text": "\t\tconsole.log(\"Delete task:\", taskId);",
            "lineNumber": 72
          },
          {
            "text": "\t};",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "\tconst handleShare = (taskId: string) =&gt; {",
            "lineNumber": 75
          },
          {
            "text": "\t\t// TODO: Implement share functionality similar to HistorySidebar",
            "lineNumber": 76
          },
          {
            "text": "\t\tconsole.log(\"Share task:\", taskId);",
            "lineNumber": 77
          },
          {
            "text": "\t};",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 80
          },
          {
            "text": "\t\tfetchHistoryTasks(setHistoryTasks);",
            "lineNumber": 81
          },
          {
            "text": "\t}, []);",
            "lineNumber": 82
          },
          {
            "text": "\treturn (",
            "lineNumber": 83
          },
          {
            "text": "\t\t&lt;&gt;",
            "lineNumber": 84
          },
          {
            "text": "\t\t\t&lt;Button",
            "lineNumber": 85
          },
          {
            "text": "\t\t\t\tvariant=\"ghost\"",
            "lineNumber": 86
          },
          {
            "text": "}",
            "lineNumber": 135,
            "isSignature": true
          }
        ]
      },
      "score": 0.2684328556060791
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Dashboard\\Project.tsx",
        "range": {
          "startPosition": {
            "line": 49
          },
          "endPosition": {
            "line": 300,
            "column": 1
          }
        },
        "contents": "export default function Project() {\n\n\n\tconst agentIconMap = {\n\t\tdeveloper_agent: (\n\t\t\t&lt;CodeXml\n\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.developer_agent.textColor}&#96;}\n\t\t\t/&gt;\n\t\t),\n\t\tbrowser_agent: (\n\t\t\t&lt;Globe\n\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.browser_agent.textColor}&#96;}\n\t\t\t/&gt;\n\t\t),\n\t\tdocument_agent: (\n\t\t\t&lt;FileText\n\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.document_agent.textColor}&#96;}\n\t\t\t/&gt;\n\t\t),\n\t\tmulti_modal_agent: (\n\t\t\t&lt;Image\n\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.multi_modal_agent.textColor}&#96;}\n\t\t\t/&gt;\n\t\t),\n\t\tsocial_medium_agent: (\n\t\t\t&lt;Bird\n\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.social_medium_agent.textColor}&#96;}\n\t\t\t/&gt;\n\t\t),\n\t};\n\n\tconst handleClickAgent = (taskId: string, agent_id: string) =&gt; {\n\t\tchatStore.setActiveTaskId(taskId);\n\t\tchatStore.setActiveWorkSpace(taskId, \"workflow\");\n\t\tchatStore.setActiveAgent(taskId, agent_id);\n\t\tnavigate(&#96;/&#96;);\n\t};\n\n\tconst handleDelete = (id: string, callback?: () =&gt; void) =&gt; {\n\t\tsetCurHistoryId(id);\n\t\tsetDeleteModalOpen(true);\n    if(callback) setDeleteCallback(callback);\n\t};\n\n\tconst confirmDelete = async () =&gt; {\n\t\tconst id = curHistoryId;\n\t\tif (!id) return;\n\t\ttry {\n\t\t\tawait proxyFetchDelete(&#96;/api/chat/history/${id}&#96;);\n\t\t\tsetHistoryTasks((list) =&gt; list.filter((item) =&gt; item.id !== id));\n\t\t\tif (chatStore.tasks[id]) {\n\t\t\t\tchatStore.removeTask(id);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Failed to delete history task:\", error);\n\t\t} finally {\n\t\t\tsetCurHistoryId(\"\");\n\t\t\tsetDeleteModalOpen(false);\n      deleteCallback();\n\t\t}\n\t};\n\n\tconst handleProjectDelete = (projectId: string, callback: () =&gt; Promise&lt;void&gt;) =&gt; {\n\t\tsetCurProjectId(projectId);\n\t\tsetProjectDeleteCallback(() =&gt; callback);\n\t\tsetDeleteProjectModalOpen(true);\n\t};\n\n\tconst confirmProjectDelete = async ()\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 50,
                "column": 1
              },
              "endPosition": {
                "line": 50,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 50,
                "column": 16
              },
              "endPosition": {
                "line": 51,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Project() {",
            "lineNumber": 50,
            "isSignature": true
          },
          {
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "\tconst agentIconMap = {",
            "lineNumber": 113
          },
          {
            "text": "\t\tdeveloper_agent: (",
            "lineNumber": 114
          },
          {
            "text": "\t\t\t&lt;CodeXml",
            "lineNumber": 115
          },
          {
            "text": "\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.developer_agent.textColor}&#96;}",
            "lineNumber": 116
          },
          {
            "text": "\t\t\t/&gt;",
            "lineNumber": 117
          },
          {
            "text": "\t\t),",
            "lineNumber": 118
          },
          {
            "text": "\t\tbrowser_agent: (",
            "lineNumber": 119
          },
          {
            "text": "\t\t\t&lt;Globe",
            "lineNumber": 120
          },
          {
            "text": "\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.browser_agent.textColor}&#96;}",
            "lineNumber": 121
          },
          {
            "text": "\t\t\t/&gt;",
            "lineNumber": 122
          },
          {
            "text": "\t\t),",
            "lineNumber": 123
          },
          {
            "text": "\t\tdocument_agent: (",
            "lineNumber": 124
          },
          {
            "text": "\t\t\t&lt;FileText",
            "lineNumber": 125
          },
          {
            "text": "\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.document_agent.textColor}&#96;}",
            "lineNumber": 126
          },
          {
            "text": "\t\t\t/&gt;",
            "lineNumber": 127
          },
          {
            "text": "\t\t),",
            "lineNumber": 128
          },
          {
            "text": "\t\tmulti_modal_agent: (",
            "lineNumber": 129
          },
          {
            "text": "\t\t\t&lt;Image",
            "lineNumber": 130
          },
          {
            "text": "\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.multi_modal_agent.textColor}&#96;}",
            "lineNumber": 131
          },
          {
            "text": "\t\t\t/&gt;",
            "lineNumber": 132
          },
          {
            "text": "\t\t),",
            "lineNumber": 133
          },
          {
            "text": "\t\tsocial_medium_agent: (",
            "lineNumber": 134
          },
          {
            "text": "\t\t\t&lt;Bird",
            "lineNumber": 135
          },
          {
            "text": "\t\t\t\tclassName={&#96;!h-[10px] !w-[10px] ${agentMap.social_medium_agent.textColor}&#96;}",
            "lineNumber": 136
          },
          {
            "text": "\t\t\t/&gt;",
            "lineNumber": 137
          },
          {
            "text": "\t\t),",
            "lineNumber": 138
          },
          {
            "text": "\t};",
            "lineNumber": 139
          },
          {
            "lineNumber": 140
          },
          {
            "text": "\tconst handleClickAgent = (taskId: string, agent_id: string) =&gt; {",
            "lineNumber": 141
          },
          {
            "text": "\t\tchatStore.setActiveTaskId(taskId);",
            "lineNumber": 142
          },
          {
            "text": "\t\tchatStore.setActiveWorkSpace(taskId, \"workflow\");",
            "lineNumber": 143
          },
          {
            "text": "\t\tchatStore.setActiveAgent(taskId, agent_id);",
            "lineNumber": 144
          },
          {
            "text": "\t\tnavigate(&#96;/&#96;);",
            "lineNumber": 145
          },
          {
            "text": "\t};",
            "lineNumber": 146
          },
          {
            "lineNumber": 147
          },
          {
            "text": "\tconst handleDelete = (id: string, callback?: () =&gt; void) =&gt; {",
            "lineNumber": 148
          },
          {
            "text": "\t\tsetCurHistoryId(id);",
            "lineNumber": 149
          },
          {
            "text": "\t\tsetDeleteModalOpen(true);",
            "lineNumber": 150
          },
          {
            "text": "    if(callback) setDeleteCallback(callback);",
            "lineNumber": 151
          },
          {
            "text": "\t};",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "\tconst confirmDelete = async () =&gt; {",
            "lineNumber": 154
          },
          {
            "text": "\t\tconst id = curHistoryId;",
            "lineNumber": 155
          },
          {
            "text": "\t\tif (!id) return;",
            "lineNumber": 156
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 157
          },
          {
            "text": "\t\t\tawait proxyFetchDelete(&#96;/api/chat/history/${id}&#96;);",
            "lineNumber": 158
          },
          {
            "text": "\t\t\tsetHistoryTasks((list) =&gt; list.filter((item) =&gt; item.id !== id));",
            "lineNumber": 159
          },
          {
            "text": "\t\t\tif (chatStore.tasks[id]) {",
            "lineNumber": 160
          },
          {
            "text": "\t\t\t\tchatStore.removeTask(id);",
            "lineNumber": 161
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 162
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 163
          },
          {
            "text": "\t\t\tconsole.error(\"Failed to delete history task:\", error);",
            "lineNumber": 164
          },
          {
            "text": "\t\t} finally {",
            "lineNumber": 165
          },
          {
            "text": "\t\t\tsetCurHistoryId(\"\");",
            "lineNumber": 166
          },
          {
            "text": "\t\t\tsetDeleteModalOpen(false);",
            "lineNumber": 167
          },
          {
            "text": "      deleteCallback();",
            "lineNumber": 168
          },
          {
            "text": "\t\t}",
            "lineNumber": 169
          },
          {
            "text": "\t};",
            "lineNumber": 170
          },
          {
            "lineNumber": 171
          },
          {
            "text": "\tconst handleProjectDelete = (projectId: string, callback: () =&gt; Promise&lt;void&gt;) =&gt; {",
            "lineNumber": 172
          },
          {
            "text": "\t\tsetCurProjectId(projectId);",
            "lineNumber": 173
          },
          {
            "text": "\t\tsetProjectDeleteCallback(() =&gt; callback);",
            "lineNumber": 174
          },
          {
            "text": "\t\tsetDeleteProjectModalOpen(true);",
            "lineNumber": 175
          },
          {
            "text": "\t};",
            "lineNumber": 176
          },
          {
            "lineNumber": 177
          },
          {
            "text": "\tconst confirmProjectDelete = async ()",
            "lineNumber": 178
          },
          {
            "text": ";",
            "lineNumber": 192
          },
          {
            "text": "}",
            "lineNumber": 301,
            "isSignature": true
          }
        ]
      },
      "score": 0.26377710700035095
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\History.tsx",
        "range": {
          "startPosition": {
            "line": 24
          },
          "endPosition": {
            "line": 140,
            "column": 1
          }
        },
        "contents": "export default function Home() {\nconst createChat = \n\n\t\tnavigate(\"/\");\n\t};\n\n  useEffect(() =&gt; {\n\t\t// Update active tab when URL parameter changes\n\t\tconst tabFromUrl = searchParams.get('tab');\n\t\tconst validTabs = [\"projects\", \"workers\", \"trigger\", \"settings\", \"mcp_tools\"];\n\t\tif (tabFromUrl &amp;&amp; validTabs.includes(tabFromUrl)) {\n\t\t\tsetActiveTab(tabFromUrl as typeof activeTab);\n\t\t}\n\t}, [searchParams]);\n\n\treturn (\n\t\t&lt;div ref={scrollContainerRef} className=\"h-full overflow-y-auto scrollbar-hide mx-auto\"&gt;\n\t\t{/* alert dialog */}\n\t\t&lt;AlertDialog\n\t\t\tisOpen={deleteModalOpen}\n\t\t\tonClose={() =&gt; setDeleteModalOpen(false)}\n\t\t\tonConfirm={confirmDelete}\n\t\t\ttitle={t(\"layout.delete-task\")}\n\t\t\tmessage={t(\"layout.delete-task-confirmation\")}\n\t\t\tconfirmText={t(\"layout.delete\")}\n\t\t\tcancelText={t(\"layout.cancel\")}\n\t\t/&gt;\n\t\t\t{/* welcome text */}\n\t\t\t&lt;div className=\"flex flex-row w-full pt-16 px-20 bg-gradient-to-b from-transparent to-[#F9F8F6]\"&gt;\n\t\t\t\t\t&lt;WordCarousel\n\t\t\t\t\t\twords={[&#96;${t(\"layout.welcome\")}, ${welcomeName} !&#96;]}\n\t\t\t\t\t\tclassName=\"text-heading-xl font-bold tracking-tight\"\n\t\t\t\t\t\trotateIntervalMs={100}\n\t\t\t\t\t\tsweepDurationMs={2000}\n\t\t\t\t\t\tsweepOnce\n\t\t\t\t\t\tgradient={&#96;linear-gradient(in oklch 90deg,\n\t\t\t\t\t\t\t#f9f8f6 0%, var(--colors-blue-300) 30%,\n\t\t\t\t\t\t\tvar(--colors-emerald-default) 50%, \n\t\t\t\t\t\t\tvar(--colors-green-500) 70%,\n\t\t\t\t\t\t\tvar(--colors-orange-300) 100%)&#96;}\n\t\t\t\t\t\tariaLabel=\"rotating headline\"\n\t\t\t\t\t/&gt;\n\t\t\t&lt;/div&gt;\n\t\t\t{/* Navbar */}\n\t\t&lt;div\n\t\t\tclassName={&#96;sticky top-0 z-20 flex flex-col justify-between items-center bg-[#F9F8F6] px-20 pt-10 pb-4 border-border-disabled border-x-0 border-t-0 border-solid&#96;}\n\t\t&gt;\n\t\t\t\t&lt;div className=\"flex flex-row justify-between items-center w-full mx-auto\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 25,
                "column": 1
              },
              "endPosition": {
                "line": 25,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 25,
                "column": 16
              },
              "endPosition": {
                "line": 26,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Home() {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "const createChat = ",
            "lineNumber": 73
          },
          {
            "lineNumber": 75
          },
          {
            "text": "\t\tnavigate(\"/\");",
            "lineNumber": 76
          },
          {
            "text": "\t};",
            "lineNumber": 77
          },
          {
            "lineNumber": 78
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 79
          },
          {
            "text": "\t\t// Update active tab when URL parameter changes",
            "lineNumber": 80
          },
          {
            "text": "\t\tconst tabFromUrl = searchParams.get('tab');",
            "lineNumber": 81
          },
          {
            "text": "\t\tconst validTabs = [\"projects\", \"workers\", \"trigger\", \"settings\", \"mcp_tools\"];",
            "lineNumber": 82
          },
          {
            "text": "\t\tif (tabFromUrl &amp;&amp; validTabs.includes(tabFromUrl)) {",
            "lineNumber": 83
          },
          {
            "text": "\t\t\tsetActiveTab(tabFromUrl as typeof activeTab);",
            "lineNumber": 84
          },
          {
            "text": "\t\t}",
            "lineNumber": 85
          },
          {
            "text": "\t}, [searchParams]);",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "\treturn (",
            "lineNumber": 88
          },
          {
            "text": "\t\t&lt;div ref={scrollContainerRef} className=\"h-full overflow-y-auto scrollbar-hide mx-auto\"&gt;",
            "lineNumber": 89
          },
          {
            "text": "\t\t{/* alert dialog */}",
            "lineNumber": 90
          },
          {
            "text": "\t\t&lt;AlertDialog",
            "lineNumber": 91
          },
          {
            "text": "\t\t\tisOpen={deleteModalOpen}",
            "lineNumber": 92
          },
          {
            "text": "\t\t\tonClose={() =&gt; setDeleteModalOpen(false)}",
            "lineNumber": 93
          },
          {
            "text": "\t\t\tonConfirm={confirmDelete}",
            "lineNumber": 94
          },
          {
            "text": "\t\t\ttitle={t(\"layout.delete-task\")}",
            "lineNumber": 95
          },
          {
            "text": "\t\t\tmessage={t(\"layout.delete-task-confirmation\")}",
            "lineNumber": 96
          },
          {
            "text": "\t\t\tconfirmText={t(\"layout.delete\")}",
            "lineNumber": 97
          },
          {
            "text": "\t\t\tcancelText={t(\"layout.cancel\")}",
            "lineNumber": 98
          },
          {
            "text": "\t\t/&gt;",
            "lineNumber": 99
          },
          {
            "text": "\t\t\t{/* welcome text */}",
            "lineNumber": 100
          },
          {
            "text": "\t\t\t&lt;div className=\"flex flex-row w-full pt-16 px-20 bg-gradient-to-b from-transparent to-[#F9F8F6]\"&gt;",
            "lineNumber": 101
          },
          {
            "text": "\t\t\t\t\t&lt;WordCarousel",
            "lineNumber": 102
          },
          {
            "text": "\t\t\t\t\t\twords={[&#96;${t(\"layout.welcome\")}, ${welcomeName} !&#96;]}",
            "lineNumber": 103
          },
          {
            "text": "\t\t\t\t\t\tclassName=\"text-heading-xl font-bold tracking-tight\"",
            "lineNumber": 104
          },
          {
            "text": "\t\t\t\t\t\trotateIntervalMs={100}",
            "lineNumber": 105
          },
          {
            "text": "\t\t\t\t\t\tsweepDurationMs={2000}",
            "lineNumber": 106
          },
          {
            "text": "\t\t\t\t\t\tsweepOnce",
            "lineNumber": 107
          },
          {
            "text": "\t\t\t\t\t\tgradient={&#96;linear-gradient(in oklch 90deg,",
            "lineNumber": 108
          },
          {
            "text": "\t\t\t\t\t\t\t#f9f8f6 0%, var(--colors-blue-300) 30%,",
            "lineNumber": 109
          },
          {
            "text": "\t\t\t\t\t\t\tvar(--colors-emerald-default) 50%, ",
            "lineNumber": 110
          },
          {
            "text": "\t\t\t\t\t\t\tvar(--colors-green-500) 70%,",
            "lineNumber": 111
          },
          {
            "text": "\t\t\t\t\t\t\tvar(--colors-orange-300) 100%)&#96;}",
            "lineNumber": 112
          },
          {
            "text": "\t\t\t\t\t\tariaLabel=\"rotating headline\"",
            "lineNumber": 113
          },
          {
            "text": "\t\t\t\t\t/&gt;",
            "lineNumber": 114
          },
          {
            "text": "\t\t\t&lt;/div&gt;",
            "lineNumber": 115
          },
          {
            "text": "\t\t\t{/* Navbar */}",
            "lineNumber": 116
          },
          {
            "text": "\t\t&lt;div",
            "lineNumber": 117
          },
          {
            "text": "\t\t\tclassName={&#96;sticky top-0 z-20 flex flex-col justify-between items-center bg-[#F9F8F6] px-20 pt-10 pb-4 border-border-disabled border-x-0 border-t-0 border-solid&#96;}",
            "lineNumber": 118
          },
          {
            "text": "\t\t&gt;",
            "lineNumber": 119
          },
          {
            "text": "\t\t\t\t&lt;div className=\"flex flex-row justify-between items-center w-full mx-auto",
            "lineNumber": 120
          },
          {
            "text": "}",
            "lineNumber": 141,
            "isSignature": true
          }
        ]
      },
      "score": 0.26279181241989136
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\General.tsx",
        "range": {
          "startPosition": {
            "line": 27,
            "column": 62
          },
          "endPosition": {
            "line": 234,
            "column": 1
          }
        },
        "contents": "export default function SettingGeneral() {\n\tconst { t } = useTranslation();\n\tconst authStore = useAuthStore();\n\n\tconst resetInstallation = useInstallationStore(state =&gt; state.reset);\n\tconst setNeedsBackendRestart = useInstallationStore(state =&gt; state.setNeedsBackendRestart);\n\n\tconst navigate = useNavigate();\n\tconst [isLoading, setIsLoading] = useState(false);\n\tconst setAppearance = authStore.setAppearance;\n\tconst language = authStore.language;\n\tconst setLanguage = authStore.setLanguage;\n\tconst appearance = authStore.appearance;\n\tconst fullNameRef: RefObject&lt;HTMLInputElement&gt; = createRef();\n\tconst nickNameRef: RefObject&lt;HTMLInputElement&gt; = createRef();\n\tconst workDescRef: RefObject&lt;HTMLInputElement&gt; = createRef();\n\t//Get Chatstore for the active project's task\n\tconst { chatStore } = useChatStoreAdapter();\n\tif (!chatStore) {\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\t\n\n\tconst [themeList, setThemeList] = useState&lt;any&gt;([\n\t\t{\n\t\t\timg: light,\n\t\t\tlabel: \"setting.light\",\n\t\t\tvalue: \"light\",\n\t\t},\n\t\t{\n\t\t\timg: transparent,\n\t\t\tlabel: \"setting.transparent\",\n\t\t\tvalue: \"transparent\",\n\t\t},\n\t]);\n\n\tconst languageList = [\n\t\t{\n\t\t\tkey: LocaleEnum.English,\n\t\t\tlabel: \"English\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.SimplifiedChinese,\n\t\t\tlabel: \"简体中文\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.TraditionalChinese,\n\t\t\tlabel: \"繁體中文\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.Japanese,\n\t\t\tlabel: \"日本語\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.Arabic,\n\t\t\tlabel: \"العربية\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.French,\n\t\t\tlabel: \"Français\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.German,\n\t\t\tlabel: \"Deutsch\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.Russian,\n\t\t\tlabel: \"Русский\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.Spanish,\n\t\t\tlabel: \"Español\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.Korean,\n\t\t\tlabel: \"한국어\",\n\t\t},\n\t\t{\n\t\t\tkey: LocaleEnum.Italian,\n\t\t\tlabel: \"Italiano\",\n\t\t},\n\t];\n\n\tuseEffect(() =&gt; {\n\t\tconst platform = window.electronAPI.getPlatform();\n\t}\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function SettingGeneral() {",
            "lineNumber": 30,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 31
          },
          {
            "text": "\tconst authStore = useAuthStore();",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "text": "\tconst resetInstallation = useInstallationStore(state =&gt; state.reset);",
            "lineNumber": 34
          },
          {
            "text": "\tconst setNeedsBackendRestart = useInstallationStore(state =&gt; state.setNeedsBackendRestart);",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 37
          },
          {
            "text": "\tconst [isLoading, setIsLoading] = useState(false);",
            "lineNumber": 38
          },
          {
            "text": "\tconst setAppearance = authStore.setAppearance;",
            "lineNumber": 39
          },
          {
            "text": "\tconst language = authStore.language;",
            "lineNumber": 40
          },
          {
            "text": "\tconst setLanguage = authStore.setLanguage;",
            "lineNumber": 41
          },
          {
            "text": "\tconst appearance = authStore.appearance;",
            "lineNumber": 42
          },
          {
            "text": "\tconst fullNameRef: RefObject&lt;HTMLInputElement&gt; = createRef();",
            "lineNumber": 43
          },
          {
            "text": "\tconst nickNameRef: RefObject&lt;HTMLInputElement&gt; = createRef();",
            "lineNumber": 44
          },
          {
            "text": "\tconst workDescRef: RefObject&lt;HTMLInputElement&gt; = createRef();",
            "lineNumber": 45
          },
          {
            "text": "\t//Get Chatstore for the active project's task",
            "lineNumber": 46
          },
          {
            "text": "\tconst { chatStore } = useChatStoreAdapter();",
            "lineNumber": 47
          },
          {
            "text": "\tif (!chatStore) {",
            "lineNumber": 48
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 49
          },
          {
            "text": "\t}",
            "lineNumber": 50
          },
          {
            "text": "\t",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "\tconst [themeList, setThemeList] = useState&lt;any&gt;([",
            "lineNumber": 53
          },
          {
            "text": "\t\t{",
            "lineNumber": 54
          },
          {
            "text": "\t\t\timg: light,",
            "lineNumber": 55
          },
          {
            "text": "\t\t\tlabel: \"setting.light\",",
            "lineNumber": 56
          },
          {
            "text": "\t\t\tvalue: \"light\",",
            "lineNumber": 57
          },
          {
            "text": "\t\t},",
            "lineNumber": 58
          },
          {
            "text": "\t\t{",
            "lineNumber": 59
          },
          {
            "text": "\t\t\timg: transparent,",
            "lineNumber": 60
          },
          {
            "text": "\t\t\tlabel: \"setting.transparent\",",
            "lineNumber": 61
          },
          {
            "text": "\t\t\tvalue: \"transparent\",",
            "lineNumber": 62
          },
          {
            "text": "\t\t},",
            "lineNumber": 63
          },
          {
            "text": "\t]);",
            "lineNumber": 64
          },
          {
            "lineNumber": 65
          },
          {
            "text": "\tconst languageList = [",
            "lineNumber": 66
          },
          {
            "text": "\t\t{",
            "lineNumber": 67
          },
          {
            "text": "\t\t\tkey: LocaleEnum.English,",
            "lineNumber": 68
          },
          {
            "text": "\t\t\tlabel: \"English\",",
            "lineNumber": 69
          },
          {
            "text": "\t\t},",
            "lineNumber": 70
          },
          {
            "text": "\t\t{",
            "lineNumber": 71
          },
          {
            "text": "\t\t\tkey: LocaleEnum.SimplifiedChinese,",
            "lineNumber": 72
          },
          {
            "text": "\t\t\tlabel: \"简体中文\",",
            "lineNumber": 73
          },
          {
            "text": "\t\t},",
            "lineNumber": 74
          },
          {
            "text": "\t\t{",
            "lineNumber": 75
          },
          {
            "text": "\t\t\tkey: LocaleEnum.TraditionalChinese,",
            "lineNumber": 76
          },
          {
            "text": "\t\t\tlabel: \"繁體中文\",",
            "lineNumber": 77
          },
          {
            "text": "\t\t},",
            "lineNumber": 78
          },
          {
            "text": "\t\t{",
            "lineNumber": 79
          },
          {
            "text": "\t\t\tkey: LocaleEnum.Japanese,",
            "lineNumber": 80
          },
          {
            "text": "\t\t\tlabel: \"日本語\",",
            "lineNumber": 81
          },
          {
            "text": "\t\t},",
            "lineNumber": 82
          },
          {
            "text": "\t\t{",
            "lineNumber": 83
          },
          {
            "text": "\t\t\tkey: LocaleEnum.Arabic,",
            "lineNumber": 84
          },
          {
            "text": "\t\t\tlabel: \"العربية\",",
            "lineNumber": 85
          },
          {
            "text": "\t\t},",
            "lineNumber": 86
          },
          {
            "text": "\t\t{",
            "lineNumber": 87
          },
          {
            "text": "\t\t\tkey: LocaleEnum.French,",
            "lineNumber": 88
          },
          {
            "text": "\t\t\tlabel: \"Français\",",
            "lineNumber": 89
          },
          {
            "text": "\t\t},",
            "lineNumber": 90
          },
          {
            "text": "\t\t{",
            "lineNumber": 91
          },
          {
            "text": "\t\t\tkey: LocaleEnum.German,",
            "lineNumber": 92
          },
          {
            "text": "\t\t\tlabel: \"Deutsch\",",
            "lineNumber": 93
          },
          {
            "text": "\t\t},",
            "lineNumber": 94
          },
          {
            "text": "\t\t{",
            "lineNumber": 95
          },
          {
            "text": "\t\t\tkey: LocaleEnum.Russian,",
            "lineNumber": 96
          },
          {
            "text": "\t\t\tlabel: \"Русский\",",
            "lineNumber": 97
          },
          {
            "text": "\t\t},",
            "lineNumber": 98
          },
          {
            "text": "\t\t{",
            "lineNumber": 99
          },
          {
            "text": "\t\t\tkey: LocaleEnum.Spanish,",
            "lineNumber": 100
          },
          {
            "text": "\t\t\tlabel: \"Español\",",
            "lineNumber": 101
          },
          {
            "text": "\t\t},",
            "lineNumber": 102
          },
          {
            "text": "\t\t{",
            "lineNumber": 103
          },
          {
            "text": "\t\t\tkey: LocaleEnum.Korean,",
            "lineNumber": 104
          },
          {
            "text": "\t\t\tlabel: \"한국어\",",
            "lineNumber": 105
          },
          {
            "text": "\t\t},",
            "lineNumber": 106
          },
          {
            "text": "\t\t{",
            "lineNumber": 107
          },
          {
            "text": "\t\t\tkey: LocaleEnum.Italian,",
            "lineNumber": 108
          },
          {
            "text": "\t\t\tlabel: \"Italiano\",",
            "lineNumber": 109
          },
          {
            "text": "\t\t},",
            "lineNumber": 110
          },
          {
            "text": "\t];",
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 113
          },
          {
            "text": "\t\tconst platform = window.electronAPI.getPlatform();",
            "lineNumber": 114
          },
          {
            "text": "\t}",
            "lineNumber": 138
          },
          {
            "text": "}",
            "lineNumber": 235,
            "isSignature": true
          }
        ]
      },
      "score": 0.26059940457344055
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\MCP.tsx",
        "range": {
          "startPosition": {
            "column": 57
          },
          "endPosition": {
            "line": 807,
            "column": 1
          }
        },
        "contents": "import {\n\tproxyFetchGet,\n\tproxyFetchDelete,\n\tproxyFetchPost,\n\tproxyFetchPut,\n\tfetchPost,\n\tfetchGet,\n} from \"@/api/http\";\nimport MCPList from \"./components/MCPList\";\nimport MCPConfigDialog from \"./components/MCPConfigDialog\";\nimport MCPAddDialog from \"./components/MCPAddDialog\";\nimport MCPDeleteDialog from \"./components/MCPDeleteDialog\";\nimport SearchEngineConfigDialog from \"./components/SearchEngineConfigDialog\";\nimport { parseArgsToArray, arrayToArgsJson } from \"./components/utils\";\nimport type { MCPUserItem, MCPConfigForm } from \"./components/types\";\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronDown, ChevronUp, Plus, Store, ChevronLeft } from \"lucide-react\";\nimport SearchInput from \"@/components/SearchInput\";\nimport { useNavigate } from \"react-router-dom\";\nimport IntegrationList from \"@/components/IntegrationList\";\nimport { getProxyBaseURL } from \"@/lib\";\nimport { useAuthStore } from \"@/store/authStore\";\nimport { useTranslation } from \"react-i18next\";\nimport MCPMarket from \"./MCPMarket\";\n\nimport { toast } from \"sonner\";\nimport { ConfigFile } from \"electron/main/utils/mcpConfig\";\nimport { SelectItem, SelectItemWithButton } from \"@/components/ui/select\";\nimport { Tag as TagComponent } from \"@/components/ui/tag\";\n\nexport default function SettingMCP() {\n\tconst navigate = useNavigate();\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import {",
            "lineNumber": 2
          },
          {
            "text": "\tproxyFetchGet,",
            "lineNumber": 3
          },
          {
            "text": "\tproxyFetchDelete,",
            "lineNumber": 4
          },
          {
            "text": "\tproxyFetchPost,",
            "lineNumber": 5
          },
          {
            "text": "\tproxyFetchPut,",
            "lineNumber": 6
          },
          {
            "text": "\tfetchPost,",
            "lineNumber": 7
          },
          {
            "text": "\tfetchGet,",
            "lineNumber": 8
          },
          {
            "text": "} from \"@/api/http\";",
            "lineNumber": 9
          },
          {
            "text": "import MCPList from \"./components/MCPList\";",
            "lineNumber": 10
          },
          {
            "text": "import MCPConfigDialog from \"./components/MCPConfigDialog\";",
            "lineNumber": 11
          },
          {
            "text": "import MCPAddDialog from \"./components/MCPAddDialog\";",
            "lineNumber": 12
          },
          {
            "text": "import MCPDeleteDialog from \"./components/MCPDeleteDialog\";",
            "lineNumber": 13
          },
          {
            "text": "import SearchEngineConfigDialog from \"./components/SearchEngineConfigDialog\";",
            "lineNumber": 14
          },
          {
            "text": "import { parseArgsToArray, arrayToArgsJson } from \"./components/utils\";",
            "lineNumber": 15
          },
          {
            "text": "import type { MCPUserItem, MCPConfigForm } from \"./components/types\";",
            "lineNumber": 16
          },
          {
            "text": "import { Button } from \"@/components/ui/button\";",
            "lineNumber": 17
          },
          {
            "text": "import { ChevronDown, ChevronUp, Plus, Store, ChevronLeft } from \"lucide-react\";",
            "lineNumber": 18
          },
          {
            "text": "import SearchInput from \"@/components/SearchInput\";",
            "lineNumber": 19
          },
          {
            "text": "import { useNavigate } from \"react-router-dom\";",
            "lineNumber": 20
          },
          {
            "text": "import IntegrationList from \"@/components/IntegrationList\";",
            "lineNumber": 21
          },
          {
            "text": "import { getProxyBaseURL } from \"@/lib\";",
            "lineNumber": 22
          },
          {
            "text": "import { useAuthStore } from \"@/store/authStore\";",
            "lineNumber": 23
          },
          {
            "text": "import { useTranslation } from \"react-i18next\";",
            "lineNumber": 24
          },
          {
            "text": "import MCPMarket from \"./MCPMarket\";",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "import { toast } from \"sonner\";",
            "lineNumber": 27
          },
          {
            "text": "import { ConfigFile } from \"electron/main/utils/mcpConfig\";",
            "lineNumber": 28
          },
          {
            "text": "import { SelectItem, SelectItemWithButton } from \"@/components/ui/select\";",
            "lineNumber": 29
          },
          {
            "text": "import { Tag as TagComponent } from \"@/components/ui/tag\";",
            "lineNumber": 30
          },
          {
            "lineNumber": 31
          },
          {
            "text": "export default function SettingMCP() {",
            "lineNumber": 32,
            "isSignature": true
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 33
          },
          {
            "text": "}",
            "lineNumber": 808,
            "isSignature": true
          }
        ]
      },
      "score": 0.2595818042755127
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\TopBar\\index.tsx",
        "range": {
          "startPosition": {
            "line": 40
          },
          "endPosition": {
            "line": 421,
            "column": 1
          }
        },
        "contents": "function HeaderWin() {\n\n\n\t//TODO: Mark ChatStore details as completed\n\tconst handleEndProject = async () =&gt; {\n\t\tconst taskId = chatStore.activeTaskId;\n\t\tconst projectId = projectStore.activeProjectId;\n\n\t\tif (!taskId) {\n\t\t\ttoast.error(t(\"layout.no-active-project-to-end\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst historyId = projectId ? projectStore.getHistoryId(projectId) : null;\n\n\t\ttry {\n\t\t\tconst task = chatStore.tasks[taskId];\n\n\t\t\t// Stop the task if it's running\n\t\t\tif (task &amp;&amp; task.status === 'running') {\n\t\t\t\tawait fetchPut(&#96;/task/${taskId}/take-control&#96;, {\n\t\t\t\t\taction: 'stop',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Stop Workforce\n\t\t\ttry {\n\t\t\t\tawait fetchDelete(&#96;/chat/${projectId}&#96;);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(\"Task may not exist on backend:\", error);\n\t\t\t}\n\n\t\t\t// Delete from history using historyId\n\t\t\tif (historyId &amp;&amp; task.status !== \"finished\") {\n\t\t\t\ttry {\n\t\t\t\t\tawait proxyFetchDelete(&#96;/api/chat/history/${historyId}&#96;);\n\t\t\t\t\t// Remove from local store\n\t\t\t\t\tchatStore.removeTask(taskId);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log(\"History may not exist:\", error);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"No historyId found for project or task finished, skipping history deletion\");\n\t\t\t}\n\n\n\t\t\t// Create a completely new project instead of just a new task\n\t\t\t// This ensures we start fresh without any residual state\n\t\t\tprojectStore.createProject(\"new project\");\n\n\t\t\t// Navigate to home with replace to force refresh\n\t\t\tnavigate(\"/\", { replace: true });\n\n\t\t\ttoast.success(t(\"layout.project-ended-successfully\"), {\n\t\t\t\tcloseButton: true,\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Failed to end project:\", error);\n\t\t\ttoast.error(t(\"layout.failed-to-end-project\"), {\n\t\t\t\tcloseButton: true,\n\t\t\t});\n\t\t} finally {\n\t\t\tsetEndDialogOpen(false);\n\t\t}\n\t};\n\n\tconst handleShare = async (taskId: string) =&gt; {\n\t\tshare(taskId);\n\t};\n\n\treturn (\n\t\t&lt;div\n\t\t\tclassName=\"absolute top-0 left-0 right-0 flex !h-9 items-center justify-between pl-2 py-1 z-50 \n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 41,
                "column": 1
              },
              "endPosition": {
                "line": 42,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "function HeaderWin() {",
            "lineNumber": 41,
            "isSignature": true
          },
          {
            "lineNumber": 146
          },
          {
            "lineNumber": 147
          },
          {
            "text": "\t//TODO: Mark ChatStore details as completed",
            "lineNumber": 148
          },
          {
            "text": "\tconst handleEndProject = async () =&gt; {",
            "lineNumber": 149
          },
          {
            "text": "\t\tconst taskId = chatStore.activeTaskId;",
            "lineNumber": 150
          },
          {
            "text": "\t\tconst projectId = projectStore.activeProjectId;",
            "lineNumber": 151
          },
          {
            "lineNumber": 152
          },
          {
            "text": "\t\tif (!taskId) {",
            "lineNumber": 153
          },
          {
            "text": "\t\t\ttoast.error(t(\"layout.no-active-project-to-end\"));",
            "lineNumber": 154
          },
          {
            "text": "\t\t\treturn;",
            "lineNumber": 155
          },
          {
            "text": "\t\t}",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "\t\tconst historyId = projectId ? projectStore.getHistoryId(projectId) : null;",
            "lineNumber": 158
          },
          {
            "lineNumber": 159
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 160
          },
          {
            "text": "\t\t\tconst task = chatStore.tasks[taskId];",
            "lineNumber": 161
          },
          {
            "lineNumber": 162
          },
          {
            "text": "\t\t\t// Stop the task if it's running",
            "lineNumber": 163
          },
          {
            "text": "\t\t\tif (task &amp;&amp; task.status === 'running') {",
            "lineNumber": 164
          },
          {
            "text": "\t\t\t\tawait fetchPut(&#96;/task/${taskId}/take-control&#96;, {",
            "lineNumber": 165
          },
          {
            "text": "\t\t\t\t\taction: 'stop',",
            "lineNumber": 166
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 167
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 168
          },
          {
            "lineNumber": 169
          },
          {
            "text": "\t\t\t// Stop Workforce",
            "lineNumber": 170
          },
          {
            "text": "\t\t\ttry {",
            "lineNumber": 171
          },
          {
            "text": "\t\t\t\tawait fetchDelete(&#96;/chat/${projectId}&#96;);",
            "lineNumber": 172
          },
          {
            "text": "\t\t\t} catch (error) {",
            "lineNumber": 173
          },
          {
            "text": "\t\t\t\tconsole.log(\"Task may not exist on backend:\", error);",
            "lineNumber": 174
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 175
          },
          {
            "lineNumber": 176
          },
          {
            "text": "\t\t\t// Delete from history using historyId",
            "lineNumber": 177
          },
          {
            "text": "\t\t\tif (historyId &amp;&amp; task.status !== \"finished\") {",
            "lineNumber": 178
          },
          {
            "text": "\t\t\t\ttry {",
            "lineNumber": 179
          },
          {
            "text": "\t\t\t\t\tawait proxyFetchDelete(&#96;/api/chat/history/${historyId}&#96;);",
            "lineNumber": 180
          },
          {
            "text": "\t\t\t\t\t// Remove from local store",
            "lineNumber": 181
          },
          {
            "text": "\t\t\t\t\tchatStore.removeTask(taskId);",
            "lineNumber": 182
          },
          {
            "text": "\t\t\t\t} catch (error) {",
            "lineNumber": 183
          },
          {
            "text": "\t\t\t\t\tconsole.log(\"History may not exist:\", error);",
            "lineNumber": 184
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 185
          },
          {
            "text": "\t\t\t} else {",
            "lineNumber": 186
          },
          {
            "text": "\t\t\t\tconsole.warn(\"No historyId found for project or task finished, skipping history deletion\");",
            "lineNumber": 187
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 188
          },
          {
            "lineNumber": 189
          },
          {
            "lineNumber": 190
          },
          {
            "text": "\t\t\t// Create a completely new project instead of just a new task",
            "lineNumber": 191
          },
          {
            "text": "\t\t\t// This ensures we start fresh without any residual state",
            "lineNumber": 192
          },
          {
            "text": "\t\t\tprojectStore.createProject(\"new project\");",
            "lineNumber": 193
          },
          {
            "lineNumber": 194
          },
          {
            "text": "\t\t\t// Navigate to home with replace to force refresh",
            "lineNumber": 195
          },
          {
            "text": "\t\t\tnavigate(\"/\", { replace: true });",
            "lineNumber": 196
          },
          {
            "lineNumber": 197
          },
          {
            "text": "\t\t\ttoast.success(t(\"layout.project-ended-successfully\"), {",
            "lineNumber": 198
          },
          {
            "text": "\t\t\t\tcloseButton: true,",
            "lineNumber": 199
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 200
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 201
          },
          {
            "text": "\t\t\tconsole.error(\"Failed to end project:\", error);",
            "lineNumber": 202
          },
          {
            "text": "\t\t\ttoast.error(t(\"layout.failed-to-end-project\"), {",
            "lineNumber": 203
          },
          {
            "text": "\t\t\t\tcloseButton: true,",
            "lineNumber": 204
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 205
          },
          {
            "text": "\t\t} finally {",
            "lineNumber": 206
          },
          {
            "text": "\t\t\tsetEndDialogOpen(false);",
            "lineNumber": 207
          },
          {
            "text": "\t\t}",
            "lineNumber": 208
          },
          {
            "text": "\t};",
            "lineNumber": 209
          },
          {
            "lineNumber": 210
          },
          {
            "text": "\tconst handleShare = async (taskId: string) =&gt; {",
            "lineNumber": 211
          },
          {
            "text": "\t\tshare(taskId);",
            "lineNumber": 212
          },
          {
            "text": "\t};",
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "\treturn (",
            "lineNumber": 215
          },
          {
            "text": "\t\t&lt;div",
            "lineNumber": 216
          },
          {
            "text": "\t\t\tclassName=\"absolute top-0 left-0 right-0 flex !h-9 items-center justify-between pl-2 py-1 z-50 ",
            "lineNumber": 217
          },
          {
            "text": "}",
            "lineNumber": 422,
            "isSignature": true
          }
        ]
      },
      "score": 0.25928783416748047
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\n\n  useEffect(() =&gt; {\n    proxyFetchGet('/api/user/privacy')\n      .then((res) =&gt; {\n        let _privacy = 0;\n        Object.keys(res).forEach((key) =&gt; {\n          if (!res[key]) {\n            _privacy++;\n            return;\n          }\n        });\n        setPrivacy(_privacy === 0 ? true : false);\n      })\n      .catch((err) =&gt; console.error('Failed to fetch settings:', err))\n      .finally(() =&gt; setIsPrivacyLoaded(true));\n\n    proxyFetchGet('/api/configs')\n      .then((configsRes) =&gt; {\n        const configs = Array.isArray(configsRes) ? configsRes : [];\n        const _hasApiKey = configs.find(\n          (item) =&gt; item.config_name === 'GOOGLE_API_KEY'\n        );\n        const _hasApiId = configs.find(\n          (item) =&gt; item.config_name === 'SEARCH_ENGINE_ID'\n        );\n        if (_hasApiKey &amp;&amp; _hasApiId) setHasSearchKey(true);\n      })\n      .catch((err) =&gt; console.error('Failed to fetch configs:', err));\n\n    checkModelConfig();\n  }, [modelType, checkModelConfig]);\n\n  // Re-check model config when returning from settings page\n  useEffect(() =&gt; {\n    // Check when location changes (user navigates)\n    if (location.pathname === '/' &amp;&amp; privacy) {\n      checkModelConfig();\n    }\n  }, [location.pathname, privacy, checkModelConfig]);\n\n  // Also check when window gains focus (user returns from settings)\n  useEffect(() =&gt; {\n    const handleFocus = () =&gt; {\n      if (privacy) {\n        checkModelConfig();\n      }\n    };\n\n    window.addEventListener('focus', handleFocus);\n    return () =&gt; {\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, [privacy, checkModelConfig]);\n\n  // Refresh privacy status when dialog closes\n  // useEffect(() =&gt; {\n  // \tif (!privacyDialogOpen) {\n  // \t\tproxyFetchGet(\"/api/user/privacy\")\n  // \t\t\t.then((res) =&gt; {\n  // \t\t\t\tlet _privacy = 0;\n  // \t\t\t\tObject.keys(res).forEach((key) =&gt; {\n  // \t\t\t\t\tif (!res[key]) {\n  // \t\t\t\t\t\t_privacy++;\n  // \t\t\t\t\t\treturn;\n  // \t\t\t\t\t}\n  // \t\t\t\t});\n  // \t\t\t\tsetPrivacy(_privacy === 0 ? true : false);\n  // \t\t\t})\n  // \t\t\t.catch((err) =&gt; console.error(\"Failed to fetch settings:\", err));\n  // \t}\n  // }, [privacyDialogOpen]);\n  const [searchParams] = useSearchParams();\n  const share_token = searchParams.get('share_token');\n\n  const handleSend = async (messageStr?: string, taskId?: string) =&gt;\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 78
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 79
          },
          {
            "text": "    proxyFetchGet('/api/user/privacy')",
            "lineNumber": 80
          },
          {
            "text": "      .then((res) =&gt; {",
            "lineNumber": 81
          },
          {
            "text": "        let _privacy = 0;",
            "lineNumber": 82
          },
          {
            "text": "        Object.keys(res).forEach((key) =&gt; {",
            "lineNumber": 83
          },
          {
            "text": "          if (!res[key]) {",
            "lineNumber": 84
          },
          {
            "text": "            _privacy++;",
            "lineNumber": 85
          },
          {
            "text": "            return;",
            "lineNumber": 86
          },
          {
            "text": "          }",
            "lineNumber": 87
          },
          {
            "text": "        });",
            "lineNumber": 88
          },
          {
            "text": "        setPrivacy(_privacy === 0 ? true : false);",
            "lineNumber": 89
          },
          {
            "text": "      })",
            "lineNumber": 90
          },
          {
            "text": "      .catch((err) =&gt; console.error('Failed to fetch settings:', err))",
            "lineNumber": 91
          },
          {
            "text": "      .finally(() =&gt; setIsPrivacyLoaded(true));",
            "lineNumber": 92
          },
          {
            "lineNumber": 93
          },
          {
            "text": "    proxyFetchGet('/api/configs')",
            "lineNumber": 94
          },
          {
            "text": "      .then((configsRes) =&gt; {",
            "lineNumber": 95
          },
          {
            "text": "        const configs = Array.isArray(configsRes) ? configsRes : [];",
            "lineNumber": 96
          },
          {
            "text": "        const _hasApiKey = configs.find(",
            "lineNumber": 97
          },
          {
            "text": "          (item) =&gt; item.config_name === 'GOOGLE_API_KEY'",
            "lineNumber": 98
          },
          {
            "text": "        );",
            "lineNumber": 99
          },
          {
            "text": "        const _hasApiId = configs.find(",
            "lineNumber": 100
          },
          {
            "text": "          (item) =&gt; item.config_name === 'SEARCH_ENGINE_ID'",
            "lineNumber": 101
          },
          {
            "text": "        );",
            "lineNumber": 102
          },
          {
            "text": "        if (_hasApiKey &amp;&amp; _hasApiId) setHasSearchKey(true);",
            "lineNumber": 103
          },
          {
            "text": "      })",
            "lineNumber": 104
          },
          {
            "text": "      .catch((err) =&gt; console.error('Failed to fetch configs:', err));",
            "lineNumber": 105
          },
          {
            "lineNumber": 106
          },
          {
            "text": "    checkModelConfig();",
            "lineNumber": 107
          },
          {
            "text": "  }, [modelType, checkModelConfig]);",
            "lineNumber": 108
          },
          {
            "lineNumber": 109
          },
          {
            "text": "  // Re-check model config when returning from settings page",
            "lineNumber": 110
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 111
          },
          {
            "text": "    // Check when location changes (user navigates)",
            "lineNumber": 112
          },
          {
            "text": "    if (location.pathname === '/' &amp;&amp; privacy) {",
            "lineNumber": 113
          },
          {
            "text": "      checkModelConfig();",
            "lineNumber": 114
          },
          {
            "text": "    }",
            "lineNumber": 115
          },
          {
            "text": "  }, [location.pathname, privacy, checkModelConfig]);",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "  // Also check when window gains focus (user returns from settings)",
            "lineNumber": 118
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 119
          },
          {
            "text": "    const handleFocus = () =&gt; {",
            "lineNumber": 120
          },
          {
            "text": "      if (privacy) {",
            "lineNumber": 121
          },
          {
            "text": "        checkModelConfig();",
            "lineNumber": 122
          },
          {
            "text": "      }",
            "lineNumber": 123
          },
          {
            "text": "    };",
            "lineNumber": 124
          },
          {
            "lineNumber": 125
          },
          {
            "text": "    window.addEventListener('focus', handleFocus);",
            "lineNumber": 126
          },
          {
            "text": "    return () =&gt; {",
            "lineNumber": 127
          },
          {
            "text": "      window.removeEventListener('focus', handleFocus);",
            "lineNumber": 128
          },
          {
            "text": "    };",
            "lineNumber": 129
          },
          {
            "text": "  }, [privacy, checkModelConfig]);",
            "lineNumber": 130
          },
          {
            "lineNumber": 131
          },
          {
            "text": "  // Refresh privacy status when dialog closes",
            "lineNumber": 132
          },
          {
            "text": "  // useEffect(() =&gt; {",
            "lineNumber": 133
          },
          {
            "text": "  // \tif (!privacyDialogOpen) {",
            "lineNumber": 134
          },
          {
            "text": "  // \t\tproxyFetchGet(\"/api/user/privacy\")",
            "lineNumber": 135
          },
          {
            "text": "  // \t\t\t.then((res) =&gt; {",
            "lineNumber": 136
          },
          {
            "text": "  // \t\t\t\tlet _privacy = 0;",
            "lineNumber": 137
          },
          {
            "text": "  // \t\t\t\tObject.keys(res).forEach((key) =&gt; {",
            "lineNumber": 138
          },
          {
            "text": "  // \t\t\t\t\tif (!res[key]) {",
            "lineNumber": 139
          },
          {
            "text": "  // \t\t\t\t\t\t_privacy++;",
            "lineNumber": 140
          },
          {
            "text": "  // \t\t\t\t\t\treturn;",
            "lineNumber": 141
          },
          {
            "text": "  // \t\t\t\t\t}",
            "lineNumber": 142
          },
          {
            "text": "  // \t\t\t\t});",
            "lineNumber": 143
          },
          {
            "text": "  // \t\t\t\tsetPrivacy(_privacy === 0 ? true : false);",
            "lineNumber": 144
          },
          {
            "text": "  // \t\t\t})",
            "lineNumber": 145
          },
          {
            "text": "  // \t\t\t.catch((err) =&gt; console.error(\"Failed to fetch settings:\", err));",
            "lineNumber": 146
          },
          {
            "text": "  // \t}",
            "lineNumber": 147
          },
          {
            "text": "  // }, [privacyDialogOpen]);",
            "lineNumber": 148
          },
          {
            "text": "  const [searchParams] = useSearchParams();",
            "lineNumber": 149
          },
          {
            "text": "  const share_token = searchParams.get('share_token');",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "  const handleSend = async (messageStr?: string, taskId?: string) =&gt;",
            "lineNumber": 152
          },
          {
            "text": ";",
            "lineNumber": 389
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.2555696964263916
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\API.tsx",
        "range": {
          "startPosition": {
            "line": 10,
            "column": 1
          },
          "endPosition": {
            "line": 109,
            "column": 1
          }
        },
        "contents": "export default function SettingAPI() {\n\tconst { t } = useTranslation();\n\tconst [items, setItems] = useState&lt;ConfigItem[]&gt;([]);\n\tconst [envValues, setEnvValues] = useState&lt;Record&lt;string, string&gt;&gt;({});\n\tconst [loading, setLoading] = useState&lt;Record&lt;string, boolean&gt;&gt;({});\n\tconst [errors, setErrors] = useState&lt;Record&lt;string, string&gt;&gt;({});\n\n\tuseEffect(() =&gt; {\n\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {\n\t\t\tconst configs = Object.entries(res || {})\n\t\t\t\t.map(([name, v]: [string, any]) =&gt; ({ name, env_vars: v.env_vars }))\n\t\t\t\t.filter((item) =&gt; Array.isArray(item.env_vars) &amp;&amp; item.env_vars.length &gt; 0);\n\t\t\tsetItems(configs);\n\t\t});\n\t\tproxyFetchGet(\"/api/configs\").then((res) =&gt; {\n\t\t\tif (Array.isArray(res)) {\n\t\t\t\tconst envMap: Record&lt;string, string&gt; = {};\n\t\t\t\tres.forEach((item: any) =&gt; {\n\t\t\t\t\tif (item.config_name &amp;&amp; item.config_value) {\n\t\t\t\t\t\tenvMap[item.config_name] = item.config_value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsetEnvValues(envMap);\n\t\t\t}\n\t\t});\n\t}, []);\n\n\tconst handleInputChange = (env: string, value: string) =&gt; {\n\t\tsetEnvValues((prev) =&gt; ({ ...prev, [env]: value }));\n\t};\n\n\tconst handleVerify = async (configGroup: string, env: string) =&gt; {\n\t\tconst value = envValues[env] || \"\";\n\t\tif (!value.trim()) {\n\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: t(\"layout.env-should-not-empty\") }));\n\t\t\treturn;\n\t\t} else {\n\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: \"\" }));\n\t\t}\n\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: true }));\n\t\ttry {\n\t\t\tawait proxyFetchPost(\"/api/configs\", {\n\t\t\t\tconfig_name: env,\n\t\t\t\tconfig_value: value,\n\t\t\t\tconfig_group: configGroup,\n\t\t\t});\n\t\t} catch (e) {\n\t\t} finally {\n\t\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: false }));\n\t\t}\n\t};\n\n\treturn (\n\t\t&lt;div className=\"space-y-8\"&gt;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function SettingAPI() {",
            "lineNumber": 13,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 14
          },
          {
            "text": "\tconst [items, setItems] = useState&lt;ConfigItem[]&gt;([]);",
            "lineNumber": 15
          },
          {
            "text": "\tconst [envValues, setEnvValues] = useState&lt;Record&lt;string, string&gt;&gt;({});",
            "lineNumber": 16
          },
          {
            "text": "\tconst [loading, setLoading] = useState&lt;Record&lt;string, boolean&gt;&gt;({});",
            "lineNumber": 17
          },
          {
            "text": "\tconst [errors, setErrors] = useState&lt;Record&lt;string, string&gt;&gt;({});",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 20
          },
          {
            "text": "\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {",
            "lineNumber": 21
          },
          {
            "text": "\t\t\tconst configs = Object.entries(res || {})",
            "lineNumber": 22
          },
          {
            "text": "\t\t\t\t.map(([name, v]: [string, any]) =&gt; ({ name, env_vars: v.env_vars }))",
            "lineNumber": 23
          },
          {
            "text": "\t\t\t\t.filter((item) =&gt; Array.isArray(item.env_vars) &amp;&amp; item.env_vars.length &gt; 0);",
            "lineNumber": 24
          },
          {
            "text": "\t\t\tsetItems(configs);",
            "lineNumber": 25
          },
          {
            "text": "\t\t});",
            "lineNumber": 26
          },
          {
            "text": "\t\tproxyFetchGet(\"/api/configs\").then((res) =&gt; {",
            "lineNumber": 27
          },
          {
            "text": "\t\t\tif (Array.isArray(res)) {",
            "lineNumber": 28
          },
          {
            "text": "\t\t\t\tconst envMap: Record&lt;string, string&gt; = {};",
            "lineNumber": 29
          },
          {
            "text": "\t\t\t\tres.forEach((item: any) =&gt; {",
            "lineNumber": 30
          },
          {
            "text": "\t\t\t\t\tif (item.config_name &amp;&amp; item.config_value) {",
            "lineNumber": 31
          },
          {
            "text": "\t\t\t\t\t\tenvMap[item.config_name] = item.config_value;",
            "lineNumber": 32
          },
          {
            "text": "\t\t\t\t\t}",
            "lineNumber": 33
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 34
          },
          {
            "text": "\t\t\t\tsetEnvValues(envMap);",
            "lineNumber": 35
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 36
          },
          {
            "text": "\t\t});",
            "lineNumber": 37
          },
          {
            "text": "\t}, []);",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "\tconst handleInputChange = (env: string, value: string) =&gt; {",
            "lineNumber": 40
          },
          {
            "text": "\t\tsetEnvValues((prev) =&gt; ({ ...prev, [env]: value }));",
            "lineNumber": 41
          },
          {
            "text": "\t};",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "\tconst handleVerify = async (configGroup: string, env: string) =&gt; {",
            "lineNumber": 44
          },
          {
            "text": "\t\tconst value = envValues[env] || \"\";",
            "lineNumber": 45
          },
          {
            "text": "\t\tif (!value.trim()) {",
            "lineNumber": 46
          },
          {
            "text": "\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: t(\"layout.env-should-not-empty\") }));",
            "lineNumber": 47
          },
          {
            "text": "\t\t\treturn;",
            "lineNumber": 48
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 49
          },
          {
            "text": "\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: \"\" }));",
            "lineNumber": 50
          },
          {
            "text": "\t\t}",
            "lineNumber": 51
          },
          {
            "text": "\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: true }));",
            "lineNumber": 52
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 53
          },
          {
            "text": "\t\t\tawait proxyFetchPost(\"/api/configs\", {",
            "lineNumber": 54
          },
          {
            "text": "\t\t\t\tconfig_name: env,",
            "lineNumber": 55
          },
          {
            "text": "\t\t\t\tconfig_value: value,",
            "lineNumber": 56
          },
          {
            "text": "\t\t\t\tconfig_group: configGroup,",
            "lineNumber": 57
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 58
          },
          {
            "text": "\t\t} catch (e) {",
            "lineNumber": 59
          },
          {
            "text": "\t\t} finally {",
            "lineNumber": 60
          },
          {
            "text": "\t\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: false }));",
            "lineNumber": 61
          },
          {
            "text": "\t\t}",
            "lineNumber": 62
          },
          {
            "text": "\t};",
            "lineNumber": 63
          },
          {
            "lineNumber": 64
          },
          {
            "text": "\treturn (",
            "lineNumber": 65
          },
          {
            "text": "\t\t&lt;div className=\"space-y-8\"&gt;",
            "lineNumber": 66
          },
          {
            "text": "}",
            "lineNumber": 110,
            "isSignature": true
          }
        ]
      },
      "score": 0.25064799189567566
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\package\\@stackframe\\react\\dist\\components-page\\account-settings.js",
        "range": {
          "startPosition": {
            "line": 43,
            "column": 4
          },
          "endPosition": {
            "line": 131,
            "column": 1
          }
        },
        "contents": "Icon = \n;\n};\nfunction AccountSettings(props) {\n  const { t } = (0, import_translations.useTranslation)();\n  const user = (0, import__.useUser)({ or: \"redirect\" });\n  const teams = user.useTeams();\n  const stackApp = (0, import__.useStackApp)();\n  const project = stackApp.useProject();\n  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_maybe_full_page.MaybeFullPage, { fullPage: !!props.fullPage, children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(\"div\", { className: \"self-stretch flex-grow w-full\", children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(\n    import_sidebar_layout.SidebarLayout,\n    {\n      items: [\n        {\n          title: t(\"My Profile\"),\n          type: \"item\",\n          id: \"profile\",\n          icon: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Icon, { name: \"Contact\" }),\n          content: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_profile_page.ProfilePage, {})\n        },\n        {\n          title: t(\"Emails &amp; Auth\"),\n          type: \"item\",\n          id: \"auth\",\n          icon: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Icon, { name: \"ShieldCheck\" }),\n          content: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react.Suspense, { fallback: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(EmailsAndAuthPageSkeleton, {}), children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_email_and_auth_page.EmailsAndAuthPage, {}) })\n        },\n        {\n          title: t(\"Active Sessions\"),\n          type: \"item\",\n          id: \"sessions\",\n          icon: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Icon, { name: \"Monitor\" }),\n          content: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react.Suspense, { fallback: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(ActiveSessionsPageSkeleton, {}), children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_active_sessions_page.ActiveSessionsPage, {}) })\n        },\n        ...project.config.allowUserApiKeys ? [{\n          title: t(\"API Keys\"),\n          type: \"item\",\n          id: \"api-keys\"\n\n\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "Icon = ",
            "lineNumber": 44
          },
          {
            "text": ";",
            "lineNumber": 46
          },
          {
            "text": "};",
            "lineNumber": 47
          },
          {
            "text": "function AccountSettings(props) {",
            "lineNumber": 48,
            "isSignature": true
          },
          {
            "text": "  const { t } = (0, import_translations.useTranslation)();",
            "lineNumber": 49
          },
          {
            "text": "  const user = (0, import__.useUser)({ or: \"redirect\" });",
            "lineNumber": 50
          },
          {
            "text": "  const teams = user.useTeams();",
            "lineNumber": 51
          },
          {
            "text": "  const stackApp = (0, import__.useStackApp)();",
            "lineNumber": 52
          },
          {
            "text": "  const project = stackApp.useProject();",
            "lineNumber": 53
          },
          {
            "text": "  return /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_maybe_full_page.MaybeFullPage, { fullPage: !!props.fullPage, children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(\"div\", { className: \"self-stretch flex-grow w-full\", children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(",
            "lineNumber": 54
          },
          {
            "text": "    import_sidebar_layout.SidebarLayout,",
            "lineNumber": 55
          },
          {
            "text": "    {",
            "lineNumber": 56
          },
          {
            "text": "      items: [",
            "lineNumber": 57
          },
          {
            "text": "        {",
            "lineNumber": 58
          },
          {
            "text": "          title: t(\"My Profile\"),",
            "lineNumber": 59
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 60
          },
          {
            "text": "          id: \"profile\",",
            "lineNumber": 61
          },
          {
            "text": "          icon: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Icon, { name: \"Contact\" }),",
            "lineNumber": 62
          },
          {
            "text": "          content: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_profile_page.ProfilePage, {})",
            "lineNumber": 63
          },
          {
            "text": "        },",
            "lineNumber": 64
          },
          {
            "text": "        {",
            "lineNumber": 65
          },
          {
            "text": "          title: t(\"Emails &amp; Auth\"),",
            "lineNumber": 66
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 67
          },
          {
            "text": "          id: \"auth\",",
            "lineNumber": 68
          },
          {
            "text": "          icon: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Icon, { name: \"ShieldCheck\" }),",
            "lineNumber": 69
          },
          {
            "text": "          content: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react.Suspense, { fallback: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(EmailsAndAuthPageSkeleton, {}), children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_email_and_auth_page.EmailsAndAuthPage, {}) })",
            "lineNumber": 70
          },
          {
            "text": "        },",
            "lineNumber": 71
          },
          {
            "text": "        {",
            "lineNumber": 72
          },
          {
            "text": "          title: t(\"Active Sessions\"),",
            "lineNumber": 73
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 74
          },
          {
            "text": "          id: \"sessions\",",
            "lineNumber": 75
          },
          {
            "text": "          icon: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(Icon, { name: \"Monitor\" }),",
            "lineNumber": 76
          },
          {
            "text": "          content: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_react.Suspense, { fallback: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(ActiveSessionsPageSkeleton, {}), children: /* @__PURE__ */ (0, import_jsx_runtime.jsx)(import_active_sessions_page.ActiveSessionsPage, {}) })",
            "lineNumber": 77
          },
          {
            "text": "        },",
            "lineNumber": 78
          },
          {
            "text": "        ...project.config.allowUserApiKeys ? [{",
            "lineNumber": 79
          },
          {
            "text": "          title: t(\"API Keys\"),",
            "lineNumber": 80
          },
          {
            "text": "          type: \"item\",",
            "lineNumber": 81
          },
          {
            "text": "          id: \"api-keys\"",
            "lineNumber": 82
          },
          {
            "lineNumber": 128
          },
          {
            "lineNumber": 131
          },
          {
            "text": "}",
            "lineNumber": 132,
            "isSignature": true
          }
        ]
      },
      "score": 0.25028806924819946
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

