<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session c5053b96-a348-4d74-8e34-e78d32ceea7a (2026-01-19 09:07Z) -->

# Esbuild 45-377 reference (2026-01-19 09:07Z)

_**User**_

@esbuild (45-377) 

---

_**Agent (model default, mode Agent)**_


ÂæåÁ´ØÂõûÂÇ≥ 404ÔºåÂÅ•Â∫∑Ê™¢Êü•Ë´ãÊ±ÇÂ§±Êïó„ÄÇÊ™¢Êü•ÂâçÁ´ØÂ¶Ç‰ΩïÂëºÂè´ÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÔºå‰ª•ÂèäÂæåÁ´ØË∑ØÁî±Ë®≠ÂÆö„ÄÇ


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** ‚Ä¢ Read file: d:\_Code\_GitHub\eigent-260119\src\api\http.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "health check endpoint route registration with api prefix",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\app\\router.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 63
          }
        },
        "contents": "\"\"\"\nCentralized router registration for the Eigent API.\nAll routers are explicitly registered here for better visibility and maintainability.\n\"\"\"\nfrom fastapi import FastAPI\nfrom app.controller import chat_controller, model_controller, task_controller, tool_controller, health_controller\nfrom utils import traceroot_wrapper as traceroot\n\nlogger = traceroot.get_logger(\"router\")\n\n\ndef register_routers(app: FastAPI, prefix: str = \"\") -&gt; None:\n    \"\"\"\n    Register all API routers with their respective prefixes and tags.\n    \n    This replaces the auto-discovery mechanism for better:\n    - Visibility: See all routes in one place\n    - Maintainability: Easy to add/remove routes\n    - Debugging: Clear registration order and configuration\n    \n    Args:\n        app: FastAPI application instance\n        prefix: Optional global prefix for all routes (e.g., \"/api\")\n    \"\"\"\n    routers_config = [\n        {\n            \"router\": health_controller.router,\n            \"tags\": [\"Health\"],\n            \"description\": \"Health check endpoint for service readiness\"\n        },\n        {\n            \"router\": chat_controller.router,\n            \"tags\": [\"chat\"],\n            \"description\": \"Chat session management, improvements, and human interactions\"\n        },\n        {\n            \"router\": model_controller.router,\n            \"tags\": [\"model\"],\n            \"description\": \"Model validation and configuration\"\n        },\n        {\n            \"router\": task_controller.router,\n            \"tags\": [\"task\"],\n            \"description\": \"Task lifecycle management (start, stop, update, control)\"\n        },\n        {\n            \"router\": tool_controller.router,\n            \"tags\": [\"tool\"], \n            \"description\": \"Tool installation and management\"\n        },\n    ]\n    \n    for config in routers_config:",
        "signatures": {},
        "detailedLines": [
          {
            "text": "\"\"\"",
            "lineNumber": 1
          },
          {
            "text": "Centralized router registration for the Eigent API.",
            "lineNumber": 2
          },
          {
            "text": "All routers are explicitly registered here for better visibility and maintainability.",
            "lineNumber": 3
          },
          {
            "text": "\"\"\"",
            "lineNumber": 4
          },
          {
            "text": "from fastapi import FastAPI",
            "lineNumber": 5
          },
          {
            "text": "from app.controller import chat_controller, model_controller, task_controller, tool_controller, health_controller",
            "lineNumber": 6
          },
          {
            "text": "from utils import traceroot_wrapper as traceroot",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "logger = traceroot.get_logger(\"router\")",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "def register_routers(app: FastAPI, prefix: str = \"\") -&gt; None:",
            "lineNumber": 12,
            "isSignature": true
          },
          {
            "text": "    \"\"\"",
            "lineNumber": 13
          },
          {
            "text": "    Register all API routers with their respective prefixes and tags.",
            "lineNumber": 14
          },
          {
            "text": "    ",
            "lineNumber": 15
          },
          {
            "text": "    This replaces the auto-discovery mechanism for better:",
            "lineNumber": 16
          },
          {
            "text": "    - Visibility: See all routes in one place",
            "lineNumber": 17
          },
          {
            "text": "    - Maintainability: Easy to add/remove routes",
            "lineNumber": 18
          },
          {
            "text": "    - Debugging: Clear registration order and configuration",
            "lineNumber": 19
          },
          {
            "text": "    ",
            "lineNumber": 20
          },
          {
            "text": "    Args:",
            "lineNumber": 21
          },
          {
            "text": "        app: FastAPI application instance",
            "lineNumber": 22
          },
          {
            "text": "        prefix: Optional global prefix for all routes (e.g., \"/api\")",
            "lineNumber": 23
          },
          {
            "text": "    \"\"\"",
            "lineNumber": 24
          },
          {
            "text": "    routers_config = [",
            "lineNumber": 25
          },
          {
            "text": "        {",
            "lineNumber": 26
          },
          {
            "text": "            \"router\": health_controller.router,",
            "lineNumber": 27
          },
          {
            "text": "            \"tags\": [\"Health\"],",
            "lineNumber": 28
          },
          {
            "text": "            \"description\": \"Health check endpoint for service readiness\"",
            "lineNumber": 29
          },
          {
            "text": "        },",
            "lineNumber": 30
          },
          {
            "text": "        {",
            "lineNumber": 31
          },
          {
            "text": "            \"router\": chat_controller.router,",
            "lineNumber": 32
          },
          {
            "text": "            \"tags\": [\"chat\"],",
            "lineNumber": 33
          },
          {
            "text": "            \"description\": \"Chat session management, improvements, and human interactions\"",
            "lineNumber": 34
          },
          {
            "text": "        },",
            "lineNumber": 35
          },
          {
            "text": "        {",
            "lineNumber": 36
          },
          {
            "text": "            \"router\": model_controller.router,",
            "lineNumber": 37
          },
          {
            "text": "            \"tags\": [\"model\"],",
            "lineNumber": 38
          },
          {
            "text": "            \"description\": \"Model validation and configuration\"",
            "lineNumber": 39
          },
          {
            "text": "        },",
            "lineNumber": 40
          },
          {
            "text": "        {",
            "lineNumber": 41
          },
          {
            "text": "            \"router\": task_controller.router,",
            "lineNumber": 42
          },
          {
            "text": "            \"tags\": [\"task\"],",
            "lineNumber": 43
          },
          {
            "text": "            \"description\": \"Task lifecycle management (start, stop, update, control)\"",
            "lineNumber": 44
          },
          {
            "text": "        },",
            "lineNumber": 45
          },
          {
            "text": "        {",
            "lineNumber": 46
          },
          {
            "text": "            \"router\": tool_controller.router,",
            "lineNumber": 47
          },
          {
            "text": "            \"tags\": [\"tool\"], ",
            "lineNumber": 48
          },
          {
            "text": "            \"description\": \"Tool installation and management\"",
            "lineNumber": 49
          },
          {
            "text": "        },",
            "lineNumber": 50
          },
          {
            "text": "    ]",
            "lineNumber": 51
          },
          {
            "text": "    ",
            "lineNumber": 52
          },
          {
            "text": "    for config in routers_config:",
            "lineNumber": 53
          }
        ]
      },
      "score": 0.5277746915817261
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\app\\controller\\health_controller.py",
        "range": {
          "startPosition": {
            "line": 11,
            "column": 16
          },
          "endPosition": {
            "line": 20,
            "column": 19
          }
        },
        "contents": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)\nasync def health_check():\n    \"\"\"Health check endpoint for verifying backend is ready to accept requests.\"\"\"\n    logger.debug(\"Health check requested\")\n    response = HealthResponse(status=\"ok\", service=\"eigent\")\n    logger.debug(\"Health check completed\", extra={\"status\": response.status, \"service\": response.service})\n    return response",
        "signatures": {},
        "detailedLines": [
          {
            "text": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)",
            "lineNumber": 15
          },
          {
            "text": "async def health_check():",
            "lineNumber": 16,
            "isSignature": true
          },
          {
            "text": "    \"\"\"Health check endpoint for verifying backend is ready to accept requests.\"\"\"",
            "lineNumber": 17
          },
          {
            "text": "    logger.debug(\"Health check requested\")",
            "lineNumber": 18
          },
          {
            "text": "    response = HealthResponse(status=\"ok\", service=\"eigent\")",
            "lineNumber": 19
          },
          {
            "text": "    logger.debug(\"Health check completed\", extra={\"status\": response.status, \"service\": response.service})",
            "lineNumber": 20
          },
          {
            "text": "    return response",
            "lineNumber": 21,
            "isSignature": true
          }
        ]
      },
      "score": 0.4481000304222107
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\app\\controller\\health_controller.py",
        "range": {
          "startPosition": {
            "line": 8,
            "column": 16
          },
          "endPosition": {
            "line": 14,
            "column": 63
          }
        },
        "contents": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)\nasync def health_check():\n    \"\"\"Health check endpoint for monitoring and container orchestration.\"\"\"\n    return HealthResponse(status=\"ok\", service=\"eigent-server\")",
        "signatures": {},
        "detailedLines": [
          {
            "text": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)",
            "lineNumber": 12
          },
          {
            "text": "async def health_check():",
            "lineNumber": 13,
            "isSignature": true
          },
          {
            "text": "    \"\"\"Health check endpoint for monitoring and container orchestration.\"\"\"",
            "lineNumber": 14
          },
          {
            "text": "    return HealthResponse(status=\"ok\", service=\"eigent-server\")",
            "lineNumber": 15,
            "isSignature": true
          }
        ]
      },
      "score": 0.4456123113632202
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\main.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 56,
            "column": 47
          }
        },
        "contents": "import os\nimport sys\nimport pathlib\nimport signal\nimport asyncio\nimport atexit\n\n# Add project root to Python path to import shared utils\n_project_root = pathlib.Path(__file__).parent.parent\nif str(_project_root) not in sys.path:\n    sys.path.insert(0, str(_project_root))\n\n# 1) Load env and init traceroot BEFORE importing modules that get a logger\nfrom utils import traceroot_wrapper as traceroot\nfrom app import api\n\n# Only initialize traceroot if enabled\nif traceroot.is_enabled():\n    from traceroot.integrations.fastapi import connect_fastapi\n    connect_fastapi(api)\n\n# 2) Now safe to import modules that use traceroot.get_logger() at import-time\nfrom app.component.environment import env\nfrom app.router import register_routers\n\n\nos.environ[\"PYTHONIOENCODING\"] = \"utf-8\"\n\napp_logger = traceroot.get_logger(\"main\")\n\n# Log application startup\napp_logger.info(\"Starting Eigent Multi-Agent System API\")\napp_logger.info(f\"Python encoding: {os.environ.get('PYTHONIOENCODING')}\")\napp_logger.info(f\"Environment: {os.environ.get('ENVIRONMENT', 'development')}\")\n\nprefix = env(\"url_prefix\", \"\")\napp_logger.info(f\"Loading routers with prefix: '{prefix}'\")\nregister_routers(api, prefix)\napp_logger.info(\"All routers loaded successfully\")\n\n# Check if debug mode is enabled via environment variable\nif os.environ.get('ENABLE_PYTHON_DEBUG') == 'true':\n    try:\n        import debugpy\n        DEBUG_PORT = int(os.environ.get('DEBUG_PORT', '5678'))\n        app_logger.info(f\"Debug mode enabled - Starting debugpy server on port {DEBUG_PORT}\")\n        debugpy.listen((\"localhost\", DEBUG_PORT))\n        app_logger.info(f\"Debugger ready for attachment on localhost:{DEBUG_PORT}\")\n        #üìù In VS Code: Run 'Debug Python Backend (Attach)' configuration\n        # Don't wait for client automatically - let it attach when ready\n    except ImportError:\n        app_logger.warning(\"debugpy not available, install with: uv add debugpy\")\n    except Exception as e:\n        app_logger.error(f\"Failed to start debugpy: {e}\")\n\n\ndir = pathlib.Path(__file__).parent / \"runtime\"",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import os",
            "lineNumber": 1
          },
          {
            "text": "import sys",
            "lineNumber": 2
          },
          {
            "text": "import pathlib",
            "lineNumber": 3
          },
          {
            "text": "import signal",
            "lineNumber": 4
          },
          {
            "text": "import asyncio",
            "lineNumber": 5
          },
          {
            "text": "import atexit",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "# Add project root to Python path to import shared utils",
            "lineNumber": 8
          },
          {
            "text": "_project_root = pathlib.Path(__file__).parent.parent",
            "lineNumber": 9
          },
          {
            "text": "if str(_project_root) not in sys.path:",
            "lineNumber": 10
          },
          {
            "text": "    sys.path.insert(0, str(_project_root))",
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "# 1) Load env and init traceroot BEFORE importing modules that get a logger",
            "lineNumber": 13
          },
          {
            "text": "from utils import traceroot_wrapper as traceroot",
            "lineNumber": 14
          },
          {
            "text": "from app import api",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "# Only initialize traceroot if enabled",
            "lineNumber": 17
          },
          {
            "text": "if traceroot.is_enabled():",
            "lineNumber": 18
          },
          {
            "text": "    from traceroot.integrations.fastapi import connect_fastapi",
            "lineNumber": 19
          },
          {
            "text": "    connect_fastapi(api)",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "text": "# 2) Now safe to import modules that use traceroot.get_logger() at import-time",
            "lineNumber": 22
          },
          {
            "text": "from app.component.environment import env",
            "lineNumber": 23
          },
          {
            "text": "from app.router import register_routers",
            "lineNumber": 24
          },
          {
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "os.environ[\"PYTHONIOENCODING\"] = \"utf-8\"",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "app_logger = traceroot.get_logger(\"main\")",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "# Log application startup",
            "lineNumber": 31
          },
          {
            "text": "app_logger.info(\"Starting Eigent Multi-Agent System API\")",
            "lineNumber": 32
          },
          {
            "text": "app_logger.info(f\"Python encoding: {os.environ.get('PYTHONIOENCODING')}\")",
            "lineNumber": 33
          },
          {
            "text": "app_logger.info(f\"Environment: {os.environ.get('ENVIRONMENT', 'development')}\")",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "prefix = env(\"url_prefix\", \"\")",
            "lineNumber": 36
          },
          {
            "text": "app_logger.info(f\"Loading routers with prefix: '{prefix}'\")",
            "lineNumber": 37
          },
          {
            "text": "register_routers(api, prefix)",
            "lineNumber": 38
          },
          {
            "text": "app_logger.info(\"All routers loaded successfully\")",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "# Check if debug mode is enabled via environment variable",
            "lineNumber": 41
          },
          {
            "text": "if os.environ.get('ENABLE_PYTHON_DEBUG') == 'true':",
            "lineNumber": 42
          },
          {
            "text": "    try:",
            "lineNumber": 43
          },
          {
            "text": "        import debugpy",
            "lineNumber": 44
          },
          {
            "text": "        DEBUG_PORT = int(os.environ.get('DEBUG_PORT', '5678'))",
            "lineNumber": 45
          },
          {
            "text": "        app_logger.info(f\"Debug mode enabled - Starting debugpy server on port {DEBUG_PORT}\")",
            "lineNumber": 46
          },
          {
            "text": "        debugpy.listen((\"localhost\", DEBUG_PORT))",
            "lineNumber": 47
          },
          {
            "text": "        app_logger.info(f\"Debugger ready for attachment on localhost:{DEBUG_PORT}\")",
            "lineNumber": 48
          },
          {
            "text": "        #üìù In VS Code: Run 'Debug Python Backend (Attach)' configuration",
            "lineNumber": 49
          },
          {
            "text": "        # Don't wait for client automatically - let it attach when ready",
            "lineNumber": 50
          },
          {
            "text": "    except ImportError:",
            "lineNumber": 51
          },
          {
            "text": "        app_logger.warning(\"debugpy not available, install with: uv add debugpy\")",
            "lineNumber": 52
          },
          {
            "text": "    except Exception as e:",
            "lineNumber": 53
          },
          {
            "text": "        app_logger.error(f\"Failed to start debugpy: {e}\")",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "lineNumber": 56
          },
          {
            "text": "dir = pathlib.Path(__file__).parent / \"runtime\"",
            "lineNumber": 57
          }
        ]
      },
      "score": 0.44128894805908203
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\main.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 46,
            "column": 84
          }
        },
        "contents": "import os\nimport sys\nimport pathlib\n\n# Add project root to Python path to import shared utils\n_project_root = pathlib.Path(__file__).parent.parent\nif str(_project_root) not in sys.path:\n    sys.path.insert(0, str(_project_root))\n\nfrom utils import traceroot_wrapper as traceroot\nfrom app import api\nfrom app.component.environment import auto_include_routers, env\nfrom fastapi.staticfiles import StaticFiles\n\n# Import middleware to register BabelMiddleware\nimport app.middleware  # noqa: F401\n\n# Import exception handlers to register them\nimport app.exception.handler  # noqa: F401\n\n# Only initialize traceroot if enabled\nif traceroot.is_enabled():\n    from traceroot.integrations.fastapi import connect_fastapi\n\n    connect_fastapi(api)\n\nlogger = traceroot.get_logger(\"server_main\")\n\nprefix = env(\"url_prefix\", \"\")\nauto_include_routers(api, prefix, \"app/controller\")\npublic_dir = os.environ.get(\"PUBLIC_DIR\") or os.path.join(\n    os.path.dirname(__file__), \"app\", \"public\"\n)\nif not os.path.isdir(public_dir):\n    try:\n        os.makedirs(public_dir, exist_ok=True)\n        logger.warning(f\"Public directory did not exist. Created: {public_dir}\")\n    except Exception as e:\n        logger.error(\n            f\"Public directory missing and could not be created: {public_dir}. Error: {e}\"\n        )\n        public_dir = None\n\nif public_dir and os.path.isdir(public_dir):\n    api.mount(\"/public\", StaticFiles(directory=public_dir), name=\"public\")\nelse:\n    logger.warning(\"Skipping /public mount because public directory is unavailable\")",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import os",
            "lineNumber": 1
          },
          {
            "text": "import sys",
            "lineNumber": 2
          },
          {
            "text": "import pathlib",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "# Add project root to Python path to import shared utils",
            "lineNumber": 5
          },
          {
            "text": "_project_root = pathlib.Path(__file__).parent.parent",
            "lineNumber": 6
          },
          {
            "text": "if str(_project_root) not in sys.path:",
            "lineNumber": 7
          },
          {
            "text": "    sys.path.insert(0, str(_project_root))",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "from utils import traceroot_wrapper as traceroot",
            "lineNumber": 10
          },
          {
            "text": "from app import api",
            "lineNumber": 11
          },
          {
            "text": "from app.component.environment import auto_include_routers, env",
            "lineNumber": 12
          },
          {
            "text": "from fastapi.staticfiles import StaticFiles",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "# Import middleware to register BabelMiddleware",
            "lineNumber": 15
          },
          {
            "text": "import app.middleware  # noqa: F401",
            "lineNumber": 16
          },
          {
            "lineNumber": 17
          },
          {
            "text": "# Import exception handlers to register them",
            "lineNumber": 18
          },
          {
            "text": "import app.exception.handler  # noqa: F401",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "# Only initialize traceroot if enabled",
            "lineNumber": 21
          },
          {
            "text": "if traceroot.is_enabled():",
            "lineNumber": 22
          },
          {
            "text": "    from traceroot.integrations.fastapi import connect_fastapi",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "    connect_fastapi(api)",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "logger = traceroot.get_logger(\"server_main\")",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "prefix = env(\"url_prefix\", \"\")",
            "lineNumber": 29
          },
          {
            "text": "auto_include_routers(api, prefix, \"app/controller\")",
            "lineNumber": 30
          },
          {
            "text": "public_dir = os.environ.get(\"PUBLIC_DIR\") or os.path.join(",
            "lineNumber": 31
          },
          {
            "text": "    os.path.dirname(__file__), \"app\", \"public\"",
            "lineNumber": 32
          },
          {
            "text": ")",
            "lineNumber": 33
          },
          {
            "text": "if not os.path.isdir(public_dir):",
            "lineNumber": 34
          },
          {
            "text": "    try:",
            "lineNumber": 35
          },
          {
            "text": "        os.makedirs(public_dir, exist_ok=True)",
            "lineNumber": 36
          },
          {
            "text": "        logger.warning(f\"Public directory did not exist. Created: {public_dir}\")",
            "lineNumber": 37
          },
          {
            "text": "    except Exception as e:",
            "lineNumber": 38
          },
          {
            "text": "        logger.error(",
            "lineNumber": 39
          },
          {
            "text": "            f\"Public directory missing and could not be created: {public_dir}. Error: {e}\"",
            "lineNumber": 40
          },
          {
            "text": "        )",
            "lineNumber": 41
          },
          {
            "text": "        public_dir = None",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "if public_dir and os.path.isdir(public_dir):",
            "lineNumber": 44
          },
          {
            "text": "    api.mount(\"/public\", StaticFiles(directory=public_dir), name=\"public\")",
            "lineNumber": 45
          },
          {
            "text": "else:",
            "lineNumber": 46
          },
          {
            "text": "    logger.warning(\"Skipping /public mount because public directory is unavailable\")",
            "lineNumber": 47
          }
        ]
      },
      "score": 0.4341822862625122
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 2077
          },
          "endPosition": {
            "line": 2131
          }
        },
        "contents": "{\n  \"filePath\": \"D:\\\\_Code\\\\_GitHub\\\\eigent-260119\\\\backend\\\\app\\\\router.py\"\n}\n&#96;&#96;&#96;\n**Output:**\n&#96;&#96;&#96;\n&lt;file&gt;\n00001| \"\"\"\n00002| Centralized router registration for the Eigent API.\n00003| All routers are explicitly registered here for better visibility and maintainability.\n00004| \"\"\"\n00005| from fastapi import FastAPI\n00006| from app.controller import chat_controller, model_controller, task_controller, tool_controller, health_controller\n00007| from utils import traceroot_wrapper as traceroot\n00008| \n00009| logger = traceroot.get_logger(\"router\")\n00010| \n00011| \n00012| def register_routers(app: FastAPI, prefix: str = \"\") -&gt; None:\n00013|     \"\"\"\n00014|     Register all API routers with their respective prefixes and tags.\n00015|     \n00016|     This replaces the auto-discovery mechanism for better:\n00017|     - Visibility: See all routes in one place\n00018|     - Maintainability: Easy to add/remove routes\n00019|     - Debugging: Clear registration order and configuration\n00020|     \n00021|     Args:\n00022|         app: FastAPI application instance\n00023|         prefix: Optional global prefix for all routes (e.g., \"/api\")\n00024|     \"\"\"\n00025|     routers_config = [\n00026|         {\n00027|             \"router\": health_controller.router,\n00028|             \"tags\": [\"Health\"],\n00029|             \"description\": \"Health check endpoint for service readiness\"\n00030|         },\n00031|         {\n00032|             \"router\": chat_controller.router,\n00033|             \"tags\": [\"chat\"],\n00034|             \"description\": \"Chat session management, improvements, and human interactions\"\n00035|         },\n00036|         {\n00037|             \"router\": model_controller.router,\n00038|             \"tags\": [\"model\"],\n00039|             \"description\": \"Model validation and configuration\"\n00040|         },\n00041|         {\n00042|             \"router\": task_controller.router,\n00043|             \"tags\": [\"task\"],\n00044|             \"description\": \"Task lifecycle management (start, stop, update, control)\"\n00045|         },\n00046|         {\n00047|             \"router\": tool_controller.router,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "{",
            "lineNumber": 2078
          },
          {
            "text": "  \"filePath\": \"D:\\\\_Code\\\\_GitHub\\\\eigent-260119\\\\backend\\\\app\\\\router.py\"",
            "lineNumber": 2079
          },
          {
            "text": "}",
            "lineNumber": 2080
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 2081
          },
          {
            "text": "**Output:**",
            "lineNumber": 2082
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 2083
          },
          {
            "text": "&lt;file&gt;",
            "lineNumber": 2084
          },
          {
            "text": "00001| \"\"\"",
            "lineNumber": 2085
          },
          {
            "text": "00002| Centralized router registration for the Eigent API.",
            "lineNumber": 2086
          },
          {
            "text": "00003| All routers are explicitly registered here for better visibility and maintainability.",
            "lineNumber": 2087
          },
          {
            "text": "00004| \"\"\"",
            "lineNumber": 2088
          },
          {
            "text": "00005| from fastapi import FastAPI",
            "lineNumber": 2089
          },
          {
            "text": "00006| from app.controller import chat_controller, model_controller, task_controller, tool_controller, health_controller",
            "lineNumber": 2090
          },
          {
            "text": "00007| from utils import traceroot_wrapper as traceroot",
            "lineNumber": 2091
          },
          {
            "text": "00008| ",
            "lineNumber": 2092
          },
          {
            "text": "00009| logger = traceroot.get_logger(\"router\")",
            "lineNumber": 2093
          },
          {
            "text": "00010| ",
            "lineNumber": 2094
          },
          {
            "text": "00011| ",
            "lineNumber": 2095
          },
          {
            "text": "00012| def register_routers(app: FastAPI, prefix: str = \"\") -&gt; None:",
            "lineNumber": 2096
          },
          {
            "text": "00013|     \"\"\"",
            "lineNumber": 2097
          },
          {
            "text": "00014|     Register all API routers with their respective prefixes and tags.",
            "lineNumber": 2098
          },
          {
            "text": "00015|     ",
            "lineNumber": 2099
          },
          {
            "text": "00016|     This replaces the auto-discovery mechanism for better:",
            "lineNumber": 2100
          },
          {
            "text": "00017|     - Visibility: See all routes in one place",
            "lineNumber": 2101
          },
          {
            "text": "00018|     - Maintainability: Easy to add/remove routes",
            "lineNumber": 2102
          },
          {
            "text": "00019|     - Debugging: Clear registration order and configuration",
            "lineNumber": 2103
          },
          {
            "text": "00020|     ",
            "lineNumber": 2104
          },
          {
            "text": "00021|     Args:",
            "lineNumber": 2105
          },
          {
            "text": "00022|         app: FastAPI application instance",
            "lineNumber": 2106
          },
          {
            "text": "00023|         prefix: Optional global prefix for all routes (e.g., \"/api\")",
            "lineNumber": 2107
          },
          {
            "text": "00024|     \"\"\"",
            "lineNumber": 2108
          },
          {
            "text": "00025|     routers_config = [",
            "lineNumber": 2109
          },
          {
            "text": "00026|         {",
            "lineNumber": 2110
          },
          {
            "text": "00027|             \"router\": health_controller.router,",
            "lineNumber": 2111
          },
          {
            "text": "00028|             \"tags\": [\"Health\"],",
            "lineNumber": 2112
          },
          {
            "text": "00029|             \"description\": \"Health check endpoint for service readiness\"",
            "lineNumber": 2113
          },
          {
            "text": "00030|         },",
            "lineNumber": 2114
          },
          {
            "text": "00031|         {",
            "lineNumber": 2115
          },
          {
            "text": "00032|             \"router\": chat_controller.router,",
            "lineNumber": 2116
          },
          {
            "text": "00033|             \"tags\": [\"chat\"],",
            "lineNumber": 2117
          },
          {
            "text": "00034|             \"description\": \"Chat session management, improvements, and human interactions\"",
            "lineNumber": 2118
          },
          {
            "text": "00035|         },",
            "lineNumber": 2119
          },
          {
            "text": "00036|         {",
            "lineNumber": 2120
          },
          {
            "text": "00037|             \"router\": model_controller.router,",
            "lineNumber": 2121
          },
          {
            "text": "00038|             \"tags\": [\"model\"],",
            "lineNumber": 2122
          },
          {
            "text": "00039|             \"description\": \"Model validation and configuration\"",
            "lineNumber": 2123
          },
          {
            "text": "00040|         },",
            "lineNumber": 2124
          },
          {
            "text": "00041|         {",
            "lineNumber": 2125
          },
          {
            "text": "00042|             \"router\": task_controller.router,",
            "lineNumber": 2126
          },
          {
            "text": "00043|             \"tags\": [\"task\"],",
            "lineNumber": 2127
          },
          {
            "text": "00044|             \"description\": \"Task lifecycle management (start, stop, update, control)\"",
            "lineNumber": 2128
          },
          {
            "text": "00045|         },",
            "lineNumber": 2129
          },
          {
            "text": "00046|         {",
            "lineNumber": 2130
          },
          {
            "text": "00047|             \"router\": tool_controller.router,",
            "lineNumber": 2131
          }
        ]
      },
      "score": 0.4040446877479553
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\app\\component\\environment.py",
        "range": {
          "startPosition": {
            "line": 119,
            "column": 64
          },
          "endPosition": {
            "line": 153,
            "column": 61
          }
        },
        "contents": "def auto_include_routers(api: FastAPI, prefix: str, directory: str):\n    \"\"\"\n    Automatically scan all modules in the specified directory and register routes\n\n    :param api: FastAPI instance\n    :param prefix: Route prefix\n    :param directory: Directory path to scan\n    \"\"\"\n    # Convert directory to absolute path\n    dir_path = Path(directory).resolve()\n\n    # Traverse all .py files in the directory\n    for root, _, files in os.walk(dir_path):\n        for file_name in files:\n            if file_name.endswith(\"_controller.py\") and not file_name.startswith(\"__\"):\n                # Construct complete file path\n                file_path = Path(root) / file_name\n\n                # Generate module name\n                module_name = file_path.stem\n\n                # Load module using importlib\n                spec = importlib.util.spec_from_file_location(module_name, file_path)\n                if spec is None or spec.loader is None:\n                    continue\n                module = importlib.util.module_from_spec(spec)\n                spec.loader.exec_module(module)\n\n                # Check if router attribute exists in module and is an APIRouter instance\n                router = getattr(module, \"router\", None)\n                if isinstance(router, APIRouter):\n                    api.include_router(router, prefix=prefix)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "def auto_include_routers(api: FastAPI, prefix: str, directory: str):",
            "lineNumber": 123,
            "isSignature": true
          },
          {
            "text": "    \"\"\"",
            "lineNumber": 124
          },
          {
            "text": "    Automatically scan all modules in the specified directory and register routes",
            "lineNumber": 125
          },
          {
            "lineNumber": 126
          },
          {
            "text": "    :param api: FastAPI instance",
            "lineNumber": 127
          },
          {
            "text": "    :param prefix: Route prefix",
            "lineNumber": 128
          },
          {
            "text": "    :param directory: Directory path to scan",
            "lineNumber": 129
          },
          {
            "text": "    \"\"\"",
            "lineNumber": 130
          },
          {
            "text": "    # Convert directory to absolute path",
            "lineNumber": 131
          },
          {
            "text": "    dir_path = Path(directory).resolve()",
            "lineNumber": 132
          },
          {
            "lineNumber": 133
          },
          {
            "text": "    # Traverse all .py files in the directory",
            "lineNumber": 134
          },
          {
            "text": "    for root, _, files in os.walk(dir_path):",
            "lineNumber": 135
          },
          {
            "text": "        for file_name in files:",
            "lineNumber": 136
          },
          {
            "text": "            if file_name.endswith(\"_controller.py\") and not file_name.startswith(\"__\"):",
            "lineNumber": 137
          },
          {
            "text": "                # Construct complete file path",
            "lineNumber": 138
          },
          {
            "text": "                file_path = Path(root) / file_name",
            "lineNumber": 139
          },
          {
            "lineNumber": 140
          },
          {
            "text": "                # Generate module name",
            "lineNumber": 141
          },
          {
            "text": "                module_name = file_path.stem",
            "lineNumber": 142
          },
          {
            "lineNumber": 143
          },
          {
            "text": "                # Load module using importlib",
            "lineNumber": 144
          },
          {
            "text": "                spec = importlib.util.spec_from_file_location(module_name, file_path)",
            "lineNumber": 145
          },
          {
            "text": "                if spec is None or spec.loader is None:",
            "lineNumber": 146
          },
          {
            "text": "                    continue",
            "lineNumber": 147
          },
          {
            "text": "                module = importlib.util.module_from_spec(spec)",
            "lineNumber": 148
          },
          {
            "text": "                spec.loader.exec_module(module)",
            "lineNumber": 149
          },
          {
            "lineNumber": 150
          },
          {
            "text": "                # Check if router attribute exists in module and is an APIRouter instance",
            "lineNumber": 151
          },
          {
            "text": "                router = getattr(module, \"router\", None)",
            "lineNumber": 152
          },
          {
            "text": "                if isinstance(router, APIRouter):",
            "lineNumber": 153
          },
          {
            "text": "                    api.include_router(router, prefix=prefix)",
            "lineNumber": 154,
            "isSignature": true
          }
        ]
      },
      "score": 0.4027704894542694
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\app\\router.py",
        "range": {
          "startPosition": {
            "line": 11
          },
          "endPosition": {
            "line": 63,
            "column": 67
          }
        },
        "contents": "def register_routers(app: FastAPI, prefix: str = \"\") -&gt; None:\n\n        },\n    ]\n    \n    for config in routers_config:\n        app.include_router(\n            config[\"router\"],\n            prefix=prefix,\n            tags=config[\"tags\"]\n        )\n        route_count = len(config[\"router\"].routes)\n        logger.info(\n            f\"Registered {config['tags'][0]} router: {route_count} routes - {config['description']}\"\n        )\n    \n    logger.info(f\"Total routers registered: {len(routers_config)}\")",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 12,
                "column": 1
              },
              "endPosition": {
                "line": 13,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "def register_routers(app: FastAPI, prefix: str = \"\") -&gt; None:",
            "lineNumber": 12,
            "isSignature": true
          },
          {
            "lineNumber": 49
          },
          {
            "text": "        },",
            "lineNumber": 50
          },
          {
            "text": "    ]",
            "lineNumber": 51
          },
          {
            "text": "    ",
            "lineNumber": 52
          },
          {
            "text": "    for config in routers_config:",
            "lineNumber": 53
          },
          {
            "text": "        app.include_router(",
            "lineNumber": 54
          },
          {
            "text": "            config[\"router\"],",
            "lineNumber": 55
          },
          {
            "text": "            prefix=prefix,",
            "lineNumber": 56
          },
          {
            "text": "            tags=config[\"tags\"]",
            "lineNumber": 57
          },
          {
            "text": "        )",
            "lineNumber": 58
          },
          {
            "text": "        route_count = len(config[\"router\"].routes)",
            "lineNumber": 59
          },
          {
            "text": "        logger.info(",
            "lineNumber": 60
          },
          {
            "text": "            f\"Registered {config['tags'][0]} router: {route_count} routes - {config['description']}\"",
            "lineNumber": 61
          },
          {
            "text": "        )",
            "lineNumber": 62
          },
          {
            "text": "    ",
            "lineNumber": 63
          },
          {
            "text": "    logger.info(f\"Total routers registered: {len(routers_config)}\")",
            "lineNumber": 64,
            "isSignature": true
          }
        ]
      },
      "score": 0.39882445335388184
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\app\\controller\\health_controller.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 20
          }
        },
        "contents": "from fastapi import APIRouter\nfrom pydantic import BaseModel\nfrom utils import traceroot_wrapper as traceroot\n\nlogger = traceroot.get_logger(\"health_controller\")\n\nrouter = APIRouter(tags=[\"Health\"])\n\n\nclass HealthResponse(BaseModel):\n    status: str\n    service: str\n\n\n@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)\nasync def health_check():\n    \"\"\"Health check endpoint for verifying backend is ready to accept requests.\"\"\"",
        "signatures": {},
        "detailedLines": [
          {
            "text": "from fastapi import APIRouter",
            "lineNumber": 1
          },
          {
            "text": "from pydantic import BaseModel",
            "lineNumber": 2
          },
          {
            "text": "from utils import traceroot_wrapper as traceroot",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "logger = traceroot.get_logger(\"health_controller\")",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "router = APIRouter(tags=[\"Health\"])",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "class HealthResponse(BaseModel):",
            "lineNumber": 10,
            "isSignature": true
          },
          {
            "text": "    status: str",
            "lineNumber": 11
          },
          {
            "text": "    service: str",
            "lineNumber": 12,
            "isSignature": true
          },
          {
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)",
            "lineNumber": 15
          },
          {
            "text": "async def health_check():",
            "lineNumber": 16,
            "isSignature": true
          },
          {
            "text": "    \"\"\"Health check endpoint for verifying backend is ready to accept requests.\"\"\"",
            "lineNumber": 17
          }
        ]
      },
      "score": 0.3935736417770386
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\app\\controller\\health_controller.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 14
          }
        },
        "contents": "from fastapi import APIRouter\nfrom pydantic import BaseModel\n\nrouter = APIRouter(tags=[\"Health\"])\n\n\nclass HealthResponse(BaseModel):\n    status: str\n    service: str\n\n\n@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)\nasync def health_check():\n    \"\"\"Health check endpoint for monitoring and container orchestration.\"\"\"",
        "signatures": {},
        "detailedLines": [
          {
            "text": "from fastapi import APIRouter",
            "lineNumber": 1
          },
          {
            "text": "from pydantic import BaseModel",
            "lineNumber": 2
          },
          {
            "lineNumber": 3
          },
          {
            "text": "router = APIRouter(tags=[\"Health\"])",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "class HealthResponse(BaseModel):",
            "lineNumber": 7,
            "isSignature": true
          },
          {
            "text": "    status: str",
            "lineNumber": 8
          },
          {
            "text": "    service: str",
            "lineNumber": 9,
            "isSignature": true
          },
          {
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)",
            "lineNumber": 12
          },
          {
            "text": "async def health_check():",
            "lineNumber": 13,
            "isSignature": true
          },
          {
            "text": "    \"\"\"Health check endpoint for monitoring and container orchestration.\"\"\"",
            "lineNumber": 14
          }
        ]
      },
      "score": 0.383713960647583
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 267,
            "column": 1
          },
          "endPosition": {
            "line": 299,
            "column": 3
          }
        },
        "contents": "// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */\nexport async function checkBackendHealth(): Promise&lt;boolean&gt; {\n  try {\n    const baseURL = await getBaseURL();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n\n    const res = await fetch(&#96;${baseURL}/health&#96;, {\n      signal: controller.signal,\n      method: 'GET',\n    });\n\n    clearTimeout(timeoutId);\n    return res.ok;\n  } catch (error) {\n    console.log('[Backend Health Check] Not ready:', error);\n    return false;\n  }\n}\n\n/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 270
          },
          {
            "lineNumber": 271
          },
          {
            "text": "/**",
            "lineNumber": 272
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 273
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 274
          },
          {
            "text": " */",
            "lineNumber": 275
          },
          {
            "text": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {",
            "lineNumber": 276,
            "isSignature": true
          },
          {
            "text": "  try {",
            "lineNumber": 277
          },
          {
            "text": "    const baseURL = await getBaseURL();",
            "lineNumber": 278
          },
          {
            "text": "    const controller = new AbortController();",
            "lineNumber": 279
          },
          {
            "text": "    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 280
          },
          {
            "lineNumber": 281
          },
          {
            "text": "    const res = await fetch(&#96;${baseURL}/health&#96;, {",
            "lineNumber": 282
          },
          {
            "text": "      signal: controller.signal,",
            "lineNumber": 283
          },
          {
            "text": "      method: 'GET',",
            "lineNumber": 284
          },
          {
            "text": "    });",
            "lineNumber": 285
          },
          {
            "lineNumber": 286
          },
          {
            "text": "    clearTimeout(timeoutId);",
            "lineNumber": 287
          },
          {
            "text": "    return res.ok;",
            "lineNumber": 288
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 289
          },
          {
            "text": "    console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 290
          },
          {
            "text": "    return false;",
            "lineNumber": 291
          },
          {
            "text": "  }",
            "lineNumber": 292
          },
          {
            "text": "}",
            "lineNumber": 293,
            "isSignature": true
          },
          {
            "lineNumber": 294
          },
          {
            "text": "/**",
            "lineNumber": 295
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 296
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 297
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 298
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 299
          },
          {
            "text": " */",
            "lineNumber": 300
          }
        ]
      },
      "score": 0.37072429060935974
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\app\\component\\environment.py",
        "range": {
          "startPosition": {
            "line": 72,
            "column": 64
          },
          "endPosition": {
            "line": 139
          }
        },
        "contents": "def auto_include_routers(api: FastAPI, prefix: str, directory: str):\n    \"\"\"\n    Ëá™Âä®Êâ´ÊèèÊåáÂÆöÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊ®°ÂùóÂπ∂Ê≥®ÂÜåË∑ØÁî±\n\n    :param api: FastAPI ÂÆû‰æã\n    :param prefix: Ë∑ØÁî±ÂâçÁºÄ\n    :param directory: Ë¶ÅÊâ´ÊèèÁöÑÁõÆÂΩïË∑ØÂæÑ\n    \"\"\"\n    logger.info(\"Starting automatic router registration\", extra={\n        \"prefix\": prefix,\n        \"directory\": directory\n    })\n\n    # Â∞ÜÁõÆÂΩïËΩ¨Êç¢‰∏∫ÁªùÂØπË∑ØÂæÑ\n    dir_path = Path(directory).resolve()\n    router_count = 0\n\n    # ÈÅçÂéÜÁõÆÂΩï‰∏ãÊâÄÊúâ.pyÊñá‰ª∂\n    for root, _, files in os.walk(dir_path):\n        for file_name in files:\n            if file_name.endswith(\"_controller.py\") and not file_name.startswith(\"__\"):\n                # ÊûÑÈÄ†ÂÆåÊï¥Êñá‰ª∂Ë∑ØÂæÑ\n                file_path = Path(root) / file_name\n\n                logger.debug(\"Processing controller file\", extra={\n                    \"file_name\": file_name,\n                    \"file_path\": str(file_path)\n                })\n\n                # ÁîüÊàêÊ®°ÂùóÂêçÁß∞\n                module_name = file_path.stem\n\n                try:\n                    # ‰ΩøÁî®importlibÂä†ËΩΩÊ®°Âùó\n                    spec",
        "signatures": {},
        "detailedLines": [
          {
            "text": "def auto_include_routers(api: FastAPI, prefix: str, directory: str):",
            "lineNumber": 76,
            "isSignature": true
          },
          {
            "text": "    \"\"\"",
            "lineNumber": 77
          },
          {
            "text": "    Ëá™Âä®Êâ´ÊèèÊåáÂÆöÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊ®°ÂùóÂπ∂Ê≥®ÂÜåË∑ØÁî±",
            "lineNumber": 78
          },
          {
            "lineNumber": 79
          },
          {
            "text": "    :param api: FastAPI ÂÆû‰æã",
            "lineNumber": 80
          },
          {
            "text": "    :param prefix: Ë∑ØÁî±ÂâçÁºÄ",
            "lineNumber": 81
          },
          {
            "text": "    :param directory: Ë¶ÅÊâ´ÊèèÁöÑÁõÆÂΩïË∑ØÂæÑ",
            "lineNumber": 82
          },
          {
            "text": "    \"\"\"",
            "lineNumber": 83
          },
          {
            "text": "    logger.info(\"Starting automatic router registration\", extra={",
            "lineNumber": 84
          },
          {
            "text": "        \"prefix\": prefix,",
            "lineNumber": 85
          },
          {
            "text": "        \"directory\": directory",
            "lineNumber": 86
          },
          {
            "text": "    })",
            "lineNumber": 87
          },
          {
            "lineNumber": 88
          },
          {
            "text": "    # Â∞ÜÁõÆÂΩïËΩ¨Êç¢‰∏∫ÁªùÂØπË∑ØÂæÑ",
            "lineNumber": 89
          },
          {
            "text": "    dir_path = Path(directory).resolve()",
            "lineNumber": 90
          },
          {
            "text": "    router_count = 0",
            "lineNumber": 91
          },
          {
            "lineNumber": 92
          },
          {
            "text": "    # ÈÅçÂéÜÁõÆÂΩï‰∏ãÊâÄÊúâ.pyÊñá‰ª∂",
            "lineNumber": 93
          },
          {
            "text": "    for root, _, files in os.walk(dir_path):",
            "lineNumber": 94
          },
          {
            "text": "        for file_name in files:",
            "lineNumber": 95
          },
          {
            "text": "            if file_name.endswith(\"_controller.py\") and not file_name.startswith(\"__\"):",
            "lineNumber": 96
          },
          {
            "text": "                # ÊûÑÈÄ†ÂÆåÊï¥Êñá‰ª∂Ë∑ØÂæÑ",
            "lineNumber": 97
          },
          {
            "text": "                file_path = Path(root) / file_name",
            "lineNumber": 98
          },
          {
            "lineNumber": 99
          },
          {
            "text": "                logger.debug(\"Processing controller file\", extra={",
            "lineNumber": 100
          },
          {
            "text": "                    \"file_name\": file_name,",
            "lineNumber": 101
          },
          {
            "text": "                    \"file_path\": str(file_path)",
            "lineNumber": 102
          },
          {
            "text": "                })",
            "lineNumber": 103
          },
          {
            "lineNumber": 104
          },
          {
            "text": "                # ÁîüÊàêÊ®°ÂùóÂêçÁß∞",
            "lineNumber": 105
          },
          {
            "text": "                module_name = file_path.stem",
            "lineNumber": 106
          },
          {
            "lineNumber": 107
          },
          {
            "text": "                try:",
            "lineNumber": 108
          },
          {
            "text": "                    # ‰ΩøÁî®importlibÂä†ËΩΩÊ®°Âùó",
            "lineNumber": 109
          },
          {
            "text": "                    spec",
            "lineNumber": 110
          }
        ]
      },
      "score": 0.3706716299057007
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\app\\component\\environment.py",
        "range": {
          "startPosition": {
            "line": 75
          },
          "endPosition": {
            "line": 139,
            "column": 6
          }
        },
        "contents": "def auto_include_routers(api: FastAPI, prefix: str, directory: str):\n\n\n                try:\n                    # ‰ΩøÁî®importlibÂä†ËΩΩÊ®°Âùó\n                    spec = importlib.util.spec_from_file_location(module_name, file_path)\n                    if spec is None or spec.loader is None:\n                        logger.warning(\"Failed to create module spec\", extra={\"file_path\": str(file_path)})\n                        continue\n                    module = importlib.util.module_from_spec(spec)\n                    spec.loader.exec_module(module)\n\n                    # Ê£ÄÊü•Ê®°Âùó‰∏≠ÊòØÂê¶Â≠òÂú®routerÂ±ûÊÄß‰∏îÊòØAPIRouterÂÆû‰æã\n                    router = getattr(module, \"router\", None)\n                    if isinstance(router, APIRouter):\n                        api.include_router(router, prefix=prefix)\n                        router_count += 1\n                        logger.debug(\"Router registered successfully\", extra={\n                            \"module_name\": module_name,\n                            \"prefix\": prefix\n                        })\n                    else:\n                        logger.debug(\"No valid router found in module\", extra={\"module_name\": module_name})\n\n                except Exception as e:\n                    logger.error(\"Failed to load controller module\", extra={\n                        \"module_name\": module_name,\n                        \"file_path\": str(file_path),\n                        \"error\": str(e)\n                    }, exc_info=True)\n\n    logger.info(\"Automatic router registration completed\", extra={\n        \"prefix\": prefix,\n        \"directory\": directory,\n        \"routers_registered\": router_count\n    })",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 76,
                "column": 1
              },
              "endPosition": {
                "line": 77,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "def auto_include_routers(api: FastAPI, prefix: str, directory: str):",
            "lineNumber": 76,
            "isSignature": true
          },
          {
            "lineNumber": 106
          },
          {
            "lineNumber": 107
          },
          {
            "text": "                try:",
            "lineNumber": 108
          },
          {
            "text": "                    # ‰ΩøÁî®importlibÂä†ËΩΩÊ®°Âùó",
            "lineNumber": 109
          },
          {
            "text": "                    spec = importlib.util.spec_from_file_location(module_name, file_path)",
            "lineNumber": 110
          },
          {
            "text": "                    if spec is None or spec.loader is None:",
            "lineNumber": 111
          },
          {
            "text": "                        logger.warning(\"Failed to create module spec\", extra={\"file_path\": str(file_path)})",
            "lineNumber": 112
          },
          {
            "text": "                        continue",
            "lineNumber": 113
          },
          {
            "text": "                    module = importlib.util.module_from_spec(spec)",
            "lineNumber": 114
          },
          {
            "text": "                    spec.loader.exec_module(module)",
            "lineNumber": 115
          },
          {
            "lineNumber": 116
          },
          {
            "text": "                    # Ê£ÄÊü•Ê®°Âùó‰∏≠ÊòØÂê¶Â≠òÂú®routerÂ±ûÊÄß‰∏îÊòØAPIRouterÂÆû‰æã",
            "lineNumber": 117
          },
          {
            "text": "                    router = getattr(module, \"router\", None)",
            "lineNumber": 118
          },
          {
            "text": "                    if isinstance(router, APIRouter):",
            "lineNumber": 119
          },
          {
            "text": "                        api.include_router(router, prefix=prefix)",
            "lineNumber": 120
          },
          {
            "text": "                        router_count += 1",
            "lineNumber": 121
          },
          {
            "text": "                        logger.debug(\"Router registered successfully\", extra={",
            "lineNumber": 122
          },
          {
            "text": "                            \"module_name\": module_name,",
            "lineNumber": 123
          },
          {
            "text": "                            \"prefix\": prefix",
            "lineNumber": 124
          },
          {
            "text": "                        })",
            "lineNumber": 125
          },
          {
            "text": "                    else:",
            "lineNumber": 126
          },
          {
            "text": "                        logger.debug(\"No valid router found in module\", extra={\"module_name\": module_name})",
            "lineNumber": 127
          },
          {
            "lineNumber": 128
          },
          {
            "text": "                except Exception as e:",
            "lineNumber": 129
          },
          {
            "text": "                    logger.error(\"Failed to load controller module\", extra={",
            "lineNumber": 130
          },
          {
            "text": "                        \"module_name\": module_name,",
            "lineNumber": 131
          },
          {
            "text": "                        \"file_path\": str(file_path),",
            "lineNumber": 132
          },
          {
            "text": "                        \"error\": str(e)",
            "lineNumber": 133
          },
          {
            "text": "                    }, exc_info=True)",
            "lineNumber": 134
          },
          {
            "lineNumber": 135
          },
          {
            "text": "    logger.info(\"Automatic router registration completed\", extra={",
            "lineNumber": 136
          },
          {
            "text": "        \"prefix\": prefix,",
            "lineNumber": 137
          },
          {
            "text": "        \"directory\": directory,",
            "lineNumber": 138
          },
          {
            "text": "        \"routers_registered\": router_count",
            "lineNumber": 139
          },
          {
            "text": "    })",
            "lineNumber": 140,
            "isSignature": true
          }
        ]
      },
      "score": 0.36357370018959045
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 4262
          },
          "endPosition": {
            "line": 4322
          }
        },
        "contents": "&lt;/answer&gt;\n\n&lt;next_steps&gt;\nReady to proceed - no follow-up needed.\n&lt;/next_steps&gt;\n&lt;/results&gt;\n&#96;&#96;&#96;\n&#96;&#96;&#96;\n\n&#96;&#96;&#96;\nTool: background_output\n\n**Input:**\n&#96;&#96;&#96;json\n{\n  \"task_id\": \"bg_5f70142e\"\n}\n&#96;&#96;&#96;\n**Output:**\n&#96;&#96;&#96;\nTask Result\n\nTask ID: bg_5f70142e\nDescription: Analyze backend Python API\nDuration: 48s\nSession ID: ses_42acbf34dffe0uEaCdoLgVoFxT\n\n---\n\nÊú¨Â†±ÂëäÈáùÂ∞ç‰ΩçÊñº &#96;D:\\_Code\\_GitHub\\eigent-260119&#96; ÁöÑ Eigent Â∞àÊ°àÂæåÁ´Ø Python API ÈÄ≤Ë°å‰∫ÜÊ∑±Â∫¶ÂàÜÊûê„ÄÇË©≤ÂæåÁ´ØÊé°Áî® **FastAPI** Ê°ÜÊû∂Ôºå‰∏¶Ëàá **CAMEL-AI** Â§öÊô∫ËÉΩÈ´îÊ°ÜÊû∂Ê∑±Â∫¶Êï¥ÂêàÔºåÂêåÊôÇÊîØÊè¥ **Model Context Protocol (MCP)** Â∑•ÂÖ∑„ÄÇ\n\n---\n\n### 1. API Á´ØÈªû (API Endpoints)\nÁ≥ªÁµ±Ë∑ØÁî±‰∏ªË¶ÅÂÆöÁæ©Âú® &#96;backend/app/router.py&#96; ‰∏≠Ôºå‰∏¶ÈÄèÈÅé &#96;register_routers&#96; Áµ±‰∏ÄË®ªÂÜä„ÄÇAPI ‰∏ªË¶Å‰ΩøÁî® **SSE (Server-Sent Events)** ÈÄ≤Ë°åÂç≥ÊôÇÈÄöË®äÔºå‰ª•‰æøÂêëÂâçÁ´ØÂõûÂÇ≥Â§öÊô∫ËÉΩÈ´îÂçî‰ΩúÁöÑÁãÄÊÖã„ÄÇ\n\n#### ‰∏ªË¶ÅË∑ØÁî± (Routers)\n- **Chat Controller (&#96;/chat&#96;)**: ÁÆ°ÁêÜËÅäÂ§©ÊúÉË©±Ëàá‰ªªÂãôÂïüÂãï„ÄÇ\n  - &#96;POST /chat&#96;: ÂïüÂãïÊñ∞‰ªªÂãôÔºåÂàùÂßãÂåñ &#96;TaskLock&#96; ‰∏¶ÈñãÂßã &#96;step_solve&#96; ÊµÅÁ®ã„ÄÇ\n  - &#96;POST /chat/{id}&#96;: ÊîπÈÄ≤/ËøΩÂïè‰ªªÂãôÔºàImprove chatÔºâÔºå‰øùÁïô‰∏ä‰∏ãÊñá„ÄÇ\n  - &#96;PUT /chat/{id}&#96;: Ë£úÂÖÖ‰ªªÂãôË≥áË®ä„ÄÇ\n  - &#96;DELETE /chat/{id}&#96;: Âº∑Âà∂ÂÅúÊ≠¢‰ªªÂãô„ÄÇ\n  - &#96;POST /chat/{id}/human-reply&#96;: Êé•Êî∂‰∫∫È°ûÂèçÈ•ãÔºàHuman-in-the-LoopÔºâ„ÄÇ\n  - &#96;POST /chat/{id}/install-mcp&#96;: ÂãïÊÖãÂÆâË£ù MCP ‰º∫ÊúçÂô®Â∑•ÂÖ∑„ÄÇ\n- **Task Controller (&#96;/task&#96;)**: ‰ªªÂãôÁîüÂëΩÈÄ±ÊúüÁÆ°ÁêÜ„ÄÇ\n  - &#96;POST /task/{id}/start&#96;: Âú®‰ªªÂãôÂàÜËß£ÂæåÊ≠£ÂºèÈñãÂßãÂü∑Ë°å„ÄÇ\n  - &#96;PUT /task/{id}&#96;: Êõ¥Êñ∞Â≠ê‰ªªÂãôÊ∏ÖÂñÆ„ÄÇ\n  - &#96;PUT /task/{id}/take-control&#96;: Êö´ÂÅú (Pause) Êàñ ÊÅ¢Âæ© (Resume) ‰ªªÂãô„ÄÇ\n  - &#96;POST /task/{id}/add-agent&#96;: ÂêëÁï∂Ââç‰ªªÂãôÂ∑•‰ΩúÈöä‰ºç‰∏≠ÂãïÊÖãÊ∑ªÂä†Êñ∞ÁöÑ Agent„ÄÇ\n- **Tool Controller (&#96;/tool&#96;)**: Â∑•ÂÖ∑Ëàá MCP ÁÆ°ÁêÜ„ÄÇ\n  - Êèê‰æõ MCP Â∑•ÂÖ∑ÁöÑÂàóË°®ËàáÈ†êÂÆâË£ùÂäüËÉΩ„ÄÇ\n- **Health Controller (&#96;/health&#96;)**: ÊúçÂãôÂÅ•Â∫∑Ê™¢Êü•„ÄÇ\n\n---\n\n### 2. Ë≥áÊñôÊ®°Âûã (Data Models)\nÂ∞àÊ°à‰∏ªË¶Å‰ΩøÁî® **Pydantic** ÈÄ≤Ë°åË≥áÊñôÈ©óË≠âËàáÊ®°ÂûãÂÆöÁæ©„ÄÇ\n\n- **Ê†∏ÂøÉÊ®°Âûã (&#96;backend/app/model/chat.py&#96;)**:\n  - &#96;Chat&#96;: ÂåÖÂê´ &#96;project_id&#96;, &#96;task_id&#96;, &#96;question&#96;, &#96;model_platform&#96;, &#96;model_type&#96;, &#96;api_key&#96;, &#96;installed_mcp&#96; Á≠âÊúÉË©±ÈÖçÁΩÆ„ÄÇ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "&lt;/answer&gt;",
            "lineNumber": 4263
          },
          {
            "lineNumber": 4264
          },
          {
            "text": "&lt;next_steps&gt;",
            "lineNumber": 4265
          },
          {
            "text": "Ready to proceed - no follow-up needed.",
            "lineNumber": 4266
          },
          {
            "text": "&lt;/next_steps&gt;",
            "lineNumber": 4267
          },
          {
            "text": "&lt;/results&gt;",
            "lineNumber": 4268
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 4269
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 4270
          },
          {
            "lineNumber": 4271
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 4272
          },
          {
            "text": "Tool: background_output",
            "lineNumber": 4273
          },
          {
            "lineNumber": 4274
          },
          {
            "text": "**Input:**",
            "lineNumber": 4275
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 4276
          },
          {
            "text": "{",
            "lineNumber": 4277
          },
          {
            "text": "  \"task_id\": \"bg_5f70142e\"",
            "lineNumber": 4278
          },
          {
            "text": "}",
            "lineNumber": 4279
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 4280
          },
          {
            "text": "**Output:**",
            "lineNumber": 4281
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 4282
          },
          {
            "text": "Task Result",
            "lineNumber": 4283
          },
          {
            "lineNumber": 4284
          },
          {
            "text": "Task ID: bg_5f70142e",
            "lineNumber": 4285
          },
          {
            "text": "Description: Analyze backend Python API",
            "lineNumber": 4286
          },
          {
            "text": "Duration: 48s",
            "lineNumber": 4287
          },
          {
            "text": "Session ID: ses_42acbf34dffe0uEaCdoLgVoFxT",
            "lineNumber": 4288
          },
          {
            "lineNumber": 4289
          },
          {
            "text": "---",
            "lineNumber": 4290
          },
          {
            "lineNumber": 4291
          },
          {
            "text": "Êú¨Â†±ÂëäÈáùÂ∞ç‰ΩçÊñº &#96;D:\\_Code\\_GitHub\\eigent-260119&#96; ÁöÑ Eigent Â∞àÊ°àÂæåÁ´Ø Python API ÈÄ≤Ë°å‰∫ÜÊ∑±Â∫¶ÂàÜÊûê„ÄÇË©≤ÂæåÁ´ØÊé°Áî® **FastAPI** Ê°ÜÊû∂Ôºå‰∏¶Ëàá **CAMEL-AI** Â§öÊô∫ËÉΩÈ´îÊ°ÜÊû∂Ê∑±Â∫¶Êï¥ÂêàÔºåÂêåÊôÇÊîØÊè¥ **Model Context Protocol (MCP)** Â∑•ÂÖ∑„ÄÇ",
            "lineNumber": 4292
          },
          {
            "lineNumber": 4293
          },
          {
            "text": "---",
            "lineNumber": 4294
          },
          {
            "lineNumber": 4295
          },
          {
            "text": "### 1. API Á´ØÈªû (API Endpoints)",
            "lineNumber": 4296
          },
          {
            "text": "Á≥ªÁµ±Ë∑ØÁî±‰∏ªË¶ÅÂÆöÁæ©Âú® &#96;backend/app/router.py&#96; ‰∏≠Ôºå‰∏¶ÈÄèÈÅé &#96;register_routers&#96; Áµ±‰∏ÄË®ªÂÜä„ÄÇAPI ‰∏ªË¶Å‰ΩøÁî® **SSE (Server-Sent Events)** ÈÄ≤Ë°åÂç≥ÊôÇÈÄöË®äÔºå‰ª•‰æøÂêëÂâçÁ´ØÂõûÂÇ≥Â§öÊô∫ËÉΩÈ´îÂçî‰ΩúÁöÑÁãÄÊÖã„ÄÇ",
            "lineNumber": 4297
          },
          {
            "lineNumber": 4298
          },
          {
            "text": "#### ‰∏ªË¶ÅË∑ØÁî± (Routers)",
            "lineNumber": 4299
          },
          {
            "text": "- **Chat Controller (&#96;/chat&#96;)**: ÁÆ°ÁêÜËÅäÂ§©ÊúÉË©±Ëàá‰ªªÂãôÂïüÂãï„ÄÇ",
            "lineNumber": 4300
          },
          {
            "text": "  - &#96;POST /chat&#96;: ÂïüÂãïÊñ∞‰ªªÂãôÔºåÂàùÂßãÂåñ &#96;TaskLock&#96; ‰∏¶ÈñãÂßã &#96;step_solve&#96; ÊµÅÁ®ã„ÄÇ",
            "lineNumber": 4301
          },
          {
            "text": "  - &#96;POST /chat/{id}&#96;: ÊîπÈÄ≤/ËøΩÂïè‰ªªÂãôÔºàImprove chatÔºâÔºå‰øùÁïô‰∏ä‰∏ãÊñá„ÄÇ",
            "lineNumber": 4302
          },
          {
            "text": "  - &#96;PUT /chat/{id}&#96;: Ë£úÂÖÖ‰ªªÂãôË≥áË®ä„ÄÇ",
            "lineNumber": 4303
          },
          {
            "text": "  - &#96;DELETE /chat/{id}&#96;: Âº∑Âà∂ÂÅúÊ≠¢‰ªªÂãô„ÄÇ",
            "lineNumber": 4304
          },
          {
            "text": "  - &#96;POST /chat/{id}/human-reply&#96;: Êé•Êî∂‰∫∫È°ûÂèçÈ•ãÔºàHuman-in-the-LoopÔºâ„ÄÇ",
            "lineNumber": 4305
          },
          {
            "text": "  - &#96;POST /chat/{id}/install-mcp&#96;: ÂãïÊÖãÂÆâË£ù MCP ‰º∫ÊúçÂô®Â∑•ÂÖ∑„ÄÇ",
            "lineNumber": 4306
          },
          {
            "text": "- **Task Controller (&#96;/task&#96;)**: ‰ªªÂãôÁîüÂëΩÈÄ±ÊúüÁÆ°ÁêÜ„ÄÇ",
            "lineNumber": 4307
          },
          {
            "text": "  - &#96;POST /task/{id}/start&#96;: Âú®‰ªªÂãôÂàÜËß£ÂæåÊ≠£ÂºèÈñãÂßãÂü∑Ë°å„ÄÇ",
            "lineNumber": 4308
          },
          {
            "text": "  - &#96;PUT /task/{id}&#96;: Êõ¥Êñ∞Â≠ê‰ªªÂãôÊ∏ÖÂñÆ„ÄÇ",
            "lineNumber": 4309
          },
          {
            "text": "  - &#96;PUT /task/{id}/take-control&#96;: Êö´ÂÅú (Pause) Êàñ ÊÅ¢Âæ© (Resume) ‰ªªÂãô„ÄÇ",
            "lineNumber": 4310
          },
          {
            "text": "  - &#96;POST /task/{id}/add-agent&#96;: ÂêëÁï∂Ââç‰ªªÂãôÂ∑•‰ΩúÈöä‰ºç‰∏≠ÂãïÊÖãÊ∑ªÂä†Êñ∞ÁöÑ Agent„ÄÇ",
            "lineNumber": 4311
          },
          {
            "text": "- **Tool Controller (&#96;/tool&#96;)**: Â∑•ÂÖ∑Ëàá MCP ÁÆ°ÁêÜ„ÄÇ",
            "lineNumber": 4312
          },
          {
            "text": "  - Êèê‰æõ MCP Â∑•ÂÖ∑ÁöÑÂàóË°®ËàáÈ†êÂÆâË£ùÂäüËÉΩ„ÄÇ",
            "lineNumber": 4313
          },
          {
            "text": "- **Health Controller (&#96;/health&#96;)**: ÊúçÂãôÂÅ•Â∫∑Ê™¢Êü•„ÄÇ",
            "lineNumber": 4314
          },
          {
            "lineNumber": 4315
          },
          {
            "text": "---",
            "lineNumber": 4316
          },
          {
            "lineNumber": 4317
          },
          {
            "text": "### 2. Ë≥áÊñôÊ®°Âûã (Data Models)",
            "lineNumber": 4318
          },
          {
            "text": "Â∞àÊ°à‰∏ªË¶Å‰ΩøÁî® **Pydantic** ÈÄ≤Ë°åË≥áÊñôÈ©óË≠âËàáÊ®°ÂûãÂÆöÁæ©„ÄÇ",
            "lineNumber": 4319
          },
          {
            "lineNumber": 4320
          },
          {
            "text": "- **Ê†∏ÂøÉÊ®°Âûã (&#96;backend/app/model/chat.py&#96;)**:",
            "lineNumber": 4321
          },
          {
            "text": "  - &#96;Chat&#96;: ÂåÖÂê´ &#96;project_id&#96;, &#96;task_id&#96;, &#96;question&#96;, &#96;model_platform&#96;, &#96;model_type&#96;, &#96;api_key&#96;, &#96;installed_mcp&#96; Á≠âÊúÉË©±ÈÖçÁΩÆ„ÄÇ",
            "lineNumber": 4322
          }
        ]
      },
      "score": 0.34442174434661865
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\docker-compose.yml",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 63
          }
        },
        "contents": "services:\n  # PostgreSQL Database\n  postgres:\n    image: postgres:15\n    container_name: eigent_postgres\n    restart: unless-stopped\n    environment:\n      POSTGRES_DB: eigent\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: 123456\n      POSTGRES_INITDB_ARGS: \"--encoding=UTF-8 --lc-collate=C --lc-ctype=C\"\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n      #- ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql:ro\n    networks:\n      - eigent_network\n    healthcheck:\n      test: [ \"CMD-SHELL\", \"pg_isready -U postgres -d eigent\" ]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\n  # FastAPI Application\n  api:\n    build:\n      context: ..\n      dockerfile: server/Dockerfile\n      args:\n        database_url: postgresql://postgres:123456@postgres:5432/eigent\n    container_name: eigent_api\n    restart: unless-stopped\n    ports:\n      - \"3001:5678\"\n    environment:\n      - DATABASE_URL=postgresql://postgres:123456@postgres:5432/eigent\n      - ENVIRONMENT=production\n      - DEBUG=false\n    # volumes:\n    #   - ./app:/app/app\n    #   - ./alembic:/app/alembic\n    #   - ./lang:/app/lang\n    #   - ./public:/app/public\n    depends_on:\n      postgres:\n        condition: service_healthy\n    networks:\n      - eigent_network\n    healthcheck:\n      test: [ \"CMD\", \"curl\", \"-f\", \"http://localhost:5678/health\" ]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n\nvolumes:\n  postgres_data:\n    driver: local\n\nnetworks:\n  eigent_network:\n    driver: bridge",
        "signatures": {},
        "detailedLines": [
          {
            "text": "services:",
            "lineNumber": 1
          },
          {
            "text": "  # PostgreSQL Database",
            "lineNumber": 2
          },
          {
            "text": "  postgres:",
            "lineNumber": 3
          },
          {
            "text": "    image: postgres:15",
            "lineNumber": 4
          },
          {
            "text": "    container_name: eigent_postgres",
            "lineNumber": 5
          },
          {
            "text": "    restart: unless-stopped",
            "lineNumber": 6
          },
          {
            "text": "    environment:",
            "lineNumber": 7
          },
          {
            "text": "      POSTGRES_DB: eigent",
            "lineNumber": 8
          },
          {
            "text": "      POSTGRES_USER: postgres",
            "lineNumber": 9
          },
          {
            "text": "      POSTGRES_PASSWORD: 123456",
            "lineNumber": 10
          },
          {
            "text": "      POSTGRES_INITDB_ARGS: \"--encoding=UTF-8 --lc-collate=C --lc-ctype=C\"",
            "lineNumber": 11
          },
          {
            "text": "    ports:",
            "lineNumber": 12
          },
          {
            "text": "      - \"5432:5432\"",
            "lineNumber": 13
          },
          {
            "text": "    volumes:",
            "lineNumber": 14
          },
          {
            "text": "      - postgres_data:/var/lib/postgresql/data",
            "lineNumber": 15
          },
          {
            "text": "      #- ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql:ro",
            "lineNumber": 16
          },
          {
            "text": "    networks:",
            "lineNumber": 17
          },
          {
            "text": "      - eigent_network",
            "lineNumber": 18
          },
          {
            "text": "    healthcheck:",
            "lineNumber": 19
          },
          {
            "text": "      test: [ \"CMD-SHELL\", \"pg_isready -U postgres -d eigent\" ]",
            "lineNumber": 20
          },
          {
            "text": "      interval: 10s",
            "lineNumber": 21
          },
          {
            "text": "      timeout: 5s",
            "lineNumber": 22
          },
          {
            "text": "      retries: 5",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "  # FastAPI Application",
            "lineNumber": 25
          },
          {
            "text": "  api:",
            "lineNumber": 26
          },
          {
            "text": "    build:",
            "lineNumber": 27
          },
          {
            "text": "      context: ..",
            "lineNumber": 28
          },
          {
            "text": "      dockerfile: server/Dockerfile",
            "lineNumber": 29
          },
          {
            "text": "      args:",
            "lineNumber": 30
          },
          {
            "text": "        database_url: postgresql://postgres:123456@postgres:5432/eigent",
            "lineNumber": 31
          },
          {
            "text": "    container_name: eigent_api",
            "lineNumber": 32
          },
          {
            "text": "    restart: unless-stopped",
            "lineNumber": 33
          },
          {
            "text": "    ports:",
            "lineNumber": 34
          },
          {
            "text": "      - \"3001:5678\"",
            "lineNumber": 35
          },
          {
            "text": "    environment:",
            "lineNumber": 36
          },
          {
            "text": "      - DATABASE_URL=postgresql://postgres:123456@postgres:5432/eigent",
            "lineNumber": 37
          },
          {
            "text": "      - ENVIRONMENT=production",
            "lineNumber": 38
          },
          {
            "text": "      - DEBUG=false",
            "lineNumber": 39
          },
          {
            "text": "    # volumes:",
            "lineNumber": 40
          },
          {
            "text": "    #   - ./app:/app/app",
            "lineNumber": 41
          },
          {
            "text": "    #   - ./alembic:/app/alembic",
            "lineNumber": 42
          },
          {
            "text": "    #   - ./lang:/app/lang",
            "lineNumber": 43
          },
          {
            "text": "    #   - ./public:/app/public",
            "lineNumber": 44
          },
          {
            "text": "    depends_on:",
            "lineNumber": 45
          },
          {
            "text": "      postgres:",
            "lineNumber": 46
          },
          {
            "text": "        condition: service_healthy",
            "lineNumber": 47
          },
          {
            "text": "    networks:",
            "lineNumber": 48
          },
          {
            "text": "      - eigent_network",
            "lineNumber": 49
          },
          {
            "text": "    healthcheck:",
            "lineNumber": 50
          },
          {
            "text": "      test: [ \"CMD\", \"curl\", \"-f\", \"http://localhost:5678/health\" ]",
            "lineNumber": 51
          },
          {
            "text": "      interval: 30s",
            "lineNumber": 52
          },
          {
            "text": "      timeout: 10s",
            "lineNumber": 53
          },
          {
            "text": "      retries: 3",
            "lineNumber": 54
          },
          {
            "text": "      start_period: 40s",
            "lineNumber": 55
          },
          {
            "lineNumber": 56
          },
          {
            "text": "volumes:",
            "lineNumber": 57
          },
          {
            "text": "  postgres_data:",
            "lineNumber": 58
          },
          {
            "text": "    driver: local",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "networks:",
            "lineNumber": 61
          },
          {
            "text": "  eigent_network:",
            "lineNumber": 62
          },
          {
            "text": "    driver: bridge",
            "lineNumber": 63
          }
        ]
      },
      "score": 0.34221330285072327
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 1918
          },
          "endPosition": {
            "line": 1960
          }
        },
        "contents": "00013| # 1) Load env and init traceroot BEFORE importing modules that get a logger\n00014| from utils import traceroot_wrapper as traceroot\n00015| from app import api\n00016| \n00017| # Only initialize traceroot if enabled\n00018| if traceroot.is_enabled():\n00019|     from traceroot.integrations.fastapi import connect_fastapi\n00020|     connect_fastapi(api)\n00021| \n00022| # 2) Now safe to import modules that use traceroot.get_logger() at import-time\n00023| from app.component.environment import env\n00024| from app.router import register_routers\n00025| \n00026| \n00027| os.environ[\"PYTHONIOENCODING\"] = \"utf-8\"\n00028| \n00029| app_logger = traceroot.get_logger(\"main\")\n00030| \n00031| # Log application startup\n00032| app_logger.info(\"Starting Eigent Multi-Agent System API\")\n00033| app_logger.info(f\"Python encoding: {os.environ.get('PYTHONIOENCODING')}\")\n00034| app_logger.info(f\"Environment: {os.environ.get('ENVIRONMENT', 'development')}\")\n00035| \n00036| prefix = env(\"url_prefix\", \"\")\n00037| app_logger.info(f\"Loading routers with prefix: '{prefix}'\")\n00038| register_routers(api, prefix)\n00039| app_logger.info(\"All routers loaded successfully\")\n00040| \n00041| # Check if debug mode is enabled via environment variable\n00042| if os.environ.get('ENABLE_PYTHON_DEBUG') == 'true':\n00043|     try:\n00044|         import debugpy\n00045|         DEBUG_PORT = int(os.environ.get('DEBUG_PORT', '5678'))\n00046|         app_logger.info(f\"Debug mode enabled - Starting debugpy server on port {DEBUG_PORT}\")\n00047|         debugpy.listen((\"localhost\", DEBUG_PORT))\n00048|         app_logger.info(f\"Debugger ready for attachment on localhost:{DEBUG_PORT}\")\n00049|         #üìù In VS Code: Run 'Debug Python Backend (Attach)' configuration\n00050|         # Don't wait for client automatically - let it attach when ready\n00051|     except ImportError:\n00052|         app_logger.warning(\"debugpy not available, install with: uv add debugpy\")\n00053|     except Exception as e:\n00054|         app_logger.error(f\"Failed to start debugpy: {e}\")",
        "signatures": {},
        "detailedLines": [
          {
            "text": "00013| # 1) Load env and init traceroot BEFORE importing modules that get a logger",
            "lineNumber": 1919
          },
          {
            "text": "00014| from utils import traceroot_wrapper as traceroot",
            "lineNumber": 1920
          },
          {
            "text": "00015| from app import api",
            "lineNumber": 1921
          },
          {
            "text": "00016| ",
            "lineNumber": 1922
          },
          {
            "text": "00017| # Only initialize traceroot if enabled",
            "lineNumber": 1923
          },
          {
            "text": "00018| if traceroot.is_enabled():",
            "lineNumber": 1924
          },
          {
            "text": "00019|     from traceroot.integrations.fastapi import connect_fastapi",
            "lineNumber": 1925
          },
          {
            "text": "00020|     connect_fastapi(api)",
            "lineNumber": 1926
          },
          {
            "text": "00021| ",
            "lineNumber": 1927
          },
          {
            "text": "00022| # 2) Now safe to import modules that use traceroot.get_logger() at import-time",
            "lineNumber": 1928
          },
          {
            "text": "00023| from app.component.environment import env",
            "lineNumber": 1929
          },
          {
            "text": "00024| from app.router import register_routers",
            "lineNumber": 1930
          },
          {
            "text": "00025| ",
            "lineNumber": 1931
          },
          {
            "text": "00026| ",
            "lineNumber": 1932
          },
          {
            "text": "00027| os.environ[\"PYTHONIOENCODING\"] = \"utf-8\"",
            "lineNumber": 1933
          },
          {
            "text": "00028| ",
            "lineNumber": 1934
          },
          {
            "text": "00029| app_logger = traceroot.get_logger(\"main\")",
            "lineNumber": 1935
          },
          {
            "text": "00030| ",
            "lineNumber": 1936
          },
          {
            "text": "00031| # Log application startup",
            "lineNumber": 1937
          },
          {
            "text": "00032| app_logger.info(\"Starting Eigent Multi-Agent System API\")",
            "lineNumber": 1938
          },
          {
            "text": "00033| app_logger.info(f\"Python encoding: {os.environ.get('PYTHONIOENCODING')}\")",
            "lineNumber": 1939
          },
          {
            "text": "00034| app_logger.info(f\"Environment: {os.environ.get('ENVIRONMENT', 'development')}\")",
            "lineNumber": 1940
          },
          {
            "text": "00035| ",
            "lineNumber": 1941
          },
          {
            "text": "00036| prefix = env(\"url_prefix\", \"\")",
            "lineNumber": 1942
          },
          {
            "text": "00037| app_logger.info(f\"Loading routers with prefix: '{prefix}'\")",
            "lineNumber": 1943
          },
          {
            "text": "00038| register_routers(api, prefix)",
            "lineNumber": 1944
          },
          {
            "text": "00039| app_logger.info(\"All routers loaded successfully\")",
            "lineNumber": 1945
          },
          {
            "text": "00040| ",
            "lineNumber": 1946
          },
          {
            "text": "00041| # Check if debug mode is enabled via environment variable",
            "lineNumber": 1947
          },
          {
            "text": "00042| if os.environ.get('ENABLE_PYTHON_DEBUG') == 'true':",
            "lineNumber": 1948
          },
          {
            "text": "00043|     try:",
            "lineNumber": 1949
          },
          {
            "text": "00044|         import debugpy",
            "lineNumber": 1950
          },
          {
            "text": "00045|         DEBUG_PORT = int(os.environ.get('DEBUG_PORT', '5678'))",
            "lineNumber": 1951
          },
          {
            "text": "00046|         app_logger.info(f\"Debug mode enabled - Starting debugpy server on port {DEBUG_PORT}\")",
            "lineNumber": 1952
          },
          {
            "text": "00047|         debugpy.listen((\"localhost\", DEBUG_PORT))",
            "lineNumber": 1953
          },
          {
            "text": "00048|         app_logger.info(f\"Debugger ready for attachment on localhost:{DEBUG_PORT}\")",
            "lineNumber": 1954
          },
          {
            "text": "00049|         #üìù In VS Code: Run 'Debug Python Backend (Attach)' configuration",
            "lineNumber": 1955
          },
          {
            "text": "00050|         # Don't wait for client automatically - let it attach when ready",
            "lineNumber": 1956
          },
          {
            "text": "00051|     except ImportError:",
            "lineNumber": 1957
          },
          {
            "text": "00052|         app_logger.warning(\"debugpy not available, install with: uv add debugpy\")",
            "lineNumber": 1958
          },
          {
            "text": "00053|     except Exception as e:",
            "lineNumber": 1959
          },
          {
            "text": "00054|         app_logger.error(f\"Failed to start debugpy: {e}\")",
            "lineNumber": 1960
          }
        ]
      },
      "score": 0.33370161056518555
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\BACKEND_API.md",
        "range": {
          "startPosition": {
            "line": 283
          },
          "endPosition": {
            "line": 359
          }
        },
        "contents": "ÂèñÂæóÂ∑≤ÂÆâË£ùÁöÑ MCP Â∑•ÂÖ∑Ê∏ÖÂñÆ„ÄÇ\n\n---\n\n### POST /api/mcp/install\n\nÂÆâË£ù MCP Â∑•ÂÖ∑„ÄÇ\n\n**Ë´ãÊ±Ç**Ôºö\n&#96;&#96;&#96;json\n{\n  \"name\": \"notion\",\n  \"command\": \"npx\",\n  \"args\": [\"-y\", \"@modelcontextprotocol/server-notion\"],\n  \"env\": {\n    \"NOTION_TOKEN\": \"xxx\"\n  }\n}\n&#96;&#96;&#96;\n\n---\n\n## ÂÅ•Â∫∑Ê™¢Êü•\n\n### GET /health\n\nÊ™¢Êü•ÊúçÂãôÊòØÂê¶Ê≠£Â∏∏ÈÅãË°å„ÄÇ\n\n**ÂõûÊáâ**Ôºö\n&#96;&#96;&#96;json\n{\n  \"status\": \"healthy\"\n}\n&#96;&#96;&#96;\n\n---\n\n## SSE ‰∫ã‰ª∂È°ûÂûã\n\n| ‰∫ã‰ª∂ | Ë™™Êòé |\n|------|------|\n| &#96;decompose_text&#96; | ‰ªªÂãôÂàÜËß£ÈÅéÁ®ã‰∏≠ÁöÑ‰∏≤ÊµÅÊñáÂ≠ó |\n| &#96;to_sub_tasks&#96; | Â≠ê‰ªªÂãôÊ∏ÖÂñÆÂ∑≤ÁîüÊàê |\n| &#96;confirmed&#96; | ‰ΩøÁî®ËÄÖÁ¢∫Ë™ç‰ªªÂãôÂàÜËß£ |\n| &#96;create_agent&#96; | Êñ∞ Agent Ë¢´Âª∫Á´ã |\n| &#96;assign_task&#96; | ‰ªªÂãôË¢´ÂàÜÈÖçÁµ¶ Agent |\n| &#96;activate_agent&#96; | Agent ÈñãÂßãÂ∑•‰Ωú |\n| &#96;deactivate_agent&#96; | Agent ÂÆåÊàêÂ∑•‰Ωú |\n| &#96;activate_toolkit&#96; | Â∑•ÂÖ∑Ë¢´Ë™øÁî® |\n| &#96;task_state&#96; | Â≠ê‰ªªÂãôÁãÄÊÖãËÆäÊõ¥ (DONE/FAILED) |\n| &#96;wait_confirm&#96; | ÈúÄË¶Å‰∫∫È°ûÁ¢∫Ë™ç |\n| &#96;end&#96; | ‰ªªÂãôÂÆåÊàê |\n\n---\n\n## ÈåØË™§Á¢º\n\n| Code | Ë™™Êòé |\n|------|------|\n| 0 | ÊàêÂäü |\n| 1 | ÂèÉÊï∏È©óË≠âÂ§±Êïó |\n| 10 | Ë™çË≠âÈåØË™§ |\n| 13 | Token ÈÅéÊúü |\n| 20 | È°çÂ∫¶‰∏çË∂≥ |\n| 21 | ÂÑ≤Â≠òÁ©∫Èñì‰∏çË∂≥ |\n| 100 | Ê¨Ñ‰ΩçÈ©óË≠âÈåØË™§ |\n| 300 | ‰∏ÄËà¨Ê•≠ÂãôÈåØË™§ |\n\n---\n\n## Áõ∏ÈóúÊñá‰ª∂\n\n- [Â∞àÊ°àÊû∂ÊßãÁ∏ΩË¶Ω](./ARCHITECTURE.md)\n- [ÂâçÁ´ØÊû∂ÊßãË™™Êòé](./FRONTEND.md)\n- [Electron IPC ÈÄöÈÅì](./ELECTRON_IPC.md)\n- [Ë≥áÊñôÊ®°Âûã](./DATA_MODELS.md)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "ÂèñÂæóÂ∑≤ÂÆâË£ùÁöÑ MCP Â∑•ÂÖ∑Ê∏ÖÂñÆ„ÄÇ",
            "lineNumber": 284
          },
          {
            "lineNumber": 285
          },
          {
            "text": "---",
            "lineNumber": 286
          },
          {
            "lineNumber": 287
          },
          {
            "text": "### POST /api/mcp/install",
            "lineNumber": 288
          },
          {
            "lineNumber": 289
          },
          {
            "text": "ÂÆâË£ù MCP Â∑•ÂÖ∑„ÄÇ",
            "lineNumber": 290
          },
          {
            "lineNumber": 291
          },
          {
            "text": "**Ë´ãÊ±Ç**Ôºö",
            "lineNumber": 292
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 293
          },
          {
            "text": "{",
            "lineNumber": 294
          },
          {
            "text": "  \"name\": \"notion\",",
            "lineNumber": 295
          },
          {
            "text": "  \"command\": \"npx\",",
            "lineNumber": 296
          },
          {
            "text": "  \"args\": [\"-y\", \"@modelcontextprotocol/server-notion\"],",
            "lineNumber": 297
          },
          {
            "text": "  \"env\": {",
            "lineNumber": 298
          },
          {
            "text": "    \"NOTION_TOKEN\": \"xxx\"",
            "lineNumber": 299
          },
          {
            "text": "  }",
            "lineNumber": 300
          },
          {
            "text": "}",
            "lineNumber": 301
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 302
          },
          {
            "lineNumber": 303
          },
          {
            "text": "---",
            "lineNumber": 304
          },
          {
            "lineNumber": 305
          },
          {
            "text": "## ÂÅ•Â∫∑Ê™¢Êü•",
            "lineNumber": 306
          },
          {
            "lineNumber": 307
          },
          {
            "text": "### GET /health",
            "lineNumber": 308
          },
          {
            "lineNumber": 309
          },
          {
            "text": "Ê™¢Êü•ÊúçÂãôÊòØÂê¶Ê≠£Â∏∏ÈÅãË°å„ÄÇ",
            "lineNumber": 310
          },
          {
            "lineNumber": 311
          },
          {
            "text": "**ÂõûÊáâ**Ôºö",
            "lineNumber": 312
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 313
          },
          {
            "text": "{",
            "lineNumber": 314
          },
          {
            "text": "  \"status\": \"healthy\"",
            "lineNumber": 315
          },
          {
            "text": "}",
            "lineNumber": 316
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 317
          },
          {
            "lineNumber": 318
          },
          {
            "text": "---",
            "lineNumber": 319
          },
          {
            "lineNumber": 320
          },
          {
            "text": "## SSE ‰∫ã‰ª∂È°ûÂûã",
            "lineNumber": 321
          },
          {
            "lineNumber": 322
          },
          {
            "text": "| ‰∫ã‰ª∂ | Ë™™Êòé |",
            "lineNumber": 323
          },
          {
            "text": "|------|------|",
            "lineNumber": 324
          },
          {
            "text": "| &#96;decompose_text&#96; | ‰ªªÂãôÂàÜËß£ÈÅéÁ®ã‰∏≠ÁöÑ‰∏≤ÊµÅÊñáÂ≠ó |",
            "lineNumber": 325
          },
          {
            "text": "| &#96;to_sub_tasks&#96; | Â≠ê‰ªªÂãôÊ∏ÖÂñÆÂ∑≤ÁîüÊàê |",
            "lineNumber": 326
          },
          {
            "text": "| &#96;confirmed&#96; | ‰ΩøÁî®ËÄÖÁ¢∫Ë™ç‰ªªÂãôÂàÜËß£ |",
            "lineNumber": 327
          },
          {
            "text": "| &#96;create_agent&#96; | Êñ∞ Agent Ë¢´Âª∫Á´ã |",
            "lineNumber": 328
          },
          {
            "text": "| &#96;assign_task&#96; | ‰ªªÂãôË¢´ÂàÜÈÖçÁµ¶ Agent |",
            "lineNumber": 329
          },
          {
            "text": "| &#96;activate_agent&#96; | Agent ÈñãÂßãÂ∑•‰Ωú |",
            "lineNumber": 330
          },
          {
            "text": "| &#96;deactivate_agent&#96; | Agent ÂÆåÊàêÂ∑•‰Ωú |",
            "lineNumber": 331
          },
          {
            "text": "| &#96;activate_toolkit&#96; | Â∑•ÂÖ∑Ë¢´Ë™øÁî® |",
            "lineNumber": 332
          },
          {
            "text": "| &#96;task_state&#96; | Â≠ê‰ªªÂãôÁãÄÊÖãËÆäÊõ¥ (DONE/FAILED) |",
            "lineNumber": 333
          },
          {
            "text": "| &#96;wait_confirm&#96; | ÈúÄË¶Å‰∫∫È°ûÁ¢∫Ë™ç |",
            "lineNumber": 334
          },
          {
            "text": "| &#96;end&#96; | ‰ªªÂãôÂÆåÊàê |",
            "lineNumber": 335
          },
          {
            "lineNumber": 336
          },
          {
            "text": "---",
            "lineNumber": 337
          },
          {
            "lineNumber": 338
          },
          {
            "text": "## ÈåØË™§Á¢º",
            "lineNumber": 339
          },
          {
            "lineNumber": 340
          },
          {
            "text": "| Code | Ë™™Êòé |",
            "lineNumber": 341
          },
          {
            "text": "|------|------|",
            "lineNumber": 342
          },
          {
            "text": "| 0 | ÊàêÂäü |",
            "lineNumber": 343
          },
          {
            "text": "| 1 | ÂèÉÊï∏È©óË≠âÂ§±Êïó |",
            "lineNumber": 344
          },
          {
            "text": "| 10 | Ë™çË≠âÈåØË™§ |",
            "lineNumber": 345
          },
          {
            "text": "| 13 | Token ÈÅéÊúü |",
            "lineNumber": 346
          },
          {
            "text": "| 20 | È°çÂ∫¶‰∏çË∂≥ |",
            "lineNumber": 347
          },
          {
            "text": "| 21 | ÂÑ≤Â≠òÁ©∫Èñì‰∏çË∂≥ |",
            "lineNumber": 348
          },
          {
            "text": "| 100 | Ê¨Ñ‰ΩçÈ©óË≠âÈåØË™§ |",
            "lineNumber": 349
          },
          {
            "text": "| 300 | ‰∏ÄËà¨Ê•≠ÂãôÈåØË™§ |",
            "lineNumber": 350
          },
          {
            "lineNumber": 351
          },
          {
            "text": "---",
            "lineNumber": 352
          },
          {
            "lineNumber": 353
          },
          {
            "text": "## Áõ∏ÈóúÊñá‰ª∂",
            "lineNumber": 354
          },
          {
            "lineNumber": 355
          },
          {
            "text": "- [Â∞àÊ°àÊû∂ÊßãÁ∏ΩË¶Ω](./ARCHITECTURE.md)",
            "lineNumber": 356
          },
          {
            "text": "- [ÂâçÁ´ØÊû∂ÊßãË™™Êòé](./FRONTEND.md)",
            "lineNumber": 357
          },
          {
            "text": "- [Electron IPC ÈÄöÈÅì](./ELECTRON_IPC.md)",
            "lineNumber": 358
          },
          {
            "text": "- [Ë≥áÊñôÊ®°Âûã](./DATA_MODELS.md)",
            "lineNumber": 359
          }
        ]
      },
      "score": 0.3293178081512451
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\COMMANDS.md",
        "range": {
          "startPosition": {
            "line": 105
          },
          "endPosition": {
            "line": 193
          }
        },
        "contents": "# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô®\ndocker compose down\n\n# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô® + Ë≥áÊñôÂç∑ (ÊÖéÁî®ÔºÅÊúÉÂà™Èô§Ë≥áÊñô)\ndocker compose down -v\n&#96;&#96;&#96;\n\n---\n\n## Git Â∑•‰ΩúÊµÅÁ®ã\n\n### Â∏∏Áî®Êåá‰ª§\n\n&#96;&#96;&#96;bash\n# Êü•ÁúãÁãÄÊÖã\ngit status\n\n# Êü•ÁúãËÆäÊõ¥\ngit diff\n\n# Êèê‰∫§ËÆäÊõ¥\ngit add .\ngit commit -m \"feat: Êñ∞Â¢ûÂäüËÉΩÊèèËø∞\"\n\n# Êé®ÈÄÅÂà∞ÈÅ†Á´Ø\ngit push origin feature-branch\n&#96;&#96;&#96;\n\n### Commit Ë®äÊÅØË¶èÁØÑ\n\n| È°ûÂûã | Ë™™Êòé |\n|-----|------|\n| &#96;feat:&#96; | Êñ∞ÂäüËÉΩ |\n| &#96;fix:&#96; | ÈåØË™§‰øÆÂæ© |\n| &#96;docs:&#96; | Êñá‰ª∂Êõ¥Êñ∞ |\n| &#96;style:&#96; | Á®ãÂºèÁ¢ºÊ†ºÂºèË™øÊï¥ |\n| &#96;refactor:&#96; | ÈáçÊßã |\n| &#96;test:&#96; | Ê∏¨Ë©¶Áõ∏Èóú |\n| &#96;chore:&#96; | Âª∫ÁΩÆ/Â∑•ÂÖ∑Áõ∏Èóú |\n\n---\n\n## Áí∞Â¢ÉËÆäÊï∏\n\n### ÂâçÁ´Ø (.env.development)\n\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\n|---------|------|--------|\n| &#96;VITE_BASE_URL&#96; | API Âü∫Á§éË∑ØÂæë | &#96;/api&#96; |\n| &#96;VITE_PROXY_URL&#96; | ‰ª£ÁêÜÁõÆÊ®ô URL | &#96;https://dev.eigent.ai&#96; |\n| &#96;VITE_USE_LOCAL_PROXY&#96; | ÊòØÂê¶‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ | &#96;true&#96; / &#96;false&#96; |\n\n### ÂæåÁ´Ø (server/.env)\n\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\n|---------|------|--------|\n| &#96;database_url&#96; | PostgreSQL ÈÄ£Á∑öÂ≠ó‰∏≤ | &#96;postgresql://user:pass@host:5432/db&#96; |\n| &#96;url_prefix&#96; | API Ë∑ØÁî±ÂâçÁ∂¥ | &#96;/api&#96; |\n\n---\n\n## Èô§ÈåØÊäÄÂ∑ß\n\n### ÈñãÂïü Electron DevTools\n\nÈñãÁôºÊ®°Âºè‰∏ãËá™ÂãïÈñãÂïüÔºåÊàñ‰ΩøÁî®Âø´Êç∑ÈçµÔºö\n- Windows/Linux: &#96;Ctrl + Shift + I&#96;\n- macOS: &#96;Cmd + Option + I&#96;\n\n### Ê™¢Êü•ÂæåÁ´ØÂÅ•Â∫∑ÁãÄÊÖã\n\n&#96;&#96;&#96;bash\ncurl http://localhost:5001/health\n&#96;&#96;&#96;\n\n### Êü•Áúã Swagger API Êñá‰ª∂\n\nÈñãÂïüÁÄèË¶ΩÂô®Ë®™ÂïèÔºö\n- ÂµåÂÖ•ÂºèÂæåÁ´ØÔºö&#96;http://localhost:5001/docs&#96;\n- Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´ØÔºö&#96;http://localhost:3001/docs&#96;\n\n---\n\n## Áõ∏ÈóúÊñá‰ª∂\n\n- [Â∞àÊ°àÊû∂ÊßãÁ∏ΩË¶Ω](./ARCHITECTURE.md)\n- [ÈñãÁôºÁí∞Â¢ÉË®≠ÁΩÆ](./GETTING_STARTED.md)\n- [ÂæåÁ´Ø API ÂèÉËÄÉ](./BACKEND_API.md)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô®",
            "lineNumber": 106
          },
          {
            "text": "docker compose down",
            "lineNumber": 107
          },
          {
            "lineNumber": 108
          },
          {
            "text": "# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô® + Ë≥áÊñôÂç∑ (ÊÖéÁî®ÔºÅÊúÉÂà™Èô§Ë≥áÊñô)",
            "lineNumber": 109
          },
          {
            "text": "docker compose down -v",
            "lineNumber": 110
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "---",
            "lineNumber": 113
          },
          {
            "lineNumber": 114
          },
          {
            "text": "## Git Â∑•‰ΩúÊµÅÁ®ã",
            "lineNumber": 115
          },
          {
            "lineNumber": 116
          },
          {
            "text": "### Â∏∏Áî®Êåá‰ª§",
            "lineNumber": 117
          },
          {
            "lineNumber": 118
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 119
          },
          {
            "text": "# Êü•ÁúãÁãÄÊÖã",
            "lineNumber": 120
          },
          {
            "text": "git status",
            "lineNumber": 121
          },
          {
            "lineNumber": 122
          },
          {
            "text": "# Êü•ÁúãËÆäÊõ¥",
            "lineNumber": 123
          },
          {
            "text": "git diff",
            "lineNumber": 124
          },
          {
            "lineNumber": 125
          },
          {
            "text": "# Êèê‰∫§ËÆäÊõ¥",
            "lineNumber": 126
          },
          {
            "text": "git add .",
            "lineNumber": 127
          },
          {
            "text": "git commit -m \"feat: Êñ∞Â¢ûÂäüËÉΩÊèèËø∞\"",
            "lineNumber": 128
          },
          {
            "lineNumber": 129
          },
          {
            "text": "# Êé®ÈÄÅÂà∞ÈÅ†Á´Ø",
            "lineNumber": 130
          },
          {
            "text": "git push origin feature-branch",
            "lineNumber": 131
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 132
          },
          {
            "lineNumber": 133
          },
          {
            "text": "### Commit Ë®äÊÅØË¶èÁØÑ",
            "lineNumber": 134
          },
          {
            "lineNumber": 135
          },
          {
            "text": "| È°ûÂûã | Ë™™Êòé |",
            "lineNumber": 136
          },
          {
            "text": "|-----|------|",
            "lineNumber": 137
          },
          {
            "text": "| &#96;feat:&#96; | Êñ∞ÂäüËÉΩ |",
            "lineNumber": 138
          },
          {
            "text": "| &#96;fix:&#96; | ÈåØË™§‰øÆÂæ© |",
            "lineNumber": 139
          },
          {
            "text": "| &#96;docs:&#96; | Êñá‰ª∂Êõ¥Êñ∞ |",
            "lineNumber": 140
          },
          {
            "text": "| &#96;style:&#96; | Á®ãÂºèÁ¢ºÊ†ºÂºèË™øÊï¥ |",
            "lineNumber": 141
          },
          {
            "text": "| &#96;refactor:&#96; | ÈáçÊßã |",
            "lineNumber": 142
          },
          {
            "text": "| &#96;test:&#96; | Ê∏¨Ë©¶Áõ∏Èóú |",
            "lineNumber": 143
          },
          {
            "text": "| &#96;chore:&#96; | Âª∫ÁΩÆ/Â∑•ÂÖ∑Áõ∏Èóú |",
            "lineNumber": 144
          },
          {
            "lineNumber": 145
          },
          {
            "text": "---",
            "lineNumber": 146
          },
          {
            "lineNumber": 147
          },
          {
            "text": "## Áí∞Â¢ÉËÆäÊï∏",
            "lineNumber": 148
          },
          {
            "lineNumber": 149
          },
          {
            "text": "### ÂâçÁ´Ø (.env.development)",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |",
            "lineNumber": 152
          },
          {
            "text": "|---------|------|--------|",
            "lineNumber": 153
          },
          {
            "text": "| &#96;VITE_BASE_URL&#96; | API Âü∫Á§éË∑ØÂæë | &#96;/api&#96; |",
            "lineNumber": 154
          },
          {
            "text": "| &#96;VITE_PROXY_URL&#96; | ‰ª£ÁêÜÁõÆÊ®ô URL | &#96;https://dev.eigent.ai&#96; |",
            "lineNumber": 155
          },
          {
            "text": "| &#96;VITE_USE_LOCAL_PROXY&#96; | ÊòØÂê¶‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ | &#96;true&#96; / &#96;false&#96; |",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "### ÂæåÁ´Ø (server/.env)",
            "lineNumber": 158
          },
          {
            "lineNumber": 159
          },
          {
            "text": "| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |",
            "lineNumber": 160
          },
          {
            "text": "|---------|------|--------|",
            "lineNumber": 161
          },
          {
            "text": "| &#96;database_url&#96; | PostgreSQL ÈÄ£Á∑öÂ≠ó‰∏≤ | &#96;postgresql://user:pass@host:5432/db&#96; |",
            "lineNumber": 162
          },
          {
            "text": "| &#96;url_prefix&#96; | API Ë∑ØÁî±ÂâçÁ∂¥ | &#96;/api&#96; |",
            "lineNumber": 163
          },
          {
            "lineNumber": 164
          },
          {
            "text": "---",
            "lineNumber": 165
          },
          {
            "lineNumber": 166
          },
          {
            "text": "## Èô§ÈåØÊäÄÂ∑ß",
            "lineNumber": 167
          },
          {
            "lineNumber": 168
          },
          {
            "text": "### ÈñãÂïü Electron DevTools",
            "lineNumber": 169
          },
          {
            "lineNumber": 170
          },
          {
            "text": "ÈñãÁôºÊ®°Âºè‰∏ãËá™ÂãïÈñãÂïüÔºåÊàñ‰ΩøÁî®Âø´Êç∑ÈçµÔºö",
            "lineNumber": 171
          },
          {
            "text": "- Windows/Linux: &#96;Ctrl + Shift + I&#96;",
            "lineNumber": 172
          },
          {
            "text": "- macOS: &#96;Cmd + Option + I&#96;",
            "lineNumber": 173
          },
          {
            "lineNumber": 174
          },
          {
            "text": "### Ê™¢Êü•ÂæåÁ´ØÂÅ•Â∫∑ÁãÄÊÖã",
            "lineNumber": 175
          },
          {
            "lineNumber": 176
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 177
          },
          {
            "text": "curl http://localhost:5001/health",
            "lineNumber": 178
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 179
          },
          {
            "lineNumber": 180
          },
          {
            "text": "### Êü•Áúã Swagger API Êñá‰ª∂",
            "lineNumber": 181
          },
          {
            "lineNumber": 182
          },
          {
            "text": "ÈñãÂïüÁÄèË¶ΩÂô®Ë®™ÂïèÔºö",
            "lineNumber": 183
          },
          {
            "text": "- ÂµåÂÖ•ÂºèÂæåÁ´ØÔºö&#96;http://localhost:5001/docs&#96;",
            "lineNumber": 184
          },
          {
            "text": "- Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´ØÔºö&#96;http://localhost:3001/docs&#96;",
            "lineNumber": 185
          },
          {
            "lineNumber": 186
          },
          {
            "text": "---",
            "lineNumber": 187
          },
          {
            "lineNumber": 188
          },
          {
            "text": "## Áõ∏ÈóúÊñá‰ª∂",
            "lineNumber": 189
          },
          {
            "lineNumber": 190
          },
          {
            "text": "- [Â∞àÊ°àÊû∂ÊßãÁ∏ΩË¶Ω](./ARCHITECTURE.md)",
            "lineNumber": 191
          },
          {
            "text": "- [ÈñãÁôºÁí∞Â¢ÉË®≠ÁΩÆ](./GETTING_STARTED.md)",
            "lineNumber": 192
          },
          {
            "text": "- [ÂæåÁ´Ø API ÂèÉËÄÉ](./BACKEND_API.md)",
            "lineNumber": 193
          }
        ]
      },
      "score": 0.3168734014034271
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nasync (resolve, reject) =&gt; {\nconst killBackendProcess = \n\n            }\n        };\n\n        const pollHealthEndpoint = (): void =&gt; {\n            let attempts = 0;\n            const maxAttempts = 240;\n            const intervalMs = 250;\n\n            healthCheckInterval = setInterval(() =&gt; {\n                attempts++;\n                const healthUrl = &#96;http://127.0.0.1:${port}/health&#96;;\n                log.debug(&#96;Health check attempt ${attempts}/${maxAttempts}: ${healthUrl}&#96;);\n\n                const req = http.get(healthUrl, { timeout: 1000 }, (res) =&gt; {\n                    if (res.statusCode === 200) {\n                        log.info(&#96;Backend health check passed after ${attempts} attempts&#96;);\n                        started = true;\n                        clearTimeout(startTimeout);\n                        if (healthCheckInterval) clearInterval(healthCheckInterval);\n                        resolve(node_process);\n                    } else {\n                        // Non-200 status (e.g., 404), continue polling unless max attempts reached\n                        if (attempts &gt;= maxAttempts) {\n                            log.error(&#96;Backend health check failed after ${attempts} attempts with status ${res.statusCode}&#96;);\n                            started = true;\n                            clearTimeout(startTimeout);\n                            if (healthCheckInterval) clearInterval(healthCheckInterval);\n                            killBackendProcess(node_process);\n                            reject(new Error(&#96;Backend health check failed: HTTP ${res.statusCode}&#96;));\n                        }\n                    }\n                });\n\n                req.on('error', () =&gt; {\n                    // Connection error - backend might not be ready yet, continue polling\n                }\n            }\n;\n    }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            },
            {
              "startPosition": {
                "line": 192,
                "column": 24
              },
              "endPosition": {
                "line": 193,
                "column": 9
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "const killBackendProcess = ",
            "lineNumber": 325
          },
          {
            "lineNumber": 346
          },
          {
            "text": "            }",
            "lineNumber": 347
          },
          {
            "text": "        };",
            "lineNumber": 348
          },
          {
            "lineNumber": 349
          },
          {
            "text": "        const pollHealthEndpoint = (): void =&gt; {",
            "lineNumber": 350
          },
          {
            "text": "            let attempts = 0;",
            "lineNumber": 351
          },
          {
            "text": "            const maxAttempts = 240;",
            "lineNumber": 352
          },
          {
            "text": "            const intervalMs = 250;",
            "lineNumber": 353
          },
          {
            "lineNumber": 354
          },
          {
            "text": "            healthCheckInterval = setInterval(() =&gt; {",
            "lineNumber": 355
          },
          {
            "text": "                attempts++;",
            "lineNumber": 356
          },
          {
            "text": "                const healthUrl = &#96;http://127.0.0.1:${port}/health&#96;;",
            "lineNumber": 357
          },
          {
            "text": "                log.debug(&#96;Health check attempt ${attempts}/${maxAttempts}: ${healthUrl}&#96;);",
            "lineNumber": 358
          },
          {
            "lineNumber": 359
          },
          {
            "text": "                const req = http.get(healthUrl, { timeout: 1000 }, (res) =&gt; {",
            "lineNumber": 360
          },
          {
            "text": "                    if (res.statusCode === 200) {",
            "lineNumber": 361
          },
          {
            "text": "                        log.info(&#96;Backend health check passed after ${attempts} attempts&#96;);",
            "lineNumber": 362
          },
          {
            "text": "                        started = true;",
            "lineNumber": 363
          },
          {
            "text": "                        clearTimeout(startTimeout);",
            "lineNumber": 364
          },
          {
            "text": "                        if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 365
          },
          {
            "text": "                        resolve(node_process);",
            "lineNumber": 366
          },
          {
            "text": "                    } else {",
            "lineNumber": 367
          },
          {
            "text": "                        // Non-200 status (e.g., 404), continue polling unless max attempts reached",
            "lineNumber": 368
          },
          {
            "text": "                        if (attempts &gt;= maxAttempts) {",
            "lineNumber": 369
          },
          {
            "text": "                            log.error(&#96;Backend health check failed after ${attempts} attempts with status ${res.statusCode}&#96;);",
            "lineNumber": 370
          },
          {
            "text": "                            started = true;",
            "lineNumber": 371
          },
          {
            "text": "                            clearTimeout(startTimeout);",
            "lineNumber": 372
          },
          {
            "text": "                            if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 373
          },
          {
            "text": "                            killBackendProcess(node_process);",
            "lineNumber": 374
          },
          {
            "text": "                            reject(new Error(&#96;Backend health check failed: HTTP ${res.statusCode}&#96;));",
            "lineNumber": 375
          },
          {
            "text": "                        }",
            "lineNumber": 376
          },
          {
            "text": "                    }",
            "lineNumber": 377
          },
          {
            "text": "                });",
            "lineNumber": 378
          },
          {
            "lineNumber": 379
          },
          {
            "text": "                req.on('error', () =&gt; {",
            "lineNumber": 380
          },
          {
            "text": "                    // Connection error - backend might not be ready yet, continue polling",
            "lineNumber": 381
          },
          {
            "text": "                }",
            "lineNumber": 390
          },
          {
            "text": "            }",
            "lineNumber": 403
          },
          {
            "text": ";",
            "lineNumber": 404
          },
          {
            "text": "    }",
            "lineNumber": 451
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.3128359019756317
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 292,
            "column": 1
          },
          "endPosition": {
            "line": 321,
            "column": 1
          }
        },
        "contents": "/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */\nexport async function waitForBackendReady(\n  maxWaitMs: number = 10000,\n  retryIntervalMs: number = 500\n): Promise&lt;boolean&gt; {\n  const startTime = Date.now();\n  console.log('[Backend Health Check] Waiting for backend to be ready...');\n\n  while (Date.now() - startTime &lt; maxWaitMs) {\n    const isReady = await checkBackendHealth();\n\n    if (isReady) {\n      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);\n    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));\n  }\n\n  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);\n  return false;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 295
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 296
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 297
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 298
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 299
          },
          {
            "text": " */",
            "lineNumber": 300
          },
          {
            "text": "export async function waitForBackendReady(",
            "lineNumber": 301,
            "isSignature": true
          },
          {
            "text": "  maxWaitMs: number = 10000,",
            "lineNumber": 302,
            "isSignature": true
          },
          {
            "text": "  retryIntervalMs: number = 500",
            "lineNumber": 303,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;boolean&gt; {",
            "lineNumber": 304,
            "isSignature": true
          },
          {
            "text": "  const startTime = Date.now();",
            "lineNumber": 305
          },
          {
            "text": "  console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 306
          },
          {
            "lineNumber": 307
          },
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 308
          },
          {
            "text": "    const isReady = await checkBackendHealth();",
            "lineNumber": 309
          },
          {
            "lineNumber": 310
          },
          {
            "text": "    if (isReady) {",
            "lineNumber": 311
          },
          {
            "text": "      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 312
          },
          {
            "text": "      return true;",
            "lineNumber": 313
          },
          {
            "text": "    }",
            "lineNumber": 314
          },
          {
            "lineNumber": 315
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 316
          },
          {
            "text": "    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));",
            "lineNumber": 317
          },
          {
            "text": "  }",
            "lineNumber": 318
          },
          {
            "lineNumber": 319
          },
          {
            "text": "  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);",
            "lineNumber": 320
          },
          {
            "text": "  return false;",
            "lineNumber": 321
          },
          {
            "text": "}",
            "lineNumber": 322,
            "isSignature": true
          }
        ]
      },
      "score": 0.3123215436935425
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 283,
            "column": 4
          },
          "endPosition": {
            "line": 353
          }
        },
        "contents": "delete requestHeaders['Content-Type']\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  if (import.meta.env.DEV) {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      requestHeaders['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: formData,\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\n// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */\nexport async function checkBackendHealth(): Promise&lt;boolean&gt; {\n  try {\n    const baseURL = await getBaseURL();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n\n    const res = await fetch(&#96;${baseURL}/health&#96;, {\n      signal: controller.signal,\n      method: 'GET',\n    });\n\n    clearTimeout(timeoutId);\n    return res.ok;\n  } catch (error) {\n    console.log('[Backend Health Check] Not ready:', error);\n    return false;\n  }\n}\n\n/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */\nexport async function waitForBackendReady(\n  maxWaitMs: number = 10000,\n  retryIntervalMs: number = 500\n): Promise&lt;boolean&gt; {\n  const startTime = Date.now();\n  console.log('[Backend Health Check] Waiting for backend to be ready...');\n\n  while (Date.now() - startTime &lt; maxWaitMs) {\n    const isReady = await checkBackendHealth();\n\n    if (isReady) {\n      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
        "signatures": {},
        "detailedLines": [
          {
            "text": "delete requestHeaders['Content-Type']",
            "lineNumber": 284
          },
          {
            "text": "  }",
            "lineNumber": 285
          },
          {
            "lineNumber": 286
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 287
          },
          {
            "text": "    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 288
          },
          {
            "text": "  }",
            "lineNumber": 289
          },
          {
            "lineNumber": 290
          },
          {
            "text": "  if (import.meta.env.DEV) {",
            "lineNumber": 291
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 292
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 293
          },
          {
            "text": "      requestHeaders['X-Proxy-Target'] = targetUrl",
            "lineNumber": 294
          },
          {
            "text": "    }",
            "lineNumber": 295
          },
          {
            "text": "  }",
            "lineNumber": 296
          },
          {
            "lineNumber": 297
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 298
          },
          {
            "text": "    method: 'POST',",
            "lineNumber": 299
          },
          {
            "text": "    headers: requestHeaders,",
            "lineNumber": 300
          },
          {
            "text": "    body: formData,",
            "lineNumber": 301
          },
          {
            "text": "  }",
            "lineNumber": 302
          },
          {
            "lineNumber": 303
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 304
          },
          {
            "text": "}",
            "lineNumber": 305
          },
          {
            "lineNumber": 306
          },
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 307
          },
          {
            "lineNumber": 308
          },
          {
            "text": "/**",
            "lineNumber": 309
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 310
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 311
          },
          {
            "text": " */",
            "lineNumber": 312
          },
          {
            "text": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {",
            "lineNumber": 313
          },
          {
            "text": "  try {",
            "lineNumber": 314
          },
          {
            "text": "    const baseURL = await getBaseURL();",
            "lineNumber": 315
          },
          {
            "text": "    const controller = new AbortController();",
            "lineNumber": 316
          },
          {
            "text": "    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 317
          },
          {
            "lineNumber": 318
          },
          {
            "text": "    const res = await fetch(&#96;${baseURL}/health&#96;, {",
            "lineNumber": 319
          },
          {
            "text": "      signal: controller.signal,",
            "lineNumber": 320
          },
          {
            "text": "      method: 'GET',",
            "lineNumber": 321
          },
          {
            "text": "    });",
            "lineNumber": 322
          },
          {
            "lineNumber": 323
          },
          {
            "text": "    clearTimeout(timeoutId);",
            "lineNumber": 324
          },
          {
            "text": "    return res.ok;",
            "lineNumber": 325
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 326
          },
          {
            "text": "    console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 327
          },
          {
            "text": "    return false;",
            "lineNumber": 328
          },
          {
            "text": "  }",
            "lineNumber": 329
          },
          {
            "text": "}",
            "lineNumber": 330
          },
          {
            "lineNumber": 331
          },
          {
            "text": "/**",
            "lineNumber": 332
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 333
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 334
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 335
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 336
          },
          {
            "text": " */",
            "lineNumber": 337
          },
          {
            "text": "export async function waitForBackendReady(",
            "lineNumber": 338
          },
          {
            "text": "  maxWaitMs: number = 10000,",
            "lineNumber": 339
          },
          {
            "text": "  retryIntervalMs: number = 500",
            "lineNumber": 340
          },
          {
            "text": "): Promise&lt;boolean&gt; {",
            "lineNumber": 341
          },
          {
            "text": "  const startTime = Date.now();",
            "lineNumber": 342
          },
          {
            "text": "  console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 343
          },
          {
            "lineNumber": 344
          },
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 345
          },
          {
            "text": "    const isReady = await checkBackendHealth();",
            "lineNumber": 346
          },
          {
            "lineNumber": 347
          },
          {
            "text": "    if (isReady) {",
            "lineNumber": 348
          },
          {
            "text": "      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 349
          },
          {
            "text": "      return true;",
            "lineNumber": 350
          },
          {
            "text": "    }",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 353
          }
        ]
      },
      "score": 0.29899489879608154
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\app\\__init__.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 9,
            "column": 1
          }
        },
        "contents": "from fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\n# Initialize FastAPI with title\napi = FastAPI(title=\"Eigent Multi-Agent System API\")\n\n# Add CORS middleware\napi.add_middleware(\n    CORSMiddleware, allow_origins=[\"*\"], allow_credentials=True, allow_methods=[\"*\"], allow_headers=[\"*\"]\n)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "from fastapi import FastAPI",
            "lineNumber": 1
          },
          {
            "text": "from fastapi.middleware.cors import CORSMiddleware",
            "lineNumber": 2
          },
          {
            "lineNumber": 3
          },
          {
            "text": "# Initialize FastAPI with title",
            "lineNumber": 4
          },
          {
            "text": "api = FastAPI(title=\"Eigent Multi-Agent System API\")",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "# Add CORS middleware",
            "lineNumber": 7
          },
          {
            "text": "api.add_middleware(",
            "lineNumber": 8
          },
          {
            "text": "    CORSMiddleware, allow_origins=[\"*\"], allow_credentials=True, allow_methods=[\"*\"], allow_headers=[\"*\"]",
            "lineNumber": 9
          },
          {
            "text": ")",
            "lineNumber": 10
          }
        ]
      },
      "score": 0.2951274514198303
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 700,
            "column": 4
          },
          "endPosition": {
            "line": 767,
            "column": 4
          }
        },
        "contents": "...headers,\n  }\n\n  // Remove Content-Type header to let browser set it with boundary for FormData\n  if (requestHeaders['Content-Type']) {\n    delete requestHeaders['Content-Type']\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  if (import.meta.env.DEV) {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      requestHeaders['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: formData,\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\n// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */\nexport async function checkBackendHealth(): Promise&lt;boolean&gt; {\n  try {\n    const baseURL = await getBaseURL();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n\n    const res = await fetch(&#96;${baseURL}/health&#96;, {\n      signal: controller.signal,\n      method: 'GET',\n    });\n\n    clearTimeout(timeoutId);\n    return res.ok;\n  } catch (error) {\n    console.log('[Backend Health Check] Not ready:', error);\n    return false;\n  }\n}\n\n/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */\nexport async function waitForBackendReady(\n  maxWaitMs: number = 10000,\n  retryIntervalMs: number = 500\n): Promise&lt;boolean&gt; {\n  const startTime = Date.now();\n  console.log('[Backend Health Check] Waiting for backend to be ready...');\n\n  while (Date.now() - startTime &lt; maxWaitMs) {\n    ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "...headers,",
            "lineNumber": 701
          },
          {
            "text": "  }",
            "lineNumber": 702
          },
          {
            "lineNumber": 703
          },
          {
            "text": "  // Remove Content-Type header to let browser set it with boundary for FormData",
            "lineNumber": 704
          },
          {
            "text": "  if (requestHeaders['Content-Type']) {",
            "lineNumber": 705
          },
          {
            "text": "    delete requestHeaders['Content-Type']",
            "lineNumber": 706
          },
          {
            "text": "  }",
            "lineNumber": 707
          },
          {
            "lineNumber": 708
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 709
          },
          {
            "text": "    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 710
          },
          {
            "text": "  }",
            "lineNumber": 711
          },
          {
            "lineNumber": 712
          },
          {
            "text": "  if (import.meta.env.DEV) {",
            "lineNumber": 713
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 714
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 715
          },
          {
            "text": "      requestHeaders['X-Proxy-Target'] = targetUrl",
            "lineNumber": 716
          },
          {
            "text": "    }",
            "lineNumber": 717
          },
          {
            "text": "  }",
            "lineNumber": 718
          },
          {
            "lineNumber": 719
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 720
          },
          {
            "text": "    method: 'POST',",
            "lineNumber": 721
          },
          {
            "text": "    headers: requestHeaders,",
            "lineNumber": 722
          },
          {
            "text": "    body: formData,",
            "lineNumber": 723
          },
          {
            "text": "  }",
            "lineNumber": 724
          },
          {
            "lineNumber": 725
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 726
          },
          {
            "text": "}",
            "lineNumber": 727
          },
          {
            "lineNumber": 728
          },
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 729
          },
          {
            "lineNumber": 730
          },
          {
            "text": "/**",
            "lineNumber": 731
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 732
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 733
          },
          {
            "text": " */",
            "lineNumber": 734
          },
          {
            "text": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {",
            "lineNumber": 735
          },
          {
            "text": "  try {",
            "lineNumber": 736
          },
          {
            "text": "    const baseURL = await getBaseURL();",
            "lineNumber": 737
          },
          {
            "text": "    const controller = new AbortController();",
            "lineNumber": 738
          },
          {
            "text": "    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 739
          },
          {
            "lineNumber": 740
          },
          {
            "text": "    const res = await fetch(&#96;${baseURL}/health&#96;, {",
            "lineNumber": 741
          },
          {
            "text": "      signal: controller.signal,",
            "lineNumber": 742
          },
          {
            "text": "      method: 'GET',",
            "lineNumber": 743
          },
          {
            "text": "    });",
            "lineNumber": 744
          },
          {
            "lineNumber": 745
          },
          {
            "text": "    clearTimeout(timeoutId);",
            "lineNumber": 746
          },
          {
            "text": "    return res.ok;",
            "lineNumber": 747
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 748
          },
          {
            "text": "    console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 749
          },
          {
            "text": "    return false;",
            "lineNumber": 750
          },
          {
            "text": "  }",
            "lineNumber": 751
          },
          {
            "text": "}",
            "lineNumber": 752
          },
          {
            "lineNumber": 753
          },
          {
            "text": "/**",
            "lineNumber": 754
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 755
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 756
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 757
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 758
          },
          {
            "text": " */",
            "lineNumber": 759
          },
          {
            "text": "export async function waitForBackendReady(",
            "lineNumber": 760
          },
          {
            "text": "  maxWaitMs: number = 10000,",
            "lineNumber": 761
          },
          {
            "text": "  retryIntervalMs: number = 500",
            "lineNumber": 762
          },
          {
            "text": "): Promise&lt;boolean&gt; {",
            "lineNumber": 763
          },
          {
            "text": "  const startTime = Date.now();",
            "lineNumber": 764
          },
          {
            "text": "  console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 765
          },
          {
            "lineNumber": 766
          },
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 767
          },
          {
            "text": "    ",
            "lineNumber": 768
          }
        ]
      },
      "score": 0.2951110601425171
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\server\\app\\__init__.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 5,
            "column": 19
          }
        },
        "contents": "from fastapi import FastAPI\nfrom fastapi_pagination import add_pagination\n\n\napi = FastAPI(swagger_ui_parameters={\"persistAuthorization\": True})\nadd_pagination(api)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "from fastapi import FastAPI",
            "lineNumber": 1
          },
          {
            "text": "from fastapi_pagination import add_pagination",
            "lineNumber": 2
          },
          {
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "api = FastAPI(swagger_ui_parameters={\"persistAuthorization\": True})",
            "lineNumber": 5
          },
          {
            "text": "add_pagination(api)",
            "lineNumber": 6
          }
        ]
      },
      "score": 0.2947789430618286
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\BACKEND_API.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 125
          }
        },
        "contents": "# ÂæåÁ´Ø API ÂèÉËÄÉ\n\n&gt; Êú¨Êñá‰ª∂Ë™™Êòé Eigent ÂæåÁ´Ø API ÁöÑÁ´ØÈªû„ÄÅË´ãÊ±ÇÊ†ºÂºèËàáÂõûÊáâÁµêÊßã„ÄÇ\n\n## API Ê¶ÇËø∞\n\nEigent ÊúâÂÖ©Â•óÂæåÁ´ØÔºö\n\n| ÂæåÁ´Ø | ‰ΩçÁΩÆ | Áî®ÈÄî | Ë™çË≠âÊñπÂºè |\n|-----|------|------|---------|\n| **ÂµåÂÖ•ÂºèÂæåÁ´Ø** | &#96;backend/&#96; | Â§öÊô∫ËÉΩÈ´îÂü∑Ë°åÂºïÊìé | ÁÑ°ÔºàÊú¨Âú∞ÈÄöË®äÔºâ |\n| **Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´Ø** | &#96;server/&#96; | ÂÆåÊï¥ APIÔºàÂê´Áî®Êà∂ÁÆ°ÁêÜÔºâ | JWT Bearer Token |\n\n---\n\n## Ë™çË≠â API\n\n### POST /api/login\n\n‰ΩøÁî® Email ÂíåÂØÜÁ¢ºÁôªÂÖ•„ÄÇ\n\n**Ë´ãÊ±Ç**Ôºö\n&#96;&#96;&#96;json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"your_password\"\n}\n&#96;&#96;&#96;\n\n**ÂõûÊáâ**Ôºö\n&#96;&#96;&#96;json\n{\n  \"token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"email\": \"user@example.com\",\n  \"username\": \"user\",\n  \"user_id\": 1\n}\n&#96;&#96;&#96;\n\n**ÈåØË™§Á¢º**Ôºö\n- &#96;code: 10&#96; - Â∏≥ËôüÊàñÂØÜÁ¢ºÈåØË™§\n\n---\n\n### POST /api/register\n\nË®ªÂÜäÊñ∞Â∏≥ËôüÔºàÂÉÖÊú¨Âú∞ÈÉ®ÁΩ≤Ê®°ÂºèÔºâ„ÄÇ\n\n**Ë´ãÊ±Ç**Ôºö\n&#96;&#96;&#96;json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"your_password\",\n  \"invite_code\": \"\"\n}\n&#96;&#96;&#96;\n\n**ÂõûÊáâ**Ôºö\n&#96;&#96;&#96;json\n{\n  \"status\": \"success\"\n}\n&#96;&#96;&#96;\n\n**ÈåØË™§Á¢º**Ôºö\n- &#96;code: 10&#96; - Email Â∑≤Ë¢´Ë®ªÂÜä\n\n---\n\n### POST /api/login-by_stack\n\n‰ΩøÁî® Stack Auth OAuth Token ÁôªÂÖ•„ÄÇ\n\n**Ë´ãÊ±Ç**Ôºö\n&#96;&#96;&#96;\nPOST /api/login-by_stack?token=xxx\n&#96;&#96;&#96;\n\n**ÂõûÊáâ**Ôºö\n&#96;&#96;&#96;json\n{\n  \"token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"email\": \"user@example.com\"\n}\n&#96;&#96;&#96;\n\n---\n\n## ËÅäÂ§©/‰ªªÂãô API\n\n### POST /chat\n\nÂïüÂãïÊñ∞‰ªªÂãôÔºàSSE ‰∏≤ÊµÅÔºâ„ÄÇ\n\n**Ë´ãÊ±Ç**Ôºö\n&#96;&#96;&#96;json\n{\n  \"project_id\": \"proj_123\",\n  \"task_id\": \"task_456\",\n  \"question\": \"Âπ´ÊàëÂØ´‰∏ÄÂÄã Python Áà¨Ëü≤\",\n  \"model_platform\": \"openai\",\n  \"model_type\": \"gpt-4.1\",\n  \"api_key\": \"sk-xxx\",\n  \"email\": \"user@example.com\",\n  \"language\": \"zh-cn\",\n  \"browser_port\": 9222\n}\n&#96;&#96;&#96;\n\n**ÂõûÊáâ (SSE)**Ôºö\n&#96;&#96;&#96;\nevent: message\ndata: {\"step\": \"to_sub_tasks\", \"data\": {\"sub_tasks\": [...]}}\n\nevent: message\ndata: {\"step\": \"create_agent\", \"data\": {\"agent_name\": \"developer_agent\"}}\n\nevent: message\ndata: {\"step\": \"assign_task\", \"data\": {\"task_id\": \"sub_1\", \"assignee_id\": \"agent_1\"}}\n\nevent: message\ndata: {\"step\": \"activate_toolkit\", \"data\": {\"toolkit_name\": \"Terminal\", \"method_name\": \"run\"}}\n\nevent: message\ndata: {\"step\": \"task_state\", \"data\": {\"task_id\": \"sub_1\", \"state\": \"DONE\"}}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# ÂæåÁ´Ø API ÂèÉËÄÉ",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "&gt; Êú¨Êñá‰ª∂Ë™™Êòé Eigent ÂæåÁ´Ø API ÁöÑÁ´ØÈªû„ÄÅË´ãÊ±ÇÊ†ºÂºèËàáÂõûÊáâÁµêÊßã„ÄÇ",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "## API Ê¶ÇËø∞",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "Eigent ÊúâÂÖ©Â•óÂæåÁ´ØÔºö",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "| ÂæåÁ´Ø | ‰ΩçÁΩÆ | Áî®ÈÄî | Ë™çË≠âÊñπÂºè |",
            "lineNumber": 9
          },
          {
            "text": "|-----|------|------|---------|",
            "lineNumber": 10
          },
          {
            "text": "| **ÂµåÂÖ•ÂºèÂæåÁ´Ø** | &#96;backend/&#96; | Â§öÊô∫ËÉΩÈ´îÂü∑Ë°åÂºïÊìé | ÁÑ°ÔºàÊú¨Âú∞ÈÄöË®äÔºâ |",
            "lineNumber": 11
          },
          {
            "text": "| **Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´Ø** | &#96;server/&#96; | ÂÆåÊï¥ APIÔºàÂê´Áî®Êà∂ÁÆ°ÁêÜÔºâ | JWT Bearer Token |",
            "lineNumber": 12
          },
          {
            "lineNumber": 13
          },
          {
            "text": "---",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "## Ë™çË≠â API",
            "lineNumber": 16
          },
          {
            "lineNumber": 17
          },
          {
            "text": "### POST /api/login",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "‰ΩøÁî® Email ÂíåÂØÜÁ¢ºÁôªÂÖ•„ÄÇ",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "text": "**Ë´ãÊ±Ç**Ôºö",
            "lineNumber": 22
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 23
          },
          {
            "text": "{",
            "lineNumber": 24
          },
          {
            "text": "  \"email\": \"user@example.com\",",
            "lineNumber": 25
          },
          {
            "text": "  \"password\": \"your_password\"",
            "lineNumber": 26
          },
          {
            "text": "}",
            "lineNumber": 27
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "**ÂõûÊáâ**Ôºö",
            "lineNumber": 30
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 31
          },
          {
            "text": "{",
            "lineNumber": 32
          },
          {
            "text": "  \"token\": \"eyJhbGciOiJIUzI1NiIs...\",",
            "lineNumber": 33
          },
          {
            "text": "  \"email\": \"user@example.com\",",
            "lineNumber": 34
          },
          {
            "text": "  \"username\": \"user\",",
            "lineNumber": 35
          },
          {
            "text": "  \"user_id\": 1",
            "lineNumber": 36
          },
          {
            "text": "}",
            "lineNumber": 37
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "**ÈåØË™§Á¢º**Ôºö",
            "lineNumber": 40
          },
          {
            "text": "- &#96;code: 10&#96; - Â∏≥ËôüÊàñÂØÜÁ¢ºÈåØË™§",
            "lineNumber": 41
          },
          {
            "lineNumber": 42
          },
          {
            "text": "---",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "### POST /api/register",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "Ë®ªÂÜäÊñ∞Â∏≥ËôüÔºàÂÉÖÊú¨Âú∞ÈÉ®ÁΩ≤Ê®°ÂºèÔºâ„ÄÇ",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "**Ë´ãÊ±Ç**Ôºö",
            "lineNumber": 49
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 50
          },
          {
            "text": "{",
            "lineNumber": 51
          },
          {
            "text": "  \"email\": \"user@example.com\",",
            "lineNumber": 52
          },
          {
            "text": "  \"password\": \"your_password\",",
            "lineNumber": 53
          },
          {
            "text": "  \"invite_code\": \"\"",
            "lineNumber": 54
          },
          {
            "text": "}",
            "lineNumber": 55
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 56
          },
          {
            "lineNumber": 57
          },
          {
            "text": "**ÂõûÊáâ**Ôºö",
            "lineNumber": 58
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 59
          },
          {
            "text": "{",
            "lineNumber": 60
          },
          {
            "text": "  \"status\": \"success\"",
            "lineNumber": 61
          },
          {
            "text": "}",
            "lineNumber": 62
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 63
          },
          {
            "lineNumber": 64
          },
          {
            "text": "**ÈåØË™§Á¢º**Ôºö",
            "lineNumber": 65
          },
          {
            "text": "- &#96;code: 10&#96; - Email Â∑≤Ë¢´Ë®ªÂÜä",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "---",
            "lineNumber": 68
          },
          {
            "lineNumber": 69
          },
          {
            "text": "### POST /api/login-by_stack",
            "lineNumber": 70
          },
          {
            "lineNumber": 71
          },
          {
            "text": "‰ΩøÁî® Stack Auth OAuth Token ÁôªÂÖ•„ÄÇ",
            "lineNumber": 72
          },
          {
            "lineNumber": 73
          },
          {
            "text": "**Ë´ãÊ±Ç**Ôºö",
            "lineNumber": 74
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 75
          },
          {
            "text": "POST /api/login-by_stack?token=xxx",
            "lineNumber": 76
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 77
          },
          {
            "lineNumber": 78
          },
          {
            "text": "**ÂõûÊáâ**Ôºö",
            "lineNumber": 79
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 80
          },
          {
            "text": "{",
            "lineNumber": 81
          },
          {
            "text": "  \"token\": \"eyJhbGciOiJIUzI1NiIs...\",",
            "lineNumber": 82
          },
          {
            "text": "  \"email\": \"user@example.com\"",
            "lineNumber": 83
          },
          {
            "text": "}",
            "lineNumber": 84
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 85
          },
          {
            "lineNumber": 86
          },
          {
            "text": "---",
            "lineNumber": 87
          },
          {
            "lineNumber": 88
          },
          {
            "text": "## ËÅäÂ§©/‰ªªÂãô API",
            "lineNumber": 89
          },
          {
            "lineNumber": 90
          },
          {
            "text": "### POST /chat",
            "lineNumber": 91
          },
          {
            "lineNumber": 92
          },
          {
            "text": "ÂïüÂãïÊñ∞‰ªªÂãôÔºàSSE ‰∏≤ÊµÅÔºâ„ÄÇ",
            "lineNumber": 93
          },
          {
            "lineNumber": 94
          },
          {
            "text": "**Ë´ãÊ±Ç**Ôºö",
            "lineNumber": 95
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 96
          },
          {
            "text": "{",
            "lineNumber": 97
          },
          {
            "text": "  \"project_id\": \"proj_123\",",
            "lineNumber": 98
          },
          {
            "text": "  \"task_id\": \"task_456\",",
            "lineNumber": 99
          },
          {
            "text": "  \"question\": \"Âπ´ÊàëÂØ´‰∏ÄÂÄã Python Áà¨Ëü≤\",",
            "lineNumber": 100
          },
          {
            "text": "  \"model_platform\": \"openai\",",
            "lineNumber": 101
          },
          {
            "text": "  \"model_type\": \"gpt-4.1\",",
            "lineNumber": 102
          },
          {
            "text": "  \"api_key\": \"sk-xxx\",",
            "lineNumber": 103
          },
          {
            "text": "  \"email\": \"user@example.com\",",
            "lineNumber": 104
          },
          {
            "text": "  \"language\": \"zh-cn\",",
            "lineNumber": 105
          },
          {
            "text": "  \"browser_port\": 9222",
            "lineNumber": 106
          },
          {
            "text": "}",
            "lineNumber": 107
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 108
          },
          {
            "lineNumber": 109
          },
          {
            "text": "**ÂõûÊáâ (SSE)**Ôºö",
            "lineNumber": 110
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 111
          },
          {
            "text": "event: message",
            "lineNumber": 112
          },
          {
            "text": "data: {\"step\": \"to_sub_tasks\", \"data\": {\"sub_tasks\": [...]}}",
            "lineNumber": 113
          },
          {
            "lineNumber": 114
          },
          {
            "text": "event: message",
            "lineNumber": 115
          },
          {
            "text": "data: {\"step\": \"create_agent\", \"data\": {\"agent_name\": \"developer_agent\"}}",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "event: message",
            "lineNumber": 118
          },
          {
            "text": "data: {\"step\": \"assign_task\", \"data\": {\"task_id\": \"sub_1\", \"assignee_id\": \"agent_1\"}}",
            "lineNumber": 119
          },
          {
            "lineNumber": 120
          },
          {
            "text": "event: message",
            "lineNumber": 121
          },
          {
            "text": "data: {\"step\": \"activate_toolkit\", \"data\": {\"toolkit_name\": \"Terminal\", \"method_name\": \"run\"}}",
            "lineNumber": 122
          },
          {
            "lineNumber": 123
          },
          {
            "text": "event: message",
            "lineNumber": 124
          },
          {
            "text": "data: {\"step\": \"task_state\", \"data\": {\"task_id\": \"sub_1\", \"state\": \"DONE\"}}",
            "lineNumber": 125
          }
        ]
      },
      "score": 0.2947376072406769
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---


Ê™¢Êü•Áí∞Â¢ÉË®≠ÂÆöÔºåÁ¢∫Ë™ç API ÂâçÁ∂¥ÁöÑ‰æÜÊ∫êÔºö


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "url_prefix|URL_PREFIX",
  "path": "backend",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "url_prefix|URL_PREFIX",
    "path": "backend",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": "backend\\main.py",
              "matches": [
                {
                  "lineNumber": 36,
                  "content": "prefix = env(\"url_prefix\", \"\")"
                }
              ]
            }
          ],
          "totalLines": 1,
          "totalMatchedLines": 1
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** ‚Ä¢ Read file: d:\_Code\_GitHub\eigent-260119\backend\app\router.py</summary>

</details>
</tool-use>

---


ÂïèÈ°åÔºöÂæåÁ´ØË∑ØÁî±‰ΩøÁî® `/api` ÂâçÁ∂¥ÔºåÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÂØ¶ÈöõÂú® `/api/health`Ôºå‰ΩÜÂâçÁ´ØÂëºÂè´ `/health`„ÄÇ‰øÆÊ≠£ÂâçÁ´ØÔºåÊîπÁÇ∫ÂëºÂè´ `/api/health`„ÄÇ


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "/api|url_prefix",
  "path": "src",
  "caseInsensitive": true
}
```
Result:

```json
{
  "success": {
    "pattern": "/api|url_prefix",
    "path": "src",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": "src\\store\\chatStore.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "import { fetchPost, fetchPut, getBaseURL, proxyFetchPost, proxyFetchPut, proxyFetchGet, uploadFile, fetchDelete, waitForBackendReady } from '@/api/http';"
                },
                {
                  "lineNumber": 397,
                  "content": "\t\t\t\t&#96;${base_Url}/api/chat/share/playback/${shareToken}?delay_time=${delayTime}&#96;"
                },
                {
                  "lineNumber": 399,
                  "content": "\t\t\t\t\t&#96;${base_Url}/api/chat/steps/playback/${newTaskId}?delay_time=${delayTime}&#96;"
                },
                {
                  "lineNumber": 409,
                  "content": "\t\t\t\tconst res = await proxyFetchGet(&#96;/api/chat/snapshots&#96;, {"
                },
                {
                  "lineNumber": 427,
                  "content": "\t\t\t\tconst res = await proxyFetchGet('/api/providers', {"
                },
                {
                  "lineNumber": 447,
                  "content": "\t\t\t\tconst res = await proxyFetchGet('/api/user/key');"
                },
                {
                  "lineNumber": 476,
                  "content": "\t\t\t\t\tconst configsRes = await proxyFetchGet('/api/configs');"
                },
                {
                  "lineNumber": 538,
                  "content": "\t\t\t\tawait proxyFetchPost(&#96;/api/chat/history&#96;, obj).then(res =&gt; {"
                },
                {
                  "lineNumber": 740,
                  "content": "\t\t\t\t\t\t\t\t\tawait proxyFetchPost(&#96;/api/chat/history&#96;, obj).then(res =&gt; {"
                },
                {
                  "lineNumber": 924,
                  "content": "\t\t\t\t\t\t\tproxyFetchPut(&#96;/api/chat/history/${historyId}&#96;, obj)"
                },
                {
                  "lineNumber": 1127,
                  "content": "\t\t\t\t\t\t\t\tproxyFetchPut(&#96;/api/chat/history/${historyId}&#96;, obj)"
                },
                {
                  "lineNumber": 1609,
                  "content": "\t\t\t\t\t\t\tproxyFetchPost(&#96;/api/chat/snapshots&#96;, { ...snapshot })"
                },
                {
                  "lineNumber": 1635,
                  "content": "\t\t\t\t\t\t\t\t\t\t\tawait uploadFile('/api/chat/files/upload', formData);"
                },
                {
                  "lineNumber": 1664,
                  "content": "\t\t\t\t\t\t\t\tproxyFetchPost(&#96;/api/user/stat&#96;, {"
                },
                {
                  "lineNumber": 1682,
                  "content": "\t\t\t\t\t\t\tproxyFetchPut(&#96;/api/chat/history/${historyId}&#96;, obj)"
                }
              ]
            },
            {
              "file": "src\\stack\\client.ts",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "\t\toauthCallback: (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + \"/api/redirect/callback\","
                }
              ]
            },
            {
              "file": "src\\service\\historyApi.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "import { proxyFetchGet } from \"@/api/http\";"
                },
                {
                  "lineNumber": 68,
                  "content": "    const res = await proxyFetchGet(&#96;/api/chat/histories&#96;);"
                },
                {
                  "lineNumber": 79,
                  "content": "    const res = await proxyFetchGet(&#96;/api/chat/histories/grouped?include_tasks=true&#96;);"
                },
                {
                  "lineNumber": 96,
                  "content": "    const res = await proxyFetchGet(&#96;/api/chat/histories/grouped?include_tasks=false&#96;);"
                },
                {
                  "lineNumber": 113,
                  "content": "    const res = await proxyFetchGet(&#96;/api/chat/histories&#96;);"
                }
              ]
            },
            {
              "file": "src\\pages\\SignUp.tsx",
              "matches": [
                {
                  "lineNumber": 14,
                  "content": "import { proxyFetchPost } from \"@/api/http\";"
                },
                {
                  "lineNumber": 94,
                  "content": "\t\t\tconst data = await proxyFetchPost(\"/api/register\", {"
                },
                {
                  "lineNumber": 132,
                  "content": "\t\t\tconst data = await proxyFetchPost(\"/api/login-by_stack?token=\" + token, {"
                },
                {
                  "lineNumber": 172,
                  "content": "\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 173,
                  "content": "\t\t\t\t: &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 178,
                  "content": "\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 179,
                  "content": "\t\t\t\t: &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 192,
                  "content": "\t\t\t\t\"https://api.stack-auth.com/api/v1/auth/oauth/token\","
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\components\\SearchEngineConfigDialog.tsx",
              "matches": [
                {
                  "lineNumber": 13,
                  "content": "import { proxyFetchGet, proxyFetchPost } from \"@/api/http\";"
                },
                {
                  "lineNumber": 99,
                  "content": "\t\t\tproxyFetchGet(\"/api/configs\")"
                },
                {
                  "lineNumber": 218,
                  "content": "\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", {"
                },
                {
                  "lineNumber": 227,
                  "content": "\t\t\t\tawait proxyFetchPost(\"/api/configs\", {"
                },
                {
                  "lineNumber": 236,
                  "content": "\t\t\tconst res = await proxyFetchGet(\"/api/configs\");"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\components\\MCPEnvDialog.tsx",
              "matches": [
                {
                  "lineNumber": 54,
                  "content": "\t\tconst res = await fetch(\"https://api.exa.ai/search\", {"
                },
                {
                  "lineNumber": 313,
                  "content": "\t\t\t\t\t\t\t\t\t\tnoteContent += &#96; ${t(\"setting.get-it-from\")}: https://console.cloud.google.com/apis/credentials&#96;;"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\Privacy.tsx",
              "matches": [
                {
                  "lineNumber": 3,
                  "content": "import { proxyFetchGet, proxyFetchPut } from \"@/api/http\";"
                },
                {
                  "lineNumber": 41,
                  "content": "\t\tproxyFetchGet(\"/api/user/privacy\")"
                },
                {
                  "lineNumber": 74,
                  "content": "\t\tproxyFetchPut(\"/api/user/privacy\", requestData);"
                },
                {
                  "lineNumber": 96,
                  "content": "\t\tproxyFetchPut(\"/api/user/privacy\", requestData).catch((err) =&gt;"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\Models.tsx",
              "matches": [
                {
                  "lineNumber": 25,
                  "content": "} from \"@/api/http\";"
                },
                {
                  "lineNumber": 106,
                  "content": "\t\t\t\tconst res = await proxyFetchGet(\"/api/providers\");"
                },
                {
                  "lineNumber": 276,
                  "content": "\t\t\t\tawait proxyFetchPut(&#96;/api/provider/${provider_id}&#96;, data);"
                },
                {
                  "lineNumber": 278,
                  "content": "\t\t\t\tawait proxyFetchPost(\"/api/provider\", data);"
                },
                {
                  "lineNumber": 281,
                  "content": "\t\t\tconst res = await proxyFetchGet(\"/api/providers\");"
                },
                {
                  "lineNumber": 413,
                  "content": "\t\t\t// 2. Save to /api/provider/ (save only base URL)"
                },
                {
                  "lineNumber": 425,
                  "content": "\t\t\tawait proxyFetchPost(\"/api/provider\", data);"
                },
                {
                  "lineNumber": 429,
                  "content": "\t\t\tconst res = await proxyFetchGet(\"/api/providers\");"
                },
                {
                  "lineNumber": 487,
                  "content": "\t\t\tawait proxyFetchPost(\"/api/provider/prefer\", {"
                },
                {
                  "lineNumber": 519,
                  "content": "\t\t\tawait proxyFetchPost(\"/api/provider/prefer\", {"
                },
                {
                  "lineNumber": 536,
                  "content": "\t\t\t\tawait proxyFetchDelete(&#96;/api/provider/${localProviderId}&#96;);"
                },
                {
                  "lineNumber": 553,
                  "content": "\t\t\t\tawait proxyFetchDelete(&#96;/api/provider/${provider_id}&#96;);"
                },
                {
                  "lineNumber": 589,
                  "content": "\t\tconst configsRes = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 603,
                  "content": "\t\tconst res = await proxyFetchGet(\"/api/subscription\");"
                },
                {
                  "lineNumber": 614,
                  "content": "\t\t\tconst res = await proxyFetchGet(&#96;/api/user/current_credits&#96;);"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\MCPMarket.tsx",
              "matches": [
                {
                  "lineNumber": 18,
                  "content": "import { proxyFetchDelete, proxyFetchGet, proxyFetchPost } from \"@/api/http\";"
                },
                {
                  "lineNumber": 106,
                  "content": "\t\tproxyFetchGet(\"/api/mcp/users\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 121,
                  "content": "\t\tproxyFetchGet(\"/api/mcp/categories\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 136,
                  "content": "\t\t\t\tconst res = await proxyFetchGet(\"/api/mcps\", params);"
                },
                {
                  "lineNumber": 213,
                  "content": "\t\t\tconst res = await proxyFetchPost(\"/api/mcp/install?mcp_id=\" + id);"
                },
                {
                  "lineNumber": 248,
                  "content": "\t\t\tawait proxyFetchDelete(&#96;/api/mcp/users/${id}&#96;);"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\components\\CookieManager.tsx",
              "matches": [
                {
                  "lineNumber": 4,
                  "content": "import { fetchGet, fetchDelete } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\MCP.tsx",
              "matches": [
                {
                  "lineNumber": 9,
                  "content": "} from \"@/api/http\";"
                },
                {
                  "lineNumber": 116,
                  "content": "\t\tproxyFetchGet(\"/api/configs\").then((configsRes) =&gt; {"
                },
                {
                  "lineNumber": 138,
                  "content": "\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 159,
                  "content": "\t\t\t\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", {"
                },
                {
                  "lineNumber": 196,
                  "content": "\t\t\t\t\t\t\t\t\t\tconst existingConfigs = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 214,
                  "content": "\t\t\t\t\t\t\t\t\t\t\t\t&#96;/api/configs/${existing.id}&#96;,"
                },
                {
                  "lineNumber": 218,
                  "content": "\t\t\t\t\t\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", configPayload);"
                },
                {
                  "lineNumber": 249,
                  "content": "\t\t\t\t\t\t\t\t\t\t\t\t\tconst configs = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 267,
                  "content": "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#96;/api/configs/${existing.id}&#96;,"
                },
                {
                  "lineNumber": 271,
                  "content": "\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", payload);"
                },
                {
                  "lineNumber": 316,
                  "content": "\t\t\t\t\t\t\tconst url = &#96;${baseURL}/api/oauth/${key.toLowerCase()}/login&#96;;"
                },
                {
                  "lineNumber": 356,
                  "content": "\t\tproxyFetchGet(\"/api/mcp/users\")"
                },
                {
                  "lineNumber": 382,
                  "content": "\t\t\tawait proxyFetchPut(&#96;/api/mcp/users/${id}&#96;, { status: checked ? 1 : 2 });"
                },
                {
                  "lineNumber": 419,
                  "content": "\t\t\tawait proxyFetchPut(&#96;/api/mcp/users/${showConfig.id}&#96;, mcpData);"
                },
                {
                  "lineNumber": 451,
                  "content": "\t\t\tawait proxyFetchPut(&#96;/api/mcp/users/${showConfig.id}&#96;, {"
                },
                {
                  "lineNumber": 497,
                  "content": "\t\t\t\tlet res = await proxyFetchPost(\"/api/mcp/import/local\", data);"
                },
                {
                  "lineNumber": 528,
                  "content": "\t\t\tawait proxyFetchDelete(&#96;/api/mcp/users/${deleteTarget.id}&#96;);"
                },
                {
                  "lineNumber": 668,
                  "content": "\t\t\t\t\t\t\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", {"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\General.tsx",
              "matches": [
                {
                  "lineNumber": 11,
                  "content": "import { proxyFetchPut, proxyFetchGet } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\pages\\Setting\\API.tsx",
              "matches": [
                {
                  "lineNumber": 5,
                  "content": "import { proxyFetchGet, proxyFetchPost } from \"@/api/http\";"
                },
                {
                  "lineNumber": 21,
                  "content": "\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 27,
                  "content": "\t\tproxyFetchGet(\"/api/configs\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 54,
                  "content": "\t\t\tawait proxyFetchPost(\"/api/configs\", {"
                }
              ]
            },
            {
              "file": "src\\pages\\Login.tsx",
              "matches": [
                {
                  "lineNumber": 14,
                  "content": "import { proxyFetchPost } from '@/api/http';"
                },
                {
                  "lineNumber": 127,
                  "content": "      const data = await proxyFetchPost('/api/login', {"
                },
                {
                  "lineNumber": 156,
                  "content": "      const data = await proxyFetchPost('/api/login-by_stack?token=' + token, {"
                },
                {
                  "lineNumber": 205,
                  "content": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 206,
                  "content": "        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 211,
                  "content": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 212,
                  "content": "        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 225,
                  "content": "        'https://api.stack-auth.com/api/v1/auth/oauth/token',"
                }
              ]
            },
            {
              "file": "src\\pages\\Home.tsx",
              "matches": [
                {
                  "lineNumber": 13,
                  "content": "import { proxyFetchPost } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\pages\\Dashboard\\Project.tsx",
              "matches": [
                {
                  "lineNumber": 39,
                  "content": "} from \"@/api/http\";"
                },
                {
                  "lineNumber": 158,
                  "content": "\t\t\tawait proxyFetchDelete(&#96;/api/chat/history/${id}&#96;);"
                }
              ]
            },
            {
              "file": "src\\pages\\Dashboard\\Browser.tsx",
              "matches": [
                {
                  "lineNumber": 4,
                  "content": "import { fetchPost, fetchGet, fetchDelete } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\lib\\share.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "import { proxyFetchPost } from \"@/api/http\";"
                },
                {
                  "lineNumber": 6,
                  "content": "\t\tconst res = await proxyFetchPost(&#96;/api/chat/share&#96;, {"
                }
              ]
            },
            {
              "file": "src\\lib\\oauth.ts",
              "matches": [
                {
                  "lineNumber": 32,
                  "content": "\t\tthis.redirect_uris = [&#96;https://dev.eigent.ai/api/oauth/${this.provider}/callback&#96;];"
                }
              ]
            },
            {
              "file": "src\\lib\\llm.ts",
              "matches": [
                {
                  "lineNumber": 17,
                  "content": "    apiHost: \"https://api.openai.com/v1\","
                },
                {
                  "lineNumber": 26,
                  "content": "    apiHost: 'https://api.anthropic.com/v1/',"
                },
                {
                  "lineNumber": 35,
                  "content": "    apiHost: 'https://openrouter.ai/api/v1',"
                },
                {
                  "lineNumber": 53,
                  "content": "    apiHost: 'https://api.deepseek.com',"
                },
                {
                  "lineNumber": 62,
                  "content": "    apiHost: 'https://api.minimax.io/v1',"
                },
                {
                  "lineNumber": 71,
                  "content": "    apiHost: 'https://api.z.ai/api/coding/paas/v4/',"
                },
                {
                  "lineNumber": 114,
                  "content": "    hostPlaceHolder: \"e.g. https://api.x.ai/v1\","
                }
              ]
            },
            {
              "file": "src\\hooks\\useIntegrationManagement.ts",
              "matches": [
                {
                  "lineNumber": 8,
                  "content": "} from \"@/api/http\";"
                },
                {
                  "lineNumber": 43,
                  "content": "\t\t\tconst configsRes = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 103,
                  "content": "\t\t\tconst fresh = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 111,
                  "content": "\t\t\tawait proxyFetchPut(&#96;/api/configs/${existingConfig.id}&#96;, configPayload);"
                },
                {
                  "lineNumber": 113,
                  "content": "\t\t\tconst res = await proxyFetchPost(\"/api/configs\", configPayload);"
                },
                {
                  "lineNumber": 116,
                  "content": "\t\t\t\t\tconst again = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 119,
                  "content": "\t\t\t\t\t\tawait proxyFetchPut(&#96;/api/configs/${found.id}&#96;, configPayload);"
                },
                {
                  "lineNumber": 144,
                  "content": "\t\t\t\t\t&#96;/api/oauth/${provider}/token&#96;,"
                },
                {
                  "lineNumber": 229,
                  "content": "\t\t\t\t\tawait proxyFetchDelete(&#96;/api/configs/${config.id}&#96;);"
                }
              ]
            },
            {
              "file": "src\\components\\TopBar\\index.tsx",
              "matches": [
                {
                  "lineNumber": 35,
                  "content": "import { proxyFetchGet, fetchPut, fetchDelete, proxyFetchDelete } from \"@/api/http\";"
                },
                {
                  "lineNumber": 134,
                  "content": "\t\t\tconst res: any = await proxyFetchGet(\"/api/user/invite_code\");"
                },
                {
                  "lineNumber": 180,
                  "content": "\t\t\t\t\tawait proxyFetchDelete(&#96;/api/chat/history/${historyId}&#96;);"
                }
              ]
            },
            {
              "file": "src\\components\\TerminalAgentWrokSpace\\index.tsx",
              "matches": [
                {
                  "lineNumber": 17,
                  "content": "import { fetchPut } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\components\\SearchHistoryDialog.tsx",
              "matches": [
                {
                  "lineNumber": 28,
                  "content": "import { proxyFetchGet } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\components\\IntegrationList\\index.tsx",
              "matches": [
                {
                  "lineNumber": 9,
                  "content": "import { fetchGet, fetchPost } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\components\\InstallStep\\Permissions.tsx",
              "matches": [
                {
                  "lineNumber": 5,
                  "content": "import { proxyFetchGet, proxyFetchPut } from \"@/api/http\";"
                },
                {
                  "lineNumber": 35,
                  "content": "\t\tproxyFetchGet(\"/api/user/privacy\")"
                },
                {
                  "lineNumber": 65,
                  "content": "\t\tproxyFetchPut(\"/api/user/privacy\", requestData).catch((err) =&gt;"
                }
              ]
            },
            {
              "file": "src\\components\\HistorySidebar\\index.tsx",
              "matches": [
                {
                  "lineNumber": 40,
                  "content": "import { proxyFetchGet, proxyFetchDelete } from \"@/api/http\";"
                },
                {
                  "lineNumber": 161,
                  "content": "\t\t\tconst res = await proxyFetchDelete(&#96;/api/chat/history/${historyId}&#96;);"
                },
                {
                  "lineNumber": 193,
                  "content": "\t\t\t\t\t\tconst deleteRes = await proxyFetchDelete(&#96;/api/chat/history/${history.id}&#96;);"
                }
              ]
            },
            {
              "file": "src\\components\\GroupedHistoryView\\index.tsx",
              "matches": [
                {
                  "lineNumber": 11,
                  "content": "import { proxyFetchDelete, proxyFetchPut } from \"@/api/http\";"
                },
                {
                  "lineNumber": 109,
                  "content": "              await proxyFetchDelete(&#96;/api/chat/history/${history.id}&#96;);"
                },
                {
                  "lineNumber": 172,
                  "content": "      const response = await proxyFetchPut(&#96;/api/chat/project/${projectId}/name?new_name=${encodeURIComponent(newName)}&#96;);"
                }
              ]
            },
            {
              "file": "src\\components\\Folder\\index.tsx",
              "matches": [
                {
                  "lineNumber": 18,
                  "content": "import { proxyFetchGet } from '@/api/http';"
                },
                {
                  "lineNumber": 330,
                  "content": "          res = await proxyFetchGet('/api/chat/files', {"
                }
              ]
            },
            {
              "file": "src\\components\\Dialog\\Privacy.tsx",
              "matches": [
                {
                  "lineNumber": 20,
                  "content": "import { proxyFetchGet, proxyFetchPut } from \"@/api/http\";"
                },
                {
                  "lineNumber": 62,
                  "content": "\t\tproxyFetchGet(\"/api/user/privacy\")"
                },
                {
                  "lineNumber": 93,
                  "content": "\t\tproxyFetchPut(\"/api/user/privacy\", requestData).catch((err) =&gt;"
                },
                {
                  "lineNumber": 112,
                  "content": "\t\tproxyFetchPut(\"/api/user/privacy\", requestData)"
                }
              ]
            },
            {
              "file": "src\\components\\ChatBox\\index.tsx",
              "matches": [
                {
                  "lineNumber": 8,
                  "content": "} from '@/api/http';"
                },
                {
                  "lineNumber": 13,
                  "content": "import { proxyFetchGet } from '@/api/http';"
                },
                {
                  "lineNumber": 50,
                  "content": "        const res = await proxyFetchGet('/api/user/key');"
                },
                {
                  "lineNumber": 54,
                  "content": "        const res = await proxyFetchGet('/api/providers', { prefer: true });"
                },
                {
                  "lineNumber": 80,
                  "content": "    proxyFetchGet('/api/user/privacy')"
                },
                {
                  "lineNumber": 94,
                  "content": "    proxyFetchGet('/api/configs')"
                },
                {
                  "lineNumber": 135,
                  "content": "  // \t\tproxyFetchGet(\"/api/user/privacy\")"
                },
                {
                  "lineNumber": 353,
                  "content": "            proxyFetchPut('/api/user/privacy', requestData);"
                },
                {
                  "lineNumber": 424,
                  "content": "    const res = await proxyFetchGet(&#96;/api/chat/share/info/${_token}&#96;);"
                },
                {
                  "lineNumber": 673,
                  "content": "        await proxyFetchDelete(&#96;/api/chat/history/${history_id}&#96;);"
                },
                {
                  "lineNumber": 1092,
                  "content": "                        proxyFetchPut('/api/user/privacy', requestData);"
                }
              ]
            },
            {
              "file": "src\\components\\BrowserAgentWorkSpace\\index.tsx",
              "matches": [
                {
                  "lineNumber": 17,
                  "content": "import { fetchPut } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\components\\AddWorker\\index.tsx",
              "matches": [
                {
                  "lineNumber": 22,
                  "content": "import { fetchPost } from \"@/api/http\";"
                }
              ]
            },
            {
              "file": "src\\components\\AddWorker\\ToolSelect.tsx",
              "matches": [
                {
                  "lineNumber": 10,
                  "content": "import { proxyFetchGet, proxyFetchPost, proxyFetchPut, fetchPost, fetchGet } from \"@/api/http\";"
                },
                {
                  "lineNumber": 59,
                  "content": "\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 83,
                  "content": "\t\t\t\t\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", {"
                },
                {
                  "lineNumber": 117,
                  "content": "                                            const existingConfigs = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 132,
                  "content": "                                                await proxyFetchPut(&#96;/api/configs/${existing.id}&#96;, configPayload);"
                },
                {
                  "lineNumber": 134,
                  "content": "                                                await proxyFetchPost(\"/api/configs\", configPayload);"
                },
                {
                  "lineNumber": 169,
                  "content": "\t\t\t\t\t\t\t\t(window.location.href = &#96;${baseURL}/api/oauth/${key.toLowerCase()}/login&#96;);"
                },
                {
                  "lineNumber": 222,
                  "content": "\t\tproxyFetchGet(\"/api/mcps\", {"
                },
                {
                  "lineNumber": 241,
                  "content": "\t\tproxyFetchGet(\"/api/mcp/users\").then((res) =&gt; {"
                },
                {
                  "lineNumber": 281,
                  "content": "\t\tconst configsRes = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 298,
                  "content": "\t\t\tawait proxyFetchPut(&#96;/api/configs/${existingConfig.id}&#96;, configPayload);"
                },
                {
                  "lineNumber": 301,
                  "content": "\t\t\tawait proxyFetchPost(\"/api/configs\", configPayload);"
                },
                {
                  "lineNumber": 371,
                  "content": "\t\t\t\t\tconst existingConfigs = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 386,
                  "content": "\t\t\t\t\t\tawait proxyFetchPut(&#96;/api/configs/${existing.id}&#96;, configPayload);"
                },
                {
                  "lineNumber": 388,
                  "content": "\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", configPayload);"
                },
                {
                  "lineNumber": 423,
                  "content": "\t\t\t\t\t\t\t\t\tconst existingConfigs = await proxyFetchGet(\"/api/configs\");"
                },
                {
                  "lineNumber": 438,
                  "content": "\t\t\t\t\t\t\t\t\t\tawait proxyFetchPut(&#96;/api/configs/${existing.id}&#96;, configPayload);"
                },
                {
                  "lineNumber": 440,
                  "content": "\t\t\t\t\t\t\t\t\t\tawait proxyFetchPost(\"/api/configs\", configPayload);"
                },
                {
                  "lineNumber": 485,
                  "content": "\t\t\tawait proxyFetchPost(\"/api/mcp/install?mcp_id=\" + id);"
                }
              ]
            }
          ],
          "totalLines": 169,
          "totalMatchedLines": 169
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "where is the API prefix /api configured or used in frontend",
  "includePattern": "src",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "column": 48
          },
          "endPosition": {
            "line": 59,
            "column": 1
          }
        },
        "contents": "import { showCreditsToast } from '@/components/Toast/creditsToast';\nimport { showStorageToast } from '@/components/Toast/storageToast';\nimport { showTrafficToast } from '@/components/Toast/trafficToast';\n\nconst defaultHeaders = {\n  'Content-Type': 'application/json',\n}\n\nlet baseUrl = ''\nexport async function getBaseURL() {\n  if (baseUrl) {\n    return baseUrl\n  }\n  const port = await window.ipcRenderer.invoke('get-backend-port')\n  baseUrl = &#96;http://localhost:${port}&#96;\n  return baseUrl\n}\n\nasync function fetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  \n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { showCreditsToast } from '@/components/Toast/creditsToast';",
            "lineNumber": 2
          },
          {
            "text": "import { showStorageToast } from '@/components/Toast/storageToast';",
            "lineNumber": 3
          },
          {
            "text": "import { showTrafficToast } from '@/components/Toast/trafficToast';",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "const defaultHeaders = {",
            "lineNumber": 6
          },
          {
            "text": "  'Content-Type': 'application/json',",
            "lineNumber": 7
          },
          {
            "text": "}",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "let baseUrl = ''",
            "lineNumber": 10
          },
          {
            "text": "export async function getBaseURL() {",
            "lineNumber": 11,
            "isSignature": true
          },
          {
            "text": "  if (baseUrl) {",
            "lineNumber": 12
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 13
          },
          {
            "text": "  }",
            "lineNumber": 14
          },
          {
            "text": "  const port = await window.ipcRenderer.invoke('get-backend-port')",
            "lineNumber": 15
          },
          {
            "text": "  baseUrl = &#96;http://localhost:${port}&#96;",
            "lineNumber": 16
          },
          {
            "text": "  return baseUrl",
            "lineNumber": 17
          },
          {
            "text": "}",
            "lineNumber": 18,
            "isSignature": true
          },
          {
            "lineNumber": 19
          },
          {
            "text": "async function fetchRequest(",
            "lineNumber": 20,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 22,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 23,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 24,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "  ",
            "lineNumber": 26
          },
          {
            "text": "}",
            "lineNumber": 60,
            "isSignature": true
          }
        ]
      },
      "score": 0.4664488136768341
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 135,
            "column": 44
          },
          "endPosition": {
            "line": 219,
            "column": 1
          }
        },
        "contents": "// =============== porxy ===============\n\n// get proxy base URL\nasync function getProxyBaseURL() {\n  const isDev = import.meta.env.DEV\n  const rawValue = import.meta.env.VITE_USE_LOCAL_PROXY\n  const useLocalProxy = rawValue === 'true'\n  console.log('[getProxyBaseURL] Debug info:', {\n    isDev,\n    rawValue,\n    rawValueType: typeof rawValue,\n    rawValueLength: rawValue?.length,\n    useLocalProxy,\n    allEnvKeys: Object.keys(import.meta.env).filter(key =&gt; key.startsWith('VITE_'))\n  })\n\n  if (isDev) {\n    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n    if (useLocalProxy) {\n      // Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n      return import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'\n    } else {\n      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n      return import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'\n    }\n  } else {\n    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n    const baseUrl = import.meta.env.VITE_BASE_URL\n    if (!baseUrl) {\n      throw new Error('VITE_BASE_URL not configured')\n    }\n    return baseUrl\n  }\n}\n\nasync function proxyFetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  \n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// =============== porxy ===============",
            "lineNumber": 138
          },
          {
            "lineNumber": 139
          },
          {
            "text": "// get proxy base URL",
            "lineNumber": 140
          },
          {
            "text": "async function getProxyBaseURL() {",
            "lineNumber": 141,
            "isSignature": true
          },
          {
            "text": "  const isDev = import.meta.env.DEV",
            "lineNumber": 142
          },
          {
            "text": "  const rawValue = import.meta.env.VITE_USE_LOCAL_PROXY",
            "lineNumber": 143
          },
          {
            "text": "  const useLocalProxy = rawValue === 'true'",
            "lineNumber": 144
          },
          {
            "text": "  console.log('[getProxyBaseURL] Debug info:', {",
            "lineNumber": 145
          },
          {
            "text": "    isDev,",
            "lineNumber": 146
          },
          {
            "text": "    rawValue,",
            "lineNumber": 147
          },
          {
            "text": "    rawValueType: typeof rawValue,",
            "lineNumber": 148
          },
          {
            "text": "    rawValueLength: rawValue?.length,",
            "lineNumber": 149
          },
          {
            "text": "    useLocalProxy,",
            "lineNumber": 150
          },
          {
            "text": "    allEnvKeys: Object.keys(import.meta.env).filter(key =&gt; key.startsWith('VITE_'))",
            "lineNumber": 151
          },
          {
            "text": "  })",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "  if (isDev) {",
            "lineNumber": 154
          },
          {
            "text": "    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 155
          },
          {
            "text": "    if (useLocalProxy) {",
            "lineNumber": 156
          },
          {
            "text": "      // Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 157
          },
          {
            "text": "      return import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'",
            "lineNumber": 158
          },
          {
            "text": "    } else {",
            "lineNumber": 159
          },
          {
            "text": "      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 160
          },
          {
            "text": "      return import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'",
            "lineNumber": 161
          },
          {
            "text": "    }",
            "lineNumber": 162
          },
          {
            "text": "  } else {",
            "lineNumber": 163
          },
          {
            "text": "    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 164
          },
          {
            "text": "    const baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 165
          },
          {
            "text": "    if (!baseUrl) {",
            "lineNumber": 166
          },
          {
            "text": "      throw new Error('VITE_BASE_URL not configured')",
            "lineNumber": 167
          },
          {
            "text": "    }",
            "lineNumber": 168
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 169
          },
          {
            "text": "  }",
            "lineNumber": 170
          },
          {
            "text": "}",
            "lineNumber": 171,
            "isSignature": true
          },
          {
            "lineNumber": 172
          },
          {
            "text": "async function proxyFetchRequest(",
            "lineNumber": 173,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 174,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 175,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 176,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 177,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 178,
            "isSignature": true
          },
          {
            "text": "  ",
            "lineNumber": 179
          },
          {
            "text": "}",
            "lineNumber": 220,
            "isSignature": true
          }
        ]
      },
      "score": 0.4454343020915985
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 170,
            "column": 1
          },
          "endPosition": {
            "line": 222
          }
        },
        "contents": "async function proxyFetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getProxyBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const headers: Record&lt;string, string&gt; = {\n    ...defaultHeaders,\n    ...customHeaders,\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    headers['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header\n  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      headers['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method,\n    headers,\n  }\n\n  if (method === 'GET') {\n    const query = data\n      ? '?' +\n      Object.entries(data)\n        .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)\n        .join('&amp;')\n      : ''\n    return handleResponse(fetch(fullUrl + query, options))\n  }\n\n  if (data) {\n    options.body = JSON.stringify(data)\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\nexport const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function proxyFetchRequest(",
            "lineNumber": 173,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 174,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 175,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 176,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 177,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 178,
            "isSignature": true
          },
          {
            "text": "  const baseURL = await getProxyBaseURL()",
            "lineNumber": 179
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 180
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 181
          },
          {
            "lineNumber": 182
          },
          {
            "text": "  const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 183
          },
          {
            "text": "    ...defaultHeaders,",
            "lineNumber": 184
          },
          {
            "text": "    ...customHeaders,",
            "lineNumber": 185
          },
          {
            "text": "  }",
            "lineNumber": 186
          },
          {
            "lineNumber": 187
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 188
          },
          {
            "text": "    headers['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 189
          },
          {
            "text": "  }",
            "lineNumber": 190
          },
          {
            "lineNumber": 191
          },
          {
            "text": "  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header",
            "lineNumber": 192
          },
          {
            "text": "  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {",
            "lineNumber": 193
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 194
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 195
          },
          {
            "text": "      headers['X-Proxy-Target'] = targetUrl",
            "lineNumber": 196
          },
          {
            "text": "    }",
            "lineNumber": 197
          },
          {
            "text": "  }",
            "lineNumber": 198
          },
          {
            "lineNumber": 199
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 200
          },
          {
            "text": "    method,",
            "lineNumber": 201
          },
          {
            "text": "    headers,",
            "lineNumber": 202
          },
          {
            "text": "  }",
            "lineNumber": 203
          },
          {
            "lineNumber": 204
          },
          {
            "text": "  if (method === 'GET') {",
            "lineNumber": 205
          },
          {
            "text": "    const query = data",
            "lineNumber": 206
          },
          {
            "text": "      ? '?' +",
            "lineNumber": 207
          },
          {
            "text": "      Object.entries(data)",
            "lineNumber": 208
          },
          {
            "text": "        .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)",
            "lineNumber": 209
          },
          {
            "text": "        .join('&amp;')",
            "lineNumber": 210
          },
          {
            "text": "      : ''",
            "lineNumber": 211
          },
          {
            "text": "    return handleResponse(fetch(fullUrl + query, options))",
            "lineNumber": 212
          },
          {
            "text": "  }",
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "  if (data) {",
            "lineNumber": 215
          },
          {
            "text": "    options.body = JSON.stringify(data)",
            "lineNumber": 216
          },
          {
            "text": "  }",
            "lineNumber": 217
          },
          {
            "lineNumber": 218
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 219
          },
          {
            "text": "}",
            "lineNumber": 220,
            "isSignature": true
          },
          {
            "lineNumber": 221
          },
          {
            "text": "export const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 222
          }
        ]
      },
      "score": 0.436198353767395
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 17,
            "column": 1
          },
          "endPosition": {
            "line": 122,
            "column": 1
          }
        },
        "contents": "async function fetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const headers: Record&lt;string, string&gt; = {\n    ...defaultHeaders,\n    ...customHeaders,\n  }\n\n  // Cases without token: url is a complete http:// path\n  if (!url.includes('http://') &amp;&amp; token) {\n    headers['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  const options: RequestInit = {\n    method,\n    headers,\n  }\n\n  if (method === 'GET') {\n    const query = data\n      ? '?' +\n      Object.entries(data)\n        .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)\n        .join('&amp;')\n      : ''\n    return handleResponse(fetch(fullUrl + query, options), data)\n  }\n\n  if (data) {\n    options.body = JSON.stringify(data)\n  }\n\n  return handleResponse(fetch(fullUrl, options), data)\n}\n\nasync function handleResponse(responsePromise: Promise&lt;Response&gt;, requestData?: Record&lt;string, any&gt;): Promise&lt;any&gt; {\n  \n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function fetchRequest(",
            "lineNumber": 20,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 22,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 23,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 24,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "  const baseURL = await getBaseURL()",
            "lineNumber": 26
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 27
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "  const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 30
          },
          {
            "text": "    ...defaultHeaders,",
            "lineNumber": 31
          },
          {
            "text": "    ...customHeaders,",
            "lineNumber": 32
          },
          {
            "text": "  }",
            "lineNumber": 33
          },
          {
            "lineNumber": 34
          },
          {
            "text": "  // Cases without token: url is a complete http:// path",
            "lineNumber": 35
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; token) {",
            "lineNumber": 36
          },
          {
            "text": "    headers['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 37
          },
          {
            "text": "  }",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 40
          },
          {
            "text": "    method,",
            "lineNumber": 41
          },
          {
            "text": "    headers,",
            "lineNumber": 42
          },
          {
            "text": "  }",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "  if (method === 'GET') {",
            "lineNumber": 45
          },
          {
            "text": "    const query = data",
            "lineNumber": 46
          },
          {
            "text": "      ? '?' +",
            "lineNumber": 47
          },
          {
            "text": "      Object.entries(data)",
            "lineNumber": 48
          },
          {
            "text": "        .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)",
            "lineNumber": 49
          },
          {
            "text": "        .join('&amp;')",
            "lineNumber": 50
          },
          {
            "text": "      : ''",
            "lineNumber": 51
          },
          {
            "text": "    return handleResponse(fetch(fullUrl + query, options), data)",
            "lineNumber": 52
          },
          {
            "text": "  }",
            "lineNumber": 53
          },
          {
            "lineNumber": 54
          },
          {
            "text": "  if (data) {",
            "lineNumber": 55
          },
          {
            "text": "    options.body = JSON.stringify(data)",
            "lineNumber": 56
          },
          {
            "text": "  }",
            "lineNumber": 57
          },
          {
            "lineNumber": 58
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options), data)",
            "lineNumber": 59
          },
          {
            "text": "}",
            "lineNumber": 60,
            "isSignature": true
          },
          {
            "lineNumber": 61
          },
          {
            "text": "async function handleResponse(responsePromise: Promise&lt;Response&gt;, requestData?: Record&lt;string, any&gt;): Promise&lt;any&gt; {",
            "lineNumber": 62,
            "isSignature": true
          },
          {
            "text": "  ",
            "lineNumber": 63
          },
          {
            "text": "}",
            "lineNumber": 123,
            "isSignature": true
          }
        ]
      },
      "score": 0.4135620594024658
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\lib\\index.ts",
        "range": {
          "startPosition": {
            "column": 48
          },
          "endPosition": {
            "line": 24,
            "column": 1
          }
        },
        "contents": "export function getProxyBaseURL() {\n\tconst isDev = import.meta.env.DEV\n\n\tif (isDev) {\n\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL\n\t\tif (!proxyUrl) {\n\t\t\treturn 'http://localhost:3001'\n\t\t}\n\t\treturn proxyUrl\n\t} else {\n\t\tconst baseUrl = import.meta.env.VITE_BASE_URL\n\t\tif (!baseUrl) {\n\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");\n\t\t}\n\t\treturn baseUrl;\n\t}\n}\n\nexport function generateUniqueId(): string {\n\tconst timestamp = Date.now();\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export function getProxyBaseURL() {",
            "lineNumber": 3,
            "isSignature": true
          },
          {
            "text": "\tconst isDev = import.meta.env.DEV",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "\tif (isDev) {",
            "lineNumber": 6
          },
          {
            "text": "\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 7
          },
          {
            "text": "\t\tif (!proxyUrl) {",
            "lineNumber": 8
          },
          {
            "text": "\t\t\treturn 'http://localhost:3001'",
            "lineNumber": 9
          },
          {
            "text": "\t\t}",
            "lineNumber": 10
          },
          {
            "text": "\t\treturn proxyUrl",
            "lineNumber": 11
          },
          {
            "text": "\t} else {",
            "lineNumber": 12
          },
          {
            "text": "\t\tconst baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 13
          },
          {
            "text": "\t\tif (!baseUrl) {",
            "lineNumber": 14
          },
          {
            "text": "\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");",
            "lineNumber": 15
          },
          {
            "text": "\t\t}",
            "lineNumber": 16
          },
          {
            "text": "\t\treturn baseUrl;",
            "lineNumber": 17
          },
          {
            "text": "\t}",
            "lineNumber": 18
          },
          {
            "text": "}",
            "lineNumber": 19,
            "isSignature": true
          },
          {
            "lineNumber": 20
          },
          {
            "text": "export function generateUniqueId(): string {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "\tconst timestamp = Date.now();",
            "lineNumber": 22
          },
          {
            "text": "}",
            "lineNumber": 25,
            "isSignature": true
          }
        ]
      },
      "score": 0.40189799666404724
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\nasync (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n\n\t\t\tif (modelType === 'custom' || modelType === 'local') {\n\t\t\t\tconst res = await proxyFetchGet('/api/providers', {\n\t\t\t\t\tprefer: true\n\t\t\t\t});\n\t\t\t\tconst providerList = res.items || []\n\t\t\t\tconsole.log('providerList', providerList)\n\t\t\t\tconst provider = providerList[0]\n\n\t\t\t\tif (!provider) {\n\t\t\t\t\tthrow new Error('No model provider configured. Please go to Settings &gt; Models and configure at least one model provider as default.');\n\t\t\t\t}\n\n\t\t\t\tapiModel = {\n\t\t\t\t\tapi_key: provider.api_key,\n\t\t\t\t\tmodel_type: provider.model_type,\n\t\t\t\t\tmodel_platform: provider.provider_name,\n\t\t\t\t\tapi_url: provider.endpoint_url || provider.api_url,\n\t\t\t\t\textra_params: provider.encrypted_config\n\t\t\t\t}\n\t\t\t} else if (modelType === 'cloud') {\n\t\t\t\t// get current model\n\t\t\t\tconst res = await proxyFetchGet('/api/user/key');\n\t\t\t\tif (res.warning_code &amp;&amp; res.warning_code === '21') {\n\t\t\t\t\tshowStorageToast()\n\t\t\t\t}\n\t\t\t\tapiModel = {\n\t\t\t\t\tapi_key: res.value,\n\t\t\t\t\tmodel_type: cloud_model_type,\n\t\t\t\t\tmodel_platform: cloud_model_type.includes('gpt') ? 'openai' :\n\t\t\t\t\t\tcloud_model_type.includes('claude') ? 'anthropic' :\n\t\t\t\t\t\t\tcloud_model_type.includes('gemini') ? 'gemini' : 'openai-compatible-model',\n\t\t\t\t\tapi_url: res.api_url,\n\t\t\t\t\textra_params: {}\n\t\t\t\t}\n\t\t\t}\n\n\n\n\n\n\t\t\tlet mcpLocal = {}\n\t\t\tif (window.ipcRenderer) {\n\t\t\t\tmcpLocal = await window.ipcRenderer.invoke(\"mcp-list\");\n\t\t\t}\n\t\t\tconsole.log('mcpLocal', mcpLocal)\n\n\t\t\t// Get search engine configuration for custom mode\n\t\t\tlet searchConfig: Record&lt;string, string&gt; = {}\n\t\t\tif (modelType === 'custom') {\n\t\t\t\ttry\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            },
            {
              "startPosition": {
                "line": 331,
                "column": 14
              },
              "endPosition": {
                "line": 332,
                "column": 4
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": "async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "lineNumber": 425
          },
          {
            "text": "\t\t\tif (modelType === 'custom' || modelType === 'local') {",
            "lineNumber": 426
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet('/api/providers', {",
            "lineNumber": 427
          },
          {
            "text": "\t\t\t\t\tprefer: true",
            "lineNumber": 428
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 429
          },
          {
            "text": "\t\t\t\tconst providerList = res.items || []",
            "lineNumber": 430
          },
          {
            "text": "\t\t\t\tconsole.log('providerList', providerList)",
            "lineNumber": 431
          },
          {
            "text": "\t\t\t\tconst provider = providerList[0]",
            "lineNumber": 432
          },
          {
            "lineNumber": 433
          },
          {
            "text": "\t\t\t\tif (!provider) {",
            "lineNumber": 434
          },
          {
            "text": "\t\t\t\t\tthrow new Error('No model provider configured. Please go to Settings &gt; Models and configure at least one model provider as default.');",
            "lineNumber": 435
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 436
          },
          {
            "lineNumber": 437
          },
          {
            "text": "\t\t\t\tapiModel = {",
            "lineNumber": 438
          },
          {
            "text": "\t\t\t\t\tapi_key: provider.api_key,",
            "lineNumber": 439
          },
          {
            "text": "\t\t\t\t\tmodel_type: provider.model_type,",
            "lineNumber": 440
          },
          {
            "text": "\t\t\t\t\tmodel_platform: provider.provider_name,",
            "lineNumber": 441
          },
          {
            "text": "\t\t\t\t\tapi_url: provider.endpoint_url || provider.api_url,",
            "lineNumber": 442
          },
          {
            "text": "\t\t\t\t\textra_params: provider.encrypted_config",
            "lineNumber": 443
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 444
          },
          {
            "text": "\t\t\t} else if (modelType === 'cloud') {",
            "lineNumber": 445
          },
          {
            "text": "\t\t\t\t// get current model",
            "lineNumber": 446
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet('/api/user/key');",
            "lineNumber": 447
          },
          {
            "text": "\t\t\t\tif (res.warning_code &amp;&amp; res.warning_code === '21') {",
            "lineNumber": 448
          },
          {
            "text": "\t\t\t\t\tshowStorageToast()",
            "lineNumber": 449
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 450
          },
          {
            "text": "\t\t\t\tapiModel = {",
            "lineNumber": 451
          },
          {
            "text": "\t\t\t\t\tapi_key: res.value,",
            "lineNumber": 452
          },
          {
            "text": "\t\t\t\t\tmodel_type: cloud_model_type,",
            "lineNumber": 453
          },
          {
            "text": "\t\t\t\t\tmodel_platform: cloud_model_type.includes('gpt') ? 'openai' :",
            "lineNumber": 454
          },
          {
            "text": "\t\t\t\t\t\tcloud_model_type.includes('claude') ? 'anthropic' :",
            "lineNumber": 455
          },
          {
            "text": "\t\t\t\t\t\t\tcloud_model_type.includes('gemini') ? 'gemini' : 'openai-compatible-model',",
            "lineNumber": 456
          },
          {
            "text": "\t\t\t\t\tapi_url: res.api_url,",
            "lineNumber": 457
          },
          {
            "text": "\t\t\t\t\textra_params: {}",
            "lineNumber": 458
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 459
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 460
          },
          {
            "lineNumber": 461
          },
          {
            "lineNumber": 462
          },
          {
            "lineNumber": 463
          },
          {
            "lineNumber": 464
          },
          {
            "lineNumber": 465
          },
          {
            "text": "\t\t\tlet mcpLocal = {}",
            "lineNumber": 466
          },
          {
            "text": "\t\t\tif (window.ipcRenderer) {",
            "lineNumber": 467
          },
          {
            "text": "\t\t\t\tmcpLocal = await window.ipcRenderer.invoke(\"mcp-list\");",
            "lineNumber": 468
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 469
          },
          {
            "text": "\t\t\tconsole.log('mcpLocal', mcpLocal)",
            "lineNumber": 470
          },
          {
            "lineNumber": 471
          },
          {
            "text": "\t\t\t// Get search engine configuration for custom mode",
            "lineNumber": 472
          },
          {
            "text": "\t\t\tlet searchConfig: Record&lt;string, string&gt; = {}",
            "lineNumber": 473
          },
          {
            "text": "\t\t\tif (modelType === 'custom') {",
            "lineNumber": 474
          },
          {
            "text": "\t\t\t\ttry",
            "lineNumber": 475
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.36450329422950745
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 59,
            "column": 1
          },
          "endPosition": {
            "line": 126
          }
        },
        "contents": "async function handleResponse(responsePromise: Promise&lt;Response&gt;, requestData?: Record&lt;string, any&gt;): Promise&lt;any&gt; {\n  try {\n    const res = await responsePromise\n    if (res.status === 204) {\n      return { code: 0, text: '' }\n    }\n\n    const contentType = res.headers.get('content-type') || ''\n    if (res.body &amp;&amp; !contentType.includes('application/json')) {\n      return {\n        isStream: true,\n        body: res.body,\n        reader: res.body.getReader(),\n      }\n    }\n    const resData = await res.json()\n    if (!resData) {\n      return null\n    }\n    const { code, text } = resData\n    // showCreditsToast()\n    if (code === 1 || code === 300) {\n      return resData\n    }\n\n    if (code === 20) {\n      showCreditsToast()\n      return resData\n    }\n\n    if (code === 21) {\n      showStorageToast()\n      return resData\n    }\n\n    if (code === 13) {\n      // const { logout } = getAuthStore()\n      // logout()\n      // window.location.href = '#/login'\n      throw new Error(text)\n    }\n\n    return resData\n  } catch (err: any) {\n\n    // Only show traffic toast for cloud model requests\n    const isCloudRequest = requestData?.api_url === 'cloud'\n    if (isCloudRequest) {\n      showTrafficToast()\n    }\n\n    console.error('[fetch error]:', err)\n\n    if (err?.response?.status === 401) {\n      // const { logout } = getAuthStore()\n      // logout()\n      // window.location.href = '#/login'\n    }\n\n    throw err\n  }\n}\n\n// Encapsulate common methods\nexport const fetchGet = (url: string, params?: any, headers?: any)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function handleResponse(responsePromise: Promise&lt;Response&gt;, requestData?: Record&lt;string, any&gt;): Promise&lt;any&gt; {",
            "lineNumber": 62,
            "isSignature": true
          },
          {
            "text": "  try {",
            "lineNumber": 63
          },
          {
            "text": "    const res = await responsePromise",
            "lineNumber": 64
          },
          {
            "text": "    if (res.status === 204) {",
            "lineNumber": 65
          },
          {
            "text": "      return { code: 0, text: '' }",
            "lineNumber": 66
          },
          {
            "text": "    }",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "    const contentType = res.headers.get('content-type') || ''",
            "lineNumber": 69
          },
          {
            "text": "    if (res.body &amp;&amp; !contentType.includes('application/json')) {",
            "lineNumber": 70
          },
          {
            "text": "      return {",
            "lineNumber": 71
          },
          {
            "text": "        isStream: true,",
            "lineNumber": 72
          },
          {
            "text": "        body: res.body,",
            "lineNumber": 73
          },
          {
            "text": "        reader: res.body.getReader(),",
            "lineNumber": 74
          },
          {
            "text": "      }",
            "lineNumber": 75
          },
          {
            "text": "    }",
            "lineNumber": 76
          },
          {
            "text": "    const resData = await res.json()",
            "lineNumber": 77
          },
          {
            "text": "    if (!resData) {",
            "lineNumber": 78
          },
          {
            "text": "      return null",
            "lineNumber": 79
          },
          {
            "text": "    }",
            "lineNumber": 80
          },
          {
            "text": "    const { code, text } = resData",
            "lineNumber": 81
          },
          {
            "text": "    // showCreditsToast()",
            "lineNumber": 82
          },
          {
            "text": "    if (code === 1 || code === 300) {",
            "lineNumber": 83
          },
          {
            "text": "      return resData",
            "lineNumber": 84
          },
          {
            "text": "    }",
            "lineNumber": 85
          },
          {
            "lineNumber": 86
          },
          {
            "text": "    if (code === 20) {",
            "lineNumber": 87
          },
          {
            "text": "      showCreditsToast()",
            "lineNumber": 88
          },
          {
            "text": "      return resData",
            "lineNumber": 89
          },
          {
            "text": "    }",
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "text": "    if (code === 21) {",
            "lineNumber": 92
          },
          {
            "text": "      showStorageToast()",
            "lineNumber": 93
          },
          {
            "text": "      return resData",
            "lineNumber": 94
          },
          {
            "text": "    }",
            "lineNumber": 95
          },
          {
            "lineNumber": 96
          },
          {
            "text": "    if (code === 13) {",
            "lineNumber": 97
          },
          {
            "text": "      // const { logout } = getAuthStore()",
            "lineNumber": 98
          },
          {
            "text": "      // logout()",
            "lineNumber": 99
          },
          {
            "text": "      // window.location.href = '#/login'",
            "lineNumber": 100
          },
          {
            "text": "      throw new Error(text)",
            "lineNumber": 101
          },
          {
            "text": "    }",
            "lineNumber": 102
          },
          {
            "lineNumber": 103
          },
          {
            "text": "    return resData",
            "lineNumber": 104
          },
          {
            "text": "  } catch (err: any) {",
            "lineNumber": 105
          },
          {
            "lineNumber": 106
          },
          {
            "text": "    // Only show traffic toast for cloud model requests",
            "lineNumber": 107
          },
          {
            "text": "    const isCloudRequest = requestData?.api_url === 'cloud'",
            "lineNumber": 108
          },
          {
            "text": "    if (isCloudRequest) {",
            "lineNumber": 109
          },
          {
            "text": "      showTrafficToast()",
            "lineNumber": 110
          },
          {
            "text": "    }",
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "    console.error('[fetch error]:', err)",
            "lineNumber": 113
          },
          {
            "lineNumber": 114
          },
          {
            "text": "    if (err?.response?.status === 401) {",
            "lineNumber": 115
          },
          {
            "text": "      // const { logout } = getAuthStore()",
            "lineNumber": 116
          },
          {
            "text": "      // logout()",
            "lineNumber": 117
          },
          {
            "text": "      // window.location.href = '#/login'",
            "lineNumber": 118
          },
          {
            "text": "    }",
            "lineNumber": 119
          },
          {
            "lineNumber": 120
          },
          {
            "text": "    throw err",
            "lineNumber": 121
          },
          {
            "text": "  }",
            "lineNumber": 122
          },
          {
            "text": "}",
            "lineNumber": 123,
            "isSignature": true
          },
          {
            "lineNumber": 124
          },
          {
            "text": "// Encapsulate common methods",
            "lineNumber": 125
          },
          {
            "text": "export const fetchGet = (url: string, params?: any, headers?: any)",
            "lineNumber": 126
          }
        ]
      },
      "score": 0.36312639713287354
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\nasync (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n // Default to current store\n\t\t\t/**\n\t\t\t * Replay creates its own chatStore for each task with replayProject\n\t\t\t */\n\t\t\tif (project_id &amp;&amp; type !== \"replay\") {\n\t\t\t\tconsole.log(\"Creating a new Chat Instance for current project on end\")\n\t\t\t\tconst newChatResult = projectStore.appendInitChatStore(project_id);\n\n\t\t\t\tif (newChatResult) {\n\t\t\t\t\tnewTaskId = newChatResult.taskId;\n\t\t\t\t\ttargetChatStore = newChatResult.chatStore;\n\t\t\t\t\ttargetChatStore.getState().setIsPending(newTaskId, true);\n\n\t\t\t\t\t//From handleSend if message is given\n\t\t\t\t\t// Add the message to the new chatStore if provided\n\t\t\t\t\tif (messageContent) {\n\t\t\t\t\t\ttargetChatStore.getState().addMessages(newTaskId, {\n\t\t\t\t\t\t\tid: generateUniqueId(),\n\t\t\t\t\t\t\trole: \"user\",\n\t\t\t\t\t\t\tcontent: messageContent,\n\t\t\t\t\t\t\tattaches: messageAttaches || [],\n\t\t\t\t\t\t});\n\t\t\t\t\t\ttargetChatStore.getState().setHasMessages(newTaskId, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst base_Url = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL\n\t\t\tconst api = type == 'share' ?\n\t\t\t\t&#96;${base_Url}/api/chat/share/playback/${shareToken}?delay_time=${delayTime}&#96;\n\t\t\t\t: type == 'replay' ?\n\t\t\t\t\t&#96;${base_Url}/api/chat/steps/playback/${newTaskId}?delay_time=${delayTime}&#96;\n\t\t\t\t\t: &#96;${baseURL}/chat&#96;\n\n\t\t\tconst { tasks } = get()\n\t\t\tlet historyId: string | null = projectStore.getHistoryId(project_id);\n\t\t\tlet snapshots: any = [];\n\t\t\tlet skipFirstConfirm = true;\n\n\t\t\t// replay or share request\n\t\t\tif (type) {\n\t\t\t\tconst res = await proxyFetchGet(&#96;/api/chat/snapshots&#96;, {\n\t\t\t\t\tapi_task_id: taskId\n\t\t\t\t});\n\t\t\t\tif (res) {\n\t\t\t\t\tsnapshots = [...new Map(res.map((item: any) =&gt; [item.camel_task_id, item])).values()];\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// get current model\n\t\t\tlet apiModel = {\n\t\t\t\tapi_key: '',\n\t\t\t\tmodel_type: '',\n\t\t\t\tmodel_platform: '',\n\t\t\t\tapi_url: '',\n\t\t\t\textra_params: {}\n\t\t\t}\n\t\t\tif (modelType === 'custom' || modelType === 'local') {\n\t\t\t\tconst res = await proxyFetchGet('/api/providers', {\n\t\t\t\t\tprefer: true\n\t\t\t\t});\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            },
            {
              "startPosition": {
                "line": 331,
                "column": 14
              },
              "endPosition": {
                "line": 332,
                "column": 4
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": "async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "text": " // Default to current store",
            "lineNumber": 368
          },
          {
            "text": "\t\t\t/**",
            "lineNumber": 369
          },
          {
            "text": "\t\t\t * Replay creates its own chatStore for each task with replayProject",
            "lineNumber": 370
          },
          {
            "text": "\t\t\t */",
            "lineNumber": 371
          },
          {
            "text": "\t\t\tif (project_id &amp;&amp; type !== \"replay\") {",
            "lineNumber": 372
          },
          {
            "text": "\t\t\t\tconsole.log(\"Creating a new Chat Instance for current project on end\")",
            "lineNumber": 373
          },
          {
            "text": "\t\t\t\tconst newChatResult = projectStore.appendInitChatStore(project_id);",
            "lineNumber": 374
          },
          {
            "lineNumber": 375
          },
          {
            "text": "\t\t\t\tif (newChatResult) {",
            "lineNumber": 376
          },
          {
            "text": "\t\t\t\t\tnewTaskId = newChatResult.taskId;",
            "lineNumber": 377
          },
          {
            "text": "\t\t\t\t\ttargetChatStore = newChatResult.chatStore;",
            "lineNumber": 378
          },
          {
            "text": "\t\t\t\t\ttargetChatStore.getState().setIsPending(newTaskId, true);",
            "lineNumber": 379
          },
          {
            "lineNumber": 380
          },
          {
            "text": "\t\t\t\t\t//From handleSend if message is given",
            "lineNumber": 381
          },
          {
            "text": "\t\t\t\t\t// Add the message to the new chatStore if provided",
            "lineNumber": 382
          },
          {
            "text": "\t\t\t\t\tif (messageContent) {",
            "lineNumber": 383
          },
          {
            "text": "\t\t\t\t\t\ttargetChatStore.getState().addMessages(newTaskId, {",
            "lineNumber": 384
          },
          {
            "text": "\t\t\t\t\t\t\tid: generateUniqueId(),",
            "lineNumber": 385
          },
          {
            "text": "\t\t\t\t\t\t\trole: \"user\",",
            "lineNumber": 386
          },
          {
            "text": "\t\t\t\t\t\t\tcontent: messageContent,",
            "lineNumber": 387
          },
          {
            "text": "\t\t\t\t\t\t\tattaches: messageAttaches || [],",
            "lineNumber": 388
          },
          {
            "text": "\t\t\t\t\t\t});",
            "lineNumber": 389
          },
          {
            "text": "\t\t\t\t\t\ttargetChatStore.getState().setHasMessages(newTaskId, true);",
            "lineNumber": 390
          },
          {
            "text": "\t\t\t\t\t}",
            "lineNumber": 391
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 392
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 393
          },
          {
            "lineNumber": 394
          },
          {
            "text": "\t\t\tconst base_Url = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL",
            "lineNumber": 395
          },
          {
            "text": "\t\t\tconst api = type == 'share' ?",
            "lineNumber": 396
          },
          {
            "text": "\t\t\t\t&#96;${base_Url}/api/chat/share/playback/${shareToken}?delay_time=${delayTime}&#96;",
            "lineNumber": 397
          },
          {
            "text": "\t\t\t\t: type == 'replay' ?",
            "lineNumber": 398
          },
          {
            "text": "\t\t\t\t\t&#96;${base_Url}/api/chat/steps/playback/${newTaskId}?delay_time=${delayTime}&#96;",
            "lineNumber": 399
          },
          {
            "text": "\t\t\t\t\t: &#96;${baseURL}/chat&#96;",
            "lineNumber": 400
          },
          {
            "lineNumber": 401
          },
          {
            "text": "\t\t\tconst { tasks } = get()",
            "lineNumber": 402
          },
          {
            "text": "\t\t\tlet historyId: string | null = projectStore.getHistoryId(project_id);",
            "lineNumber": 403
          },
          {
            "text": "\t\t\tlet snapshots: any = [];",
            "lineNumber": 404
          },
          {
            "text": "\t\t\tlet skipFirstConfirm = true;",
            "lineNumber": 405
          },
          {
            "lineNumber": 406
          },
          {
            "text": "\t\t\t// replay or share request",
            "lineNumber": 407
          },
          {
            "text": "\t\t\tif (type) {",
            "lineNumber": 408
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet(&#96;/api/chat/snapshots&#96;, {",
            "lineNumber": 409
          },
          {
            "text": "\t\t\t\t\tapi_task_id: taskId",
            "lineNumber": 410
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 411
          },
          {
            "text": "\t\t\t\tif (res) {",
            "lineNumber": 412
          },
          {
            "text": "\t\t\t\t\tsnapshots = [...new Map(res.map((item: any) =&gt; [item.camel_task_id, item])).values()];",
            "lineNumber": 413
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 414
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 415
          },
          {
            "lineNumber": 416
          },
          {
            "lineNumber": 417
          },
          {
            "text": "\t\t\t// get current model",
            "lineNumber": 418
          },
          {
            "text": "\t\t\tlet apiModel = {",
            "lineNumber": 419
          },
          {
            "text": "\t\t\t\tapi_key: '',",
            "lineNumber": 420
          },
          {
            "text": "\t\t\t\tmodel_type: '',",
            "lineNumber": 421
          },
          {
            "text": "\t\t\t\tmodel_platform: '',",
            "lineNumber": 422
          },
          {
            "text": "\t\t\t\tapi_url: '',",
            "lineNumber": 423
          },
          {
            "text": "\t\t\t\textra_params: {}",
            "lineNumber": 424
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 425
          },
          {
            "text": "\t\t\tif (modelType === 'custom' || modelType === 'local') {",
            "lineNumber": 426
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet('/api/providers', {",
            "lineNumber": 427
          },
          {
            "text": "\t\t\t\t\tprefer: true",
            "lineNumber": 428
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 429
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.3595426082611084
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\API.tsx",
        "range": {
          "startPosition": {
            "line": 10,
            "column": 1
          },
          "endPosition": {
            "line": 109,
            "column": 1
          }
        },
        "contents": "export default function SettingAPI() {\n\tconst { t } = useTranslation();\n\tconst [items, setItems] = useState&lt;ConfigItem[]&gt;([]);\n\tconst [envValues, setEnvValues] = useState&lt;Record&lt;string, string&gt;&gt;({});\n\tconst [loading, setLoading] = useState&lt;Record&lt;string, boolean&gt;&gt;({});\n\tconst [errors, setErrors] = useState&lt;Record&lt;string, string&gt;&gt;({});\n\n\tuseEffect(() =&gt; {\n\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {\n\t\t\tconst configs = Object.entries(res || {})\n\t\t\t\t.map(([name, v]: [string, any]) =&gt; ({ name, env_vars: v.env_vars }))\n\t\t\t\t.filter((item) =&gt; Array.isArray(item.env_vars) &amp;&amp; item.env_vars.length &gt; 0);\n\t\t\tsetItems(configs);\n\t\t});\n\t\tproxyFetchGet(\"/api/configs\").then((res) =&gt; {\n\t\t\tif (Array.isArray(res)) {\n\t\t\t\tconst envMap: Record&lt;string, string&gt; = {};\n\t\t\t\tres.forEach((item: any) =&gt; {\n\t\t\t\t\tif (item.config_name &amp;&amp; item.config_value) {\n\t\t\t\t\t\tenvMap[item.config_name] = item.config_value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsetEnvValues(envMap);\n\t\t\t}\n\t\t});\n\t}, []);\n\n\tconst handleInputChange = (env: string, value: string) =&gt; {\n\t\tsetEnvValues((prev) =&gt; ({ ...prev, [env]: value }));\n\t};\n\n\tconst handleVerify = async (configGroup: string, env: string) =&gt; {\n\t\tconst value = envValues[env] || \"\";\n\t\tif (!value.trim()) {\n\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: t(\"layout.env-should-not-empty\") }));\n\t\t\treturn;\n\t\t} else {\n\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: \"\" }));\n\t\t}\n\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: true }));\n\t\ttry {\n\t\t\tawait proxyFetchPost(\"/api/configs\", {\n\t\t\t\tconfig_name: env,\n\t\t\t\tconfig_value: value,\n\t\t\t\tconfig_group: configGroup,\n\t\t\t});\n\t\t} catch (e) {\n\t\t} finally {\n\t\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: false }));\n\t\t}\n\t};\n\n\treturn (\n\t\t&lt;div className=\"space-y-8\"&gt;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default function SettingAPI() {",
            "lineNumber": 13,
            "isSignature": true
          },
          {
            "text": "\tconst { t } = useTranslation();",
            "lineNumber": 14
          },
          {
            "text": "\tconst [items, setItems] = useState&lt;ConfigItem[]&gt;([]);",
            "lineNumber": 15
          },
          {
            "text": "\tconst [envValues, setEnvValues] = useState&lt;Record&lt;string, string&gt;&gt;({});",
            "lineNumber": 16
          },
          {
            "text": "\tconst [loading, setLoading] = useState&lt;Record&lt;string, boolean&gt;&gt;({});",
            "lineNumber": 17
          },
          {
            "text": "\tconst [errors, setErrors] = useState&lt;Record&lt;string, string&gt;&gt;({});",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 20
          },
          {
            "text": "\t\tproxyFetchGet(\"/api/config/info\").then((res) =&gt; {",
            "lineNumber": 21
          },
          {
            "text": "\t\t\tconst configs = Object.entries(res || {})",
            "lineNumber": 22
          },
          {
            "text": "\t\t\t\t.map(([name, v]: [string, any]) =&gt; ({ name, env_vars: v.env_vars }))",
            "lineNumber": 23
          },
          {
            "text": "\t\t\t\t.filter((item) =&gt; Array.isArray(item.env_vars) &amp;&amp; item.env_vars.length &gt; 0);",
            "lineNumber": 24
          },
          {
            "text": "\t\t\tsetItems(configs);",
            "lineNumber": 25
          },
          {
            "text": "\t\t});",
            "lineNumber": 26
          },
          {
            "text": "\t\tproxyFetchGet(\"/api/configs\").then((res) =&gt; {",
            "lineNumber": 27
          },
          {
            "text": "\t\t\tif (Array.isArray(res)) {",
            "lineNumber": 28
          },
          {
            "text": "\t\t\t\tconst envMap: Record&lt;string, string&gt; = {};",
            "lineNumber": 29
          },
          {
            "text": "\t\t\t\tres.forEach((item: any) =&gt; {",
            "lineNumber": 30
          },
          {
            "text": "\t\t\t\t\tif (item.config_name &amp;&amp; item.config_value) {",
            "lineNumber": 31
          },
          {
            "text": "\t\t\t\t\t\tenvMap[item.config_name] = item.config_value;",
            "lineNumber": 32
          },
          {
            "text": "\t\t\t\t\t}",
            "lineNumber": 33
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 34
          },
          {
            "text": "\t\t\t\tsetEnvValues(envMap);",
            "lineNumber": 35
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 36
          },
          {
            "text": "\t\t});",
            "lineNumber": 37
          },
          {
            "text": "\t}, []);",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "\tconst handleInputChange = (env: string, value: string) =&gt; {",
            "lineNumber": 40
          },
          {
            "text": "\t\tsetEnvValues((prev) =&gt; ({ ...prev, [env]: value }));",
            "lineNumber": 41
          },
          {
            "text": "\t};",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "\tconst handleVerify = async (configGroup: string, env: string) =&gt; {",
            "lineNumber": 44
          },
          {
            "text": "\t\tconst value = envValues[env] || \"\";",
            "lineNumber": 45
          },
          {
            "text": "\t\tif (!value.trim()) {",
            "lineNumber": 46
          },
          {
            "text": "\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: t(\"layout.env-should-not-empty\") }));",
            "lineNumber": 47
          },
          {
            "text": "\t\t\treturn;",
            "lineNumber": 48
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 49
          },
          {
            "text": "\t\t\tsetErrors((prev) =&gt; ({ ...prev, [env]: \"\" }));",
            "lineNumber": 50
          },
          {
            "text": "\t\t}",
            "lineNumber": 51
          },
          {
            "text": "\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: true }));",
            "lineNumber": 52
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 53
          },
          {
            "text": "\t\t\tawait proxyFetchPost(\"/api/configs\", {",
            "lineNumber": 54
          },
          {
            "text": "\t\t\t\tconfig_name: env,",
            "lineNumber": 55
          },
          {
            "text": "\t\t\t\tconfig_value: value,",
            "lineNumber": 56
          },
          {
            "text": "\t\t\t\tconfig_group: configGroup,",
            "lineNumber": 57
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 58
          },
          {
            "text": "\t\t} catch (e) {",
            "lineNumber": 59
          },
          {
            "text": "\t\t} finally {",
            "lineNumber": 60
          },
          {
            "text": "\t\t\tsetLoading((prev) =&gt; ({ ...prev, [env]: false }));",
            "lineNumber": 61
          },
          {
            "text": "\t\t}",
            "lineNumber": 62
          },
          {
            "text": "\t};",
            "lineNumber": 63
          },
          {
            "lineNumber": 64
          },
          {
            "text": "\treturn (",
            "lineNumber": 65
          },
          {
            "text": "\t\t&lt;div className=\"space-y-8\"&gt;",
            "lineNumber": 66
          },
          {
            "text": "}",
            "lineNumber": 110,
            "isSignature": true
          }
        ]
      },
      "score": 0.33037686347961426
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 231,
            "column": 49
          },
          "endPosition": {
            "line": 274,
            "column": 3
          }
        },
        "contents": "// File upload function with FormData\nexport async function uploadFile(url: string, formData: FormData, headers?: Record&lt;string, string&gt;): Promise&lt;any&gt; {\n  const baseURL = await getProxyBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const requestHeaders: Record&lt;string, string&gt; = {\n    ...headers,\n  }\n\n  // Remove Content-Type header to let browser set it with boundary for FormData\n  if (requestHeaders['Content-Type']) {\n    delete requestHeaders['Content-Type']\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header\n  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      requestHeaders['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: formData,\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\n// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// File upload function with FormData",
            "lineNumber": 234
          },
          {
            "text": "export async function uploadFile(url: string, formData: FormData, headers?: Record&lt;string, string&gt;): Promise&lt;any&gt; {",
            "lineNumber": 235,
            "isSignature": true
          },
          {
            "text": "  const baseURL = await getProxyBaseURL()",
            "lineNumber": 236
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 237
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 238
          },
          {
            "lineNumber": 239
          },
          {
            "text": "  const requestHeaders: Record&lt;string, string&gt; = {",
            "lineNumber": 240
          },
          {
            "text": "    ...headers,",
            "lineNumber": 241
          },
          {
            "text": "  }",
            "lineNumber": 242
          },
          {
            "lineNumber": 243
          },
          {
            "text": "  // Remove Content-Type header to let browser set it with boundary for FormData",
            "lineNumber": 244
          },
          {
            "text": "  if (requestHeaders['Content-Type']) {",
            "lineNumber": 245
          },
          {
            "text": "    delete requestHeaders['Content-Type']",
            "lineNumber": 246
          },
          {
            "text": "  }",
            "lineNumber": 247
          },
          {
            "lineNumber": 248
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 249
          },
          {
            "text": "    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 250
          },
          {
            "text": "  }",
            "lineNumber": 251
          },
          {
            "lineNumber": 252
          },
          {
            "text": "  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header",
            "lineNumber": 253
          },
          {
            "text": "  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {",
            "lineNumber": 254
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 255
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 256
          },
          {
            "text": "      requestHeaders['X-Proxy-Target'] = targetUrl",
            "lineNumber": 257
          },
          {
            "text": "    }",
            "lineNumber": 258
          },
          {
            "text": "  }",
            "lineNumber": 259
          },
          {
            "lineNumber": 260
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 261
          },
          {
            "text": "    method: 'POST',",
            "lineNumber": 262
          },
          {
            "text": "    headers: requestHeaders,",
            "lineNumber": 263
          },
          {
            "text": "    body: formData,",
            "lineNumber": 264
          },
          {
            "text": "  }",
            "lineNumber": 265
          },
          {
            "lineNumber": 266
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 267
          },
          {
            "text": "}",
            "lineNumber": 268,
            "isSignature": true
          },
          {
            "lineNumber": 269
          },
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 270
          },
          {
            "lineNumber": 271
          },
          {
            "text": "/**",
            "lineNumber": 272
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 273
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 274
          },
          {
            "text": " */",
            "lineNumber": 275
          }
        ]
      },
      "score": 0.32627108693122864
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Login.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 465,
            "column": 1
          }
        },
        "contents": "export default function Login() {\n\n\n  //\n  const handleLogin = async () =&gt; {\n    if (!validateForm()) {\n      return;\n    }\n\n    setGeneralError('');\n    setIsLoading(true);\n    try {\n      const data = await proxyFetchPost('/api/login', {\n        email: formData.email,\n        password: formData.password,\n      });\n\n      const errorMessage = getLoginErrorMessage(data);\n      if (errorMessage) {\n        setGeneralError(errorMessage);\n        return;\n      }\n\n      setAuth({ email: formData.email, ...data });\n      setModelType('cloud');\n      // Record VITE_USE_LOCAL_PROXY value at login\n      const localProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;\n      setLocalProxyValue(localProxyValue);\n      navigate('/');\n    } catch (error: any) {\n      console.error('Login failed:', error);\n      setGeneralError(\n        t('layout.login-failed-please-check-your-email-and-password')\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleLoginByStack = async (token: string) =&gt; {\n    try {\n      const data = await proxyFetchPost('/api/login-by_stack?token=' + token, {\n        token: token,\n      });\n\n      const errorMessage = getLoginErrorMessage(data);\n      if (errorMessage) {\n        setGeneralError(errorMessage);\n        return;\n      }\n      console.log('data', data);\n      setModelType('cloud');\n      setAuth({ email: formData.email, ...data });\n      // Record VITE_USE_LOCAL_PROXY value at login\n      const localProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;\n      setLocalProxyValue(localProxyValue);\n      navigate('/');\n    } catch (error: any) {\n      console.error('Login failed:', error);\n      setGeneralError(\n        t('layout.login-failed-please-check-your-email-and-password')\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleReloadBtn = async (type: string) =&gt;\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Login() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "  //",
            "lineNumber": 118
          },
          {
            "text": "  const handleLogin = async () =&gt; {",
            "lineNumber": 119
          },
          {
            "text": "    if (!validateForm()) {",
            "lineNumber": 120
          },
          {
            "text": "      return;",
            "lineNumber": 121
          },
          {
            "text": "    }",
            "lineNumber": 122
          },
          {
            "lineNumber": 123
          },
          {
            "text": "    setGeneralError('');",
            "lineNumber": 124
          },
          {
            "text": "    setIsLoading(true);",
            "lineNumber": 125
          },
          {
            "text": "    try {",
            "lineNumber": 126
          },
          {
            "text": "      const data = await proxyFetchPost('/api/login', {",
            "lineNumber": 127
          },
          {
            "text": "        email: formData.email,",
            "lineNumber": 128
          },
          {
            "text": "        password: formData.password,",
            "lineNumber": 129
          },
          {
            "text": "      });",
            "lineNumber": 130
          },
          {
            "lineNumber": 131
          },
          {
            "text": "      const errorMessage = getLoginErrorMessage(data);",
            "lineNumber": 132
          },
          {
            "text": "      if (errorMessage) {",
            "lineNumber": 133
          },
          {
            "text": "        setGeneralError(errorMessage);",
            "lineNumber": 134
          },
          {
            "text": "        return;",
            "lineNumber": 135
          },
          {
            "text": "      }",
            "lineNumber": 136
          },
          {
            "lineNumber": 137
          },
          {
            "text": "      setAuth({ email: formData.email, ...data });",
            "lineNumber": 138
          },
          {
            "text": "      setModelType('cloud');",
            "lineNumber": 139
          },
          {
            "text": "      // Record VITE_USE_LOCAL_PROXY value at login",
            "lineNumber": 140
          },
          {
            "text": "      const localProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;",
            "lineNumber": 141
          },
          {
            "text": "      setLocalProxyValue(localProxyValue);",
            "lineNumber": 142
          },
          {
            "text": "      navigate('/');",
            "lineNumber": 143
          },
          {
            "text": "    } catch (error: any) {",
            "lineNumber": 144
          },
          {
            "text": "      console.error('Login failed:', error);",
            "lineNumber": 145
          },
          {
            "text": "      setGeneralError(",
            "lineNumber": 146
          },
          {
            "text": "        t('layout.login-failed-please-check-your-email-and-password')",
            "lineNumber": 147
          },
          {
            "text": "      );",
            "lineNumber": 148
          },
          {
            "text": "    } finally {",
            "lineNumber": 149
          },
          {
            "text": "      setIsLoading(false);",
            "lineNumber": 150
          },
          {
            "text": "    }",
            "lineNumber": 151
          },
          {
            "text": "  };",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "  const handleLoginByStack = async (token: string) =&gt; {",
            "lineNumber": 154
          },
          {
            "text": "    try {",
            "lineNumber": 155
          },
          {
            "text": "      const data = await proxyFetchPost('/api/login-by_stack?token=' + token, {",
            "lineNumber": 156
          },
          {
            "text": "        token: token,",
            "lineNumber": 157
          },
          {
            "text": "      });",
            "lineNumber": 158
          },
          {
            "lineNumber": 159
          },
          {
            "text": "      const errorMessage = getLoginErrorMessage(data);",
            "lineNumber": 160
          },
          {
            "text": "      if (errorMessage) {",
            "lineNumber": 161
          },
          {
            "text": "        setGeneralError(errorMessage);",
            "lineNumber": 162
          },
          {
            "text": "        return;",
            "lineNumber": 163
          },
          {
            "text": "      }",
            "lineNumber": 164
          },
          {
            "text": "      console.log('data', data);",
            "lineNumber": 165
          },
          {
            "text": "      setModelType('cloud');",
            "lineNumber": 166
          },
          {
            "text": "      setAuth({ email: formData.email, ...data });",
            "lineNumber": 167
          },
          {
            "text": "      // Record VITE_USE_LOCAL_PROXY value at login",
            "lineNumber": 168
          },
          {
            "text": "      const localProxyValue = import.meta.env.VITE_USE_LOCAL_PROXY || null;",
            "lineNumber": 169
          },
          {
            "text": "      setLocalProxyValue(localProxyValue);",
            "lineNumber": 170
          },
          {
            "text": "      navigate('/');",
            "lineNumber": 171
          },
          {
            "text": "    } catch (error: any) {",
            "lineNumber": 172
          },
          {
            "text": "      console.error('Login failed:', error);",
            "lineNumber": 173
          },
          {
            "text": "      setGeneralError(",
            "lineNumber": 174
          },
          {
            "text": "        t('layout.login-failed-please-check-your-email-and-password')",
            "lineNumber": 175
          },
          {
            "text": "      );",
            "lineNumber": 176
          },
          {
            "text": "    } finally {",
            "lineNumber": 177
          },
          {
            "text": "      setIsLoading(false);",
            "lineNumber": 178
          },
          {
            "text": "    }",
            "lineNumber": 179
          },
          {
            "text": "  };",
            "lineNumber": 180
          },
          {
            "lineNumber": 181
          },
          {
            "text": "  const handleReloadBtn = async (type: string) =&gt;",
            "lineNumber": 182
          },
          {
            "text": ";",
            "lineNumber": 197
          },
          {
            "text": "}",
            "lineNumber": 466,
            "isSignature": true
          }
        ]
      },
      "score": 0.316219687461853
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Login.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 465,
            "column": 1
          }
        },
        "contents": "export default function Login() {\n\n\n  const handleReloadBtn = async (type: string) =&gt; {\n    if (!app) {\n      console.error('Stack app not initialized');\n      return;\n    }\n    console.log('handleReloadBtn1', type);\n    const cookies = document.cookie.split('; ');\n    cookies.forEach((cookie) =&gt; {\n      const [name] = cookie.split('=');\n      if (name.startsWith('stack-oauth-outer-')) {\n        document.cookie = &#96;${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/&#96;;\n      }\n    });\n    console.log('handleReloadBtn2', type);\n    await app.signInWithOAuth(type);\n  };\n\n  const handleGetToken = async (code: string) =&gt; {\n    const code_verifier = localStorage.getItem('stack-oauth-outer-');\n    const formData = new URLSearchParams();\n    console.log(\n      'import.meta.env.PROD',\n      import.meta.env.PROD\n        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;\n        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;\n    );\n    formData.append(\n      'redirect_uri',\n      import.meta.env.PROD\n        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;\n        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;\n    );\n    formData.append('code_verifier', code_verifier || '');\n    formData.append('code', code);\n    formData.append('grant_type', 'authorization_code');\n    formData.append('client_id', 'aa49cdd0-318e-46bd-a540-0f1e5f2b391f');\n    formData.append(\n      'client_secret',\n      'pck_t13egrd9ve57tz52kfcd2s4h1zwya5502z43kr5xv5cx8'\n    );\n\n    try {\n      const res = await fetch(\n        'https://api.stack-auth.com/api/v1/auth/oauth/token',\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',\n          },\n          body: formData,\n        }\n      );\n      const data = await res.json(); // parse response data\n      return data.access_token;\n    } catch (error) {\n      console.error(error);\n      setIsLoading(false);\n    }\n  };\n\n  const handleAuthCode = useCallback\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Login() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 180
          },
          {
            "lineNumber": 181
          },
          {
            "text": "  const handleReloadBtn = async (type: string) =&gt; {",
            "lineNumber": 182
          },
          {
            "text": "    if (!app) {",
            "lineNumber": 183
          },
          {
            "text": "      console.error('Stack app not initialized');",
            "lineNumber": 184
          },
          {
            "text": "      return;",
            "lineNumber": 185
          },
          {
            "text": "    }",
            "lineNumber": 186
          },
          {
            "text": "    console.log('handleReloadBtn1', type);",
            "lineNumber": 187
          },
          {
            "text": "    const cookies = document.cookie.split('; ');",
            "lineNumber": 188
          },
          {
            "text": "    cookies.forEach((cookie) =&gt; {",
            "lineNumber": 189
          },
          {
            "text": "      const [name] = cookie.split('=');",
            "lineNumber": 190
          },
          {
            "text": "      if (name.startsWith('stack-oauth-outer-')) {",
            "lineNumber": 191
          },
          {
            "text": "        document.cookie = &#96;${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/&#96;;",
            "lineNumber": 192
          },
          {
            "text": "      }",
            "lineNumber": 193
          },
          {
            "text": "    });",
            "lineNumber": 194
          },
          {
            "text": "    console.log('handleReloadBtn2', type);",
            "lineNumber": 195
          },
          {
            "text": "    await app.signInWithOAuth(type);",
            "lineNumber": 196
          },
          {
            "text": "  };",
            "lineNumber": 197
          },
          {
            "lineNumber": 198
          },
          {
            "text": "  const handleGetToken = async (code: string) =&gt; {",
            "lineNumber": 199
          },
          {
            "text": "    const code_verifier = localStorage.getItem('stack-oauth-outer-');",
            "lineNumber": 200
          },
          {
            "text": "    const formData = new URLSearchParams();",
            "lineNumber": 201
          },
          {
            "text": "    console.log(",
            "lineNumber": 202
          },
          {
            "text": "      'import.meta.env.PROD',",
            "lineNumber": 203
          },
          {
            "text": "      import.meta.env.PROD",
            "lineNumber": 204
          },
          {
            "text": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;",
            "lineNumber": 205
          },
          {
            "text": "        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;",
            "lineNumber": 206
          },
          {
            "text": "    );",
            "lineNumber": 207
          },
          {
            "text": "    formData.append(",
            "lineNumber": 208
          },
          {
            "text": "      'redirect_uri',",
            "lineNumber": 209
          },
          {
            "text": "      import.meta.env.PROD",
            "lineNumber": 210
          },
          {
            "text": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;",
            "lineNumber": 211
          },
          {
            "text": "        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;",
            "lineNumber": 212
          },
          {
            "text": "    );",
            "lineNumber": 213
          },
          {
            "text": "    formData.append('code_verifier', code_verifier || '');",
            "lineNumber": 214
          },
          {
            "text": "    formData.append('code', code);",
            "lineNumber": 215
          },
          {
            "text": "    formData.append('grant_type', 'authorization_code');",
            "lineNumber": 216
          },
          {
            "text": "    formData.append('client_id', 'aa49cdd0-318e-46bd-a540-0f1e5f2b391f');",
            "lineNumber": 217
          },
          {
            "text": "    formData.append(",
            "lineNumber": 218
          },
          {
            "text": "      'client_secret',",
            "lineNumber": 219
          },
          {
            "text": "      'pck_t13egrd9ve57tz52kfcd2s4h1zwya5502z43kr5xv5cx8'",
            "lineNumber": 220
          },
          {
            "text": "    );",
            "lineNumber": 221
          },
          {
            "lineNumber": 222
          },
          {
            "text": "    try {",
            "lineNumber": 223
          },
          {
            "text": "      const res = await fetch(",
            "lineNumber": 224
          },
          {
            "text": "        'https://api.stack-auth.com/api/v1/auth/oauth/token',",
            "lineNumber": 225
          },
          {
            "text": "        {",
            "lineNumber": 226
          },
          {
            "text": "          method: 'POST',",
            "lineNumber": 227
          },
          {
            "text": "          headers: {",
            "lineNumber": 228
          },
          {
            "text": "            'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',",
            "lineNumber": 229
          },
          {
            "text": "          },",
            "lineNumber": 230
          },
          {
            "text": "          body: formData,",
            "lineNumber": 231
          },
          {
            "text": "        }",
            "lineNumber": 232
          },
          {
            "text": "      );",
            "lineNumber": 233
          },
          {
            "text": "      const data = await res.json(); // parse response data",
            "lineNumber": 234
          },
          {
            "text": "      return data.access_token;",
            "lineNumber": 235
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 236
          },
          {
            "text": "      console.error(error);",
            "lineNumber": 237
          },
          {
            "text": "      setIsLoading(false);",
            "lineNumber": 238
          },
          {
            "text": "    }",
            "lineNumber": 239
          },
          {
            "text": "  };",
            "lineNumber": 240
          },
          {
            "lineNumber": 241
          },
          {
            "text": "  const handleAuthCode = useCallback",
            "lineNumber": 242
          },
          {
            "text": ";",
            "lineNumber": 255
          },
          {
            "text": "}",
            "lineNumber": 466,
            "isSignature": true
          }
        ]
      },
      "score": 0.3096194863319397
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\n\n  useEffect(() =&gt; {\n    proxyFetchGet('/api/user/privacy')\n      .then((res) =&gt; {\n        let _privacy = 0;\n        Object.keys(res).forEach((key) =&gt; {\n          if (!res[key]) {\n            _privacy++;\n            return;\n          }\n        });\n        setPrivacy(_privacy === 0 ? true : false);\n      })\n      .catch((err) =&gt; console.error('Failed to fetch settings:', err))\n      .finally(() =&gt; setIsPrivacyLoaded(true));\n\n    proxyFetchGet('/api/configs')\n      .then((configsRes) =&gt; {\n        const configs = Array.isArray(configsRes) ? configsRes : [];\n        const _hasApiKey = configs.find(\n          (item) =&gt; item.config_name === 'GOOGLE_API_KEY'\n        );\n        const _hasApiId = configs.find(\n          (item) =&gt; item.config_name === 'SEARCH_ENGINE_ID'\n        );\n        if (_hasApiKey &amp;&amp; _hasApiId) setHasSearchKey(true);\n      })\n      .catch((err) =&gt; console.error('Failed to fetch configs:', err));\n\n    checkModelConfig();\n  }, [modelType, checkModelConfig]);\n\n  // Re-check model config when returning from settings page\n  useEffect(() =&gt; {\n    // Check when location changes (user navigates)\n    if (location.pathname === '/' &amp;&amp; privacy) {\n      checkModelConfig();\n    }\n  }, [location.pathname, privacy, checkModelConfig]);\n\n  // Also check when window gains focus (user returns from settings)\n  useEffect(() =&gt; {\n    const handleFocus = () =&gt; {\n      if (privacy) {\n        checkModelConfig();\n      }\n    };\n\n    window.addEventListener('focus', handleFocus);\n    return () =&gt; {\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, [privacy, checkModelConfig]);\n\n  // Refresh privacy status when dialog closes\n  // useEffect(() =&gt; {\n  // \tif (!privacyDialogOpen) {\n  // \t\tproxyFetchGet(\"/api/user/privacy\")\n  // \t\t\t.then((res) =&gt; {\n  // \t\t\t\tlet _privacy = 0;\n  // \t\t\t\tObject.keys(res).forEach((key) =&gt; {\n  // \t\t\t\t\tif (!res[key]) {\n  // \t\t\t\t\t\t_privacy++;\n  // \t\t\t\t\t\treturn;\n  // \t\t\t\t\t}\n  // \t\t\t\t});\n  // \t\t\t\tsetPrivacy(_privacy === 0 ? true : false);\n  // \t\t\t})\n  // \t\t\t.catch((err) =&gt; console.error(\"Failed to fetch settings:\", err));\n  // \t}\n  // }, [privacyDialogOpen]);\n  const [searchParams] = useSearchParams();\n  const share_token = searchParams.get('share_token');\n\n  const handleSend = async (messageStr?: string, taskId?: string) =&gt;\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 78
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 79
          },
          {
            "text": "    proxyFetchGet('/api/user/privacy')",
            "lineNumber": 80
          },
          {
            "text": "      .then((res) =&gt; {",
            "lineNumber": 81
          },
          {
            "text": "        let _privacy = 0;",
            "lineNumber": 82
          },
          {
            "text": "        Object.keys(res).forEach((key) =&gt; {",
            "lineNumber": 83
          },
          {
            "text": "          if (!res[key]) {",
            "lineNumber": 84
          },
          {
            "text": "            _privacy++;",
            "lineNumber": 85
          },
          {
            "text": "            return;",
            "lineNumber": 86
          },
          {
            "text": "          }",
            "lineNumber": 87
          },
          {
            "text": "        });",
            "lineNumber": 88
          },
          {
            "text": "        setPrivacy(_privacy === 0 ? true : false);",
            "lineNumber": 89
          },
          {
            "text": "      })",
            "lineNumber": 90
          },
          {
            "text": "      .catch((err) =&gt; console.error('Failed to fetch settings:', err))",
            "lineNumber": 91
          },
          {
            "text": "      .finally(() =&gt; setIsPrivacyLoaded(true));",
            "lineNumber": 92
          },
          {
            "lineNumber": 93
          },
          {
            "text": "    proxyFetchGet('/api/configs')",
            "lineNumber": 94
          },
          {
            "text": "      .then((configsRes) =&gt; {",
            "lineNumber": 95
          },
          {
            "text": "        const configs = Array.isArray(configsRes) ? configsRes : [];",
            "lineNumber": 96
          },
          {
            "text": "        const _hasApiKey = configs.find(",
            "lineNumber": 97
          },
          {
            "text": "          (item) =&gt; item.config_name === 'GOOGLE_API_KEY'",
            "lineNumber": 98
          },
          {
            "text": "        );",
            "lineNumber": 99
          },
          {
            "text": "        const _hasApiId = configs.find(",
            "lineNumber": 100
          },
          {
            "text": "          (item) =&gt; item.config_name === 'SEARCH_ENGINE_ID'",
            "lineNumber": 101
          },
          {
            "text": "        );",
            "lineNumber": 102
          },
          {
            "text": "        if (_hasApiKey &amp;&amp; _hasApiId) setHasSearchKey(true);",
            "lineNumber": 103
          },
          {
            "text": "      })",
            "lineNumber": 104
          },
          {
            "text": "      .catch((err) =&gt; console.error('Failed to fetch configs:', err));",
            "lineNumber": 105
          },
          {
            "lineNumber": 106
          },
          {
            "text": "    checkModelConfig();",
            "lineNumber": 107
          },
          {
            "text": "  }, [modelType, checkModelConfig]);",
            "lineNumber": 108
          },
          {
            "lineNumber": 109
          },
          {
            "text": "  // Re-check model config when returning from settings page",
            "lineNumber": 110
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 111
          },
          {
            "text": "    // Check when location changes (user navigates)",
            "lineNumber": 112
          },
          {
            "text": "    if (location.pathname === '/' &amp;&amp; privacy) {",
            "lineNumber": 113
          },
          {
            "text": "      checkModelConfig();",
            "lineNumber": 114
          },
          {
            "text": "    }",
            "lineNumber": 115
          },
          {
            "text": "  }, [location.pathname, privacy, checkModelConfig]);",
            "lineNumber": 116
          },
          {
            "lineNumber": 117
          },
          {
            "text": "  // Also check when window gains focus (user returns from settings)",
            "lineNumber": 118
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 119
          },
          {
            "text": "    const handleFocus = () =&gt; {",
            "lineNumber": 120
          },
          {
            "text": "      if (privacy) {",
            "lineNumber": 121
          },
          {
            "text": "        checkModelConfig();",
            "lineNumber": 122
          },
          {
            "text": "      }",
            "lineNumber": 123
          },
          {
            "text": "    };",
            "lineNumber": 124
          },
          {
            "lineNumber": 125
          },
          {
            "text": "    window.addEventListener('focus', handleFocus);",
            "lineNumber": 126
          },
          {
            "text": "    return () =&gt; {",
            "lineNumber": 127
          },
          {
            "text": "      window.removeEventListener('focus', handleFocus);",
            "lineNumber": 128
          },
          {
            "text": "    };",
            "lineNumber": 129
          },
          {
            "text": "  }, [privacy, checkModelConfig]);",
            "lineNumber": 130
          },
          {
            "lineNumber": 131
          },
          {
            "text": "  // Refresh privacy status when dialog closes",
            "lineNumber": 132
          },
          {
            "text": "  // useEffect(() =&gt; {",
            "lineNumber": 133
          },
          {
            "text": "  // \tif (!privacyDialogOpen) {",
            "lineNumber": 134
          },
          {
            "text": "  // \t\tproxyFetchGet(\"/api/user/privacy\")",
            "lineNumber": 135
          },
          {
            "text": "  // \t\t\t.then((res) =&gt; {",
            "lineNumber": 136
          },
          {
            "text": "  // \t\t\t\tlet _privacy = 0;",
            "lineNumber": 137
          },
          {
            "text": "  // \t\t\t\tObject.keys(res).forEach((key) =&gt; {",
            "lineNumber": 138
          },
          {
            "text": "  // \t\t\t\t\tif (!res[key]) {",
            "lineNumber": 139
          },
          {
            "text": "  // \t\t\t\t\t\t_privacy++;",
            "lineNumber": 140
          },
          {
            "text": "  // \t\t\t\t\t\treturn;",
            "lineNumber": 141
          },
          {
            "text": "  // \t\t\t\t\t}",
            "lineNumber": 142
          },
          {
            "text": "  // \t\t\t\t});",
            "lineNumber": 143
          },
          {
            "text": "  // \t\t\t\tsetPrivacy(_privacy === 0 ? true : false);",
            "lineNumber": 144
          },
          {
            "text": "  // \t\t\t})",
            "lineNumber": 145
          },
          {
            "text": "  // \t\t\t.catch((err) =&gt; console.error(\"Failed to fetch settings:\", err));",
            "lineNumber": 146
          },
          {
            "text": "  // \t}",
            "lineNumber": 147
          },
          {
            "text": "  // }, [privacyDialogOpen]);",
            "lineNumber": 148
          },
          {
            "text": "  const [searchParams] = useSearchParams();",
            "lineNumber": 149
          },
          {
            "text": "  const share_token = searchParams.get('share_token');",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "  const handleSend = async (messageStr?: string, taskId?: string) =&gt;",
            "lineNumber": 152
          },
          {
            "text": ";",
            "lineNumber": 389
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.3072623908519745
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\nasync (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\nconst \n;\n\n\t\t\t// Get the locked task ID - this won't change during the SSE session\n\t\t\tconst getCurrentTaskId = () =&gt; {\n\t\t\t\treturn lockedTaskId;\n\t\t\t};\n\n\t\t\t// Function to update locked references (only for special cases like replay)\n\t\t\tconst updateLockedReferences = (newChatStore: VanillaChatStore, newTaskId: string) =&gt; {\n\t\t\t\tlockedChatStore = newChatStore;\n\t\t\t\tlockedTaskId = newTaskId;\n\t\t\t};\n\n\t\t\tfetchEventSource(api, {\n\t\t\t\tmethod: !type ? \"POST\" : \"GET\",\n\t\t\t\topenWhenHidden: true,\n\t\t\t\tsignal: abortController.signal, // Add abort signal for proper cleanup\n\t\t\t\theaders: { \"Content-Type\": \"application/json\", \"Authorization\": type == 'replay' ? &#96;Bearer ${token}&#96; : undefined as unknown as string },\n\t\t\t\tbody: !type ? JSON.stringify({\n\t\t\t\t\tproject_id: project_id,\n\t\t\t\t\ttask_id: newTaskId,\n\t\t\t\t\tquestion: messageContent || targetChatStore.getState().getLastUserMessage()?.content,\n\t\t\t\t\tmodel_platform: apiModel.model_platform,\n\t\t\t\t\temail,\n\t\t\t\t\tmodel_type: apiModel.model_type,\n\t\t\t\t\tapi_key: apiModel.api_key,\n\t\t\t\t\tapi_url: apiModel.api_url,\n\t\t\t\t\textra_params: apiModel.extra_params,\n\t\t\t\t\tinstalled_mcp: { mcpServers: {} },\n\t\t\t\t\tlanguage: systemLanguage,\n\t\t\t\t\tallow_local_system: true,\n\t\t\t\t\tattaches: (messageAttaches || targetChatStore.getState().tasks[newTaskId]?.attaches || []).map(f =&gt; f.filePath),\n\t\t\t\t\tsummary_prompt: &#96;&#96;,\n\t\t\t\t\tnew_agents: [...addWorkers],\n\t\t\t\t\tbrowser_port: browser_port,\n\t\t\t\t\tenv_path: envPath,\n\t\t\t\t\tsearch_config: searchConfig\n\t\t\t\t}) : undefined,\n\n\t\t\t\tasync onmessage(event: any) {\n\t\t\t\t\tlet agentMessages: AgentMessage;\n\t\t\t\t}\n\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            },
            {
              "startPosition": {
                "line": 331,
                "column": 14
              },
              "endPosition": {
                "line": 332,
                "column": 4
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": "async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "text": "const ",
            "lineNumber": 571
          },
          {
            "text": ";",
            "lineNumber": 573
          },
          {
            "lineNumber": 574
          },
          {
            "text": "\t\t\t// Get the locked task ID - this won't change during the SSE session",
            "lineNumber": 575
          },
          {
            "text": "\t\t\tconst getCurrentTaskId = () =&gt; {",
            "lineNumber": 576
          },
          {
            "text": "\t\t\t\treturn lockedTaskId;",
            "lineNumber": 577
          },
          {
            "text": "\t\t\t};",
            "lineNumber": 578
          },
          {
            "lineNumber": 579
          },
          {
            "text": "\t\t\t// Function to update locked references (only for special cases like replay)",
            "lineNumber": 580
          },
          {
            "text": "\t\t\tconst updateLockedReferences = (newChatStore: VanillaChatStore, newTaskId: string) =&gt; {",
            "lineNumber": 581
          },
          {
            "text": "\t\t\t\tlockedChatStore = newChatStore;",
            "lineNumber": 582
          },
          {
            "text": "\t\t\t\tlockedTaskId = newTaskId;",
            "lineNumber": 583
          },
          {
            "text": "\t\t\t};",
            "lineNumber": 584
          },
          {
            "lineNumber": 585
          },
          {
            "text": "\t\t\tfetchEventSource(api, {",
            "lineNumber": 586
          },
          {
            "text": "\t\t\t\tmethod: !type ? \"POST\" : \"GET\",",
            "lineNumber": 587
          },
          {
            "text": "\t\t\t\topenWhenHidden: true,",
            "lineNumber": 588
          },
          {
            "text": "\t\t\t\tsignal: abortController.signal, // Add abort signal for proper cleanup",
            "lineNumber": 589
          },
          {
            "text": "\t\t\t\theaders: { \"Content-Type\": \"application/json\", \"Authorization\": type == 'replay' ? &#96;Bearer ${token}&#96; : undefined as unknown as string },",
            "lineNumber": 590
          },
          {
            "text": "\t\t\t\tbody: !type ? JSON.stringify({",
            "lineNumber": 591
          },
          {
            "text": "\t\t\t\t\tproject_id: project_id,",
            "lineNumber": 592
          },
          {
            "text": "\t\t\t\t\ttask_id: newTaskId,",
            "lineNumber": 593
          },
          {
            "text": "\t\t\t\t\tquestion: messageContent || targetChatStore.getState().getLastUserMessage()?.content,",
            "lineNumber": 594
          },
          {
            "text": "\t\t\t\t\tmodel_platform: apiModel.model_platform,",
            "lineNumber": 595
          },
          {
            "text": "\t\t\t\t\temail,",
            "lineNumber": 596
          },
          {
            "text": "\t\t\t\t\tmodel_type: apiModel.model_type,",
            "lineNumber": 597
          },
          {
            "text": "\t\t\t\t\tapi_key: apiModel.api_key,",
            "lineNumber": 598
          },
          {
            "text": "\t\t\t\t\tapi_url: apiModel.api_url,",
            "lineNumber": 599
          },
          {
            "text": "\t\t\t\t\textra_params: apiModel.extra_params,",
            "lineNumber": 600
          },
          {
            "text": "\t\t\t\t\tinstalled_mcp: { mcpServers: {} },",
            "lineNumber": 601
          },
          {
            "text": "\t\t\t\t\tlanguage: systemLanguage,",
            "lineNumber": 602
          },
          {
            "text": "\t\t\t\t\tallow_local_system: true,",
            "lineNumber": 603
          },
          {
            "text": "\t\t\t\t\tattaches: (messageAttaches || targetChatStore.getState().tasks[newTaskId]?.attaches || []).map(f =&gt; f.filePath),",
            "lineNumber": 604
          },
          {
            "text": "\t\t\t\t\tsummary_prompt: &#96;&#96;,",
            "lineNumber": 605
          },
          {
            "text": "\t\t\t\t\tnew_agents: [...addWorkers],",
            "lineNumber": 606
          },
          {
            "text": "\t\t\t\t\tbrowser_port: browser_port,",
            "lineNumber": 607
          },
          {
            "text": "\t\t\t\t\tenv_path: envPath,",
            "lineNumber": 608
          },
          {
            "text": "\t\t\t\t\tsearch_config: searchConfig",
            "lineNumber": 609
          },
          {
            "text": "\t\t\t\t}) : undefined,",
            "lineNumber": 610
          },
          {
            "lineNumber": 611
          },
          {
            "text": "\t\t\t\tasync onmessage(event: any) {",
            "lineNumber": 612
          },
          {
            "text": "\t\t\t\t\tlet agentMessages: AgentMessage;",
            "lineNumber": 613
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 1836
          },
          {
            "lineNumber": 1886
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.29656004905700684
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 122,
            "column": 1
          },
          "endPosition": {
            "line": 129
          }
        },
        "contents": "// Encapsulate common methods\nexport const fetchGet = (url: string, params?: any, headers?: any) =&gt;\n  fetchRequest('GET', url, params, headers)\n\nexport const fetchPost = (url: string, data?: any, headers?: any) =&gt;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// Encapsulate common methods",
            "lineNumber": 125
          },
          {
            "text": "export const fetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 126
          },
          {
            "text": "  fetchRequest('GET', url, params, headers)",
            "lineNumber": 127
          },
          {
            "lineNumber": 128
          },
          {
            "text": "export const fetchPost = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 129
          }
        ]
      },
      "score": 0.28878355026245117
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\Folder\\index.tsx",
        "range": {
          "startPosition": {
            "line": 156
          },
          "endPosition": {
            "line": 621,
            "column": 1
          }
        },
        "contents": "export default function Folder({ data }: { data?: Agent }) {\nconst [expandedFolders, setExpandedFolders] = (\n    new Set()\n  );\n\n  const toggleFolder = (folderPath: string) =&gt; {\n    setExpandedFolders((prev) =&gt; {\n      const newSet = new Set(prev);\n      if (newSet.has(folderPath)) {\n        newSet.delete(folderPath);\n      } else {\n        newSet.add(folderPath);\n      }\n      return newSet;\n    });\n  };\n\n  const [fileGroups, setFileGroups] = useState&lt;\n    {\n      folder: string;\n      files: FileInfo[];\n    }[]\n  &gt;([\n    {\n      folder: 'Reports',\n      files: [],\n    },\n  ]);\n\n  const hasFetchedRemote = useRef(false);\n\n  // Reset hasFetchedRemote when activeTaskId changes\n  useEffect(() =&gt; {\n    hasFetchedRemote.current = false;\n  }, [chatStore.activeTaskId]);\n\n  useEffect(() =&gt; {\n    const setFileList = async () =&gt; {\n      let res = null;\n      res = await window.ipcRenderer.invoke(\n        'get-project-file-list',\n        authStore.email,\n        projectStore.activeProjectId as string\n      );\n      let tree: any = null;\n      if (\n        (res &amp;&amp; res.length &gt; 0) ||\n        import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n      ) {\n        tree = buildFileTree(res || []);\n      } else {\n        if (!hasFetchedRemote.current) {\n          //TODO(file): rename endpoint to use project_id\n          res = await proxyFetchGet('/api/chat/files', {\n            task_id: projectStore.activeProjectId as string,\n          });\n          hasFetchedRemote.current = true;\n        }\n        console.log('res', res);\n        if (res) {\n          res = res.map((item: any) =&gt; {\n            return {\n              name: item.filename,\n              type: item.filename.split('.')[1],\n              path: item.url,\n              isRemote: true,\n            };\n          });\n          tree = buildFileTree(res || []);\n        }\n      }\n      setFileTree(tree);\n      // Keep the old structure for compatibility\n      setFileGroups((prev) =&gt; {\n        const chatStoreSelectedFile =\n          chatStore.tasks[chatStore.activeTaskId as string];\n      }\n;\n  }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 157,
                "column": 1
              },
              "endPosition": {
                "line": 157,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 157,
                "column": 16
              },
              "endPosition": {
                "line": 158,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Folder({ data }: { data?: Agent }) {",
            "lineNumber": 157,
            "isSignature": true
          },
          {
            "text": "const [expandedFolders, setExpandedFolders] = (",
            "lineNumber": 278
          },
          {
            "text": "    new Set()",
            "lineNumber": 279
          },
          {
            "text": "  );",
            "lineNumber": 280
          },
          {
            "lineNumber": 281
          },
          {
            "text": "  const toggleFolder = (folderPath: string) =&gt; {",
            "lineNumber": 282
          },
          {
            "text": "    setExpandedFolders((prev) =&gt; {",
            "lineNumber": 283
          },
          {
            "text": "      const newSet = new Set(prev);",
            "lineNumber": 284
          },
          {
            "text": "      if (newSet.has(folderPath)) {",
            "lineNumber": 285
          },
          {
            "text": "        newSet.delete(folderPath);",
            "lineNumber": 286
          },
          {
            "text": "      } else {",
            "lineNumber": 287
          },
          {
            "text": "        newSet.add(folderPath);",
            "lineNumber": 288
          },
          {
            "text": "      }",
            "lineNumber": 289
          },
          {
            "text": "      return newSet;",
            "lineNumber": 290
          },
          {
            "text": "    });",
            "lineNumber": 291
          },
          {
            "text": "  };",
            "lineNumber": 292
          },
          {
            "lineNumber": 293
          },
          {
            "text": "  const [fileGroups, setFileGroups] = useState&lt;",
            "lineNumber": 294
          },
          {
            "text": "    {",
            "lineNumber": 295
          },
          {
            "text": "      folder: string;",
            "lineNumber": 296
          },
          {
            "text": "      files: FileInfo[];",
            "lineNumber": 297
          },
          {
            "text": "    }[]",
            "lineNumber": 298
          },
          {
            "text": "  &gt;([",
            "lineNumber": 299
          },
          {
            "text": "    {",
            "lineNumber": 300
          },
          {
            "text": "      folder: 'Reports',",
            "lineNumber": 301
          },
          {
            "text": "      files: [],",
            "lineNumber": 302
          },
          {
            "text": "    },",
            "lineNumber": 303
          },
          {
            "text": "  ]);",
            "lineNumber": 304
          },
          {
            "lineNumber": 305
          },
          {
            "text": "  const hasFetchedRemote = useRef(false);",
            "lineNumber": 306
          },
          {
            "lineNumber": 307
          },
          {
            "text": "  // Reset hasFetchedRemote when activeTaskId changes",
            "lineNumber": 308
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 309
          },
          {
            "text": "    hasFetchedRemote.current = false;",
            "lineNumber": 310
          },
          {
            "text": "  }, [chatStore.activeTaskId]);",
            "lineNumber": 311
          },
          {
            "lineNumber": 312
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 313
          },
          {
            "text": "    const setFileList = async () =&gt; {",
            "lineNumber": 314
          },
          {
            "text": "      let res = null;",
            "lineNumber": 315
          },
          {
            "text": "      res = await window.ipcRenderer.invoke(",
            "lineNumber": 316
          },
          {
            "text": "        'get-project-file-list',",
            "lineNumber": 317
          },
          {
            "text": "        authStore.email,",
            "lineNumber": 318
          },
          {
            "text": "        projectStore.activeProjectId as string",
            "lineNumber": 319
          },
          {
            "text": "      );",
            "lineNumber": 320
          },
          {
            "text": "      let tree: any = null;",
            "lineNumber": 321
          },
          {
            "text": "      if (",
            "lineNumber": 322
          },
          {
            "text": "        (res &amp;&amp; res.length &gt; 0) ||",
            "lineNumber": 323
          },
          {
            "text": "        import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 324
          },
          {
            "text": "      ) {",
            "lineNumber": 325
          },
          {
            "text": "        tree = buildFileTree(res || []);",
            "lineNumber": 326
          },
          {
            "text": "      } else {",
            "lineNumber": 327
          },
          {
            "text": "        if (!hasFetchedRemote.current) {",
            "lineNumber": 328
          },
          {
            "text": "          //TODO(file): rename endpoint to use project_id",
            "lineNumber": 329
          },
          {
            "text": "          res = await proxyFetchGet('/api/chat/files', {",
            "lineNumber": 330
          },
          {
            "text": "            task_id: projectStore.activeProjectId as string,",
            "lineNumber": 331
          },
          {
            "text": "          });",
            "lineNumber": 332
          },
          {
            "text": "          hasFetchedRemote.current = true;",
            "lineNumber": 333
          },
          {
            "text": "        }",
            "lineNumber": 334
          },
          {
            "text": "        console.log('res', res);",
            "lineNumber": 335
          },
          {
            "text": "        if (res) {",
            "lineNumber": 336
          },
          {
            "text": "          res = res.map((item: any) =&gt; {",
            "lineNumber": 337
          },
          {
            "text": "            return {",
            "lineNumber": 338
          },
          {
            "text": "              name: item.filename,",
            "lineNumber": 339
          },
          {
            "text": "              type: item.filename.split('.')[1],",
            "lineNumber": 340
          },
          {
            "text": "              path: item.url,",
            "lineNumber": 341
          },
          {
            "text": "              isRemote: true,",
            "lineNumber": 342
          },
          {
            "text": "            };",
            "lineNumber": 343
          },
          {
            "text": "          });",
            "lineNumber": 344
          },
          {
            "text": "          tree = buildFileTree(res || []);",
            "lineNumber": 345
          },
          {
            "text": "        }",
            "lineNumber": 346
          },
          {
            "text": "      }",
            "lineNumber": 347
          },
          {
            "text": "      setFileTree(tree);",
            "lineNumber": 348
          },
          {
            "text": "      // Keep the old structure for compatibility",
            "lineNumber": 349
          },
          {
            "text": "      setFileGroups((prev) =&gt; {",
            "lineNumber": 350
          },
          {
            "text": "        const chatStoreSelectedFile =",
            "lineNumber": 351
          },
          {
            "text": "          chatStore.tasks[chatStore.activeTaskId as string];",
            "lineNumber": 352
          },
          {
            "text": "      }",
            "lineNumber": 369
          },
          {
            "text": ";",
            "lineNumber": 370
          },
          {
            "text": "  }",
            "lineNumber": 372
          },
          {
            "text": "}",
            "lineNumber": 622,
            "isSignature": true
          }
        ]
      },
      "score": 0.28495556116104126
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Setting\\Models.tsx",
        "range": {
          "startPosition": {
            "line": 44
          },
          "endPosition": {
            "line": 1116,
            "column": 1
          }
        },
        "contents": "export default function SettingModels() {\n // Local model prefer state\n\tconst [localProviderId, setLocalProviderId] = useState&lt;number | undefined&gt;(\n\t\tundefined\n\t); // Local model provider_id\n\n\t// Load provider list and populate form\n\tuseEffect(() =&gt; {\n\t\t(async () =&gt; {\n\t\t\ttry {\n\t\t\t\tconst res = await proxyFetchGet(\"/api/providers\");\n\t\t\t\tconst providerList = Array.isArray(res) ? res : res.items || [];\n\t\t\t\t// Handle custom models\n\t\t\t\tsetForm((f) =&gt;\n\t\t\t\t\tf.map((fi, idx) =&gt; {\n\t\t\t\t\t\tconst item = items[idx];\n\t\t\t\t\t\tconst found = providerList.find(\n\t\t\t\t\t\t\t(p: any) =&gt; p.provider_name === item.id\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (found) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...fi,\n\t\t\t\t\t\t\t\tprovider_id: found.id,\n\t\t\t\t\t\t\t\tapiKey: found.api_key || \"\",\n\t\t\t\t\t\t\t\tapiHost: found.endpoint_url || \"\",\n\t\t\t\t\t\t\t\tis_valid: !!found?.is_valid,\n\t\t\t\t\t\t\t\tprefer: found.prefer ?? false,\n\t\t\t\t\t\t\t\tmodel_type: found.model_type ?? \"\",\n\t\t\t\t\t\t\t\texternalConfig: fi.externalConfig\n\t\t\t\t\t\t\t\t\t? fi.externalConfig.map((ec) =&gt; {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\tfound.encrypted_config &amp;&amp;\n\t\t\t\t\t\t\t\t\t\t\tfound.encrypted_config[ec.key] !== undefined\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\treturn { ...ec, value: found.encrypted_config[ec.key] };\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn ec;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn fi;\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\t// Handle local model\n\t\t\t\tconst local = providerList.find(\n\t\t\t\t\t(p: any) =&gt; LOCAL_PROVIDER_NAMES.includes(p.provider_name)\n\t\t\t\t);\n\t\t\t\tconsole.log(123123, local);\n\t\t\t\tif (local) {\n\t\t\t\t\tsetLocalEndpoint(local.endpoint_url || \"\");\n\t\t\t\t\tsetLocalPlatform(\n\t\t\t\t\t\tlocal.encrypted_config?.model_platform ||\n\t\t\t\t\t\tlocal.provider_name ||\n\t\t\t\t\t\t\"ollama\"\n\t\t\t\t\t);\n\t\t\t\t\tsetLocalType(local.encrypted_config?.model_type || \"llama3.2\");\n\t\t\t\t\tsetLocalEnabled(local.is_valid ?? true);\n\t\t\t\t\tsetLocalPrefer(local.prefer ?? false);\n\t\t\t\t\tsetLocalProviderId(local.id);\n\t\t\t\t}\n\t\t\t\tif (modelType === \"cloud\") {\n\t\t\t\t\tsetCloudPrefer(true);\n\t\t}\n\t}\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 45,
                "column": 1
              },
              "endPosition": {
                "line": 45,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 45,
                "column": 16
              },
              "endPosition": {
                "line": 46,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function SettingModels() {",
            "lineNumber": 45,
            "isSignature": true
          },
          {
            "text": " // Local model prefer state",
            "lineNumber": 97
          },
          {
            "text": "\tconst [localProviderId, setLocalProviderId] = useState&lt;number | undefined&gt;(",
            "lineNumber": 98
          },
          {
            "text": "\t\tundefined",
            "lineNumber": 99
          },
          {
            "text": "\t); // Local model provider_id",
            "lineNumber": 100
          },
          {
            "lineNumber": 101
          },
          {
            "text": "\t// Load provider list and populate form",
            "lineNumber": 102
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 103
          },
          {
            "text": "\t\t(async () =&gt; {",
            "lineNumber": 104
          },
          {
            "text": "\t\t\ttry {",
            "lineNumber": 105
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet(\"/api/providers\");",
            "lineNumber": 106
          },
          {
            "text": "\t\t\t\tconst providerList = Array.isArray(res) ? res : res.items || [];",
            "lineNumber": 107
          },
          {
            "text": "\t\t\t\t// Handle custom models",
            "lineNumber": 108
          },
          {
            "text": "\t\t\t\tsetForm((f) =&gt;",
            "lineNumber": 109
          },
          {
            "text": "\t\t\t\t\tf.map((fi, idx) =&gt; {",
            "lineNumber": 110
          },
          {
            "text": "\t\t\t\t\t\tconst item = items[idx];",
            "lineNumber": 111
          },
          {
            "text": "\t\t\t\t\t\tconst found = providerList.find(",
            "lineNumber": 112
          },
          {
            "text": "\t\t\t\t\t\t\t(p: any) =&gt; p.provider_name === item.id",
            "lineNumber": 113
          },
          {
            "text": "\t\t\t\t\t\t);",
            "lineNumber": 114
          },
          {
            "text": "\t\t\t\t\t\tif (found) {",
            "lineNumber": 115
          },
          {
            "text": "\t\t\t\t\t\t\treturn {",
            "lineNumber": 116
          },
          {
            "text": "\t\t\t\t\t\t\t\t...fi,",
            "lineNumber": 117
          },
          {
            "text": "\t\t\t\t\t\t\t\tprovider_id: found.id,",
            "lineNumber": 118
          },
          {
            "text": "\t\t\t\t\t\t\t\tapiKey: found.api_key || \"\",",
            "lineNumber": 119
          },
          {
            "text": "\t\t\t\t\t\t\t\tapiHost: found.endpoint_url || \"\",",
            "lineNumber": 120
          },
          {
            "text": "\t\t\t\t\t\t\t\tis_valid: !!found?.is_valid,",
            "lineNumber": 121
          },
          {
            "text": "\t\t\t\t\t\t\t\tprefer: found.prefer ?? false,",
            "lineNumber": 122
          },
          {
            "text": "\t\t\t\t\t\t\t\tmodel_type: found.model_type ?? \"\",",
            "lineNumber": 123
          },
          {
            "text": "\t\t\t\t\t\t\t\texternalConfig: fi.externalConfig",
            "lineNumber": 124
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t? fi.externalConfig.map((ec) =&gt; {",
            "lineNumber": 125
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\tif (",
            "lineNumber": 126
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\t\tfound.encrypted_config &amp;&amp;",
            "lineNumber": 127
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\t\tfound.encrypted_config[ec.key] !== undefined",
            "lineNumber": 128
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\t) {",
            "lineNumber": 129
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\t\treturn { ...ec, value: found.encrypted_config[ec.key] };",
            "lineNumber": 130
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\t}",
            "lineNumber": 131
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t\treturn ec;",
            "lineNumber": 132
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t})",
            "lineNumber": 133
          },
          {
            "text": "\t\t\t\t\t\t\t\t\t: undefined,",
            "lineNumber": 134
          },
          {
            "text": "\t\t\t\t\t\t\t};",
            "lineNumber": 135
          },
          {
            "text": "\t\t\t\t\t\t}",
            "lineNumber": 136
          },
          {
            "text": "\t\t\t\t\t\treturn fi;",
            "lineNumber": 137
          },
          {
            "text": "\t\t\t\t\t})",
            "lineNumber": 138
          },
          {
            "text": "\t\t\t\t);",
            "lineNumber": 139
          },
          {
            "text": "\t\t\t\t// Handle local model",
            "lineNumber": 140
          },
          {
            "text": "\t\t\t\tconst local = providerList.find(",
            "lineNumber": 141
          },
          {
            "text": "\t\t\t\t\t(p: any) =&gt; LOCAL_PROVIDER_NAMES.includes(p.provider_name)",
            "lineNumber": 142
          },
          {
            "text": "\t\t\t\t);",
            "lineNumber": 143
          },
          {
            "text": "\t\t\t\tconsole.log(123123, local);",
            "lineNumber": 144
          },
          {
            "text": "\t\t\t\tif (local) {",
            "lineNumber": 145
          },
          {
            "text": "\t\t\t\t\tsetLocalEndpoint(local.endpoint_url || \"\");",
            "lineNumber": 146
          },
          {
            "text": "\t\t\t\t\tsetLocalPlatform(",
            "lineNumber": 147
          },
          {
            "text": "\t\t\t\t\t\tlocal.encrypted_config?.model_platform ||",
            "lineNumber": 148
          },
          {
            "text": "\t\t\t\t\t\tlocal.provider_name ||",
            "lineNumber": 149
          },
          {
            "text": "\t\t\t\t\t\t\"ollama\"",
            "lineNumber": 150
          },
          {
            "text": "\t\t\t\t\t);",
            "lineNumber": 151
          },
          {
            "text": "\t\t\t\t\tsetLocalType(local.encrypted_config?.model_type || \"llama3.2\");",
            "lineNumber": 152
          },
          {
            "text": "\t\t\t\t\tsetLocalEnabled(local.is_valid ?? true);",
            "lineNumber": 153
          },
          {
            "text": "\t\t\t\t\tsetLocalPrefer(local.prefer ?? false);",
            "lineNumber": 154
          },
          {
            "text": "\t\t\t\t\tsetLocalProviderId(local.id);",
            "lineNumber": 155
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 156
          },
          {
            "text": "\t\t\t\tif (modelType === \"cloud\") {",
            "lineNumber": 157
          },
          {
            "text": "\t\t\t\t\tsetCloudPrefer(true);",
            "lineNumber": 158
          },
          {
            "text": "\t\t}",
            "lineNumber": 173
          },
          {
            "text": "\t}",
            "lineNumber": 179
          },
          {
            "text": "}",
            "lineNumber": 1117,
            "isSignature": true
          }
        ]
      },
      "score": 0.2778725028038025
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\nasync (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n\n\n\t\t\t// create history\n\t\t\tif (!type) {\n\t\t\t\tconst authStore = getAuthStore();\n\n\t\t\t\tconst obj = {\n\t\t\t\t\t\"project_id\": project_id,\n\t\t\t\t\t\"task_id\": newTaskId,\n\t\t\t\t\t\"user_id\": authStore.user_id,\n\t\t\t\t\t\"question\": messageContent || (targetChatStore.getState().tasks[newTaskId]?.messages[0]?.content ?? ''),\n\t\t\t\t\t\"language\": systemLanguage,\n\t\t\t\t\t\"model_platform\": apiModel.model_platform,\n\t\t\t\t\t\"model_type\": apiModel.model_type,\n\t\t\t\t\t\"api_url\": modelType === 'cloud' ? \"cloud\" : apiModel.api_url,\n\t\t\t\t\t\"max_retries\": 3,\n\t\t\t\t\t\"file_save_path\": \"string\",\n\t\t\t\t\t\"installed_mcp\": \"string\",\n\t\t\t\t\t\"status\": 1,\n\t\t\t\t\t\"tokens\": 0\n\t\t\t\t}\n\t\t\t\tawait proxyFetchPost(&#96;/api/chat/history&#96;, obj).then(res =&gt; {\n\t\t\t\t\thistoryId = res.id;\n\n\t\t\t\t\t/**Save history id for replay reuse purposes.\n\t\t\t\t\t * TODO(history): Remove historyId handling to support per projectId \n\t\t\t\t\t * instead in history api\n\t\t\t\t\t */\n\t\t\t\t\tif (project_id &amp;&amp; historyId) projectStore.setHistoryId(project_id, historyId);\n\t\t\t\t})\n\t\t\t}\n\t\t\tconst browser_port = await window.ipcRenderer.invoke('get-browser-port');\n\n\t\t\t// Lock the chatStore reference at the start of SSE session to prevent focus changes\n\t\t\t// during active message processing\n\t\t\tlet lockedChatStore = targetChatStore;\n\t\t\tlet lockedTaskId = newTaskId;\n\n\t\t\t// Create AbortController for this task's SSE connection\n\t\t\t// First check if there's already an active SSE connection for this task\n\t\t\tif (activeSSEControllers[newTaskId]) {\n\t\t\t\tconsole.warn(&#96;Task ${newTaskId} already has an active SSE connection, aborting old one&#96;);\n\t\t\t\ttry {\n\t\t\t\t\tactiveSSEControllers[newTaskId].abort();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn('Error aborting existing SSE connection:', error);\n\t\t\t\t}\n\t\t\t\tdelete activeSSEControllers[newTaskId];\n\t\t\t}\n\n\t\t\tconst abortController = new AbortController();\n\t\t\tactiveSSEControllers[newTaskId] = abortController;\n\n\t\t\t// Getter functions that use the locked references instead of dynamic ones\n\t\t\tconst getCurrentChatStore = () =&gt; {\n\t\t\t\treturn lockedChatStore.getState();\n\t\t\t};\n\n\t\t\t// Get the locked task ID - this won't change during the SSE session\n\t\t\tconst getCurrentTaskId = () =&gt; {\n\t\t\t\treturn lockedTaskId;\n\t\t\t};\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            },
            {
              "startPosition": {
                "line": 331,
                "column": 14
              },
              "endPosition": {
                "line": 332,
                "column": 4
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": "async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "lineNumber": 517
          },
          {
            "lineNumber": 518
          },
          {
            "text": "\t\t\t// create history",
            "lineNumber": 519
          },
          {
            "text": "\t\t\tif (!type) {",
            "lineNumber": 520
          },
          {
            "text": "\t\t\t\tconst authStore = getAuthStore();",
            "lineNumber": 521
          },
          {
            "lineNumber": 522
          },
          {
            "text": "\t\t\t\tconst obj = {",
            "lineNumber": 523
          },
          {
            "text": "\t\t\t\t\t\"project_id\": project_id,",
            "lineNumber": 524
          },
          {
            "text": "\t\t\t\t\t\"task_id\": newTaskId,",
            "lineNumber": 525
          },
          {
            "text": "\t\t\t\t\t\"user_id\": authStore.user_id,",
            "lineNumber": 526
          },
          {
            "text": "\t\t\t\t\t\"question\": messageContent || (targetChatStore.getState().tasks[newTaskId]?.messages[0]?.content ?? ''),",
            "lineNumber": 527
          },
          {
            "text": "\t\t\t\t\t\"language\": systemLanguage,",
            "lineNumber": 528
          },
          {
            "text": "\t\t\t\t\t\"model_platform\": apiModel.model_platform,",
            "lineNumber": 529
          },
          {
            "text": "\t\t\t\t\t\"model_type\": apiModel.model_type,",
            "lineNumber": 530
          },
          {
            "text": "\t\t\t\t\t\"api_url\": modelType === 'cloud' ? \"cloud\" : apiModel.api_url,",
            "lineNumber": 531
          },
          {
            "text": "\t\t\t\t\t\"max_retries\": 3,",
            "lineNumber": 532
          },
          {
            "text": "\t\t\t\t\t\"file_save_path\": \"string\",",
            "lineNumber": 533
          },
          {
            "text": "\t\t\t\t\t\"installed_mcp\": \"string\",",
            "lineNumber": 534
          },
          {
            "text": "\t\t\t\t\t\"status\": 1,",
            "lineNumber": 535
          },
          {
            "text": "\t\t\t\t\t\"tokens\": 0",
            "lineNumber": 536
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 537
          },
          {
            "text": "\t\t\t\tawait proxyFetchPost(&#96;/api/chat/history&#96;, obj).then(res =&gt; {",
            "lineNumber": 538
          },
          {
            "text": "\t\t\t\t\thistoryId = res.id;",
            "lineNumber": 539
          },
          {
            "lineNumber": 540
          },
          {
            "text": "\t\t\t\t\t/**Save history id for replay reuse purposes.",
            "lineNumber": 541
          },
          {
            "text": "\t\t\t\t\t * TODO(history): Remove historyId handling to support per projectId ",
            "lineNumber": 542
          },
          {
            "text": "\t\t\t\t\t * instead in history api",
            "lineNumber": 543
          },
          {
            "text": "\t\t\t\t\t */",
            "lineNumber": 544
          },
          {
            "text": "\t\t\t\t\tif (project_id &amp;&amp; historyId) projectStore.setHistoryId(project_id, historyId);",
            "lineNumber": 545
          },
          {
            "text": "\t\t\t\t})",
            "lineNumber": 546
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 547
          },
          {
            "text": "\t\t\tconst browser_port = await window.ipcRenderer.invoke('get-browser-port');",
            "lineNumber": 548
          },
          {
            "lineNumber": 549
          },
          {
            "text": "\t\t\t// Lock the chatStore reference at the start of SSE session to prevent focus changes",
            "lineNumber": 550
          },
          {
            "text": "\t\t\t// during active message processing",
            "lineNumber": 551
          },
          {
            "text": "\t\t\tlet lockedChatStore = targetChatStore;",
            "lineNumber": 552
          },
          {
            "text": "\t\t\tlet lockedTaskId = newTaskId;",
            "lineNumber": 553
          },
          {
            "lineNumber": 554
          },
          {
            "text": "\t\t\t// Create AbortController for this task's SSE connection",
            "lineNumber": 555
          },
          {
            "text": "\t\t\t// First check if there's already an active SSE connection for this task",
            "lineNumber": 556
          },
          {
            "text": "\t\t\tif (activeSSEControllers[newTaskId]) {",
            "lineNumber": 557
          },
          {
            "text": "\t\t\t\tconsole.warn(&#96;Task ${newTaskId} already has an active SSE connection, aborting old one&#96;);",
            "lineNumber": 558
          },
          {
            "text": "\t\t\t\ttry {",
            "lineNumber": 559
          },
          {
            "text": "\t\t\t\t\tactiveSSEControllers[newTaskId].abort();",
            "lineNumber": 560
          },
          {
            "text": "\t\t\t\t} catch (error) {",
            "lineNumber": 561
          },
          {
            "text": "\t\t\t\t\tconsole.warn('Error aborting existing SSE connection:', error);",
            "lineNumber": 562
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 563
          },
          {
            "text": "\t\t\t\tdelete activeSSEControllers[newTaskId];",
            "lineNumber": 564
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 565
          },
          {
            "lineNumber": 566
          },
          {
            "text": "\t\t\tconst abortController = new AbortController();",
            "lineNumber": 567
          },
          {
            "text": "\t\t\tactiveSSEControllers[newTaskId] = abortController;",
            "lineNumber": 568
          },
          {
            "lineNumber": 569
          },
          {
            "text": "\t\t\t// Getter functions that use the locked references instead of dynamic ones",
            "lineNumber": 570
          },
          {
            "text": "\t\t\tconst getCurrentChatStore = () =&gt; {",
            "lineNumber": 571
          },
          {
            "text": "\t\t\t\treturn lockedChatStore.getState();",
            "lineNumber": 572
          },
          {
            "text": "\t\t\t};",
            "lineNumber": 573
          },
          {
            "lineNumber": 574
          },
          {
            "text": "\t\t\t// Get the locked task ID - this won't change during the SSE session",
            "lineNumber": 575
          },
          {
            "text": "\t\t\tconst getCurrentTaskId = () =&gt; {",
            "lineNumber": 576
          },
          {
            "text": "\t\t\t\treturn lockedTaskId;",
            "lineNumber": 577
          },
          {
            "text": "\t\t\t};",
            "lineNumber": 578
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.27752459049224854
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\n\n  const navigate = useNavigate();\n\n  // Shared function to check model configuration\n  const checkModelConfig = useCallback(async () =&gt; {\n    try {\n      if (modelType === 'cloud') {\n        // For cloud model, check if API key exists\n        const res = await proxyFetchGet('/api/user/key');\n        setHasModel(!!res.value);\n      } else if (modelType === 'local' || modelType === 'custom') {\n        // For local/custom model, check if provider exists\n        const res = await proxyFetchGet('/api/providers', { prefer: true });\n        const providerList = res.items || [];\n        setHasModel(providerList.length &gt; 0);\n      } else {\n        setHasModel(false);\n      }\n    } catch (err) {\n      console.error('Failed to check model config:', err);\n      setHasModel(false);\n    } finally {\n      setIsConfigLoaded(true);\n    }\n  }, [modelType]);\n\n  useEffect(() =&gt; {\n    // Only show warning message, don't block functionality\n    if (\n      import.meta.env.VITE_USE_LOCAL_PROXY === 'true' &amp;&amp;\n      modelType === 'cloud'\n    ) {\n      setUseCloudModelInDev(true);\n    } else {\n      setUseCloudModelInDev(false);\n    }\n  }, [modelType]);\n  useEffect(() =&gt; {\n    proxyFetchGet('/api/user/privacy')\n      .then\n\n\n\n  }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 42
          },
          {
            "text": "  const navigate = useNavigate();",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "  // Shared function to check model configuration",
            "lineNumber": 45
          },
          {
            "text": "  const checkModelConfig = useCallback(async () =&gt; {",
            "lineNumber": 46
          },
          {
            "text": "    try {",
            "lineNumber": 47
          },
          {
            "text": "      if (modelType === 'cloud') {",
            "lineNumber": 48
          },
          {
            "text": "        // For cloud model, check if API key exists",
            "lineNumber": 49
          },
          {
            "text": "        const res = await proxyFetchGet('/api/user/key');",
            "lineNumber": 50
          },
          {
            "text": "        setHasModel(!!res.value);",
            "lineNumber": 51
          },
          {
            "text": "      } else if (modelType === 'local' || modelType === 'custom') {",
            "lineNumber": 52
          },
          {
            "text": "        // For local/custom model, check if provider exists",
            "lineNumber": 53
          },
          {
            "text": "        const res = await proxyFetchGet('/api/providers', { prefer: true });",
            "lineNumber": 54
          },
          {
            "text": "        const providerList = res.items || [];",
            "lineNumber": 55
          },
          {
            "text": "        setHasModel(providerList.length &gt; 0);",
            "lineNumber": 56
          },
          {
            "text": "      } else {",
            "lineNumber": 57
          },
          {
            "text": "        setHasModel(false);",
            "lineNumber": 58
          },
          {
            "text": "      }",
            "lineNumber": 59
          },
          {
            "text": "    } catch (err) {",
            "lineNumber": 60
          },
          {
            "text": "      console.error('Failed to check model config:', err);",
            "lineNumber": 61
          },
          {
            "text": "      setHasModel(false);",
            "lineNumber": 62
          },
          {
            "text": "    } finally {",
            "lineNumber": 63
          },
          {
            "text": "      setIsConfigLoaded(true);",
            "lineNumber": 64
          },
          {
            "text": "    }",
            "lineNumber": 65
          },
          {
            "text": "  }, [modelType]);",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 68
          },
          {
            "text": "    // Only show warning message, don't block functionality",
            "lineNumber": 69
          },
          {
            "text": "    if (",
            "lineNumber": 70
          },
          {
            "text": "      import.meta.env.VITE_USE_LOCAL_PROXY === 'true' &amp;&amp;",
            "lineNumber": 71
          },
          {
            "text": "      modelType === 'cloud'",
            "lineNumber": 72
          },
          {
            "text": "    ) {",
            "lineNumber": 73
          },
          {
            "text": "      setUseCloudModelInDev(true);",
            "lineNumber": 74
          },
          {
            "text": "    } else {",
            "lineNumber": 75
          },
          {
            "text": "      setUseCloudModelInDev(false);",
            "lineNumber": 76
          },
          {
            "text": "    }",
            "lineNumber": 77
          },
          {
            "text": "  }, [modelType]);",
            "lineNumber": 78
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 79
          },
          {
            "text": "    proxyFetchGet('/api/user/privacy')",
            "lineNumber": 80
          },
          {
            "text": "      .then",
            "lineNumber": 81
          },
          {
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "lineNumber": 92
          },
          {
            "text": "  }",
            "lineNumber": 108
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.2741149067878723
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\stack\\client.ts",
        "range": {
          "startPosition": {
            "column": 51
          },
          "endPosition": {
            "line": 16,
            "column": 10
          }
        },
        "contents": "import { useNavigate } from \"react-router-dom\";\nimport { hasStackKeys } from \"../lib\";\n\nconst hasSlackKeys = hasStackKeys();\n\nexport const stackClientApp = hasSlackKeys ? new StackClientApp({\n\tprojectId: import.meta.env.VITE_STACK_PROJECT_ID,\n\tpublishableClientKey: import.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY,\n\ttokenStore: \"cookie\",\n\tredirectMethod: {\n\t\tuseNavigate,\n\t},\n\turls: {\n\t\toauthCallback: (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + \"/api/redirect/callback\",\n\t},\n}) : null;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { useNavigate } from \"react-router-dom\";",
            "lineNumber": 2
          },
          {
            "text": "import { hasStackKeys } from \"../lib\";",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "const hasSlackKeys = hasStackKeys();",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "export const stackClientApp = hasSlackKeys ? new StackClientApp({",
            "lineNumber": 7
          },
          {
            "text": "\tprojectId: import.meta.env.VITE_STACK_PROJECT_ID,",
            "lineNumber": 8
          },
          {
            "text": "\tpublishableClientKey: import.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY,",
            "lineNumber": 9
          },
          {
            "text": "\ttokenStore: \"cookie\",",
            "lineNumber": 10
          },
          {
            "text": "\tredirectMethod: {",
            "lineNumber": 11
          },
          {
            "text": "\t\tuseNavigate,",
            "lineNumber": 12
          },
          {
            "text": "\t},",
            "lineNumber": 13
          },
          {
            "text": "\turls: {",
            "lineNumber": 14
          },
          {
            "text": "\t\toauthCallback: (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + \"/api/redirect/callback\",",
            "lineNumber": 15
          },
          {
            "text": "\t},",
            "lineNumber": 16
          },
          {
            "text": "}) : null;",
            "lineNumber": 17
          }
        ]
      },
      "score": 0.27170073986053467
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\nasync (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n\n\t\t\tif (modelType === 'custom') {\n\t\t\t\ttry {\n\t\t\t\t\tconst configsRes = await proxyFetchGet('/api/configs');\n\t\t\t\t\tconst configs = Array.isArray(configsRes) ? configsRes : [];\n\n\t\t\t\t\t// Extract Google Search API keys\n\t\t\t\t\tconst googleApiKey = configs.find((c: any) =&gt;\n\t\t\t\t\t\tc.config_group?.toLowerCase() === 'search' &amp;&amp;\n\t\t\t\t\t\tc.config_name === 'GOOGLE_API_KEY'\n\t\t\t\t\t)?.config_value;\n\n\t\t\t\t\tconst searchEngineId = configs.find((c: any) =&gt;\n\t\t\t\t\t\tc.config_group?.toLowerCase() === 'search' &amp;&amp;\n\t\t\t\t\t\tc.config_name === 'SEARCH_ENGINE_ID'\n\t\t\t\t\t)?.config_value;\n\n\t\t\t\t\tif (googleApiKey &amp;&amp; searchEngineId) {\n\t\t\t\t\t\tsearchConfig = {\n\t\t\t\t\t\t\tGOOGLE_API_KEY: googleApiKey,\n\t\t\t\t\t\t\tSEARCH_ENGINE_ID: searchEngineId\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconsole.log('Loaded custom search configuration');\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('Failed to load search configuration:', error);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst addWorkers = workerList.map((worker) =&gt; {\n\t\t\t\treturn {\n\t\t\t\t\tname: worker.workerInfo?.name,\n\t\t\t\t\tdescription: worker.workerInfo?.description,\n\t\t\t\t\ttools: worker.workerInfo?.tools,\n\t\t\t\t\tmcp_tools: worker.workerInfo?.mcp_tools,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// get env path\n\t\t\tlet envPath = ''\n\t\t\ttry {\n\t\t\t\tenvPath = await window.ipcRenderer.invoke('get-env-path', email);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('get-env-path error', error)\n\t\t\t}\n\n\t\t\t// create history\n\t\t\tif (!type) {\n\t\t\t\tconst authStore = getAuthStore();\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            },
            {
              "startPosition": {
                "line": 331,
                "column": 14
              },
              "endPosition": {
                "line": 332,
                "column": 4
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": "async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "lineNumber": 473
          },
          {
            "text": "\t\t\tif (modelType === 'custom') {",
            "lineNumber": 474
          },
          {
            "text": "\t\t\t\ttry {",
            "lineNumber": 475
          },
          {
            "text": "\t\t\t\t\tconst configsRes = await proxyFetchGet('/api/configs');",
            "lineNumber": 476
          },
          {
            "text": "\t\t\t\t\tconst configs = Array.isArray(configsRes) ? configsRes : [];",
            "lineNumber": 477
          },
          {
            "lineNumber": 478
          },
          {
            "text": "\t\t\t\t\t// Extract Google Search API keys",
            "lineNumber": 479
          },
          {
            "text": "\t\t\t\t\tconst googleApiKey = configs.find((c: any) =&gt;",
            "lineNumber": 480
          },
          {
            "text": "\t\t\t\t\t\tc.config_group?.toLowerCase() === 'search' &amp;&amp;",
            "lineNumber": 481
          },
          {
            "text": "\t\t\t\t\t\tc.config_name === 'GOOGLE_API_KEY'",
            "lineNumber": 482
          },
          {
            "text": "\t\t\t\t\t)?.config_value;",
            "lineNumber": 483
          },
          {
            "lineNumber": 484
          },
          {
            "text": "\t\t\t\t\tconst searchEngineId = configs.find((c: any) =&gt;",
            "lineNumber": 485
          },
          {
            "text": "\t\t\t\t\t\tc.config_group?.toLowerCase() === 'search' &amp;&amp;",
            "lineNumber": 486
          },
          {
            "text": "\t\t\t\t\t\tc.config_name === 'SEARCH_ENGINE_ID'",
            "lineNumber": 487
          },
          {
            "text": "\t\t\t\t\t)?.config_value;",
            "lineNumber": 488
          },
          {
            "lineNumber": 489
          },
          {
            "text": "\t\t\t\t\tif (googleApiKey &amp;&amp; searchEngineId) {",
            "lineNumber": 490
          },
          {
            "text": "\t\t\t\t\t\tsearchConfig = {",
            "lineNumber": 491
          },
          {
            "text": "\t\t\t\t\t\t\tGOOGLE_API_KEY: googleApiKey,",
            "lineNumber": 492
          },
          {
            "text": "\t\t\t\t\t\t\tSEARCH_ENGINE_ID: searchEngineId",
            "lineNumber": 493
          },
          {
            "text": "\t\t\t\t\t\t};",
            "lineNumber": 494
          },
          {
            "text": "\t\t\t\t\t\tconsole.log('Loaded custom search configuration');",
            "lineNumber": 495
          },
          {
            "text": "\t\t\t\t\t}",
            "lineNumber": 496
          },
          {
            "text": "\t\t\t\t} catch (error) {",
            "lineNumber": 497
          },
          {
            "text": "\t\t\t\t\tconsole.error('Failed to load search configuration:', error);",
            "lineNumber": 498
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 499
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 500
          },
          {
            "lineNumber": 501
          },
          {
            "text": "\t\t\tconst addWorkers = workerList.map((worker) =&gt; {",
            "lineNumber": 502
          },
          {
            "text": "\t\t\t\treturn {",
            "lineNumber": 503
          },
          {
            "text": "\t\t\t\t\tname: worker.workerInfo?.name,",
            "lineNumber": 504
          },
          {
            "text": "\t\t\t\t\tdescription: worker.workerInfo?.description,",
            "lineNumber": 505
          },
          {
            "text": "\t\t\t\t\ttools: worker.workerInfo?.tools,",
            "lineNumber": 506
          },
          {
            "text": "\t\t\t\t\tmcp_tools: worker.workerInfo?.mcp_tools,",
            "lineNumber": 507
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 508
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 509
          },
          {
            "lineNumber": 510
          },
          {
            "text": "\t\t\t// get env path",
            "lineNumber": 511
          },
          {
            "text": "\t\t\tlet envPath = ''",
            "lineNumber": 512
          },
          {
            "text": "\t\t\ttry {",
            "lineNumber": 513
          },
          {
            "text": "\t\t\t\tenvPath = await window.ipcRenderer.invoke('get-env-path', email);",
            "lineNumber": 514
          },
          {
            "text": "\t\t\t} catch (error) {",
            "lineNumber": 515
          },
          {
            "text": "\t\t\t\tconsole.log('get-env-path error', error)",
            "lineNumber": 516
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 517
          },
          {
            "lineNumber": 518
          },
          {
            "text": "\t\t\t// create history",
            "lineNumber": 519
          },
          {
            "text": "\t\t\tif (!type) {",
            "lineNumber": 520
          },
          {
            "text": "\t\t\t\tconst authStore = getAuthStore();",
            "lineNumber": 521
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.26709526777267456
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\ChatBox\\index.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 1174,
            "column": 1
          }
        },
        "contents": "export default function ChatBox(): JSX.Element {\nconst handleSend = async \n else {\n          if (!privacy) {\n            const API_FIELDS = [\n              'take_screenshot',\n              'access_local_software',\n              'access_your_address',\n              'password_storage',\n            ];\n            const requestData = {\n              [API_FIELDS[0]]: true,\n              [API_FIELDS[1]]: true,\n              [API_FIELDS[2]]: true,\n              [API_FIELDS[3]]: true,\n            };\n            proxyFetchPut('/api/user/privacy', requestData);\n            setPrivacy(true);\n          }\n\n          setTimeout(() =&gt; {\n            scrollToBottom();\n          }, 200);\n\n          // For the very first message, add it to the current chatStore first, then call startTask\n          const attachesToSend =\n            JSON.parse(JSON.stringify(chatStore.tasks[_taskId]?.attaches)) ||\n            [];\n          setMessage('');\n          try {\n            await chatStore.startTask(\n              _taskId,\n              undefined,\n              undefined,\n              undefined,\n              tempMessageContent,\n              attachesToSend\n            );\n            chatStore.setHasWaitComfirm(_taskId as string, true);\n          } catch (err: any) {\n            console.error('Failed to start task:', err);\n            toast.error(\n              err?.message ||\n                'Failed to start task. Please check your model configuration.'\n            );\n            return;\n          }\n        }\n      }\n    } catch (error) {\n      console.error('error:', error);\n    }\n  };\n\n  useEffect(() =&gt; {\n    // Wait for both config and privacy to be loaded before handling share token\n    if (share_token &amp;&amp; isConfigLoaded &amp;&amp; isPrivacyLoaded) {\n      handleSendShare(share_token);\n    }\n  }, [share_token, isConfigLoaded, isPrivacyLoaded]);\n\n  useEffect(() =&gt; {\n    console.log('ChatStore Data: ', chatStore);\n  }, []);\n\n  const handleSendShare = async (token: string) =&gt;\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            },
            {
              "startPosition": {
                "line": 152,
                "column": 3
              },
              "endPosition": {
                "line": 152,
                "column": 9
              }
            },
            {
              "startPosition": {
                "line": 152,
                "column": 9
              },
              "endPosition": {
                "line": 152,
                "column": 28
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function ChatBox(): JSX.Element {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "const handleSend = async ",
            "lineNumber": 152
          },
          {
            "text": " else {",
            "lineNumber": 339
          },
          {
            "text": "          if (!privacy) {",
            "lineNumber": 340
          },
          {
            "text": "            const API_FIELDS = [",
            "lineNumber": 341
          },
          {
            "text": "              'take_screenshot',",
            "lineNumber": 342
          },
          {
            "text": "              'access_local_software',",
            "lineNumber": 343
          },
          {
            "text": "              'access_your_address',",
            "lineNumber": 344
          },
          {
            "text": "              'password_storage',",
            "lineNumber": 345
          },
          {
            "text": "            ];",
            "lineNumber": 346
          },
          {
            "text": "            const requestData = {",
            "lineNumber": 347
          },
          {
            "text": "              [API_FIELDS[0]]: true,",
            "lineNumber": 348
          },
          {
            "text": "              [API_FIELDS[1]]: true,",
            "lineNumber": 349
          },
          {
            "text": "              [API_FIELDS[2]]: true,",
            "lineNumber": 350
          },
          {
            "text": "              [API_FIELDS[3]]: true,",
            "lineNumber": 351
          },
          {
            "text": "            };",
            "lineNumber": 352
          },
          {
            "text": "            proxyFetchPut('/api/user/privacy', requestData);",
            "lineNumber": 353
          },
          {
            "text": "            setPrivacy(true);",
            "lineNumber": 354
          },
          {
            "text": "          }",
            "lineNumber": 355
          },
          {
            "lineNumber": 356
          },
          {
            "text": "          setTimeout(() =&gt; {",
            "lineNumber": 357
          },
          {
            "text": "            scrollToBottom();",
            "lineNumber": 358
          },
          {
            "text": "          }, 200);",
            "lineNumber": 359
          },
          {
            "lineNumber": 360
          },
          {
            "text": "          // For the very first message, add it to the current chatStore first, then call startTask",
            "lineNumber": 361
          },
          {
            "text": "          const attachesToSend =",
            "lineNumber": 362
          },
          {
            "text": "            JSON.parse(JSON.stringify(chatStore.tasks[_taskId]?.attaches)) ||",
            "lineNumber": 363
          },
          {
            "text": "            [];",
            "lineNumber": 364
          },
          {
            "text": "          setMessage('');",
            "lineNumber": 365
          },
          {
            "text": "          try {",
            "lineNumber": 366
          },
          {
            "text": "            await chatStore.startTask(",
            "lineNumber": 367
          },
          {
            "text": "              _taskId,",
            "lineNumber": 368
          },
          {
            "text": "              undefined,",
            "lineNumber": 369
          },
          {
            "text": "              undefined,",
            "lineNumber": 370
          },
          {
            "text": "              undefined,",
            "lineNumber": 371
          },
          {
            "text": "              tempMessageContent,",
            "lineNumber": 372
          },
          {
            "text": "              attachesToSend",
            "lineNumber": 373
          },
          {
            "text": "            );",
            "lineNumber": 374
          },
          {
            "text": "            chatStore.setHasWaitComfirm(_taskId as string, true);",
            "lineNumber": 375
          },
          {
            "text": "          } catch (err: any) {",
            "lineNumber": 376
          },
          {
            "text": "            console.error('Failed to start task:', err);",
            "lineNumber": 377
          },
          {
            "text": "            toast.error(",
            "lineNumber": 378
          },
          {
            "text": "              err?.message ||",
            "lineNumber": 379
          },
          {
            "text": "                'Failed to start task. Please check your model configuration.'",
            "lineNumber": 380
          },
          {
            "text": "            );",
            "lineNumber": 381
          },
          {
            "text": "            return;",
            "lineNumber": 382
          },
          {
            "text": "          }",
            "lineNumber": 383
          },
          {
            "text": "        }",
            "lineNumber": 384
          },
          {
            "text": "      }",
            "lineNumber": 385
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 386
          },
          {
            "text": "      console.error('error:', error);",
            "lineNumber": 387
          },
          {
            "text": "    }",
            "lineNumber": 388
          },
          {
            "text": "  };",
            "lineNumber": 389
          },
          {
            "lineNumber": 390
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 391
          },
          {
            "text": "    // Wait for both config and privacy to be loaded before handling share token",
            "lineNumber": 392
          },
          {
            "text": "    if (share_token &amp;&amp; isConfigLoaded &amp;&amp; isPrivacyLoaded) {",
            "lineNumber": 393
          },
          {
            "text": "      handleSendShare(share_token);",
            "lineNumber": 394
          },
          {
            "text": "    }",
            "lineNumber": 395
          },
          {
            "text": "  }, [share_token, isConfigLoaded, isPrivacyLoaded]);",
            "lineNumber": 396
          },
          {
            "lineNumber": 397
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 398
          },
          {
            "text": "    console.log('ChatStore Data: ', chatStore);",
            "lineNumber": 399
          },
          {
            "text": "  }, []);",
            "lineNumber": 400
          },
          {
            "lineNumber": 401
          },
          {
            "text": "  const handleSendShare = async (token: string) =&gt;",
            "lineNumber": 402
          },
          {
            "text": ";",
            "lineNumber": 447
          },
          {
            "text": "}",
            "lineNumber": 1175,
            "isSignature": true
          }
        ]
      },
      "score": 0.2656641900539398
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\App.tsx",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 87,
            "column": 1
          }
        },
        "contents": "import AppRoutes from \"@/routers/index\";\nimport React, { useEffect, useState } from \"react\";\nimport { stackClientApp } from \"@/stack/client\";\nimport { StackProvider, StackTheme } from \"@stackframe/react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AnimationJson } from \"@/components/AnimationJson\";\nimport animationData from \"@/assets/animation/openning_animaiton.json\";\nimport { useAuthStore } from \"./store/authStore\";\nimport { Toaster } from \"sonner\";\nimport { hasStackKeys } from \"./lib\";\n\nconst HAS_STACK_KEYS = hasStackKeys();\n\nfunction App() {\n\tconst navigate = useNavigate();\n\tconst { setInitState } = useAuthStore();\n\tconst [animationFinished, setAnimationFinished] = useState(false);\n\tconst { isFirstLaunch } = useAuthStore();\n\n\tuseEffect(() =&gt; {\n\t\tconst handleShareCode = (event: any, share_token: string) =&gt; {\n\t\t\tnavigate({\n\t\t\t\tpathname: \"/\",\n\t\t\t\tsearch: &#96;?share_token=${encodeURIComponent(share_token)}&#96;,\n\t\t\t});\n\t\t};\n\n\t\t//  listen version update notification\n\t\tconst handleUpdateNotification = (data: {\n\t\t\ttype: string;\n\t\t\tcurrentVersion: string;\n\t\t\tpreviousVersion: string;\n\t\t\treason: string;\n\t\t}) =&gt; {\n\t\t\tconsole.log(\"receive version update notification:\", data);\n\n\t\t\tif (data.type === \"version-update\") {\n\t\t\t\t// handle version update logic\n\t\t\t\tconsole.log(\n\t\t\t\t\t&#96;version from ${data.previousVersion} to ${data.currentVersion}&#96;\n\t\t\t\t);\n\t\t\t\tconsole.log(&#96;update reason: ${data.reason}&#96;);\n\t\t\t\tsetInitState(\"carousel\");\n\t\t\t}\n\t\t};\n\n\t\twindow.ipcRenderer?.on(\"auth-share-token-received\", handleShareCode);\n\t\twindow.electronAPI?.onUpdateNotification(handleUpdateNotification);\n\n\t\treturn () =&gt; {\n\t\t\twindow.ipcRenderer?.off(\"auth-share-token-received\", handleShareCode);\n\t\t\twindow.electronAPI?.removeAllListeners(\"update-notification\");\n\t\t};\n\t}, [navigate, setInitState]);\n\n\t// render main content\n\tconst renderMainContent = ()\n;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import AppRoutes from \"@/routers/index\";",
            "lineNumber": 1
          },
          {
            "text": "import React, { useEffect, useState } from \"react\";",
            "lineNumber": 2
          },
          {
            "text": "import { stackClientApp } from \"@/stack/client\";",
            "lineNumber": 3
          },
          {
            "text": "import { StackProvider, StackTheme } from \"@stackframe/react\";",
            "lineNumber": 4
          },
          {
            "text": "import { useNavigate } from \"react-router-dom\";",
            "lineNumber": 5
          },
          {
            "text": "import { AnimationJson } from \"@/components/AnimationJson\";",
            "lineNumber": 6
          },
          {
            "text": "import animationData from \"@/assets/animation/openning_animaiton.json\";",
            "lineNumber": 7
          },
          {
            "text": "import { useAuthStore } from \"./store/authStore\";",
            "lineNumber": 8
          },
          {
            "text": "import { Toaster } from \"sonner\";",
            "lineNumber": 9
          },
          {
            "text": "import { hasStackKeys } from \"./lib\";",
            "lineNumber": 10
          },
          {
            "lineNumber": 11
          },
          {
            "text": "const HAS_STACK_KEYS = hasStackKeys();",
            "lineNumber": 12
          },
          {
            "lineNumber": 13
          },
          {
            "text": "function App() {",
            "lineNumber": 14,
            "isSignature": true
          },
          {
            "text": "\tconst navigate = useNavigate();",
            "lineNumber": 15
          },
          {
            "text": "\tconst { setInitState } = useAuthStore();",
            "lineNumber": 16
          },
          {
            "text": "\tconst [animationFinished, setAnimationFinished] = useState(false);",
            "lineNumber": 17
          },
          {
            "text": "\tconst { isFirstLaunch } = useAuthStore();",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 20
          },
          {
            "text": "\t\tconst handleShareCode = (event: any, share_token: string) =&gt; {",
            "lineNumber": 21
          },
          {
            "text": "\t\t\tnavigate({",
            "lineNumber": 22
          },
          {
            "text": "\t\t\t\tpathname: \"/\",",
            "lineNumber": 23
          },
          {
            "text": "\t\t\t\tsearch: &#96;?share_token=${encodeURIComponent(share_token)}&#96;,",
            "lineNumber": 24
          },
          {
            "text": "\t\t\t});",
            "lineNumber": 25
          },
          {
            "text": "\t\t};",
            "lineNumber": 26
          },
          {
            "lineNumber": 27
          },
          {
            "text": "\t\t//  listen version update notification",
            "lineNumber": 28
          },
          {
            "text": "\t\tconst handleUpdateNotification = (data: {",
            "lineNumber": 29
          },
          {
            "text": "\t\t\ttype: string;",
            "lineNumber": 30
          },
          {
            "text": "\t\t\tcurrentVersion: string;",
            "lineNumber": 31
          },
          {
            "text": "\t\t\tpreviousVersion: string;",
            "lineNumber": 32
          },
          {
            "text": "\t\t\treason: string;",
            "lineNumber": 33
          },
          {
            "text": "\t\t}) =&gt; {",
            "lineNumber": 34
          },
          {
            "text": "\t\t\tconsole.log(\"receive version update notification:\", data);",
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "\t\t\tif (data.type === \"version-update\") {",
            "lineNumber": 37
          },
          {
            "text": "\t\t\t\t// handle version update logic",
            "lineNumber": 38
          },
          {
            "text": "\t\t\t\tconsole.log(",
            "lineNumber": 39
          },
          {
            "text": "\t\t\t\t\t&#96;version from ${data.previousVersion} to ${data.currentVersion}&#96;",
            "lineNumber": 40
          },
          {
            "text": "\t\t\t\t);",
            "lineNumber": 41
          },
          {
            "text": "\t\t\t\tconsole.log(&#96;update reason: ${data.reason}&#96;);",
            "lineNumber": 42
          },
          {
            "text": "\t\t\t\tsetInitState(\"carousel\");",
            "lineNumber": 43
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 44
          },
          {
            "text": "\t\t};",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "\t\twindow.ipcRenderer?.on(\"auth-share-token-received\", handleShareCode);",
            "lineNumber": 47
          },
          {
            "text": "\t\twindow.electronAPI?.onUpdateNotification(handleUpdateNotification);",
            "lineNumber": 48
          },
          {
            "lineNumber": 49
          },
          {
            "text": "\t\treturn () =&gt; {",
            "lineNumber": 50
          },
          {
            "text": "\t\t\twindow.ipcRenderer?.off(\"auth-share-token-received\", handleShareCode);",
            "lineNumber": 51
          },
          {
            "text": "\t\t\twindow.electronAPI?.removeAllListeners(\"update-notification\");",
            "lineNumber": 52
          },
          {
            "text": "\t\t};",
            "lineNumber": 53
          },
          {
            "text": "\t}, [navigate, setInitState]);",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "text": "\t// render main content",
            "lineNumber": 56
          },
          {
            "text": "\tconst renderMainContent = ()",
            "lineNumber": 57
          },
          {
            "text": ";",
            "lineNumber": 67
          },
          {
            "text": "}",
            "lineNumber": 88,
            "isSignature": true
          }
        ]
      },
      "score": 0.26541250944137573
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 219,
            "column": 1
          },
          "endPosition": {
            "line": 225
          }
        },
        "contents": "export const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;\n  proxyFetchRequest('GET', url, params, headers)\n\nexport const proxyFetchPost = (url: string, data?: any, headers?: any) =&gt;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 222
          },
          {
            "text": "  proxyFetchRequest('GET', url, params, headers)",
            "lineNumber": 223
          },
          {
            "lineNumber": 224
          },
          {
            "text": "export const proxyFetchPost = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 225
          }
        ]
      },
      "score": 0.2638523578643799
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\SignUp.tsx",
        "range": {
          "startPosition": {
            "line": 19
          },
          "endPosition": {
            "line": 354,
            "column": 1
          }
        },
        "contents": "export default function SignUp() {\n\n\n\tconst handleReloadBtn = async (type: string) =&gt; {\n\t\tlocalStorage.setItem(\"invite_code\", formData.invite_code);\n\t\tconsole.log(\"handleReloadBtn1\", type);\n\t\tconst cookies = document.cookie.split(\"; \");\n\t\tcookies.forEach((cookie) =&gt; {\n\t\t\tconst [name] = cookie.split(\"=\");\n\t\t\tif (name.startsWith(\"stack-oauth-outer-\")) {\n\t\t\t\tdocument.cookie = &#96;${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/&#96;;\n\t\t\t}\n\t\t});\n\t\tconsole.log(\"handleReloadBtn2\", type);\n\t\tawait app.signInWithOAuth(type);\n\t};\n\n\tconst handleGetToken = async (code: string) =&gt; {\n\t\tconst code_verifier = localStorage.getItem(\"stack-oauth-outer-\");\n\t\tconst formData = new URLSearchParams();\n\t\tconsole.log(\n\t\t\t\"import.meta.env.PROD\",\n\t\t\timport.meta.env.PROD\n\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;\n\t\t\t\t: &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;\n\t\t);\n\t\tformData.append(\n\t\t\t\"redirect_uri\",\n\t\t\timport.meta.env.PROD\n\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;\n\t\t\t\t: &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;\n\t\t);\n\t\tformData.append(\"code_verifier\", code_verifier || \"\");\n\t\tformData.append(\"code\", code);\n\t\tformData.append(\"grant_type\", \"authorization_code\");\n\t\tformData.append(\"client_id\", \"7b927864-23c3-4bff-969f-ef90e85f1707\");\n\t\tformData.append(\n\t\t\t\"client_secret\",\n\t\t\t\"pck_r0g1stv09a2fy2ecnc8tfnzt1rdp2dntemt37pjfc4am0\"\n\t\t);\n\n\t\ttry {\n\t\t\tconst res = await fetch(\n\t\t\t\t\"https://api.stack-auth.com/api/v1/auth/oauth/token\",\n\t\t\t\t{\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded;charset=UTF-8\",\n\t\t\t\t\t},\n\t\t\t\t\tbody: formData,\n\t\t\t\t}\n\t\t\t);\n\t\t\tconst data = await res.json(); // parse response data\n\t\t\treturn data.access_token;\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t\tsetIsLoading(false);\n\t\t}\n\t};\n\n\tconst handleAuthCode = useCallback(\n\t\tasync (event: any, code: string) =&gt; {\n\t\t\tif\n\t\t}\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 20,
                "column": 1
              },
              "endPosition": {
                "line": 20,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 20,
                "column": 16
              },
              "endPosition": {
                "line": 21,
                "column": 2
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function SignUp() {",
            "lineNumber": 20,
            "isSignature": true
          },
          {
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "\tconst handleReloadBtn = async (type: string) =&gt; {",
            "lineNumber": 152
          },
          {
            "text": "\t\tlocalStorage.setItem(\"invite_code\", formData.invite_code);",
            "lineNumber": 153
          },
          {
            "text": "\t\tconsole.log(\"handleReloadBtn1\", type);",
            "lineNumber": 154
          },
          {
            "text": "\t\tconst cookies = document.cookie.split(\"; \");",
            "lineNumber": 155
          },
          {
            "text": "\t\tcookies.forEach((cookie) =&gt; {",
            "lineNumber": 156
          },
          {
            "text": "\t\t\tconst [name] = cookie.split(\"=\");",
            "lineNumber": 157
          },
          {
            "text": "\t\t\tif (name.startsWith(\"stack-oauth-outer-\")) {",
            "lineNumber": 158
          },
          {
            "text": "\t\t\t\tdocument.cookie = &#96;${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/&#96;;",
            "lineNumber": 159
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 160
          },
          {
            "text": "\t\t});",
            "lineNumber": 161
          },
          {
            "text": "\t\tconsole.log(\"handleReloadBtn2\", type);",
            "lineNumber": 162
          },
          {
            "text": "\t\tawait app.signInWithOAuth(type);",
            "lineNumber": 163
          },
          {
            "text": "\t};",
            "lineNumber": 164
          },
          {
            "lineNumber": 165
          },
          {
            "text": "\tconst handleGetToken = async (code: string) =&gt; {",
            "lineNumber": 166
          },
          {
            "text": "\t\tconst code_verifier = localStorage.getItem(\"stack-oauth-outer-\");",
            "lineNumber": 167
          },
          {
            "text": "\t\tconst formData = new URLSearchParams();",
            "lineNumber": 168
          },
          {
            "text": "\t\tconsole.log(",
            "lineNumber": 169
          },
          {
            "text": "\t\t\t\"import.meta.env.PROD\",",
            "lineNumber": 170
          },
          {
            "text": "\t\t\timport.meta.env.PROD",
            "lineNumber": 171
          },
          {
            "text": "\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;",
            "lineNumber": 172
          },
          {
            "text": "\t\t\t\t: &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;",
            "lineNumber": 173
          },
          {
            "text": "\t\t);",
            "lineNumber": 174
          },
          {
            "text": "\t\tformData.append(",
            "lineNumber": 175
          },
          {
            "text": "\t\t\t\"redirect_uri\",",
            "lineNumber": 176
          },
          {
            "text": "\t\t\timport.meta.env.PROD",
            "lineNumber": 177
          },
          {
            "text": "\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;",
            "lineNumber": 178
          },
          {
            "text": "\t\t\t\t: &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;",
            "lineNumber": 179
          },
          {
            "text": "\t\t);",
            "lineNumber": 180
          },
          {
            "text": "\t\tformData.append(\"code_verifier\", code_verifier || \"\");",
            "lineNumber": 181
          },
          {
            "text": "\t\tformData.append(\"code\", code);",
            "lineNumber": 182
          },
          {
            "text": "\t\tformData.append(\"grant_type\", \"authorization_code\");",
            "lineNumber": 183
          },
          {
            "text": "\t\tformData.append(\"client_id\", \"7b927864-23c3-4bff-969f-ef90e85f1707\");",
            "lineNumber": 184
          },
          {
            "text": "\t\tformData.append(",
            "lineNumber": 185
          },
          {
            "text": "\t\t\t\"client_secret\",",
            "lineNumber": 186
          },
          {
            "text": "\t\t\t\"pck_r0g1stv09a2fy2ecnc8tfnzt1rdp2dntemt37pjfc4am0\"",
            "lineNumber": 187
          },
          {
            "text": "\t\t);",
            "lineNumber": 188
          },
          {
            "lineNumber": 189
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 190
          },
          {
            "text": "\t\t\tconst res = await fetch(",
            "lineNumber": 191
          },
          {
            "text": "\t\t\t\t\"https://api.stack-auth.com/api/v1/auth/oauth/token\",",
            "lineNumber": 192
          },
          {
            "text": "\t\t\t\t{",
            "lineNumber": 193
          },
          {
            "text": "\t\t\t\t\tmethod: \"POST\",",
            "lineNumber": 194
          },
          {
            "text": "\t\t\t\t\theaders: {",
            "lineNumber": 195
          },
          {
            "text": "\t\t\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded;charset=UTF-8\",",
            "lineNumber": 196
          },
          {
            "text": "\t\t\t\t\t},",
            "lineNumber": 197
          },
          {
            "text": "\t\t\t\t\tbody: formData,",
            "lineNumber": 198
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 199
          },
          {
            "text": "\t\t\t);",
            "lineNumber": 200
          },
          {
            "text": "\t\t\tconst data = await res.json(); // parse response data",
            "lineNumber": 201
          },
          {
            "text": "\t\t\treturn data.access_token;",
            "lineNumber": 202
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 203
          },
          {
            "text": "\t\t\tconsole.error(error);",
            "lineNumber": 204
          },
          {
            "text": "\t\t\tsetIsLoading(false);",
            "lineNumber": 205
          },
          {
            "text": "\t\t}",
            "lineNumber": 206
          },
          {
            "text": "\t};",
            "lineNumber": 207
          },
          {
            "lineNumber": 208
          },
          {
            "text": "\tconst handleAuthCode = useCallback(",
            "lineNumber": 209
          },
          {
            "text": "\t\tasync (event: any, code: string) =&gt; {",
            "lineNumber": 210
          },
          {
            "text": "\t\t\tif",
            "lineNumber": 211
          },
          {
            "text": "\t\t}",
            "lineNumber": 220
          },
          {
            "text": ";",
            "lineNumber": 222
          },
          {
            "text": "}",
            "lineNumber": 355,
            "isSignature": true
          }
        ]
      },
      "score": 0.26212188601493835
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---


‰øÆÊ≠£ÂâçÁ´ØÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÔºöÂ∞á `/health` ÊîπÁÇ∫ `/api/health`„ÄÇ


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** ‚Ä¢ Edit file: d:\_Code\_GitHub\eigent-260119\src\api\http.ts</summary>

</details>

</tool-use>

---


Â∑≤‰øÆÊ≠£ÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûË∑ØÂæë„ÄÇÂâçÁ´ØÁèæÂú®ÊúÉÂëºÂè´ `/api/health`ÔºåËàáÂæåÁ´ØË∑ØÁî±‰∏ÄËá¥„ÄÇ

**‰øÆÊ≠£ÂÖßÂÆπÔºö**
- Â∞á `checkBackendHealth()` ‰∏≠ÁöÑÁ´ØÈªûÂæû `/health` ÊîπÁÇ∫ `/api/health`
- ËàáÂæåÁ´ØË∑ØÁî±Ë®ªÂÜäÁöÑ `/api` ÂâçÁ∂¥‰∏ÄËá¥

ÈáçÊñ∞ÂïüÂãïÊáâÁî®ÂæåÔºåÂÅ•Â∫∑Ê™¢Êü•ÊáâÂèØÊ≠£Â∏∏ÈÅã‰ΩúÔºå‰∏çÂÜçÂá∫Áèæ 404„ÄÇ

---

_**User**_

Ë®≠ÂÆöÊ™îÊ°àÊúâ "VITE_BASE_URL=/api" 
ÈÄôÂÄãË®≠ÂÆöÊúâ‰ΩúÁî®ÂóéÔºü

---

_**Agent (model default, mode Agent)**_


Ê™¢Êü• `VITE_BASE_URL` Âú®Á®ãÂºèÁ¢º‰∏≠ÁöÑ‰ΩøÁî®ÊñπÂºèÔºö


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "VITE_BASE_URL",
  "path": "src",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "VITE_BASE_URL",
    "path": "src",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": "src\\api\\http.ts",
              "matches": [
                {
                  "lineNumber": 164,
                  "content": "    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL"
                },
                {
                  "lineNumber": 165,
                  "content": "    const baseUrl = import.meta.env.VITE_BASE_URL"
                },
                {
                  "lineNumber": 167,
                  "content": "      throw new Error('VITE_BASE_URL not configured')"
                },
                {
                  "lineNumber": 194,
                  "content": "    const targetUrl = import.meta.env.VITE_BASE_URL"
                },
                {
                  "lineNumber": 255,
                  "content": "    const targetUrl = import.meta.env.VITE_BASE_URL"
                }
              ]
            },
            {
              "file": "src\\lib\\index.ts",
              "matches": [
                {
                  "lineNumber": 13,
                  "content": "\t\tconst baseUrl = import.meta.env.VITE_BASE_URL"
                },
                {
                  "lineNumber": 15,
                  "content": "\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");"
                },
                {
                  "lineNumber": 70,
                  "content": "\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL"
                }
              ]
            },
            {
              "file": "src\\store\\chatStore.ts",
              "matches": [
                {
                  "lineNumber": 395,
                  "content": "\t\t\tconst base_Url = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL"
                },
                {
                  "lineNumber": 945,
                  "content": "\t\t\t\t\t\t\t\t\t\tconst imgurl = !item.image_path.includes('/public') ? item.image_path : (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + item.image_path"
                }
              ]
            },
            {
              "file": "src\\stack\\client.ts",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "\t\toauthCallback: (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + \"/api/redirect/callback\","
                }
              ]
            },
            {
              "file": "src\\pages\\SignUp.tsx",
              "matches": [
                {
                  "lineNumber": 172,
                  "content": "\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 178,
                  "content": "\t\t\t\t? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                }
              ]
            },
            {
              "file": "src\\pages\\Login.tsx",
              "matches": [
                {
                  "lineNumber": 205,
                  "content": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                },
                {
                  "lineNumber": 211,
                  "content": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;"
                }
              ]
            }
          ],
          "totalLines": 15,
          "totalMatchedLines": 15
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "how is VITE_BASE_URL environment variable used in the application",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 135,
            "column": 44
          },
          "endPosition": {
            "line": 219,
            "column": 1
          }
        },
        "contents": "// =============== porxy ===============\n\n// get proxy base URL\nasync function getProxyBaseURL() {\n  const isDev = import.meta.env.DEV\n  const rawValue = import.meta.env.VITE_USE_LOCAL_PROXY\n  const useLocalProxy = rawValue === 'true'\n  console.log('[getProxyBaseURL] Debug info:', {\n    isDev,\n    rawValue,\n    rawValueType: typeof rawValue,\n    rawValueLength: rawValue?.length,\n    useLocalProxy,\n    allEnvKeys: Object.keys(import.meta.env).filter(key =&gt; key.startsWith('VITE_'))\n  })\n\n  if (isDev) {\n    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n    if (useLocalProxy) {\n      // Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n      return import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'\n    } else {\n      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n      return import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'\n    }\n  } else {\n    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n    const baseUrl = import.meta.env.VITE_BASE_URL\n    if (!baseUrl) {\n      throw new Error('VITE_BASE_URL not configured')\n    }\n    return baseUrl\n  }\n}\n\nasync function proxyFetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  \n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// =============== porxy ===============",
            "lineNumber": 138
          },
          {
            "lineNumber": 139
          },
          {
            "text": "// get proxy base URL",
            "lineNumber": 140
          },
          {
            "text": "async function getProxyBaseURL() {",
            "lineNumber": 141,
            "isSignature": true
          },
          {
            "text": "  const isDev = import.meta.env.DEV",
            "lineNumber": 142
          },
          {
            "text": "  const rawValue = import.meta.env.VITE_USE_LOCAL_PROXY",
            "lineNumber": 143
          },
          {
            "text": "  const useLocalProxy = rawValue === 'true'",
            "lineNumber": 144
          },
          {
            "text": "  console.log('[getProxyBaseURL] Debug info:', {",
            "lineNumber": 145
          },
          {
            "text": "    isDev,",
            "lineNumber": 146
          },
          {
            "text": "    rawValue,",
            "lineNumber": 147
          },
          {
            "text": "    rawValueType: typeof rawValue,",
            "lineNumber": 148
          },
          {
            "text": "    rawValueLength: rawValue?.length,",
            "lineNumber": 149
          },
          {
            "text": "    useLocalProxy,",
            "lineNumber": 150
          },
          {
            "text": "    allEnvKeys: Object.keys(import.meta.env).filter(key =&gt; key.startsWith('VITE_'))",
            "lineNumber": 151
          },
          {
            "text": "  })",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "  if (isDev) {",
            "lineNumber": 154
          },
          {
            "text": "    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 155
          },
          {
            "text": "    if (useLocalProxy) {",
            "lineNumber": 156
          },
          {
            "text": "      // Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 157
          },
          {
            "text": "      return import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'",
            "lineNumber": 158
          },
          {
            "text": "    } else {",
            "lineNumber": 159
          },
          {
            "text": "      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 160
          },
          {
            "text": "      return import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'",
            "lineNumber": 161
          },
          {
            "text": "    }",
            "lineNumber": 162
          },
          {
            "text": "  } else {",
            "lineNumber": 163
          },
          {
            "text": "    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 164
          },
          {
            "text": "    const baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 165
          },
          {
            "text": "    if (!baseUrl) {",
            "lineNumber": 166
          },
          {
            "text": "      throw new Error('VITE_BASE_URL not configured')",
            "lineNumber": 167
          },
          {
            "text": "    }",
            "lineNumber": 168
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 169
          },
          {
            "text": "  }",
            "lineNumber": 170
          },
          {
            "text": "}",
            "lineNumber": 171,
            "isSignature": true
          },
          {
            "lineNumber": 172
          },
          {
            "text": "async function proxyFetchRequest(",
            "lineNumber": 173,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 174,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 175,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 176,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 177,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 178,
            "isSignature": true
          },
          {
            "text": "  ",
            "lineNumber": 179
          },
          {
            "text": "}",
            "lineNumber": 220,
            "isSignature": true
          }
        ]
      },
      "score": 0.5271409153938293
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\lib\\index.ts",
        "range": {
          "startPosition": {
            "column": 48
          },
          "endPosition": {
            "line": 24,
            "column": 1
          }
        },
        "contents": "export function getProxyBaseURL() {\n\tconst isDev = import.meta.env.DEV\n\n\tif (isDev) {\n\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL\n\t\tif (!proxyUrl) {\n\t\t\treturn 'http://localhost:3001'\n\t\t}\n\t\treturn proxyUrl\n\t} else {\n\t\tconst baseUrl = import.meta.env.VITE_BASE_URL\n\t\tif (!baseUrl) {\n\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");\n\t\t}\n\t\treturn baseUrl;\n\t}\n}\n\nexport function generateUniqueId(): string {\n\tconst timestamp = Date.now();\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export function getProxyBaseURL() {",
            "lineNumber": 3,
            "isSignature": true
          },
          {
            "text": "\tconst isDev = import.meta.env.DEV",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "\tif (isDev) {",
            "lineNumber": 6
          },
          {
            "text": "\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 7
          },
          {
            "text": "\t\tif (!proxyUrl) {",
            "lineNumber": 8
          },
          {
            "text": "\t\t\treturn 'http://localhost:3001'",
            "lineNumber": 9
          },
          {
            "text": "\t\t}",
            "lineNumber": 10
          },
          {
            "text": "\t\treturn proxyUrl",
            "lineNumber": 11
          },
          {
            "text": "\t} else {",
            "lineNumber": 12
          },
          {
            "text": "\t\tconst baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 13
          },
          {
            "text": "\t\tif (!baseUrl) {",
            "lineNumber": 14
          },
          {
            "text": "\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");",
            "lineNumber": 15
          },
          {
            "text": "\t\t}",
            "lineNumber": 16
          },
          {
            "text": "\t\treturn baseUrl;",
            "lineNumber": 17
          },
          {
            "text": "\t}",
            "lineNumber": 18
          },
          {
            "text": "}",
            "lineNumber": 19,
            "isSignature": true
          },
          {
            "lineNumber": 20
          },
          {
            "text": "export function generateUniqueId(): string {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "\tconst timestamp = Date.now();",
            "lineNumber": 22
          },
          {
            "text": "}",
            "lineNumber": 25,
            "isSignature": true
          }
        ]
      },
      "score": 0.49932634830474854
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 74
          }
        },
        "contents": "# ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®\n_Exported on 2026/1/19 at 16:43:04 [GMT+8] from Cursor (2.3.41)_\n\n---\n\n**User**\n\n@.env (14-16) \nÁÇ∫‰ªÄÈ∫ºË®≠ÂÆö‰ΩøÁî®Êú¨Ê©ü server (http://localhost:3001) login ‰æùÁÑ∂Â∞éÂêë https://dev.eigent.ai/api/login Ôºü\n\n---\n\n**Cursor**\n\n\nÊ™¢Êü• &#96;.env&#96; ËàáÁôªÂÖ•Áõ∏ÈóúÁ®ãÂºèÁ¢ºÔºåÊâæÂá∫ÁÇ∫‰Ωï‰ªçÂ∞éÂêë &#96;https://dev.eigent.ai/api/login&#96;„ÄÇ\n\n\n\nÊ™¢Êü• &#96;proxyFetchPost&#96; ÁöÑÂØ¶‰ΩúËàá proxy URL ÁöÑË®≠ÂÆöÈÇèËºØÔºö\n\n\n\nÊ™¢Êü• Vite ÈÖçÁΩÆËàáÁí∞Â¢ÉËÆäÊï∏Ë®≠ÂÆöÔºö\n\n\n\nÊ™¢Êü•Áí∞Â¢ÉËÆäÊï∏Ê™îÊ°àÔºö\n\n\n\nÂïèÈ°åÂú®Êñº &#96;getProxyBaseURL()&#96; Êú™Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96;ÔºåÂÉÖ‰æùË≥¥ &#96;import.meta.env.DEV&#96;„ÄÇ‰øÆÊ≠£ÈÄôÂÖ©ÂÄãÂáΩÊï∏Ôºå‰ΩøÂÖ∂‰æùÊìö &#96;VITE_USE_LOCAL_PROXY&#96; Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø URL„ÄÇ\n\n\n\n‰øÆÊ≠£ &#96;getProxyBaseURL()&#96;ÔºöÁõÆÂâçÊú™Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96;ÔºåÂ∞éËá¥Âç≥‰ΩøË®≠ÁÇ∫ &#96;true&#96; ‰ªçÂèØËÉΩ‰ΩøÁî®Èõ≤Á´Ø URL„ÄÇÊõ¥Êñ∞ÂÖ©ÂÄã &#96;getProxyBaseURL()&#96; ÂáΩÊï∏Ôºå‰ΩøÂÖ∂‰æùÊìö &#96;VITE_USE_LOCAL_PROXY&#96; Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø URL„ÄÇ\n\n\n&#96;&#96;&#96;typescript\nimport { getAuthStore } from '@/store/authStore'\nimport { showCreditsToast } from '@/components/Toast/creditsToast';\nimport { showStorageToast } from '@/components/Toast/storageToast';\nimport { showTrafficToast } from '@/components/Toast/trafficToast';\n\nconst defaultHeaders = {\n  'Content-Type': 'application/json',\n}\n\nlet baseUrl = ''\nexport async function getBaseURL() {\n  if (baseUrl) {\n    return baseUrl\n  }\n  const port = await window.ipcRenderer.invoke('get-backend-port')\n  baseUrl = &#96;http://localhost:${port}&#96;\n  return baseUrl\n}\n\nasync function fetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const headers: Record&lt;string, string&gt; = {\n    ...defaultHeaders,\n    ...customHeaders,\n  }\n\n  // Cases without token: url is a complete http:// path",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®",
            "lineNumber": 1
          },
          {
            "text": "_Exported on 2026/1/19 at 16:43:04 [GMT+8] from Cursor (2.3.41)_",
            "lineNumber": 2
          },
          {
            "lineNumber": 3
          },
          {
            "text": "---",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "**User**",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "@.env (14-16) ",
            "lineNumber": 8
          },
          {
            "text": "ÁÇ∫‰ªÄÈ∫ºË®≠ÂÆö‰ΩøÁî®Êú¨Ê©ü server (http://localhost:3001) login ‰æùÁÑ∂Â∞éÂêë https://dev.eigent.ai/api/login Ôºü",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "---",
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "**Cursor**",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "Ê™¢Êü• &#96;.env&#96; ËàáÁôªÂÖ•Áõ∏ÈóúÁ®ãÂºèÁ¢ºÔºåÊâæÂá∫ÁÇ∫‰Ωï‰ªçÂ∞éÂêë &#96;https://dev.eigent.ai/api/login&#96;„ÄÇ",
            "lineNumber": 16
          },
          {
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "Ê™¢Êü• &#96;proxyFetchPost&#96; ÁöÑÂØ¶‰ΩúËàá proxy URL ÁöÑË®≠ÂÆöÈÇèËºØÔºö",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "Ê™¢Êü• Vite ÈÖçÁΩÆËàáÁí∞Â¢ÉËÆäÊï∏Ë®≠ÂÆöÔºö",
            "lineNumber": 24
          },
          {
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "lineNumber": 27
          },
          {
            "text": "Ê™¢Êü•Áí∞Â¢ÉËÆäÊï∏Ê™îÊ°àÔºö",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "lineNumber": 31
          },
          {
            "text": "ÂïèÈ°åÂú®Êñº &#96;getProxyBaseURL()&#96; Êú™Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96;ÔºåÂÉÖ‰æùË≥¥ &#96;import.meta.env.DEV&#96;„ÄÇ‰øÆÊ≠£ÈÄôÂÖ©ÂÄãÂáΩÊï∏Ôºå‰ΩøÂÖ∂‰æùÊìö &#96;VITE_USE_LOCAL_PROXY&#96; Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø URL„ÄÇ",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "‰øÆÊ≠£ &#96;getProxyBaseURL()&#96;ÔºöÁõÆÂâçÊú™Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96;ÔºåÂ∞éËá¥Âç≥‰ΩøË®≠ÁÇ∫ &#96;true&#96; ‰ªçÂèØËÉΩ‰ΩøÁî®Èõ≤Á´Ø URL„ÄÇÊõ¥Êñ∞ÂÖ©ÂÄã &#96;getProxyBaseURL()&#96; ÂáΩÊï∏Ôºå‰ΩøÂÖ∂‰æùÊìö &#96;VITE_USE_LOCAL_PROXY&#96; Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø URL„ÄÇ",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 39
          },
          {
            "text": "import { getAuthStore } from '@/store/authStore'",
            "lineNumber": 40
          },
          {
            "text": "import { showCreditsToast } from '@/components/Toast/creditsToast';",
            "lineNumber": 41
          },
          {
            "text": "import { showStorageToast } from '@/components/Toast/storageToast';",
            "lineNumber": 42
          },
          {
            "text": "import { showTrafficToast } from '@/components/Toast/trafficToast';",
            "lineNumber": 43
          },
          {
            "lineNumber": 44
          },
          {
            "text": "const defaultHeaders = {",
            "lineNumber": 45
          },
          {
            "text": "  'Content-Type': 'application/json',",
            "lineNumber": 46
          },
          {
            "text": "}",
            "lineNumber": 47
          },
          {
            "lineNumber": 48
          },
          {
            "text": "let baseUrl = ''",
            "lineNumber": 49
          },
          {
            "text": "export async function getBaseURL() {",
            "lineNumber": 50
          },
          {
            "text": "  if (baseUrl) {",
            "lineNumber": 51
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 52
          },
          {
            "text": "  }",
            "lineNumber": 53
          },
          {
            "text": "  const port = await window.ipcRenderer.invoke('get-backend-port')",
            "lineNumber": 54
          },
          {
            "text": "  baseUrl = &#96;http://localhost:${port}&#96;",
            "lineNumber": 55
          },
          {
            "text": "  return baseUrl",
            "lineNumber": 56
          },
          {
            "text": "}",
            "lineNumber": 57
          },
          {
            "lineNumber": 58
          },
          {
            "text": "async function fetchRequest(",
            "lineNumber": 59
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 60
          },
          {
            "text": "  url: string,",
            "lineNumber": 61
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 62
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 63
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 64
          },
          {
            "text": "  const baseURL = await getBaseURL()",
            "lineNumber": 65
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 66
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "  const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 69
          },
          {
            "text": "    ...defaultHeaders,",
            "lineNumber": 70
          },
          {
            "text": "    ...customHeaders,",
            "lineNumber": 71
          },
          {
            "text": "  }",
            "lineNumber": 72
          },
          {
            "lineNumber": 73
          },
          {
            "text": "  // Cases without token: url is a complete http:// path",
            "lineNumber": 74
          }
        ]
      },
      "score": 0.4414689540863037
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 574
          },
          "endPosition": {
            "line": 639
          }
        },
        "contents": "    // Only show traffic toast for cloud model requests\n    const isCloudRequest = requestData?.api_url === 'cloud'\n    if (isCloudRequest) {\n      showTrafficToast()\n    }\n\n    console.error('[fetch error]:', err)\n\n    if (err?.response?.status === 401) {\n      // const { logout } = getAuthStore()\n      // logout()\n      // window.location.href = '#/login'\n    }\n\n    throw err\n  }\n}\n\n// Encapsulate common methods\nexport const fetchGet = (url: string, params?: any, headers?: any) =&gt;\n  fetchRequest('GET', url, params, headers)\n\nexport const fetchPost = (url: string, data?: any, headers?: any) =&gt;\n  fetchRequest('POST', url, data, headers)\n\nexport const fetchPut = (url: string, data?: any, headers?: any) =&gt;\n  fetchRequest('PUT', url, data, headers)\n\nexport const fetchDelete = (url: string, data?: any, headers?: any) =&gt;\n  fetchRequest('DELETE', url, data, headers)\n\n// =============== porxy ===============\n\n// get proxy base URL\nasync function getProxyBaseURL() {\n  const isDev = import.meta.env.DEV\n  const useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n\n  if (isDev) {\n    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n    if (useLocalProxy) {\n      // Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n      return import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'\n    } else {\n      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n      return import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'\n    }\n  } else {\n    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n    const baseUrl = import.meta.env.VITE_BASE_URL\n    if (!baseUrl) {\n      throw new Error('VITE_BASE_URL not configured')\n    }\n    return baseUrl\n  }\n}\n\nasync function proxyFetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getProxyBaseURL()",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    // Only show traffic toast for cloud model requests",
            "lineNumber": 576
          },
          {
            "text": "    const isCloudRequest = requestData?.api_url === 'cloud'",
            "lineNumber": 577
          },
          {
            "text": "    if (isCloudRequest) {",
            "lineNumber": 578
          },
          {
            "text": "      showTrafficToast()",
            "lineNumber": 579
          },
          {
            "text": "    }",
            "lineNumber": 580
          },
          {
            "lineNumber": 581
          },
          {
            "text": "    console.error('[fetch error]:', err)",
            "lineNumber": 582
          },
          {
            "lineNumber": 583
          },
          {
            "text": "    if (err?.response?.status === 401) {",
            "lineNumber": 584
          },
          {
            "text": "      // const { logout } = getAuthStore()",
            "lineNumber": 585
          },
          {
            "text": "      // logout()",
            "lineNumber": 586
          },
          {
            "text": "      // window.location.href = '#/login'",
            "lineNumber": 587
          },
          {
            "text": "    }",
            "lineNumber": 588
          },
          {
            "lineNumber": 589
          },
          {
            "text": "    throw err",
            "lineNumber": 590
          },
          {
            "text": "  }",
            "lineNumber": 591
          },
          {
            "text": "}",
            "lineNumber": 592
          },
          {
            "lineNumber": 593
          },
          {
            "text": "// Encapsulate common methods",
            "lineNumber": 594
          },
          {
            "text": "export const fetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 595
          },
          {
            "text": "  fetchRequest('GET', url, params, headers)",
            "lineNumber": 596
          },
          {
            "lineNumber": 597
          },
          {
            "text": "export const fetchPost = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 598
          },
          {
            "text": "  fetchRequest('POST', url, data, headers)",
            "lineNumber": 599
          },
          {
            "lineNumber": 600
          },
          {
            "text": "export const fetchPut = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 601
          },
          {
            "text": "  fetchRequest('PUT', url, data, headers)",
            "lineNumber": 602
          },
          {
            "lineNumber": 603
          },
          {
            "text": "export const fetchDelete = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 604
          },
          {
            "text": "  fetchRequest('DELETE', url, data, headers)",
            "lineNumber": 605
          },
          {
            "lineNumber": 606
          },
          {
            "text": "// =============== porxy ===============",
            "lineNumber": 607
          },
          {
            "lineNumber": 608
          },
          {
            "text": "// get proxy base URL",
            "lineNumber": 609
          },
          {
            "text": "async function getProxyBaseURL() {",
            "lineNumber": 610
          },
          {
            "text": "  const isDev = import.meta.env.DEV",
            "lineNumber": 611
          },
          {
            "text": "  const useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 612
          },
          {
            "lineNumber": 613
          },
          {
            "text": "  if (isDev) {",
            "lineNumber": 614
          },
          {
            "text": "    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 615
          },
          {
            "text": "    if (useLocalProxy) {",
            "lineNumber": 616
          },
          {
            "text": "      // Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 617
          },
          {
            "text": "      return import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'",
            "lineNumber": 618
          },
          {
            "text": "    } else {",
            "lineNumber": 619
          },
          {
            "text": "      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 620
          },
          {
            "text": "      return import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'",
            "lineNumber": 621
          },
          {
            "text": "    }",
            "lineNumber": 622
          },
          {
            "text": "  } else {",
            "lineNumber": 623
          },
          {
            "text": "    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 624
          },
          {
            "text": "    const baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 625
          },
          {
            "text": "    if (!baseUrl) {",
            "lineNumber": 626
          },
          {
            "text": "      throw new Error('VITE_BASE_URL not configured')",
            "lineNumber": 627
          },
          {
            "text": "    }",
            "lineNumber": 628
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 629
          },
          {
            "text": "  }",
            "lineNumber": 630
          },
          {
            "text": "}",
            "lineNumber": 631
          },
          {
            "lineNumber": 632
          },
          {
            "text": "async function proxyFetchRequest(",
            "lineNumber": 633
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 634
          },
          {
            "text": "  url: string,",
            "lineNumber": 635
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 636
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 637
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 638
          },
          {
            "text": "  const baseURL = await getProxyBaseURL()",
            "lineNumber": 639
          }
        ]
      },
      "score": 0.42343321442604065
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 170,
            "column": 1
          },
          "endPosition": {
            "line": 222
          }
        },
        "contents": "async function proxyFetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getProxyBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const headers: Record&lt;string, string&gt; = {\n    ...defaultHeaders,\n    ...customHeaders,\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    headers['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header\n  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      headers['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method,\n    headers,\n  }\n\n  if (method === 'GET') {\n    const query = data\n      ? '?' +\n      Object.entries(data)\n        .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)\n        .join('&amp;')\n      : ''\n    return handleResponse(fetch(fullUrl + query, options))\n  }\n\n  if (data) {\n    options.body = JSON.stringify(data)\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\nexport const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "async function proxyFetchRequest(",
            "lineNumber": 173,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 174,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 175,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 176,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 177,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 178,
            "isSignature": true
          },
          {
            "text": "  const baseURL = await getProxyBaseURL()",
            "lineNumber": 179
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 180
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 181
          },
          {
            "lineNumber": 182
          },
          {
            "text": "  const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 183
          },
          {
            "text": "    ...defaultHeaders,",
            "lineNumber": 184
          },
          {
            "text": "    ...customHeaders,",
            "lineNumber": 185
          },
          {
            "text": "  }",
            "lineNumber": 186
          },
          {
            "lineNumber": 187
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 188
          },
          {
            "text": "    headers['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 189
          },
          {
            "text": "  }",
            "lineNumber": 190
          },
          {
            "lineNumber": 191
          },
          {
            "text": "  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header",
            "lineNumber": 192
          },
          {
            "text": "  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {",
            "lineNumber": 193
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 194
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 195
          },
          {
            "text": "      headers['X-Proxy-Target'] = targetUrl",
            "lineNumber": 196
          },
          {
            "text": "    }",
            "lineNumber": 197
          },
          {
            "text": "  }",
            "lineNumber": 198
          },
          {
            "lineNumber": 199
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 200
          },
          {
            "text": "    method,",
            "lineNumber": 201
          },
          {
            "text": "    headers,",
            "lineNumber": 202
          },
          {
            "text": "  }",
            "lineNumber": 203
          },
          {
            "lineNumber": 204
          },
          {
            "text": "  if (method === 'GET') {",
            "lineNumber": 205
          },
          {
            "text": "    const query = data",
            "lineNumber": 206
          },
          {
            "text": "      ? '?' +",
            "lineNumber": 207
          },
          {
            "text": "      Object.entries(data)",
            "lineNumber": 208
          },
          {
            "text": "        .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)",
            "lineNumber": 209
          },
          {
            "text": "        .join('&amp;')",
            "lineNumber": 210
          },
          {
            "text": "      : ''",
            "lineNumber": 211
          },
          {
            "text": "    return handleResponse(fetch(fullUrl + query, options))",
            "lineNumber": 212
          },
          {
            "text": "  }",
            "lineNumber": 213
          },
          {
            "lineNumber": 214
          },
          {
            "text": "  if (data) {",
            "lineNumber": 215
          },
          {
            "text": "    options.body = JSON.stringify(data)",
            "lineNumber": 216
          },
          {
            "text": "  }",
            "lineNumber": 217
          },
          {
            "lineNumber": 218
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 219
          },
          {
            "text": "}",
            "lineNumber": 220,
            "isSignature": true
          },
          {
            "lineNumber": 221
          },
          {
            "text": "export const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 222
          }
        ]
      },
      "score": 0.4230271875858307
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 349
          },
          "endPosition": {
            "line": 430
          }
        },
        "contents": "      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);\n    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));\n  }\n\n  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);\n  return false;\n}\n\n&#96;&#96;&#96;\n\n&#96;&#96;&#96;typescript\nimport { getAuthStore } from \"@/store/authStore\"\n\nexport function getProxyBaseURL() {\n\tconst isDev = import.meta.env.DEV\n\tconst useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n\n\tif (isDev) {\n\t\t// Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n\t\tif (useLocalProxy) {\n\t\t\t// ‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ\n\t\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL\n\t\t\tif (!proxyUrl) {\n\t\t\t\treturn 'http://localhost:3001'\n\t\t\t}\n\t\t\treturn proxyUrl\n\t\t} else {\n\t\t\t// ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜ\n\t\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL\n\t\t\tif (!proxyUrl) {\n\t\t\t\treturn 'https://dev.eigent.ai'\n\t\t\t}\n\t\t\treturn proxyUrl\n\t\t}\n\t} else {\n\t\t// ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n\t\tconst baseUrl = import.meta.env.VITE_BASE_URL\n\t\tif (!baseUrl) {\n\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");\n\t\t}\n\t\treturn baseUrl;\n\t}\n}\n\nexport function generateUniqueId(): string {\n\tconst timestamp = Date.now();\n\tconst random = Math.floor(Math.random() * 10000);\n\treturn &#96;${timestamp}-${random}&#96;;\n}\n\nexport function debounce&lt;T extends (...args: any[]) =&gt; void&gt;(\n\tfunc: T,\n\twait: number,\n\timmediate: boolean = false\n): (...args: Parameters&lt;T&gt;) =&gt; void {\n\tlet timeout: NodeJS.Timeout | null = null;\n\n\treturn function (this: any, ...args: Parameters&lt;T&gt;) {\n\t\tconst context = this;\n\n\t\tconst later = () =&gt; {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\n\t\tconst callNow = immediate &amp;&amp; !timeout;\n\n\t\tif (timeout) clearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\n\t\tif (callNow) func.apply(context, args);\n\t};\n}\n\n\nexport function capitalizeFirstLetter(input: string): string {\n\tif (input.length === 0) return input;\n\treturn input.charAt(0).toUpperCase() + input.slice(1);",
        "signatures": {},
        "detailedLines": [
          {
            "text": "      return true;",
            "lineNumber": 350
          },
          {
            "text": "    }",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 353
          },
          {
            "text": "    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));",
            "lineNumber": 354
          },
          {
            "text": "  }",
            "lineNumber": 355
          },
          {
            "lineNumber": 356
          },
          {
            "text": "  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);",
            "lineNumber": 357
          },
          {
            "text": "  return false;",
            "lineNumber": 358
          },
          {
            "text": "}",
            "lineNumber": 359
          },
          {
            "lineNumber": 360
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 361
          },
          {
            "lineNumber": 362
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 363
          },
          {
            "text": "import { getAuthStore } from \"@/store/authStore\"",
            "lineNumber": 364
          },
          {
            "lineNumber": 365
          },
          {
            "text": "export function getProxyBaseURL() {",
            "lineNumber": 366
          },
          {
            "text": "\tconst isDev = import.meta.env.DEV",
            "lineNumber": 367
          },
          {
            "text": "\tconst useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 368
          },
          {
            "lineNumber": 369
          },
          {
            "text": "\tif (isDev) {",
            "lineNumber": 370
          },
          {
            "text": "\t\t// Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 371
          },
          {
            "text": "\t\tif (useLocalProxy) {",
            "lineNumber": 372
          },
          {
            "text": "\t\t\t// ‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ",
            "lineNumber": 373
          },
          {
            "text": "\t\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 374
          },
          {
            "text": "\t\t\tif (!proxyUrl) {",
            "lineNumber": 375
          },
          {
            "text": "\t\t\t\treturn 'http://localhost:3001'",
            "lineNumber": 376
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 377
          },
          {
            "text": "\t\t\treturn proxyUrl",
            "lineNumber": 378
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 379
          },
          {
            "text": "\t\t\t// ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜ",
            "lineNumber": 380
          },
          {
            "text": "\t\t\tconst proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 381
          },
          {
            "text": "\t\t\tif (!proxyUrl) {",
            "lineNumber": 382
          },
          {
            "text": "\t\t\t\treturn 'https://dev.eigent.ai'",
            "lineNumber": 383
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 384
          },
          {
            "text": "\t\t\treturn proxyUrl",
            "lineNumber": 385
          },
          {
            "text": "\t\t}",
            "lineNumber": 386
          },
          {
            "text": "\t} else {",
            "lineNumber": 387
          },
          {
            "text": "\t\t// ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 388
          },
          {
            "text": "\t\tconst baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 389
          },
          {
            "text": "\t\tif (!baseUrl) {",
            "lineNumber": 390
          },
          {
            "text": "\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");",
            "lineNumber": 391
          },
          {
            "text": "\t\t}",
            "lineNumber": 392
          },
          {
            "text": "\t\treturn baseUrl;",
            "lineNumber": 393
          },
          {
            "text": "\t}",
            "lineNumber": 394
          },
          {
            "text": "}",
            "lineNumber": 395
          },
          {
            "lineNumber": 396
          },
          {
            "text": "export function generateUniqueId(): string {",
            "lineNumber": 397
          },
          {
            "text": "\tconst timestamp = Date.now();",
            "lineNumber": 398
          },
          {
            "text": "\tconst random = Math.floor(Math.random() * 10000);",
            "lineNumber": 399
          },
          {
            "text": "\treturn &#96;${timestamp}-${random}&#96;;",
            "lineNumber": 400
          },
          {
            "text": "}",
            "lineNumber": 401
          },
          {
            "lineNumber": 402
          },
          {
            "text": "export function debounce&lt;T extends (...args: any[]) =&gt; void&gt;(",
            "lineNumber": 403
          },
          {
            "text": "\tfunc: T,",
            "lineNumber": 404
          },
          {
            "text": "\twait: number,",
            "lineNumber": 405
          },
          {
            "text": "\timmediate: boolean = false",
            "lineNumber": 406
          },
          {
            "text": "): (...args: Parameters&lt;T&gt;) =&gt; void {",
            "lineNumber": 407
          },
          {
            "text": "\tlet timeout: NodeJS.Timeout | null = null;",
            "lineNumber": 408
          },
          {
            "lineNumber": 409
          },
          {
            "text": "\treturn function (this: any, ...args: Parameters&lt;T&gt;) {",
            "lineNumber": 410
          },
          {
            "text": "\t\tconst context = this;",
            "lineNumber": 411
          },
          {
            "lineNumber": 412
          },
          {
            "text": "\t\tconst later = () =&gt; {",
            "lineNumber": 413
          },
          {
            "text": "\t\t\ttimeout = null;",
            "lineNumber": 414
          },
          {
            "text": "\t\t\tif (!immediate) func.apply(context, args);",
            "lineNumber": 415
          },
          {
            "text": "\t\t};",
            "lineNumber": 416
          },
          {
            "lineNumber": 417
          },
          {
            "text": "\t\tconst callNow = immediate &amp;&amp; !timeout;",
            "lineNumber": 418
          },
          {
            "lineNumber": 419
          },
          {
            "text": "\t\tif (timeout) clearTimeout(timeout);",
            "lineNumber": 420
          },
          {
            "text": "\t\ttimeout = setTimeout(later, wait);",
            "lineNumber": 421
          },
          {
            "lineNumber": 422
          },
          {
            "text": "\t\tif (callNow) func.apply(context, args);",
            "lineNumber": 423
          },
          {
            "text": "\t};",
            "lineNumber": 424
          },
          {
            "text": "}",
            "lineNumber": 425
          },
          {
            "lineNumber": 426
          },
          {
            "lineNumber": 427
          },
          {
            "text": "export function capitalizeFirstLetter(input: string): string {",
            "lineNumber": 428
          },
          {
            "text": "\tif (input.length === 0) return input;",
            "lineNumber": 429
          },
          {
            "text": "\treturn input.charAt(0).toUpperCase() + input.slice(1);",
            "lineNumber": 430
          }
        ]
      },
      "score": 0.4220527410507202
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 765
          },
          "endPosition": {
            "line": 833
          }
        },
        "contents": "  while (Date.now() - startTime &lt; maxWaitMs) {\n    const isReady = await checkBackendHealth();\n\n    if (isReady) {\n      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);\n    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));\n  }\n\n  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);\n  return false;\n}\n\n&#96;&#96;&#96;\n\n&#96;&#96;&#96;typescript\nimport { getAuthStore } from \"@/store/authStore\"\n\nexport function getProxyBaseURL() {\n\tconst isDev = import.meta.env.DEV\n\tconst useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n\n\tif (isDev) {\n\t\t// Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n\t\tif (useLocalProxy) {\n\t\t\t// Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n\t\t\treturn import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'\n\t\t} else {\n\t\t\t// ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n\t\t\treturn import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'\n\t\t}\n\t} else {\n\t\t// ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n\t\tconst baseUrl = import.meta.env.VITE_BASE_URL\n\t\tif (!baseUrl) {\n\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");\n\t\t}\n\t\treturn baseUrl;\n\t}\n}\n\nexport function generateUniqueId(): string {\n\tconst timestamp = Date.now();\n\tconst random = Math.floor(Math.random() * 10000);\n\treturn &#96;${timestamp}-${random}&#96;;\n}\n\nexport function debounce&lt;T extends (...args: any[]) =&gt; void&gt;(\n\tfunc: T,\n\twait: number,\n\timmediate: boolean = false\n): (...args: Parameters&lt;T&gt;) =&gt; void {\n\tlet timeout: NodeJS.Timeout | null = null;\n\n\treturn function (this: any, ...args: Parameters&lt;T&gt;) {\n\t\tconst context = this;\n\n\t\tconst later = () =&gt; {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\n\t\tconst callNow = immediate &amp;&amp; !timeout;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 767
          },
          {
            "text": "    const isReady = await checkBackendHealth();",
            "lineNumber": 768
          },
          {
            "lineNumber": 769
          },
          {
            "text": "    if (isReady) {",
            "lineNumber": 770
          },
          {
            "text": "      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 771
          },
          {
            "text": "      return true;",
            "lineNumber": 772
          },
          {
            "text": "    }",
            "lineNumber": 773
          },
          {
            "lineNumber": 774
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 775
          },
          {
            "text": "    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));",
            "lineNumber": 776
          },
          {
            "text": "  }",
            "lineNumber": 777
          },
          {
            "lineNumber": 778
          },
          {
            "text": "  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);",
            "lineNumber": 779
          },
          {
            "text": "  return false;",
            "lineNumber": 780
          },
          {
            "text": "}",
            "lineNumber": 781
          },
          {
            "lineNumber": 782
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 783
          },
          {
            "lineNumber": 784
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 785
          },
          {
            "text": "import { getAuthStore } from \"@/store/authStore\"",
            "lineNumber": 786
          },
          {
            "lineNumber": 787
          },
          {
            "text": "export function getProxyBaseURL() {",
            "lineNumber": 788
          },
          {
            "text": "\tconst isDev = import.meta.env.DEV",
            "lineNumber": 789
          },
          {
            "text": "\tconst useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 790
          },
          {
            "lineNumber": 791
          },
          {
            "text": "\tif (isDev) {",
            "lineNumber": 792
          },
          {
            "text": "\t\t// Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 793
          },
          {
            "text": "\t\tif (useLocalProxy) {",
            "lineNumber": 794
          },
          {
            "text": "\t\t\t// Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 795
          },
          {
            "text": "\t\t\treturn import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'",
            "lineNumber": 796
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 797
          },
          {
            "text": "\t\t\t// ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 798
          },
          {
            "text": "\t\t\treturn import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'",
            "lineNumber": 799
          },
          {
            "text": "\t\t}",
            "lineNumber": 800
          },
          {
            "text": "\t} else {",
            "lineNumber": 801
          },
          {
            "text": "\t\t// ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 802
          },
          {
            "text": "\t\tconst baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 803
          },
          {
            "text": "\t\tif (!baseUrl) {",
            "lineNumber": 804
          },
          {
            "text": "\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");",
            "lineNumber": 805
          },
          {
            "text": "\t\t}",
            "lineNumber": 806
          },
          {
            "text": "\t\treturn baseUrl;",
            "lineNumber": 807
          },
          {
            "text": "\t}",
            "lineNumber": 808
          },
          {
            "text": "}",
            "lineNumber": 809
          },
          {
            "lineNumber": 810
          },
          {
            "text": "export function generateUniqueId(): string {",
            "lineNumber": 811
          },
          {
            "text": "\tconst timestamp = Date.now();",
            "lineNumber": 812
          },
          {
            "text": "\tconst random = Math.floor(Math.random() * 10000);",
            "lineNumber": 813
          },
          {
            "text": "\treturn &#96;${timestamp}-${random}&#96;;",
            "lineNumber": 814
          },
          {
            "text": "}",
            "lineNumber": 815
          },
          {
            "lineNumber": 816
          },
          {
            "text": "export function debounce&lt;T extends (...args: any[]) =&gt; void&gt;(",
            "lineNumber": 817
          },
          {
            "text": "\tfunc: T,",
            "lineNumber": 818
          },
          {
            "text": "\twait: number,",
            "lineNumber": 819
          },
          {
            "text": "\timmediate: boolean = false",
            "lineNumber": 820
          },
          {
            "text": "): (...args: Parameters&lt;T&gt;) =&gt; void {",
            "lineNumber": 821
          },
          {
            "text": "\tlet timeout: NodeJS.Timeout | null = null;",
            "lineNumber": 822
          },
          {
            "lineNumber": 823
          },
          {
            "text": "\treturn function (this: any, ...args: Parameters&lt;T&gt;) {",
            "lineNumber": 824
          },
          {
            "text": "\t\tconst context = this;",
            "lineNumber": 825
          },
          {
            "lineNumber": 826
          },
          {
            "text": "\t\tconst later = () =&gt; {",
            "lineNumber": 827
          },
          {
            "text": "\t\t\ttimeout = null;",
            "lineNumber": 828
          },
          {
            "text": "\t\t\tif (!immediate) func.apply(context, args);",
            "lineNumber": 829
          },
          {
            "text": "\t\t};",
            "lineNumber": 830
          },
          {
            "lineNumber": 831
          },
          {
            "text": "\t\tconst callNow = immediate &amp;&amp; !timeout;",
            "lineNumber": 832
          }
        ]
      },
      "score": 0.42018041014671326
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 151
          },
          "endPosition": {
            "line": 222
          }
        },
        "contents": "    console.error('[fetch error]:', err)\n\n    if (err?.response?.status === 401) {\n      // const { logout } = getAuthStore()\n      // logout()\n      // window.location.href = '#/login'\n    }\n\n    throw err\n  }\n}\n\n// Encapsulate common methods\nexport const fetchGet = (url: string, params?: any, headers?: any) =&gt;\n  fetchRequest('GET', url, params, headers)\n\nexport const fetchPost = (url: string, data?: any, headers?: any) =&gt;\n  fetchRequest('POST', url, data, headers)\n\nexport const fetchPut = (url: string, data?: any, headers?: any) =&gt;\n  fetchRequest('PUT', url, data, headers)\n\nexport const fetchDelete = (url: string, data?: any, headers?: any) =&gt;\n  fetchRequest('DELETE', url, data, headers)\n\n// =============== porxy ===============\n\n// get proxy base URL\nasync function getProxyBaseURL() {\n  const isDev = import.meta.env.DEV\n  const useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n\n  if (isDev) {\n    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n    if (useLocalProxy) {\n      // ‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ\n      const proxyUrl = import.meta.env.VITE_PROXY_URL\n      if (!proxyUrl) {\n        return 'http://localhost:3001'\n      }\n      return proxyUrl\n    } else {\n      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜ\n      const proxyUrl = import.meta.env.VITE_PROXY_URL\n      if (!proxyUrl) {\n        return 'https://dev.eigent.ai'\n      }\n      return proxyUrl\n    }\n  } else {\n    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n    const baseUrl = import.meta.env.VITE_BASE_URL\n    if (!baseUrl) {\n      throw new Error('VITE_BASE_URL not configured')\n    }\n    return baseUrl\n  }\n}\n\nasync function proxyFetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getProxyBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const headers: Record&lt;string, string&gt; = {\n    ...defaultHeaders,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    console.error('[fetch error]:', err)",
            "lineNumber": 152
          },
          {
            "lineNumber": 153
          },
          {
            "text": "    if (err?.response?.status === 401) {",
            "lineNumber": 154
          },
          {
            "text": "      // const { logout } = getAuthStore()",
            "lineNumber": 155
          },
          {
            "text": "      // logout()",
            "lineNumber": 156
          },
          {
            "text": "      // window.location.href = '#/login'",
            "lineNumber": 157
          },
          {
            "text": "    }",
            "lineNumber": 158
          },
          {
            "lineNumber": 159
          },
          {
            "text": "    throw err",
            "lineNumber": 160
          },
          {
            "text": "  }",
            "lineNumber": 161
          },
          {
            "text": "}",
            "lineNumber": 162
          },
          {
            "lineNumber": 163
          },
          {
            "text": "// Encapsulate common methods",
            "lineNumber": 164
          },
          {
            "text": "export const fetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 165
          },
          {
            "text": "  fetchRequest('GET', url, params, headers)",
            "lineNumber": 166
          },
          {
            "lineNumber": 167
          },
          {
            "text": "export const fetchPost = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 168
          },
          {
            "text": "  fetchRequest('POST', url, data, headers)",
            "lineNumber": 169
          },
          {
            "lineNumber": 170
          },
          {
            "text": "export const fetchPut = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 171
          },
          {
            "text": "  fetchRequest('PUT', url, data, headers)",
            "lineNumber": 172
          },
          {
            "lineNumber": 173
          },
          {
            "text": "export const fetchDelete = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 174
          },
          {
            "text": "  fetchRequest('DELETE', url, data, headers)",
            "lineNumber": 175
          },
          {
            "lineNumber": 176
          },
          {
            "text": "// =============== porxy ===============",
            "lineNumber": 177
          },
          {
            "lineNumber": 178
          },
          {
            "text": "// get proxy base URL",
            "lineNumber": 179
          },
          {
            "text": "async function getProxyBaseURL() {",
            "lineNumber": 180
          },
          {
            "text": "  const isDev = import.meta.env.DEV",
            "lineNumber": 181
          },
          {
            "text": "  const useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 182
          },
          {
            "lineNumber": 183
          },
          {
            "text": "  if (isDev) {",
            "lineNumber": 184
          },
          {
            "text": "    // Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 185
          },
          {
            "text": "    if (useLocalProxy) {",
            "lineNumber": 186
          },
          {
            "text": "      // ‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ",
            "lineNumber": 187
          },
          {
            "text": "      const proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 188
          },
          {
            "text": "      if (!proxyUrl) {",
            "lineNumber": 189
          },
          {
            "text": "        return 'http://localhost:3001'",
            "lineNumber": 190
          },
          {
            "text": "      }",
            "lineNumber": 191
          },
          {
            "text": "      return proxyUrl",
            "lineNumber": 192
          },
          {
            "text": "    } else {",
            "lineNumber": 193
          },
          {
            "text": "      // ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜ",
            "lineNumber": 194
          },
          {
            "text": "      const proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 195
          },
          {
            "text": "      if (!proxyUrl) {",
            "lineNumber": 196
          },
          {
            "text": "        return 'https://dev.eigent.ai'",
            "lineNumber": 197
          },
          {
            "text": "      }",
            "lineNumber": 198
          },
          {
            "text": "      return proxyUrl",
            "lineNumber": 199
          },
          {
            "text": "    }",
            "lineNumber": 200
          },
          {
            "text": "  } else {",
            "lineNumber": 201
          },
          {
            "text": "    // ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 202
          },
          {
            "text": "    const baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 203
          },
          {
            "text": "    if (!baseUrl) {",
            "lineNumber": 204
          },
          {
            "text": "      throw new Error('VITE_BASE_URL not configured')",
            "lineNumber": 205
          },
          {
            "text": "    }",
            "lineNumber": 206
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 207
          },
          {
            "text": "  }",
            "lineNumber": 208
          },
          {
            "text": "}",
            "lineNumber": 209
          },
          {
            "lineNumber": 210
          },
          {
            "text": "async function proxyFetchRequest(",
            "lineNumber": 211
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 212
          },
          {
            "text": "  url: string,",
            "lineNumber": 213
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 214
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 215
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 216
          },
          {
            "text": "  const baseURL = await getProxyBaseURL()",
            "lineNumber": 217
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 218
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 219
          },
          {
            "lineNumber": 220
          },
          {
            "text": "  const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 221
          },
          {
            "text": "    ...defaultHeaders,",
            "lineNumber": 222
          }
        ]
      },
      "score": 0.41409429907798767
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 427
          },
          "endPosition": {
            "line": 500
          }
        },
        "contents": "export function capitalizeFirstLetter(input: string): string {\n\tif (input.length === 0) return input;\n\treturn input.charAt(0).toUpperCase() + input.slice(1);\n}\n\nexport function hasStackKeys() {\n\treturn import.meta.env.VITE_STACK_PROJECT_ID &amp;&amp;\n\t\timport.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY &amp;&amp;\n\t\timport.meta.env.VITE_STACK_SECRET_SERVER_KEY;\n}\n\n// Re-export replay utilities\nexport { replayProject, replayActiveTask } from './replay';\n\nexport async function uploadLog(taskId: string, type?: string | undefined) {\n\tif (import.meta.env.VITE_USE_LOCAL_PROXY !== \"true\" &amp;&amp; !type) {\n\t\ttry {\n\t\t\tconst { email, token } = getAuthStore()\n\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL\n\t\t\t\n\t\t\tawait window.electronAPI.uploadLog(\n\t\t\t\temail,\n\t\t\t\ttaskId,\n\t\t\t\tbaseUrl,\n\t\t\t\ttoken\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to upload log:', error);\n\t\t}\n\t}\n}\n&#96;&#96;&#96;\n\n\nÊ™¢Êü•ÊòØÂê¶ÊúâË™ûÊ≥ïÈåØË™§Ôºö\n\n\n\nË™øÊï¥ÈÇèËºØÔºöÁï∂ &#96;VITE_USE_LOCAL_PROXY=true&#96; ÊôÇÔºåÁõ¥Êé•‰ΩøÁî®Êú¨Âú∞ URLÔºåÂøΩÁï• &#96;VITE_PROXY_URL&#96;ÔºåÈÅøÂÖçË®≠ÂÆöÈåØË™§„ÄÇ\n\n\n&#96;&#96;&#96;typescript\nimport { getAuthStore } from '@/store/authStore'\nimport { showCreditsToast } from '@/components/Toast/creditsToast';\nimport { showStorageToast } from '@/components/Toast/storageToast';\nimport { showTrafficToast } from '@/components/Toast/trafficToast';\n\nconst defaultHeaders = {\n  'Content-Type': 'application/json',\n}\n\nlet baseUrl = ''\nexport async function getBaseURL() {\n  if (baseUrl) {\n    return baseUrl\n  }\n  const port = await window.ipcRenderer.invoke('get-backend-port')\n  baseUrl = &#96;http://localhost:${port}&#96;\n  return baseUrl\n}\n\nasync function fetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  const baseURL = await getBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const headers: Record&lt;string, string&gt; = {\n    ...defaultHeaders,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export function capitalizeFirstLetter(input: string): string {",
            "lineNumber": 428
          },
          {
            "text": "\tif (input.length === 0) return input;",
            "lineNumber": 429
          },
          {
            "text": "\treturn input.charAt(0).toUpperCase() + input.slice(1);",
            "lineNumber": 430
          },
          {
            "text": "}",
            "lineNumber": 431
          },
          {
            "lineNumber": 432
          },
          {
            "text": "export function hasStackKeys() {",
            "lineNumber": 433
          },
          {
            "text": "\treturn import.meta.env.VITE_STACK_PROJECT_ID &amp;&amp;",
            "lineNumber": 434
          },
          {
            "text": "\t\timport.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY &amp;&amp;",
            "lineNumber": 435
          },
          {
            "text": "\t\timport.meta.env.VITE_STACK_SECRET_SERVER_KEY;",
            "lineNumber": 436
          },
          {
            "text": "}",
            "lineNumber": 437
          },
          {
            "lineNumber": 438
          },
          {
            "text": "// Re-export replay utilities",
            "lineNumber": 439
          },
          {
            "text": "export { replayProject, replayActiveTask } from './replay';",
            "lineNumber": 440
          },
          {
            "lineNumber": 441
          },
          {
            "text": "export async function uploadLog(taskId: string, type?: string | undefined) {",
            "lineNumber": 442
          },
          {
            "text": "\tif (import.meta.env.VITE_USE_LOCAL_PROXY !== \"true\" &amp;&amp; !type) {",
            "lineNumber": 443
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 444
          },
          {
            "text": "\t\t\tconst { email, token } = getAuthStore()",
            "lineNumber": 445
          },
          {
            "text": "\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL",
            "lineNumber": 446
          },
          {
            "text": "\t\t\t",
            "lineNumber": 447
          },
          {
            "text": "\t\t\tawait window.electronAPI.uploadLog(",
            "lineNumber": 448
          },
          {
            "text": "\t\t\t\temail,",
            "lineNumber": 449
          },
          {
            "text": "\t\t\t\ttaskId,",
            "lineNumber": 450
          },
          {
            "text": "\t\t\t\tbaseUrl,",
            "lineNumber": 451
          },
          {
            "text": "\t\t\t\ttoken",
            "lineNumber": 452
          },
          {
            "text": "\t\t\t);",
            "lineNumber": 453
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 454
          },
          {
            "text": "\t\t\tconsole.error('Failed to upload log:', error);",
            "lineNumber": 455
          },
          {
            "text": "\t\t}",
            "lineNumber": 456
          },
          {
            "text": "\t}",
            "lineNumber": 457
          },
          {
            "text": "}",
            "lineNumber": 458
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 459
          },
          {
            "lineNumber": 460
          },
          {
            "lineNumber": 461
          },
          {
            "text": "Ê™¢Êü•ÊòØÂê¶ÊúâË™ûÊ≥ïÈåØË™§Ôºö",
            "lineNumber": 462
          },
          {
            "lineNumber": 463
          },
          {
            "lineNumber": 464
          },
          {
            "lineNumber": 465
          },
          {
            "text": "Ë™øÊï¥ÈÇèËºØÔºöÁï∂ &#96;VITE_USE_LOCAL_PROXY=true&#96; ÊôÇÔºåÁõ¥Êé•‰ΩøÁî®Êú¨Âú∞ URLÔºåÂøΩÁï• &#96;VITE_PROXY_URL&#96;ÔºåÈÅøÂÖçË®≠ÂÆöÈåØË™§„ÄÇ",
            "lineNumber": 466
          },
          {
            "lineNumber": 467
          },
          {
            "lineNumber": 468
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 469
          },
          {
            "text": "import { getAuthStore } from '@/store/authStore'",
            "lineNumber": 470
          },
          {
            "text": "import { showCreditsToast } from '@/components/Toast/creditsToast';",
            "lineNumber": 471
          },
          {
            "text": "import { showStorageToast } from '@/components/Toast/storageToast';",
            "lineNumber": 472
          },
          {
            "text": "import { showTrafficToast } from '@/components/Toast/trafficToast';",
            "lineNumber": 473
          },
          {
            "lineNumber": 474
          },
          {
            "text": "const defaultHeaders = {",
            "lineNumber": 475
          },
          {
            "text": "  'Content-Type': 'application/json',",
            "lineNumber": 476
          },
          {
            "text": "}",
            "lineNumber": 477
          },
          {
            "lineNumber": 478
          },
          {
            "text": "let baseUrl = ''",
            "lineNumber": 479
          },
          {
            "text": "export async function getBaseURL() {",
            "lineNumber": 480
          },
          {
            "text": "  if (baseUrl) {",
            "lineNumber": 481
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 482
          },
          {
            "text": "  }",
            "lineNumber": 483
          },
          {
            "text": "  const port = await window.ipcRenderer.invoke('get-backend-port')",
            "lineNumber": 484
          },
          {
            "text": "  baseUrl = &#96;http://localhost:${port}&#96;",
            "lineNumber": 485
          },
          {
            "text": "  return baseUrl",
            "lineNumber": 486
          },
          {
            "text": "}",
            "lineNumber": 487
          },
          {
            "lineNumber": 488
          },
          {
            "text": "async function fetchRequest(",
            "lineNumber": 489
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 490
          },
          {
            "text": "  url: string,",
            "lineNumber": 491
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 492
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 493
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 494
          },
          {
            "text": "  const baseURL = await getBaseURL()",
            "lineNumber": 495
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 496
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 497
          },
          {
            "lineNumber": 498
          },
          {
            "text": "  const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 499
          },
          {
            "text": "    ...defaultHeaders,",
            "lineNumber": 500
          }
        ]
      },
      "score": 0.40611109137535095
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 7180
          },
          "endPosition": {
            "line": 7245
          }
        },
        "contents": "00152|     if (!baseUrl) {\n00153|       throw new Error('VITE_BASE_URL not configured')\n00154|     }\n00155|     return baseUrl\n00156|   }\n00157| }\n00158| \n00159| async function proxyFetchRequest(\n00160|   method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n00161|   url: string,\n00162|   data?: Record&lt;string, any&gt;,\n00163|   customHeaders: Record&lt;string, string&gt; = {}\n00164| ): Promise&lt;any&gt; {\n00165|   const baseURL = await getProxyBaseURL()\n00166|   const fullUrl = &#96;${baseURL}${url}&#96;\n00167|   const { token } = getAuthStore()\n00168| \n00169|   const headers: Record&lt;string, string&gt; = {\n00170|     ...defaultHeaders,\n00171|     ...customHeaders,\n00172|   }\n00173| \n00174|   if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n00175|     headers['Authorization'] = &#96;Bearer ${token}&#96;\n00176|   }\n00177| \n00178| \n00179|   if (import.meta.env.DEV) {\n00180|     const targetUrl = import.meta.env.VITE_BASE_URL\n00181|     if (targetUrl) {\n00182|       headers['X-Proxy-Target'] = targetUrl\n00183|     }\n00184|   }\n00185| \n00186|   const options: RequestInit = {\n00187|     method,\n00188|     headers,\n00189|   }\n00190| \n00191|   if (method === 'GET') {\n00192|     const query = data\n00193|       ? '?' +\n00194|       Object.entries(data)\n00195|         .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)\n00196|         .join('&amp;')\n00197|       : ''\n00198|     return handleResponse(fetch(fullUrl + query, options))\n00199|   }\n00200| \n00201|   if (data) {\n00202|     options.body = JSON.stringify(data)\n00203|   }\n00204| \n00205|   return handleResponse(fetch(fullUrl, options))\n00206| }\n00207| \n00208| export const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;\n00209|   proxyFetchRequest('GET', url, params, headers)\n00210| \n00211| export const proxyFetchPost = (url: string, data?: any, headers?: any) =&gt;\n00212|   proxyFetchRequest('POST', url, data, headers)\n00213| \n00214| export const proxyFetchPut = (url: string, data?: any, headers?: any) =&gt;\n00215|   proxyFetchRequest('PUT', url, data, headers)\n00216| ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "00152|     if (!baseUrl) {",
            "lineNumber": 7181
          },
          {
            "text": "00153|       throw new Error('VITE_BASE_URL not configured')",
            "lineNumber": 7182
          },
          {
            "text": "00154|     }",
            "lineNumber": 7183
          },
          {
            "text": "00155|     return baseUrl",
            "lineNumber": 7184
          },
          {
            "text": "00156|   }",
            "lineNumber": 7185
          },
          {
            "text": "00157| }",
            "lineNumber": 7186
          },
          {
            "text": "00158| ",
            "lineNumber": 7187
          },
          {
            "text": "00159| async function proxyFetchRequest(",
            "lineNumber": 7188
          },
          {
            "text": "00160|   method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 7189
          },
          {
            "text": "00161|   url: string,",
            "lineNumber": 7190
          },
          {
            "text": "00162|   data?: Record&lt;string, any&gt;,",
            "lineNumber": 7191
          },
          {
            "text": "00163|   customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 7192
          },
          {
            "text": "00164| ): Promise&lt;any&gt; {",
            "lineNumber": 7193
          },
          {
            "text": "00165|   const baseURL = await getProxyBaseURL()",
            "lineNumber": 7194
          },
          {
            "text": "00166|   const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 7195
          },
          {
            "text": "00167|   const { token } = getAuthStore()",
            "lineNumber": 7196
          },
          {
            "text": "00168| ",
            "lineNumber": 7197
          },
          {
            "text": "00169|   const headers: Record&lt;string, string&gt; = {",
            "lineNumber": 7198
          },
          {
            "text": "00170|     ...defaultHeaders,",
            "lineNumber": 7199
          },
          {
            "text": "00171|     ...customHeaders,",
            "lineNumber": 7200
          },
          {
            "text": "00172|   }",
            "lineNumber": 7201
          },
          {
            "text": "00173| ",
            "lineNumber": 7202
          },
          {
            "text": "00174|   if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 7203
          },
          {
            "text": "00175|     headers['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 7204
          },
          {
            "text": "00176|   }",
            "lineNumber": 7205
          },
          {
            "text": "00177| ",
            "lineNumber": 7206
          },
          {
            "text": "00178| ",
            "lineNumber": 7207
          },
          {
            "text": "00179|   if (import.meta.env.DEV) {",
            "lineNumber": 7208
          },
          {
            "text": "00180|     const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 7209
          },
          {
            "text": "00181|     if (targetUrl) {",
            "lineNumber": 7210
          },
          {
            "text": "00182|       headers['X-Proxy-Target'] = targetUrl",
            "lineNumber": 7211
          },
          {
            "text": "00183|     }",
            "lineNumber": 7212
          },
          {
            "text": "00184|   }",
            "lineNumber": 7213
          },
          {
            "text": "00185| ",
            "lineNumber": 7214
          },
          {
            "text": "00186|   const options: RequestInit = {",
            "lineNumber": 7215
          },
          {
            "text": "00187|     method,",
            "lineNumber": 7216
          },
          {
            "text": "00188|     headers,",
            "lineNumber": 7217
          },
          {
            "text": "00189|   }",
            "lineNumber": 7218
          },
          {
            "text": "00190| ",
            "lineNumber": 7219
          },
          {
            "text": "00191|   if (method === 'GET') {",
            "lineNumber": 7220
          },
          {
            "text": "00192|     const query = data",
            "lineNumber": 7221
          },
          {
            "text": "00193|       ? '?' +",
            "lineNumber": 7222
          },
          {
            "text": "00194|       Object.entries(data)",
            "lineNumber": 7223
          },
          {
            "text": "00195|         .map(([key, val]) =&gt; &#96;${encodeURIComponent(key)}=${encodeURIComponent(val)}&#96;)",
            "lineNumber": 7224
          },
          {
            "text": "00196|         .join('&amp;')",
            "lineNumber": 7225
          },
          {
            "text": "00197|       : ''",
            "lineNumber": 7226
          },
          {
            "text": "00198|     return handleResponse(fetch(fullUrl + query, options))",
            "lineNumber": 7227
          },
          {
            "text": "00199|   }",
            "lineNumber": 7228
          },
          {
            "text": "00200| ",
            "lineNumber": 7229
          },
          {
            "text": "00201|   if (data) {",
            "lineNumber": 7230
          },
          {
            "text": "00202|     options.body = JSON.stringify(data)",
            "lineNumber": 7231
          },
          {
            "text": "00203|   }",
            "lineNumber": 7232
          },
          {
            "text": "00204| ",
            "lineNumber": 7233
          },
          {
            "text": "00205|   return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 7234
          },
          {
            "text": "00206| }",
            "lineNumber": 7235
          },
          {
            "text": "00207| ",
            "lineNumber": 7236
          },
          {
            "text": "00208| export const proxyFetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 7237
          },
          {
            "text": "00209|   proxyFetchRequest('GET', url, params, headers)",
            "lineNumber": 7238
          },
          {
            "text": "00210| ",
            "lineNumber": 7239
          },
          {
            "text": "00211| export const proxyFetchPost = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 7240
          },
          {
            "text": "00212|   proxyFetchRequest('POST', url, data, headers)",
            "lineNumber": 7241
          },
          {
            "text": "00213| ",
            "lineNumber": 7242
          },
          {
            "text": "00214| export const proxyFetchPut = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 7243
          },
          {
            "text": "00215|   proxyFetchRequest('PUT', url, data, headers)",
            "lineNumber": 7244
          },
          {
            "text": "00216| ",
            "lineNumber": 7245
          }
        ]
      },
      "score": 0.39559459686279297
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 7122
          },
          "endPosition": {
            "line": 7187
          }
        },
        "contents": "00094|       return resData\n00095|     }\n00096| \n00097|     if (code === 13) {\n00098|       // const { logout } = getAuthStore()\n00099|       // logout()\n00100|       // window.location.href = '#/login'\n00101|       throw new Error(text)\n00102|     }\n00103| \n00104|     return resData\n00105|   } catch (err: any) {\n00106| \n00107|     // Only show traffic toast for cloud model requests\n00108|     const isCloudRequest = requestData?.api_url === 'cloud'\n00109|     if (isCloudRequest) {\n00110|       showTrafficToast()\n00111|     }\n00112| \n00113|     console.error('[fetch error]:', err)\n00114| \n00115|     if (err?.response?.status === 401) {\n00116|       // const { logout } = getAuthStore()\n00117|       // logout()\n00118|       // window.location.href = '#/login'\n00119|     }\n00120| \n00121|     throw err\n00122|   }\n00123| }\n00124| \n00125| // Encapsulate common methods\n00126| export const fetchGet = (url: string, params?: any, headers?: any) =&gt;\n00127|   fetchRequest('GET', url, params, headers)\n00128| \n00129| export const fetchPost = (url: string, data?: any, headers?: any) =&gt;\n00130|   fetchRequest('POST', url, data, headers)\n00131| \n00132| export const fetchPut = (url: string, data?: any, headers?: any) =&gt;\n00133|   fetchRequest('PUT', url, data, headers)\n00134| \n00135| export const fetchDelete = (url: string, data?: any, headers?: any) =&gt;\n00136|   fetchRequest('DELETE', url, data, headers)\n00137| \n00138| // =============== porxy ===============\n00139| \n00140| // get proxy base URL\n00141| async function getProxyBaseURL() {\n00142|   const isDev = import.meta.env.DEV\n00143| \n00144|   if (isDev) {\n00145|     const proxyUrl = import.meta.env.VITE_PROXY_URL\n00146|     if (!proxyUrl) {\n00147|       return 'http://localhost:3001'\n00148|     }\n00149|     return proxyUrl\n00150|   } else {\n00151|     const baseUrl = import.meta.env.VITE_BASE_URL\n00152|     if (!baseUrl) {\n00153|       throw new Error('VITE_BASE_URL not configured')\n00154|     }\n00155|     return baseUrl\n00156|   }\n00157| }\n00158| ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "00094|       return resData",
            "lineNumber": 7123
          },
          {
            "text": "00095|     }",
            "lineNumber": 7124
          },
          {
            "text": "00096| ",
            "lineNumber": 7125
          },
          {
            "text": "00097|     if (code === 13) {",
            "lineNumber": 7126
          },
          {
            "text": "00098|       // const { logout } = getAuthStore()",
            "lineNumber": 7127
          },
          {
            "text": "00099|       // logout()",
            "lineNumber": 7128
          },
          {
            "text": "00100|       // window.location.href = '#/login'",
            "lineNumber": 7129
          },
          {
            "text": "00101|       throw new Error(text)",
            "lineNumber": 7130
          },
          {
            "text": "00102|     }",
            "lineNumber": 7131
          },
          {
            "text": "00103| ",
            "lineNumber": 7132
          },
          {
            "text": "00104|     return resData",
            "lineNumber": 7133
          },
          {
            "text": "00105|   } catch (err: any) {",
            "lineNumber": 7134
          },
          {
            "text": "00106| ",
            "lineNumber": 7135
          },
          {
            "text": "00107|     // Only show traffic toast for cloud model requests",
            "lineNumber": 7136
          },
          {
            "text": "00108|     const isCloudRequest = requestData?.api_url === 'cloud'",
            "lineNumber": 7137
          },
          {
            "text": "00109|     if (isCloudRequest) {",
            "lineNumber": 7138
          },
          {
            "text": "00110|       showTrafficToast()",
            "lineNumber": 7139
          },
          {
            "text": "00111|     }",
            "lineNumber": 7140
          },
          {
            "text": "00112| ",
            "lineNumber": 7141
          },
          {
            "text": "00113|     console.error('[fetch error]:', err)",
            "lineNumber": 7142
          },
          {
            "text": "00114| ",
            "lineNumber": 7143
          },
          {
            "text": "00115|     if (err?.response?.status === 401) {",
            "lineNumber": 7144
          },
          {
            "text": "00116|       // const { logout } = getAuthStore()",
            "lineNumber": 7145
          },
          {
            "text": "00117|       // logout()",
            "lineNumber": 7146
          },
          {
            "text": "00118|       // window.location.href = '#/login'",
            "lineNumber": 7147
          },
          {
            "text": "00119|     }",
            "lineNumber": 7148
          },
          {
            "text": "00120| ",
            "lineNumber": 7149
          },
          {
            "text": "00121|     throw err",
            "lineNumber": 7150
          },
          {
            "text": "00122|   }",
            "lineNumber": 7151
          },
          {
            "text": "00123| }",
            "lineNumber": 7152
          },
          {
            "text": "00124| ",
            "lineNumber": 7153
          },
          {
            "text": "00125| // Encapsulate common methods",
            "lineNumber": 7154
          },
          {
            "text": "00126| export const fetchGet = (url: string, params?: any, headers?: any) =&gt;",
            "lineNumber": 7155
          },
          {
            "text": "00127|   fetchRequest('GET', url, params, headers)",
            "lineNumber": 7156
          },
          {
            "text": "00128| ",
            "lineNumber": 7157
          },
          {
            "text": "00129| export const fetchPost = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 7158
          },
          {
            "text": "00130|   fetchRequest('POST', url, data, headers)",
            "lineNumber": 7159
          },
          {
            "text": "00131| ",
            "lineNumber": 7160
          },
          {
            "text": "00132| export const fetchPut = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 7161
          },
          {
            "text": "00133|   fetchRequest('PUT', url, data, headers)",
            "lineNumber": 7162
          },
          {
            "text": "00134| ",
            "lineNumber": 7163
          },
          {
            "text": "00135| export const fetchDelete = (url: string, data?: any, headers?: any) =&gt;",
            "lineNumber": 7164
          },
          {
            "text": "00136|   fetchRequest('DELETE', url, data, headers)",
            "lineNumber": 7165
          },
          {
            "text": "00137| ",
            "lineNumber": 7166
          },
          {
            "text": "00138| // =============== porxy ===============",
            "lineNumber": 7167
          },
          {
            "text": "00139| ",
            "lineNumber": 7168
          },
          {
            "text": "00140| // get proxy base URL",
            "lineNumber": 7169
          },
          {
            "text": "00141| async function getProxyBaseURL() {",
            "lineNumber": 7170
          },
          {
            "text": "00142|   const isDev = import.meta.env.DEV",
            "lineNumber": 7171
          },
          {
            "text": "00143| ",
            "lineNumber": 7172
          },
          {
            "text": "00144|   if (isDev) {",
            "lineNumber": 7173
          },
          {
            "text": "00145|     const proxyUrl = import.meta.env.VITE_PROXY_URL",
            "lineNumber": 7174
          },
          {
            "text": "00146|     if (!proxyUrl) {",
            "lineNumber": 7175
          },
          {
            "text": "00147|       return 'http://localhost:3001'",
            "lineNumber": 7176
          },
          {
            "text": "00148|     }",
            "lineNumber": 7177
          },
          {
            "text": "00149|     return proxyUrl",
            "lineNumber": 7178
          },
          {
            "text": "00150|   } else {",
            "lineNumber": 7179
          },
          {
            "text": "00151|     const baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 7180
          },
          {
            "text": "00152|     if (!baseUrl) {",
            "lineNumber": 7181
          },
          {
            "text": "00153|       throw new Error('VITE_BASE_URL not configured')",
            "lineNumber": 7182
          },
          {
            "text": "00154|     }",
            "lineNumber": 7183
          },
          {
            "text": "00155|     return baseUrl",
            "lineNumber": 7184
          },
          {
            "text": "00156|   }",
            "lineNumber": 7185
          },
          {
            "text": "00157| }",
            "lineNumber": 7186
          },
          {
            "text": "00158| ",
            "lineNumber": 7187
          }
        ]
      },
      "score": 0.3901447653770447
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 965
          },
          "endPosition": {
            "line": 1049
          }
        },
        "contents": "- &#96;.env&#96;ÔºàÊâÄÊúâÊ®°ÂºèÈÉΩÊúÉËºâÂÖ•Ôºâ\n\nÊ†πÊìöÊñá‰ª∂ÔºåÊáâÁ∑®ËºØ &#96;.env.development&#96;Ôºö\n\n&#96;&#96;&#96;bash\nVITE_BASE_URL=/api\nVITE_PROXY_URL=http://localhost:3001\nVITE_USE_LOCAL_PROXY=true\n&#96;&#96;&#96;\n\nÊ≥®ÊÑèÔºö&#96;import.meta.env.DEV&#96; ‰∏çÈúÄË¶ÅÂú® &#96;.env&#96; ‰∏≠Ë®≠ÂÆöÔºåÁî± Vite Ëá™ÂãïËôïÁêÜ„ÄÇ\n\n---\n\n## 2. Â¶Ç‰ΩïÊ∏ÖÈô§ÁÄèË¶ΩÂô®Âø´Âèñ\n\nÈÄôÊòØ Electron ÊáâÁî®ÔºåÂø´Âèñ‰ΩçÁΩÆËàá‰∏ÄËà¨ÁÄèË¶ΩÂô®‰∏çÂêå„ÄÇ\n\n### ÊñπÊ≥ï 1ÔºöÊ∏ÖÈô§ Electron ÊáâÁî®Âø´ÂèñÔºàÊé®Ëñ¶Ôºâ\n\n1. ÈóúÈñâÊáâÁî®\n2. Âà™Èô§Âø´ÂèñÁõÆÈåÑÔºàWindowsÔºâÔºö\n   &#96;&#96;&#96;powershell\n   # Âø´ÂèñÁõÆÈåÑÈÄöÂ∏∏Âú®Ôºö\n   %APPDATA%\\Eigent\\Cache\n   # Êàñ\n   %USERPROFILE%\\AppData\\Roaming\\Eigent\\Cache\n   &#96;&#96;&#96;\n3. ÈáçÊñ∞ÂïüÂãïÊáâÁî®\n\n### ÊñπÊ≥ï 2ÔºöÂú®ÈñãÁôºËÄÖÂ∑•ÂÖ∑‰∏≠Ê∏ÖÈô§\n\n1. ÈñãÂïüÈñãÁôºËÄÖÂ∑•ÂÖ∑Ôºà&#96;Ctrl + Shift + I&#96; Êàñ &#96;F12&#96;Ôºâ\n2. Âú® Application Êàñ Storage ÂàÜÈ†Å‰∏≠Ôºö\n   - Ê∏ÖÈô§ Cache Storage\n   - Ê∏ÖÈô§ Local Storage\n   - Ê∏ÖÈô§ Session Storage\n3. ÊàñÂú® Network ÂàÜÈ†ÅÂãæÈÅ∏„ÄåDisable cache„Äç\n\n### ÊñπÊ≥ï 3ÔºöÂº∑Âà∂ÈáçÊñ∞ËºâÂÖ•\n\n- &#96;Ctrl + Shift + R&#96;ÔºàWindows/LinuxÔºâ\n- &#96;Cmd + Shift + R&#96;ÔºàmacOSÔºâ\n\n### ÊñπÊ≥ï 4ÔºöÊ∏ÖÈô§ Vite Âø´Âèñ\n\n&#96;&#96;&#96;bash\nnpm run clean-cache\n&#96;&#96;&#96;\n\nÈÄôÊúÉÊ∏ÖÈô§ &#96;node_modules/.vite&#96; ÁõÆÈåÑ„ÄÇ\n\n---\n\n## Á∏ΩÁµê\n\n1. &#96;import.meta.env.DEV&#96;ÔºöÁî± Vite Ëá™ÂãïË®≠ÂÆöÔºåÁÑ°ÈúÄÂú® &#96;.env&#96; ‰∏≠ÈÖçÁΩÆ\n2. Áí∞Â¢ÉËÆäÊï∏Ê™îÊ°àÔºö&#96;.env.development&#96;ÔºàÈñãÁôºÊ®°ÂºèÔºâ\n3. Ê∏ÖÈô§Âø´ÂèñÔºöÂà™Èô§ Electron Âø´ÂèñÁõÆÈåÑÔºåÊàñ‰ΩøÁî®ÈñãÁôºËÄÖÂ∑•ÂÖ∑Ê∏ÖÈô§\n\nËã•‰øÆÊîπ &#96;.env.development&#96; Âæå‰ªçÁÑ°ÊïàÔºåË´ãÔºö\n1. Á¢∫Ë™çÊ™îÊ°à‰ΩçÊñºÂ∞àÊ°àÊ†πÁõÆÈåÑ\n2. ÈáçÊñ∞ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô®Ôºà&#96;npm run dev&#96;Ôºâ\n3. Ê∏ÖÈô§ Electron Âø´Âèñ\n4. Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96; ÊòØÂê¶ÁÇ∫ &#96;'true'&#96;ÔºàÂ≠ó‰∏≤ÔºåÈùûÂ∏ÉÊûóÂÄºÔºâ\n\n&#96;&#96;&#96;typescript\nexport default defineConfig(({ command, mode }) =&gt; {\n  rmSync('dist-electron', { recursive: true, force: true })\n\n  const isServe = command === 'serve'\n  const isBuild = command === 'build'\n  const sourcemap = isServe || !!process.env.VSCODE_DEBUG\n  const env = loadEnv(mode, process.cwd(), '')\n&#96;&#96;&#96;\n\n&#96;&#96;&#96;shellscript\nVITE_BASE_URL=/api\nVITE_PROXY_URL=http://localhost:3001\nVITE_USE_LOCAL_PROXY=true\n&#96;&#96;&#96;\n\n&#96;&#96;&#96;powershell\n   # Âø´ÂèñÁõÆÈåÑÈÄöÂ∏∏Âú®Ôºö",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- &#96;.env&#96;ÔºàÊâÄÊúâÊ®°ÂºèÈÉΩÊúÉËºâÂÖ•Ôºâ",
            "lineNumber": 966
          },
          {
            "lineNumber": 967
          },
          {
            "text": "Ê†πÊìöÊñá‰ª∂ÔºåÊáâÁ∑®ËºØ &#96;.env.development&#96;Ôºö",
            "lineNumber": 968
          },
          {
            "lineNumber": 969
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 970
          },
          {
            "text": "VITE_BASE_URL=/api",
            "lineNumber": 971
          },
          {
            "text": "VITE_PROXY_URL=http://localhost:3001",
            "lineNumber": 972
          },
          {
            "text": "VITE_USE_LOCAL_PROXY=true",
            "lineNumber": 973
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 974
          },
          {
            "lineNumber": 975
          },
          {
            "text": "Ê≥®ÊÑèÔºö&#96;import.meta.env.DEV&#96; ‰∏çÈúÄË¶ÅÂú® &#96;.env&#96; ‰∏≠Ë®≠ÂÆöÔºåÁî± Vite Ëá™ÂãïËôïÁêÜ„ÄÇ",
            "lineNumber": 976
          },
          {
            "lineNumber": 977
          },
          {
            "text": "---",
            "lineNumber": 978
          },
          {
            "lineNumber": 979
          },
          {
            "text": "## 2. Â¶Ç‰ΩïÊ∏ÖÈô§ÁÄèË¶ΩÂô®Âø´Âèñ",
            "lineNumber": 980
          },
          {
            "lineNumber": 981
          },
          {
            "text": "ÈÄôÊòØ Electron ÊáâÁî®ÔºåÂø´Âèñ‰ΩçÁΩÆËàá‰∏ÄËà¨ÁÄèË¶ΩÂô®‰∏çÂêå„ÄÇ",
            "lineNumber": 982
          },
          {
            "lineNumber": 983
          },
          {
            "text": "### ÊñπÊ≥ï 1ÔºöÊ∏ÖÈô§ Electron ÊáâÁî®Âø´ÂèñÔºàÊé®Ëñ¶Ôºâ",
            "lineNumber": 984
          },
          {
            "lineNumber": 985
          },
          {
            "text": "1. ÈóúÈñâÊáâÁî®",
            "lineNumber": 986
          },
          {
            "text": "2. Âà™Èô§Âø´ÂèñÁõÆÈåÑÔºàWindowsÔºâÔºö",
            "lineNumber": 987
          },
          {
            "text": "   &#96;&#96;&#96;powershell",
            "lineNumber": 988
          },
          {
            "text": "   # Âø´ÂèñÁõÆÈåÑÈÄöÂ∏∏Âú®Ôºö",
            "lineNumber": 989
          },
          {
            "text": "   %APPDATA%\\Eigent\\Cache",
            "lineNumber": 990
          },
          {
            "text": "   # Êàñ",
            "lineNumber": 991
          },
          {
            "text": "   %USERPROFILE%\\AppData\\Roaming\\Eigent\\Cache",
            "lineNumber": 992
          },
          {
            "text": "   &#96;&#96;&#96;",
            "lineNumber": 993
          },
          {
            "text": "3. ÈáçÊñ∞ÂïüÂãïÊáâÁî®",
            "lineNumber": 994
          },
          {
            "lineNumber": 995
          },
          {
            "text": "### ÊñπÊ≥ï 2ÔºöÂú®ÈñãÁôºËÄÖÂ∑•ÂÖ∑‰∏≠Ê∏ÖÈô§",
            "lineNumber": 996
          },
          {
            "lineNumber": 997
          },
          {
            "text": "1. ÈñãÂïüÈñãÁôºËÄÖÂ∑•ÂÖ∑Ôºà&#96;Ctrl + Shift + I&#96; Êàñ &#96;F12&#96;Ôºâ",
            "lineNumber": 998
          },
          {
            "text": "2. Âú® Application Êàñ Storage ÂàÜÈ†Å‰∏≠Ôºö",
            "lineNumber": 999
          },
          {
            "text": "   - Ê∏ÖÈô§ Cache Storage",
            "lineNumber": 1000
          },
          {
            "text": "   - Ê∏ÖÈô§ Local Storage",
            "lineNumber": 1001
          },
          {
            "text": "   - Ê∏ÖÈô§ Session Storage",
            "lineNumber": 1002
          },
          {
            "text": "3. ÊàñÂú® Network ÂàÜÈ†ÅÂãæÈÅ∏„ÄåDisable cache„Äç",
            "lineNumber": 1003
          },
          {
            "lineNumber": 1004
          },
          {
            "text": "### ÊñπÊ≥ï 3ÔºöÂº∑Âà∂ÈáçÊñ∞ËºâÂÖ•",
            "lineNumber": 1005
          },
          {
            "lineNumber": 1006
          },
          {
            "text": "- &#96;Ctrl + Shift + R&#96;ÔºàWindows/LinuxÔºâ",
            "lineNumber": 1007
          },
          {
            "text": "- &#96;Cmd + Shift + R&#96;ÔºàmacOSÔºâ",
            "lineNumber": 1008
          },
          {
            "lineNumber": 1009
          },
          {
            "text": "### ÊñπÊ≥ï 4ÔºöÊ∏ÖÈô§ Vite Âø´Âèñ",
            "lineNumber": 1010
          },
          {
            "lineNumber": 1011
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 1012
          },
          {
            "text": "npm run clean-cache",
            "lineNumber": 1013
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 1014
          },
          {
            "lineNumber": 1015
          },
          {
            "text": "ÈÄôÊúÉÊ∏ÖÈô§ &#96;node_modules/.vite&#96; ÁõÆÈåÑ„ÄÇ",
            "lineNumber": 1016
          },
          {
            "lineNumber": 1017
          },
          {
            "text": "---",
            "lineNumber": 1018
          },
          {
            "lineNumber": 1019
          },
          {
            "text": "## Á∏ΩÁµê",
            "lineNumber": 1020
          },
          {
            "lineNumber": 1021
          },
          {
            "text": "1. &#96;import.meta.env.DEV&#96;ÔºöÁî± Vite Ëá™ÂãïË®≠ÂÆöÔºåÁÑ°ÈúÄÂú® &#96;.env&#96; ‰∏≠ÈÖçÁΩÆ",
            "lineNumber": 1022
          },
          {
            "text": "2. Áí∞Â¢ÉËÆäÊï∏Ê™îÊ°àÔºö&#96;.env.development&#96;ÔºàÈñãÁôºÊ®°ÂºèÔºâ",
            "lineNumber": 1023
          },
          {
            "text": "3. Ê∏ÖÈô§Âø´ÂèñÔºöÂà™Èô§ Electron Âø´ÂèñÁõÆÈåÑÔºåÊàñ‰ΩøÁî®ÈñãÁôºËÄÖÂ∑•ÂÖ∑Ê∏ÖÈô§",
            "lineNumber": 1024
          },
          {
            "lineNumber": 1025
          },
          {
            "text": "Ëã•‰øÆÊîπ &#96;.env.development&#96; Âæå‰ªçÁÑ°ÊïàÔºåË´ãÔºö",
            "lineNumber": 1026
          },
          {
            "text": "1. Á¢∫Ë™çÊ™îÊ°à‰ΩçÊñºÂ∞àÊ°àÊ†πÁõÆÈåÑ",
            "lineNumber": 1027
          },
          {
            "text": "2. ÈáçÊñ∞ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô®Ôºà&#96;npm run dev&#96;Ôºâ",
            "lineNumber": 1028
          },
          {
            "text": "3. Ê∏ÖÈô§ Electron Âø´Âèñ",
            "lineNumber": 1029
          },
          {
            "text": "4. Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96; ÊòØÂê¶ÁÇ∫ &#96;'true'&#96;ÔºàÂ≠ó‰∏≤ÔºåÈùûÂ∏ÉÊûóÂÄºÔºâ",
            "lineNumber": 1030
          },
          {
            "lineNumber": 1031
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 1032
          },
          {
            "text": "export default defineConfig(({ command, mode }) =&gt; {",
            "lineNumber": 1033
          },
          {
            "text": "  rmSync('dist-electron', { recursive: true, force: true })",
            "lineNumber": 1034
          },
          {
            "lineNumber": 1035
          },
          {
            "text": "  const isServe = command === 'serve'",
            "lineNumber": 1036
          },
          {
            "text": "  const isBuild = command === 'build'",
            "lineNumber": 1037
          },
          {
            "text": "  const sourcemap = isServe || !!process.env.VSCODE_DEBUG",
            "lineNumber": 1038
          },
          {
            "text": "  const env = loadEnv(mode, process.cwd(), '')",
            "lineNumber": 1039
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 1040
          },
          {
            "lineNumber": 1041
          },
          {
            "text": "&#96;&#96;&#96;shellscript",
            "lineNumber": 1042
          },
          {
            "text": "VITE_BASE_URL=/api",
            "lineNumber": 1043
          },
          {
            "text": "VITE_PROXY_URL=http://localhost:3001",
            "lineNumber": 1044
          },
          {
            "text": "VITE_USE_LOCAL_PROXY=true",
            "lineNumber": 1045
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 1046
          },
          {
            "lineNumber": 1047
          },
          {
            "text": "&#96;&#96;&#96;powershell",
            "lineNumber": 1048
          },
          {
            "text": "   # Âø´ÂèñÁõÆÈåÑÈÄöÂ∏∏Âú®Ôºö",
            "lineNumber": 1049
          }
        ]
      },
      "score": 0.383844256401062
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "column": 48
          },
          "endPosition": {
            "line": 59,
            "column": 1
          }
        },
        "contents": "import { showCreditsToast } from '@/components/Toast/creditsToast';\nimport { showStorageToast } from '@/components/Toast/storageToast';\nimport { showTrafficToast } from '@/components/Toast/trafficToast';\n\nconst defaultHeaders = {\n  'Content-Type': 'application/json',\n}\n\nlet baseUrl = ''\nexport async function getBaseURL() {\n  if (baseUrl) {\n    return baseUrl\n  }\n  const port = await window.ipcRenderer.invoke('get-backend-port')\n  baseUrl = &#96;http://localhost:${port}&#96;\n  return baseUrl\n}\n\nasync function fetchRequest(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  url: string,\n  data?: Record&lt;string, any&gt;,\n  customHeaders: Record&lt;string, string&gt; = {}\n): Promise&lt;any&gt; {\n  \n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { showCreditsToast } from '@/components/Toast/creditsToast';",
            "lineNumber": 2
          },
          {
            "text": "import { showStorageToast } from '@/components/Toast/storageToast';",
            "lineNumber": 3
          },
          {
            "text": "import { showTrafficToast } from '@/components/Toast/trafficToast';",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "const defaultHeaders = {",
            "lineNumber": 6
          },
          {
            "text": "  'Content-Type': 'application/json',",
            "lineNumber": 7
          },
          {
            "text": "}",
            "lineNumber": 8
          },
          {
            "lineNumber": 9
          },
          {
            "text": "let baseUrl = ''",
            "lineNumber": 10
          },
          {
            "text": "export async function getBaseURL() {",
            "lineNumber": 11,
            "isSignature": true
          },
          {
            "text": "  if (baseUrl) {",
            "lineNumber": 12
          },
          {
            "text": "    return baseUrl",
            "lineNumber": 13
          },
          {
            "text": "  }",
            "lineNumber": 14
          },
          {
            "text": "  const port = await window.ipcRenderer.invoke('get-backend-port')",
            "lineNumber": 15
          },
          {
            "text": "  baseUrl = &#96;http://localhost:${port}&#96;",
            "lineNumber": 16
          },
          {
            "text": "  return baseUrl",
            "lineNumber": 17
          },
          {
            "text": "}",
            "lineNumber": 18,
            "isSignature": true
          },
          {
            "lineNumber": 19
          },
          {
            "text": "async function fetchRequest(",
            "lineNumber": 20,
            "isSignature": true
          },
          {
            "text": "  method: 'GET' | 'POST' | 'PUT' | 'DELETE',",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "text": "  url: string,",
            "lineNumber": 22,
            "isSignature": true
          },
          {
            "text": "  data?: Record&lt;string, any&gt;,",
            "lineNumber": 23,
            "isSignature": true
          },
          {
            "text": "  customHeaders: Record&lt;string, string&gt; = {}",
            "lineNumber": 24,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;any&gt; {",
            "lineNumber": 25,
            "isSignature": true
          },
          {
            "text": "  ",
            "lineNumber": 26
          },
          {
            "text": "}",
            "lineNumber": 60,
            "isSignature": true
          }
        ]
      },
      "score": 0.38027438521385193
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 828
          },
          "endPosition": {
            "line": 903
          }
        },
        "contents": "\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\n\t\tconst callNow = immediate &amp;&amp; !timeout;\n\n\t\tif (timeout) clearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\n\t\tif (callNow) func.apply(context, args);\n\t};\n}\n\n\nexport function capitalizeFirstLetter(input: string): string {\n\tif (input.length === 0) return input;\n\treturn input.charAt(0).toUpperCase() + input.slice(1);\n}\n\nexport function hasStackKeys() {\n\treturn import.meta.env.VITE_STACK_PROJECT_ID &amp;&amp;\n\t\timport.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY &amp;&amp;\n\t\timport.meta.env.VITE_STACK_SECRET_SERVER_KEY;\n}\n\n// Re-export replay utilities\nexport { replayProject, replayActiveTask } from './replay';\n\nexport async function uploadLog(taskId: string, type?: string | undefined) {\n\tif (import.meta.env.VITE_USE_LOCAL_PROXY !== \"true\" &amp;&amp; !type) {\n\t\ttry {\n\t\t\tconst { email, token } = getAuthStore()\n\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL\n\t\t\t\n\t\t\tawait window.electronAPI.uploadLog(\n\t\t\t\temail,\n\t\t\t\ttaskId,\n\t\t\t\tbaseUrl,\n\t\t\t\ttoken\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to upload log:', error);\n\t\t}\n\t}\n}\n&#96;&#96;&#96;\n\n\nÊ™¢Êü•ÊòØÂê¶ÊúâÂÖ∂‰ªñÂú∞ÊñπÈúÄË¶Å‰øÆÊ≠£Ôºö\n\n\n\nÊ™¢Êü• &#96;src/lib/index.ts&#96; ‰∏≠ÂÖ∂‰ªñ‰ΩøÁî® &#96;VITE_PROXY_URL&#96; ÁöÑÂú∞ÊñπÔºö\n\n\n\n## ÂïèÈ°åÂàÜÊûê\n\n&#96;getProxyBaseURL()&#96; ÂáΩÊï∏Êú™Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96;ÔºåÂÉÖ‰æùË≥¥ &#96;import.meta.env.DEV&#96;ÔºåÂ∞éËá¥Âç≥‰ΩøË®≠ÂÆö &#96;VITE_USE_LOCAL_PROXY=true&#96;Ôºå‰ªçÂèØËÉΩ‰ΩøÁî®Èõ≤Á´Ø URL„ÄÇ\n\n## ‰øÆÊ≠£ÂÖßÂÆπ\n\nÂ∑≤Êõ¥Êñ∞ÂÖ©ÂÄã &#96;getProxyBaseURL()&#96; ÂáΩÊï∏Ôºö\n1. &#96;src/api/http.ts&#96;ÔºàÁ¨¨ 141-157 Ë°åÔºâ\n2. &#96;src/lib/index.ts&#96;ÔºàÁ¨¨ 3-19 Ë°åÔºâ\n\nÊñ∞ÈÇèËºØÔºö\n- ÈñãÁôºÊ®°Âºè (&#96;isDev = true&#96;)Ôºö\n  - Ëã• &#96;VITE_USE_LOCAL_PROXY === 'true'&#96;Ôºö‰ΩøÁî®Êú¨Âú∞ URLÔºà&#96;VITE_PROXY_URL&#96; ÊàñÈ†êË®≠ &#96;http://localhost:3001&#96;Ôºâ\n  - Âê¶ÂâáÔºö‰ΩøÁî®Èõ≤Á´Ø URLÔºà&#96;VITE_PROXY_URL&#96; ÊàñÈ†êË®≠ &#96;https://dev.eigent.ai&#96;Ôºâ\n- ÁîüÁî¢Ê®°ÂºèÔºö‰ΩøÁî® &#96;VITE_BASE_URL&#96;\n\n## ÂæåÁ∫åÊ≠•È©ü\n\n1. Á¢∫Ë™çÁí∞Â¢ÉËÆäÊï∏Ë®≠ÂÆöÔºöÂú® &#96;.env.development&#96; ‰∏≠Ë®≠ÂÆöÔºö\n   &#96;&#96;&#96;bash",
        "signatures": {},
        "detailedLines": [
          {
            "text": "\t\t\tif (!immediate) func.apply(context, args);",
            "lineNumber": 829
          },
          {
            "text": "\t\t};",
            "lineNumber": 830
          },
          {
            "lineNumber": 831
          },
          {
            "text": "\t\tconst callNow = immediate &amp;&amp; !timeout;",
            "lineNumber": 832
          },
          {
            "lineNumber": 833
          },
          {
            "text": "\t\tif (timeout) clearTimeout(timeout);",
            "lineNumber": 834
          },
          {
            "text": "\t\ttimeout = setTimeout(later, wait);",
            "lineNumber": 835
          },
          {
            "lineNumber": 836
          },
          {
            "text": "\t\tif (callNow) func.apply(context, args);",
            "lineNumber": 837
          },
          {
            "text": "\t};",
            "lineNumber": 838
          },
          {
            "text": "}",
            "lineNumber": 839
          },
          {
            "lineNumber": 840
          },
          {
            "lineNumber": 841
          },
          {
            "text": "export function capitalizeFirstLetter(input: string): string {",
            "lineNumber": 842
          },
          {
            "text": "\tif (input.length === 0) return input;",
            "lineNumber": 843
          },
          {
            "text": "\treturn input.charAt(0).toUpperCase() + input.slice(1);",
            "lineNumber": 844
          },
          {
            "text": "}",
            "lineNumber": 845
          },
          {
            "lineNumber": 846
          },
          {
            "text": "export function hasStackKeys() {",
            "lineNumber": 847
          },
          {
            "text": "\treturn import.meta.env.VITE_STACK_PROJECT_ID &amp;&amp;",
            "lineNumber": 848
          },
          {
            "text": "\t\timport.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY &amp;&amp;",
            "lineNumber": 849
          },
          {
            "text": "\t\timport.meta.env.VITE_STACK_SECRET_SERVER_KEY;",
            "lineNumber": 850
          },
          {
            "text": "}",
            "lineNumber": 851
          },
          {
            "lineNumber": 852
          },
          {
            "text": "// Re-export replay utilities",
            "lineNumber": 853
          },
          {
            "text": "export { replayProject, replayActiveTask } from './replay';",
            "lineNumber": 854
          },
          {
            "lineNumber": 855
          },
          {
            "text": "export async function uploadLog(taskId: string, type?: string | undefined) {",
            "lineNumber": 856
          },
          {
            "text": "\tif (import.meta.env.VITE_USE_LOCAL_PROXY !== \"true\" &amp;&amp; !type) {",
            "lineNumber": 857
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 858
          },
          {
            "text": "\t\t\tconst { email, token } = getAuthStore()",
            "lineNumber": 859
          },
          {
            "text": "\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL",
            "lineNumber": 860
          },
          {
            "text": "\t\t\t",
            "lineNumber": 861
          },
          {
            "text": "\t\t\tawait window.electronAPI.uploadLog(",
            "lineNumber": 862
          },
          {
            "text": "\t\t\t\temail,",
            "lineNumber": 863
          },
          {
            "text": "\t\t\t\ttaskId,",
            "lineNumber": 864
          },
          {
            "text": "\t\t\t\tbaseUrl,",
            "lineNumber": 865
          },
          {
            "text": "\t\t\t\ttoken",
            "lineNumber": 866
          },
          {
            "text": "\t\t\t);",
            "lineNumber": 867
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 868
          },
          {
            "text": "\t\t\tconsole.error('Failed to upload log:', error);",
            "lineNumber": 869
          },
          {
            "text": "\t\t}",
            "lineNumber": 870
          },
          {
            "text": "\t}",
            "lineNumber": 871
          },
          {
            "text": "}",
            "lineNumber": 872
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 873
          },
          {
            "lineNumber": 874
          },
          {
            "lineNumber": 875
          },
          {
            "text": "Ê™¢Êü•ÊòØÂê¶ÊúâÂÖ∂‰ªñÂú∞ÊñπÈúÄË¶Å‰øÆÊ≠£Ôºö",
            "lineNumber": 876
          },
          {
            "lineNumber": 877
          },
          {
            "lineNumber": 878
          },
          {
            "lineNumber": 879
          },
          {
            "text": "Ê™¢Êü• &#96;src/lib/index.ts&#96; ‰∏≠ÂÖ∂‰ªñ‰ΩøÁî® &#96;VITE_PROXY_URL&#96; ÁöÑÂú∞ÊñπÔºö",
            "lineNumber": 880
          },
          {
            "lineNumber": 881
          },
          {
            "lineNumber": 882
          },
          {
            "lineNumber": 883
          },
          {
            "text": "## ÂïèÈ°åÂàÜÊûê",
            "lineNumber": 884
          },
          {
            "lineNumber": 885
          },
          {
            "text": "&#96;getProxyBaseURL()&#96; ÂáΩÊï∏Êú™Ê™¢Êü• &#96;VITE_USE_LOCAL_PROXY&#96;ÔºåÂÉÖ‰æùË≥¥ &#96;import.meta.env.DEV&#96;ÔºåÂ∞éËá¥Âç≥‰ΩøË®≠ÂÆö &#96;VITE_USE_LOCAL_PROXY=true&#96;Ôºå‰ªçÂèØËÉΩ‰ΩøÁî®Èõ≤Á´Ø URL„ÄÇ",
            "lineNumber": 886
          },
          {
            "lineNumber": 887
          },
          {
            "text": "## ‰øÆÊ≠£ÂÖßÂÆπ",
            "lineNumber": 888
          },
          {
            "lineNumber": 889
          },
          {
            "text": "Â∑≤Êõ¥Êñ∞ÂÖ©ÂÄã &#96;getProxyBaseURL()&#96; ÂáΩÊï∏Ôºö",
            "lineNumber": 890
          },
          {
            "text": "1. &#96;src/api/http.ts&#96;ÔºàÁ¨¨ 141-157 Ë°åÔºâ",
            "lineNumber": 891
          },
          {
            "text": "2. &#96;src/lib/index.ts&#96;ÔºàÁ¨¨ 3-19 Ë°åÔºâ",
            "lineNumber": 892
          },
          {
            "lineNumber": 893
          },
          {
            "text": "Êñ∞ÈÇèËºØÔºö",
            "lineNumber": 894
          },
          {
            "text": "- ÈñãÁôºÊ®°Âºè (&#96;isDev = true&#96;)Ôºö",
            "lineNumber": 895
          },
          {
            "text": "  - Ëã• &#96;VITE_USE_LOCAL_PROXY === 'true'&#96;Ôºö‰ΩøÁî®Êú¨Âú∞ URLÔºà&#96;VITE_PROXY_URL&#96; ÊàñÈ†êË®≠ &#96;http://localhost:3001&#96;Ôºâ",
            "lineNumber": 896
          },
          {
            "text": "  - Âê¶ÂâáÔºö‰ΩøÁî®Èõ≤Á´Ø URLÔºà&#96;VITE_PROXY_URL&#96; ÊàñÈ†êË®≠ &#96;https://dev.eigent.ai&#96;Ôºâ",
            "lineNumber": 897
          },
          {
            "text": "- ÁîüÁî¢Ê®°ÂºèÔºö‰ΩøÁî® &#96;VITE_BASE_URL&#96;",
            "lineNumber": 898
          },
          {
            "lineNumber": 899
          },
          {
            "text": "## ÂæåÁ∫åÊ≠•È©ü",
            "lineNumber": 900
          },
          {
            "lineNumber": 901
          },
          {
            "text": "1. Á¢∫Ë™çÁí∞Â¢ÉËÆäÊï∏Ë®≠ÂÆöÔºöÂú® &#96;.env.development&#96; ‰∏≠Ë®≠ÂÆöÔºö",
            "lineNumber": 902
          },
          {
            "text": "   &#96;&#96;&#96;bash",
            "lineNumber": 903
          }
        ]
      },
      "score": 0.3744106888771057
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\index.ts",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 60,
            "column": 24
          }
        },
        "contents": "import {\n  app,\n  BrowserWindow,\n  shell,\n  ipcMain,\n  Menu,\n  dialog,\n  nativeTheme,\n  protocol,\n  session,\n} from 'electron';\nimport { fileURLToPath } from 'node:url';\nimport path from 'node:path';\nimport os, { homedir } from 'node:os';\nimport log from 'electron-log';\nimport { update, registerUpdateIpcHandlers } from './update';\nimport { checkToolInstalled, killProcessOnPort, startBackend } from './init';\nimport { WebViewManager } from './webview';\nimport { FileReader } from './fileReader';\nimport { ChildProcessWithoutNullStreams } from 'node:child_process';\nimport fs, { existsSync, readFileSync } from 'node:fs';\nimport fsp from 'fs/promises';\nimport { addMcp, removeMcp, updateMcp, readMcpConfig } from './utils/mcpConfig';\nimport {\n  getEnvPath,\n  updateEnvBlock,\n  removeEnvKey,\n  getEmailFolderPath,\n} from './utils/envUtil';\nimport { copyBrowserData } from './copy';\nimport { findAvailablePort } from './init';\nimport kill from 'tree-kill';\nimport { zipFolder } from './utils/log';\nimport mime from 'mime';\nimport axios from 'axios';\nimport FormData from 'form-data';\nimport {\n  checkAndInstallDepsOnUpdate,\n  PromiseReturnType,\n  getInstallationStatus,\n} from './install-deps';\nimport { isBinaryExists, getBackendPath, getVenvPath } from './utils/process';\n\nconst userData = app.getPath('userData');\n\n// ==================== constants ====================\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nconst MAIN_DIST = path.join(__dirname, '../..');\nconst RENDERER_DIST = path.join(MAIN_DIST, 'dist');\nconst VITE_DEV_SERVER_URL = process.env.VITE_DEV_SERVER_URL;\nconst VITE_PUBLIC = VITE_DEV_SERVER_URL\n  ? path.join(MAIN_DIST, 'public')\n  : RENDERER_DIST;\n\n// ==================== global variables ====================\nlet win: BrowserWindow | null = null;\nlet webViewManager: WebViewManager | null = null;\nlet fileReader: FileReader | null = null;\nlet python_process: ChildProcessWithoutNullStreams | null = null;\nlet backendPort: number = 5001;\nlet browser_port = 9222;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import {",
            "lineNumber": 1
          },
          {
            "text": "  app,",
            "lineNumber": 2
          },
          {
            "text": "  BrowserWindow,",
            "lineNumber": 3
          },
          {
            "text": "  shell,",
            "lineNumber": 4
          },
          {
            "text": "  ipcMain,",
            "lineNumber": 5
          },
          {
            "text": "  Menu,",
            "lineNumber": 6
          },
          {
            "text": "  dialog,",
            "lineNumber": 7
          },
          {
            "text": "  nativeTheme,",
            "lineNumber": 8
          },
          {
            "text": "  protocol,",
            "lineNumber": 9
          },
          {
            "text": "  session,",
            "lineNumber": 10
          },
          {
            "text": "} from 'electron';",
            "lineNumber": 11
          },
          {
            "text": "import { fileURLToPath } from 'node:url';",
            "lineNumber": 12
          },
          {
            "text": "import path from 'node:path';",
            "lineNumber": 13
          },
          {
            "text": "import os, { homedir } from 'node:os';",
            "lineNumber": 14
          },
          {
            "text": "import log from 'electron-log';",
            "lineNumber": 15
          },
          {
            "text": "import { update, registerUpdateIpcHandlers } from './update';",
            "lineNumber": 16
          },
          {
            "text": "import { checkToolInstalled, killProcessOnPort, startBackend } from './init';",
            "lineNumber": 17
          },
          {
            "text": "import { WebViewManager } from './webview';",
            "lineNumber": 18
          },
          {
            "text": "import { FileReader } from './fileReader';",
            "lineNumber": 19
          },
          {
            "text": "import { ChildProcessWithoutNullStreams } from 'node:child_process';",
            "lineNumber": 20
          },
          {
            "text": "import fs, { existsSync, readFileSync } from 'node:fs';",
            "lineNumber": 21
          },
          {
            "text": "import fsp from 'fs/promises';",
            "lineNumber": 22
          },
          {
            "text": "import { addMcp, removeMcp, updateMcp, readMcpConfig } from './utils/mcpConfig';",
            "lineNumber": 23
          },
          {
            "text": "import {",
            "lineNumber": 24
          },
          {
            "text": "  getEnvPath,",
            "lineNumber": 25
          },
          {
            "text": "  updateEnvBlock,",
            "lineNumber": 26
          },
          {
            "text": "  removeEnvKey,",
            "lineNumber": 27
          },
          {
            "text": "  getEmailFolderPath,",
            "lineNumber": 28
          },
          {
            "text": "} from './utils/envUtil';",
            "lineNumber": 29
          },
          {
            "text": "import { copyBrowserData } from './copy';",
            "lineNumber": 30
          },
          {
            "text": "import { findAvailablePort } from './init';",
            "lineNumber": 31
          },
          {
            "text": "import kill from 'tree-kill';",
            "lineNumber": 32
          },
          {
            "text": "import { zipFolder } from './utils/log';",
            "lineNumber": 33
          },
          {
            "text": "import mime from 'mime';",
            "lineNumber": 34
          },
          {
            "text": "import axios from 'axios';",
            "lineNumber": 35
          },
          {
            "text": "import FormData from 'form-data';",
            "lineNumber": 36
          },
          {
            "text": "import {",
            "lineNumber": 37
          },
          {
            "text": "  checkAndInstallDepsOnUpdate,",
            "lineNumber": 38
          },
          {
            "text": "  PromiseReturnType,",
            "lineNumber": 39
          },
          {
            "text": "  getInstallationStatus,",
            "lineNumber": 40
          },
          {
            "text": "} from './install-deps';",
            "lineNumber": 41
          },
          {
            "text": "import { isBinaryExists, getBackendPath, getVenvPath } from './utils/process';",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "const userData = app.getPath('userData');",
            "lineNumber": 44
          },
          {
            "lineNumber": 45
          },
          {
            "text": "// ==================== constants ====================",
            "lineNumber": 46
          },
          {
            "text": "const __dirname = path.dirname(fileURLToPath(import.meta.url));",
            "lineNumber": 47
          },
          {
            "text": "const MAIN_DIST = path.join(__dirname, '../..');",
            "lineNumber": 48
          },
          {
            "text": "const RENDERER_DIST = path.join(MAIN_DIST, 'dist');",
            "lineNumber": 49
          },
          {
            "text": "const VITE_DEV_SERVER_URL = process.env.VITE_DEV_SERVER_URL;",
            "lineNumber": 50
          },
          {
            "text": "const VITE_PUBLIC = VITE_DEV_SERVER_URL",
            "lineNumber": 51
          },
          {
            "text": "  ? path.join(MAIN_DIST, 'public')",
            "lineNumber": 52
          },
          {
            "text": "  : RENDERER_DIST;",
            "lineNumber": 53
          },
          {
            "lineNumber": 54
          },
          {
            "text": "// ==================== global variables ====================",
            "lineNumber": 55
          },
          {
            "text": "let win: BrowserWindow | null = null;",
            "lineNumber": 56
          },
          {
            "text": "let webViewManager: WebViewManager | null = null;",
            "lineNumber": 57
          },
          {
            "text": "let fileReader: FileReader | null = null;",
            "lineNumber": 58
          },
          {
            "text": "let python_process: ChildProcessWithoutNullStreams | null = null;",
            "lineNumber": 59
          },
          {
            "text": "let backendPort: number = 5001;",
            "lineNumber": 60
          },
          {
            "text": "let browser_port = 9222;",
            "lineNumber": 61
          }
        ]
      },
      "score": 0.3722642660140991
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\COMMANDS.md",
        "range": {
          "startPosition": {
            "line": 105
          },
          "endPosition": {
            "line": 193
          }
        },
        "contents": "# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô®\ndocker compose down\n\n# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô® + Ë≥áÊñôÂç∑ (ÊÖéÁî®ÔºÅÊúÉÂà™Èô§Ë≥áÊñô)\ndocker compose down -v\n&#96;&#96;&#96;\n\n---\n\n## Git Â∑•‰ΩúÊµÅÁ®ã\n\n### Â∏∏Áî®Êåá‰ª§\n\n&#96;&#96;&#96;bash\n# Êü•ÁúãÁãÄÊÖã\ngit status\n\n# Êü•ÁúãËÆäÊõ¥\ngit diff\n\n# Êèê‰∫§ËÆäÊõ¥\ngit add .\ngit commit -m \"feat: Êñ∞Â¢ûÂäüËÉΩÊèèËø∞\"\n\n# Êé®ÈÄÅÂà∞ÈÅ†Á´Ø\ngit push origin feature-branch\n&#96;&#96;&#96;\n\n### Commit Ë®äÊÅØË¶èÁØÑ\n\n| È°ûÂûã | Ë™™Êòé |\n|-----|------|\n| &#96;feat:&#96; | Êñ∞ÂäüËÉΩ |\n| &#96;fix:&#96; | ÈåØË™§‰øÆÂæ© |\n| &#96;docs:&#96; | Êñá‰ª∂Êõ¥Êñ∞ |\n| &#96;style:&#96; | Á®ãÂºèÁ¢ºÊ†ºÂºèË™øÊï¥ |\n| &#96;refactor:&#96; | ÈáçÊßã |\n| &#96;test:&#96; | Ê∏¨Ë©¶Áõ∏Èóú |\n| &#96;chore:&#96; | Âª∫ÁΩÆ/Â∑•ÂÖ∑Áõ∏Èóú |\n\n---\n\n## Áí∞Â¢ÉËÆäÊï∏\n\n### ÂâçÁ´Ø (.env.development)\n\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\n|---------|------|--------|\n| &#96;VITE_BASE_URL&#96; | API Âü∫Á§éË∑ØÂæë | &#96;/api&#96; |\n| &#96;VITE_PROXY_URL&#96; | ‰ª£ÁêÜÁõÆÊ®ô URL | &#96;https://dev.eigent.ai&#96; |\n| &#96;VITE_USE_LOCAL_PROXY&#96; | ÊòØÂê¶‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ | &#96;true&#96; / &#96;false&#96; |\n\n### ÂæåÁ´Ø (server/.env)\n\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\n|---------|------|--------|\n| &#96;database_url&#96; | PostgreSQL ÈÄ£Á∑öÂ≠ó‰∏≤ | &#96;postgresql://user:pass@host:5432/db&#96; |\n| &#96;url_prefix&#96; | API Ë∑ØÁî±ÂâçÁ∂¥ | &#96;/api&#96; |\n\n---\n\n## Èô§ÈåØÊäÄÂ∑ß\n\n### ÈñãÂïü Electron DevTools\n\nÈñãÁôºÊ®°Âºè‰∏ãËá™ÂãïÈñãÂïüÔºåÊàñ‰ΩøÁî®Âø´Êç∑ÈçµÔºö\n- Windows/Linux: &#96;Ctrl + Shift + I&#96;\n- macOS: &#96;Cmd + Option + I&#96;\n\n### Ê™¢Êü•ÂæåÁ´ØÂÅ•Â∫∑ÁãÄÊÖã\n\n&#96;&#96;&#96;bash\ncurl http://localhost:5001/health\n&#96;&#96;&#96;\n\n### Êü•Áúã Swagger API Êñá‰ª∂\n\nÈñãÂïüÁÄèË¶ΩÂô®Ë®™ÂïèÔºö\n- ÂµåÂÖ•ÂºèÂæåÁ´ØÔºö&#96;http://localhost:5001/docs&#96;\n- Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´ØÔºö&#96;http://localhost:3001/docs&#96;\n\n---\n\n## Áõ∏ÈóúÊñá‰ª∂\n\n- [Â∞àÊ°àÊû∂ÊßãÁ∏ΩË¶Ω](./ARCHITECTURE.md)\n- [ÈñãÁôºÁí∞Â¢ÉË®≠ÁΩÆ](./GETTING_STARTED.md)\n- [ÂæåÁ´Ø API ÂèÉËÄÉ](./BACKEND_API.md)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô®",
            "lineNumber": 106
          },
          {
            "text": "docker compose down",
            "lineNumber": 107
          },
          {
            "lineNumber": 108
          },
          {
            "text": "# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô® + Ë≥áÊñôÂç∑ (ÊÖéÁî®ÔºÅÊúÉÂà™Èô§Ë≥áÊñô)",
            "lineNumber": 109
          },
          {
            "text": "docker compose down -v",
            "lineNumber": 110
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 111
          },
          {
            "lineNumber": 112
          },
          {
            "text": "---",
            "lineNumber": 113
          },
          {
            "lineNumber": 114
          },
          {
            "text": "## Git Â∑•‰ΩúÊµÅÁ®ã",
            "lineNumber": 115
          },
          {
            "lineNumber": 116
          },
          {
            "text": "### Â∏∏Áî®Êåá‰ª§",
            "lineNumber": 117
          },
          {
            "lineNumber": 118
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 119
          },
          {
            "text": "# Êü•ÁúãÁãÄÊÖã",
            "lineNumber": 120
          },
          {
            "text": "git status",
            "lineNumber": 121
          },
          {
            "lineNumber": 122
          },
          {
            "text": "# Êü•ÁúãËÆäÊõ¥",
            "lineNumber": 123
          },
          {
            "text": "git diff",
            "lineNumber": 124
          },
          {
            "lineNumber": 125
          },
          {
            "text": "# Êèê‰∫§ËÆäÊõ¥",
            "lineNumber": 126
          },
          {
            "text": "git add .",
            "lineNumber": 127
          },
          {
            "text": "git commit -m \"feat: Êñ∞Â¢ûÂäüËÉΩÊèèËø∞\"",
            "lineNumber": 128
          },
          {
            "lineNumber": 129
          },
          {
            "text": "# Êé®ÈÄÅÂà∞ÈÅ†Á´Ø",
            "lineNumber": 130
          },
          {
            "text": "git push origin feature-branch",
            "lineNumber": 131
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 132
          },
          {
            "lineNumber": 133
          },
          {
            "text": "### Commit Ë®äÊÅØË¶èÁØÑ",
            "lineNumber": 134
          },
          {
            "lineNumber": 135
          },
          {
            "text": "| È°ûÂûã | Ë™™Êòé |",
            "lineNumber": 136
          },
          {
            "text": "|-----|------|",
            "lineNumber": 137
          },
          {
            "text": "| &#96;feat:&#96; | Êñ∞ÂäüËÉΩ |",
            "lineNumber": 138
          },
          {
            "text": "| &#96;fix:&#96; | ÈåØË™§‰øÆÂæ© |",
            "lineNumber": 139
          },
          {
            "text": "| &#96;docs:&#96; | Êñá‰ª∂Êõ¥Êñ∞ |",
            "lineNumber": 140
          },
          {
            "text": "| &#96;style:&#96; | Á®ãÂºèÁ¢ºÊ†ºÂºèË™øÊï¥ |",
            "lineNumber": 141
          },
          {
            "text": "| &#96;refactor:&#96; | ÈáçÊßã |",
            "lineNumber": 142
          },
          {
            "text": "| &#96;test:&#96; | Ê∏¨Ë©¶Áõ∏Èóú |",
            "lineNumber": 143
          },
          {
            "text": "| &#96;chore:&#96; | Âª∫ÁΩÆ/Â∑•ÂÖ∑Áõ∏Èóú |",
            "lineNumber": 144
          },
          {
            "lineNumber": 145
          },
          {
            "text": "---",
            "lineNumber": 146
          },
          {
            "lineNumber": 147
          },
          {
            "text": "## Áí∞Â¢ÉËÆäÊï∏",
            "lineNumber": 148
          },
          {
            "lineNumber": 149
          },
          {
            "text": "### ÂâçÁ´Ø (.env.development)",
            "lineNumber": 150
          },
          {
            "lineNumber": 151
          },
          {
            "text": "| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |",
            "lineNumber": 152
          },
          {
            "text": "|---------|------|--------|",
            "lineNumber": 153
          },
          {
            "text": "| &#96;VITE_BASE_URL&#96; | API Âü∫Á§éË∑ØÂæë | &#96;/api&#96; |",
            "lineNumber": 154
          },
          {
            "text": "| &#96;VITE_PROXY_URL&#96; | ‰ª£ÁêÜÁõÆÊ®ô URL | &#96;https://dev.eigent.ai&#96; |",
            "lineNumber": 155
          },
          {
            "text": "| &#96;VITE_USE_LOCAL_PROXY&#96; | ÊòØÂê¶‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ | &#96;true&#96; / &#96;false&#96; |",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "### ÂæåÁ´Ø (server/.env)",
            "lineNumber": 158
          },
          {
            "lineNumber": 159
          },
          {
            "text": "| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |",
            "lineNumber": 160
          },
          {
            "text": "|---------|------|--------|",
            "lineNumber": 161
          },
          {
            "text": "| &#96;database_url&#96; | PostgreSQL ÈÄ£Á∑öÂ≠ó‰∏≤ | &#96;postgresql://user:pass@host:5432/db&#96; |",
            "lineNumber": 162
          },
          {
            "text": "| &#96;url_prefix&#96; | API Ë∑ØÁî±ÂâçÁ∂¥ | &#96;/api&#96; |",
            "lineNumber": 163
          },
          {
            "lineNumber": 164
          },
          {
            "text": "---",
            "lineNumber": 165
          },
          {
            "lineNumber": 166
          },
          {
            "text": "## Èô§ÈåØÊäÄÂ∑ß",
            "lineNumber": 167
          },
          {
            "lineNumber": 168
          },
          {
            "text": "### ÈñãÂïü Electron DevTools",
            "lineNumber": 169
          },
          {
            "lineNumber": 170
          },
          {
            "text": "ÈñãÁôºÊ®°Âºè‰∏ãËá™ÂãïÈñãÂïüÔºåÊàñ‰ΩøÁî®Âø´Êç∑ÈçµÔºö",
            "lineNumber": 171
          },
          {
            "text": "- Windows/Linux: &#96;Ctrl + Shift + I&#96;",
            "lineNumber": 172
          },
          {
            "text": "- macOS: &#96;Cmd + Option + I&#96;",
            "lineNumber": 173
          },
          {
            "lineNumber": 174
          },
          {
            "text": "### Ê™¢Êü•ÂæåÁ´ØÂÅ•Â∫∑ÁãÄÊÖã",
            "lineNumber": 175
          },
          {
            "lineNumber": 176
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 177
          },
          {
            "text": "curl http://localhost:5001/health",
            "lineNumber": 178
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 179
          },
          {
            "lineNumber": 180
          },
          {
            "text": "### Êü•Áúã Swagger API Êñá‰ª∂",
            "lineNumber": 181
          },
          {
            "lineNumber": 182
          },
          {
            "text": "ÈñãÂïüÁÄèË¶ΩÂô®Ë®™ÂïèÔºö",
            "lineNumber": 183
          },
          {
            "text": "- ÂµåÂÖ•ÂºèÂæåÁ´ØÔºö&#96;http://localhost:5001/docs&#96;",
            "lineNumber": 184
          },
          {
            "text": "- Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´ØÔºö&#96;http://localhost:3001/docs&#96;",
            "lineNumber": 185
          },
          {
            "lineNumber": 186
          },
          {
            "text": "---",
            "lineNumber": 187
          },
          {
            "lineNumber": 188
          },
          {
            "text": "## Áõ∏ÈóúÊñá‰ª∂",
            "lineNumber": 189
          },
          {
            "lineNumber": 190
          },
          {
            "text": "- [Â∞àÊ°àÊû∂ÊßãÁ∏ΩË¶Ω](./ARCHITECTURE.md)",
            "lineNumber": 191
          },
          {
            "text": "- [ÈñãÁôºÁí∞Â¢ÉË®≠ÁΩÆ](./GETTING_STARTED.md)",
            "lineNumber": 192
          },
          {
            "text": "- [ÂæåÁ´Ø API ÂèÉËÄÉ](./BACKEND_API.md)",
            "lineNumber": 193
          }
        ]
      },
      "score": 0.3715862035751343
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\vite.config.ts",
        "range": {
          "startPosition": {
            "line": 11
          },
          "endPosition": {
            "line": 104,
            "column": 1
          }
        },
        "contents": "export default ({ command, mode }) =&gt; {\n\n\n        renderer: {},\n      }),\n    ],\n    server: {\n      open: false,\n      ...(process.env.VSCODE_DEBUG &amp;&amp; (() =&gt; {\n        const url = new URL(pkg.debug.env.VITE_DEV_SERVER_URL)\n        return {\n          host: url.hostname,\n          port: +url.port,\n          proxy: {\n            '/api': {\n              target: env.VITE_PROXY_URL,\n              changeOrigin: true,\n              // rewrite: path =&gt; path.replace(/^\\/api/, ''),\n            },\n          },\n        }\n      })()),\n      clearScreen: false,\n\n    }\n  }\n})\n\nprocess.on('SIGINT', () =&gt; {\n  try {\n    const backend = path.join(__dirname, 'backend')\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 12,
                "column": 1
              },
              "endPosition": {
                "line": 12,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 12,
                "column": 16
              },
              "endPosition": {
                "line": 12,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 12,
                "column": 29
              },
              "endPosition": {
                "line": 13,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default ({ command, mode }) =&gt; {",
            "lineNumber": 12
          },
          {
            "lineNumber": 31
          },
          {
            "lineNumber": 70
          },
          {
            "text": "        renderer: {},",
            "lineNumber": 71
          },
          {
            "text": "      }),",
            "lineNumber": 72
          },
          {
            "text": "    ],",
            "lineNumber": 73
          },
          {
            "text": "    server: {",
            "lineNumber": 74
          },
          {
            "text": "      open: false,",
            "lineNumber": 75
          },
          {
            "text": "      ...(process.env.VSCODE_DEBUG &amp;&amp; (() =&gt; {",
            "lineNumber": 76
          },
          {
            "text": "        const url = new URL(pkg.debug.env.VITE_DEV_SERVER_URL)",
            "lineNumber": 77
          },
          {
            "text": "        return {",
            "lineNumber": 78
          },
          {
            "text": "          host: url.hostname,",
            "lineNumber": 79
          },
          {
            "text": "          port: +url.port,",
            "lineNumber": 80
          },
          {
            "text": "          proxy: {",
            "lineNumber": 81
          },
          {
            "text": "            '/api': {",
            "lineNumber": 82
          },
          {
            "text": "              target: env.VITE_PROXY_URL,",
            "lineNumber": 83
          },
          {
            "text": "              changeOrigin: true,",
            "lineNumber": 84
          },
          {
            "text": "              // rewrite: path =&gt; path.replace(/^\\/api/, ''),",
            "lineNumber": 85
          },
          {
            "text": "            },",
            "lineNumber": 86
          },
          {
            "text": "          },",
            "lineNumber": 87
          },
          {
            "text": "        }",
            "lineNumber": 88
          },
          {
            "text": "      })()),",
            "lineNumber": 89
          },
          {
            "text": "      clearScreen: false,",
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "text": "    }",
            "lineNumber": 92
          },
          {
            "text": "  }",
            "lineNumber": 93
          },
          {
            "text": "})",
            "lineNumber": 94
          },
          {
            "lineNumber": 95
          },
          {
            "text": "process.on('SIGINT', () =&gt; {",
            "lineNumber": 96
          },
          {
            "text": "  try {",
            "lineNumber": 97
          },
          {
            "text": "    const backend = path.join(__dirname, 'backend')",
            "lineNumber": 98
          },
          {
            "text": "}",
            "lineNumber": 105
          }
        ]
      },
      "score": 0.36650216579437256
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\stack\\client.ts",
        "range": {
          "startPosition": {
            "column": 51
          },
          "endPosition": {
            "line": 16,
            "column": 10
          }
        },
        "contents": "import { useNavigate } from \"react-router-dom\";\nimport { hasStackKeys } from \"../lib\";\n\nconst hasSlackKeys = hasStackKeys();\n\nexport const stackClientApp = hasSlackKeys ? new StackClientApp({\n\tprojectId: import.meta.env.VITE_STACK_PROJECT_ID,\n\tpublishableClientKey: import.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY,\n\ttokenStore: \"cookie\",\n\tredirectMethod: {\n\t\tuseNavigate,\n\t},\n\turls: {\n\t\toauthCallback: (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + \"/api/redirect/callback\",\n\t},\n}) : null;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import { useNavigate } from \"react-router-dom\";",
            "lineNumber": 2
          },
          {
            "text": "import { hasStackKeys } from \"../lib\";",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "const hasSlackKeys = hasStackKeys();",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "export const stackClientApp = hasSlackKeys ? new StackClientApp({",
            "lineNumber": 7
          },
          {
            "text": "\tprojectId: import.meta.env.VITE_STACK_PROJECT_ID,",
            "lineNumber": 8
          },
          {
            "text": "\tpublishableClientKey: import.meta.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY,",
            "lineNumber": 9
          },
          {
            "text": "\ttokenStore: \"cookie\",",
            "lineNumber": 10
          },
          {
            "text": "\tredirectMethod: {",
            "lineNumber": 11
          },
          {
            "text": "\t\tuseNavigate,",
            "lineNumber": 12
          },
          {
            "text": "\t},",
            "lineNumber": 13
          },
          {
            "text": "\turls: {",
            "lineNumber": 14
          },
          {
            "text": "\t\toauthCallback: (import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL) + \"/api/redirect/callback\",",
            "lineNumber": 15
          },
          {
            "text": "\t},",
            "lineNumber": 16
          },
          {
            "text": "}) : null;",
            "lineNumber": 17
          }
        ]
      },
      "score": 0.3631165027618408
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 901
          },
          "endPosition": {
            "line": 972
          }
        },
        "contents": "1. Á¢∫Ë™çÁí∞Â¢ÉËÆäÊï∏Ë®≠ÂÆöÔºöÂú® &#96;.env.development&#96; ‰∏≠Ë®≠ÂÆöÔºö\n   &#96;&#96;&#96;bash\n   VITE_USE_LOCAL_PROXY=true\n   VITE_PROXY_URL=http://localhost:3001\n   &#96;&#96;&#96;\n2. ÈáçÊñ∞ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô®ÔºöÁí∞Â¢ÉËÆäÊï∏ËÆäÊõ¥ÂæåÈúÄÈáçÂïüÊâçËÉΩÁîüÊïà„ÄÇ\n3. Ê∏ÖÈô§ÁÄèË¶ΩÂô®Âø´ÂèñÔºöÂøÖË¶ÅÊôÇÊ∏ÖÈô§Âø´ÂèñÔºåÁ¢∫‰øù‰ΩøÁî®Êñ∞ÁöÑË®≠ÂÆö„ÄÇ\n\n‰øÆÊ≠£ÂæåÔºåÁï∂ &#96;VITE_USE_LOCAL_PROXY=true&#96; ÊôÇÔºåÁôªÂÖ•Ë´ãÊ±ÇÊúÉÊ≠£Á¢∫Â∞éÂêë &#96;http://localhost:3001/api/login&#96;ÔºåËÄåÈùû &#96;https://dev.eigent.ai/api/login&#96;„ÄÇ\n\n&#96;&#96;&#96;shellscript\n   VITE_USE_LOCAL_PROXY=true\n   VITE_PROXY_URL=http://localhost:3001\n&#96;&#96;&#96;\n\n---\n\n**User**\n\nmeta.env.DEV ÁöÑÂÄºÂæû‰ΩïËôïÂèñÂæóÔºüÁ®ãÂºèÁ¢ºÂú®Âì™ÔºüË®≠ÂÆöÊ™îÊ°àÊòØÂì™‰∏ÄÂÄãÔºü\nÂ¶Ç‰ΩïÊ∏ÖÈô§ÁÄèË¶ΩÂô®Âø´ÂèñÔºü\n\n---\n\n**Cursor**\n\n\nÊü•Êâæ &#96;import.meta.env.DEV&#96; ÁöÑ‰æÜÊ∫êËàáË®≠ÂÆöÊñπÂºèÔºö\n\n\n\nÊï¥ÁêÜÈÄô‰∏âÂÄãÂïèÈ°åÁöÑÁ≠îÊ°àÔºö\n\n\n\n## 1. &#96;import.meta.env.DEV&#96; ÁöÑÂÄº‰æÜÊ∫ê\n\n### ÂÄºÂæû‰ΩïËôïÂèñÂæó\n&#96;import.meta.env.DEV&#96; ÊòØ Vite ÁöÑÂÖßÂª∫Áí∞Â¢ÉÂ∏∏Êï∏Ôºàbuilt-in constantÔºâÔºåÁî± Vite Âú®Á∑®Ë≠ØÊôÇËá™ÂãïÊ≥®ÂÖ•ÔºåÁÑ°ÈúÄÊâãÂãïË®≠ÂÆö„ÄÇ\n\n- ÈñãÁôºÊ®°ÂºèÔºà&#96;vite dev&#96; Êàñ &#96;npm run dev&#96;ÔºâÔºö&#96;import.meta.env.DEV = true&#96;\n- ÁîüÁî¢Ê®°ÂºèÔºà&#96;vite build&#96;ÔºâÔºö&#96;import.meta.env.DEV = false&#96;\n\n### Á®ãÂºèÁ¢º‰ΩçÁΩÆ\nVite Âú®Á∑®Ë≠ØÊôÇÈÄ≤Ë°åÈùúÊÖãÊõøÊèõÔºåÂéüÂßãÁ¢º‰∏≠‰∏çÊúÉÁúãÂà∞Ë®≠ÂÆö„ÄÇÁõ∏ÈóúÈÖçÁΩÆÂú®Ôºö\n\n&#96;&#96;&#96;12:18:vite.config.ts\nexport default defineConfig(({ command, mode }) =&gt; {\n  rmSync('dist-electron', { recursive: true, force: true })\n\n  const isServe = command === 'serve'\n  const isBuild = command === 'build'\n  const sourcemap = isServe || !!process.env.VSCODE_DEBUG\n  const env = loadEnv(mode, process.cwd(), '')\n&#96;&#96;&#96;\n\n- &#96;command === 'serve'&#96; ÊôÇÔºåVite ÊúÉÂ∞á &#96;import.meta.env.DEV&#96; ÊõøÊèõÁÇ∫ &#96;true&#96;\n- &#96;command === 'build'&#96; ÊôÇÔºåVite ÊúÉÂ∞á &#96;import.meta.env.DEV&#96; ÊõøÊèõÁÇ∫ &#96;false&#96;\n\n### Ë®≠ÂÆöÊ™îÊ°à\nÁí∞Â¢ÉËÆäÊï∏Ê™îÊ°à‰ΩçÊñºÂ∞àÊ°àÊ†πÁõÆÈåÑÔºö\n\n- &#96;.env.development&#96;ÔºàÈñãÁôºÊ®°ÂºèÔºåÂü∑Ë°å &#96;npm run dev&#96; ÊôÇËºâÂÖ•Ôºâ\n- &#96;.env.production&#96;ÔºàÁîüÁî¢Ê®°ÂºèÔºåÂü∑Ë°å &#96;npm run build&#96; ÊôÇËºâÂÖ•Ôºâ\n- &#96;.env&#96;ÔºàÊâÄÊúâÊ®°ÂºèÈÉΩÊúÉËºâÂÖ•Ôºâ\n\nÊ†πÊìöÊñá‰ª∂ÔºåÊáâÁ∑®ËºØ &#96;.env.development&#96;Ôºö\n\n&#96;&#96;&#96;bash\nVITE_BASE_URL=/api\nVITE_PROXY_URL=http://localhost:3001",
        "signatures": {},
        "detailedLines": [
          {
            "text": "1. Á¢∫Ë™çÁí∞Â¢ÉËÆäÊï∏Ë®≠ÂÆöÔºöÂú® &#96;.env.development&#96; ‰∏≠Ë®≠ÂÆöÔºö",
            "lineNumber": 902
          },
          {
            "text": "   &#96;&#96;&#96;bash",
            "lineNumber": 903
          },
          {
            "text": "   VITE_USE_LOCAL_PROXY=true",
            "lineNumber": 904
          },
          {
            "text": "   VITE_PROXY_URL=http://localhost:3001",
            "lineNumber": 905
          },
          {
            "text": "   &#96;&#96;&#96;",
            "lineNumber": 906
          },
          {
            "text": "2. ÈáçÊñ∞ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô®ÔºöÁí∞Â¢ÉËÆäÊï∏ËÆäÊõ¥ÂæåÈúÄÈáçÂïüÊâçËÉΩÁîüÊïà„ÄÇ",
            "lineNumber": 907
          },
          {
            "text": "3. Ê∏ÖÈô§ÁÄèË¶ΩÂô®Âø´ÂèñÔºöÂøÖË¶ÅÊôÇÊ∏ÖÈô§Âø´ÂèñÔºåÁ¢∫‰øù‰ΩøÁî®Êñ∞ÁöÑË®≠ÂÆö„ÄÇ",
            "lineNumber": 908
          },
          {
            "lineNumber": 909
          },
          {
            "text": "‰øÆÊ≠£ÂæåÔºåÁï∂ &#96;VITE_USE_LOCAL_PROXY=true&#96; ÊôÇÔºåÁôªÂÖ•Ë´ãÊ±ÇÊúÉÊ≠£Á¢∫Â∞éÂêë &#96;http://localhost:3001/api/login&#96;ÔºåËÄåÈùû &#96;https://dev.eigent.ai/api/login&#96;„ÄÇ",
            "lineNumber": 910
          },
          {
            "lineNumber": 911
          },
          {
            "text": "&#96;&#96;&#96;shellscript",
            "lineNumber": 912
          },
          {
            "text": "   VITE_USE_LOCAL_PROXY=true",
            "lineNumber": 913
          },
          {
            "text": "   VITE_PROXY_URL=http://localhost:3001",
            "lineNumber": 914
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 915
          },
          {
            "lineNumber": 916
          },
          {
            "text": "---",
            "lineNumber": 917
          },
          {
            "lineNumber": 918
          },
          {
            "text": "**User**",
            "lineNumber": 919
          },
          {
            "lineNumber": 920
          },
          {
            "text": "meta.env.DEV ÁöÑÂÄºÂæû‰ΩïËôïÂèñÂæóÔºüÁ®ãÂºèÁ¢ºÂú®Âì™ÔºüË®≠ÂÆöÊ™îÊ°àÊòØÂì™‰∏ÄÂÄãÔºü",
            "lineNumber": 921
          },
          {
            "text": "Â¶Ç‰ΩïÊ∏ÖÈô§ÁÄèË¶ΩÂô®Âø´ÂèñÔºü",
            "lineNumber": 922
          },
          {
            "lineNumber": 923
          },
          {
            "text": "---",
            "lineNumber": 924
          },
          {
            "lineNumber": 925
          },
          {
            "text": "**Cursor**",
            "lineNumber": 926
          },
          {
            "lineNumber": 927
          },
          {
            "lineNumber": 928
          },
          {
            "text": "Êü•Êâæ &#96;import.meta.env.DEV&#96; ÁöÑ‰æÜÊ∫êËàáË®≠ÂÆöÊñπÂºèÔºö",
            "lineNumber": 929
          },
          {
            "lineNumber": 930
          },
          {
            "lineNumber": 931
          },
          {
            "lineNumber": 932
          },
          {
            "text": "Êï¥ÁêÜÈÄô‰∏âÂÄãÂïèÈ°åÁöÑÁ≠îÊ°àÔºö",
            "lineNumber": 933
          },
          {
            "lineNumber": 934
          },
          {
            "lineNumber": 935
          },
          {
            "lineNumber": 936
          },
          {
            "text": "## 1. &#96;import.meta.env.DEV&#96; ÁöÑÂÄº‰æÜÊ∫ê",
            "lineNumber": 937
          },
          {
            "lineNumber": 938
          },
          {
            "text": "### ÂÄºÂæû‰ΩïËôïÂèñÂæó",
            "lineNumber": 939
          },
          {
            "text": "&#96;import.meta.env.DEV&#96; ÊòØ Vite ÁöÑÂÖßÂª∫Áí∞Â¢ÉÂ∏∏Êï∏Ôºàbuilt-in constantÔºâÔºåÁî± Vite Âú®Á∑®Ë≠ØÊôÇËá™ÂãïÊ≥®ÂÖ•ÔºåÁÑ°ÈúÄÊâãÂãïË®≠ÂÆö„ÄÇ",
            "lineNumber": 940
          },
          {
            "lineNumber": 941
          },
          {
            "text": "- ÈñãÁôºÊ®°ÂºèÔºà&#96;vite dev&#96; Êàñ &#96;npm run dev&#96;ÔºâÔºö&#96;import.meta.env.DEV = true&#96;",
            "lineNumber": 942
          },
          {
            "text": "- ÁîüÁî¢Ê®°ÂºèÔºà&#96;vite build&#96;ÔºâÔºö&#96;import.meta.env.DEV = false&#96;",
            "lineNumber": 943
          },
          {
            "lineNumber": 944
          },
          {
            "text": "### Á®ãÂºèÁ¢º‰ΩçÁΩÆ",
            "lineNumber": 945
          },
          {
            "text": "Vite Âú®Á∑®Ë≠ØÊôÇÈÄ≤Ë°åÈùúÊÖãÊõøÊèõÔºåÂéüÂßãÁ¢º‰∏≠‰∏çÊúÉÁúãÂà∞Ë®≠ÂÆö„ÄÇÁõ∏ÈóúÈÖçÁΩÆÂú®Ôºö",
            "lineNumber": 946
          },
          {
            "lineNumber": 947
          },
          {
            "text": "&#96;&#96;&#96;12:18:vite.config.ts",
            "lineNumber": 948
          },
          {
            "text": "export default defineConfig(({ command, mode }) =&gt; {",
            "lineNumber": 949
          },
          {
            "text": "  rmSync('dist-electron', { recursive: true, force: true })",
            "lineNumber": 950
          },
          {
            "lineNumber": 951
          },
          {
            "text": "  const isServe = command === 'serve'",
            "lineNumber": 952
          },
          {
            "text": "  const isBuild = command === 'build'",
            "lineNumber": 953
          },
          {
            "text": "  const sourcemap = isServe || !!process.env.VSCODE_DEBUG",
            "lineNumber": 954
          },
          {
            "text": "  const env = loadEnv(mode, process.cwd(), '')",
            "lineNumber": 955
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 956
          },
          {
            "lineNumber": 957
          },
          {
            "text": "- &#96;command === 'serve'&#96; ÊôÇÔºåVite ÊúÉÂ∞á &#96;import.meta.env.DEV&#96; ÊõøÊèõÁÇ∫ &#96;true&#96;",
            "lineNumber": 958
          },
          {
            "text": "- &#96;command === 'build'&#96; ÊôÇÔºåVite ÊúÉÂ∞á &#96;import.meta.env.DEV&#96; ÊõøÊèõÁÇ∫ &#96;false&#96;",
            "lineNumber": 959
          },
          {
            "lineNumber": 960
          },
          {
            "text": "### Ë®≠ÂÆöÊ™îÊ°à",
            "lineNumber": 961
          },
          {
            "text": "Áí∞Â¢ÉËÆäÊï∏Ê™îÊ°à‰ΩçÊñºÂ∞àÊ°àÊ†πÁõÆÈåÑÔºö",
            "lineNumber": 962
          },
          {
            "lineNumber": 963
          },
          {
            "text": "- &#96;.env.development&#96;ÔºàÈñãÁôºÊ®°ÂºèÔºåÂü∑Ë°å &#96;npm run dev&#96; ÊôÇËºâÂÖ•Ôºâ",
            "lineNumber": 964
          },
          {
            "text": "- &#96;.env.production&#96;ÔºàÁîüÁî¢Ê®°ÂºèÔºåÂü∑Ë°å &#96;npm run build&#96; ÊôÇËºâÂÖ•Ôºâ",
            "lineNumber": 965
          },
          {
            "text": "- &#96;.env&#96;ÔºàÊâÄÊúâÊ®°ÂºèÈÉΩÊúÉËºâÂÖ•Ôºâ",
            "lineNumber": 966
          },
          {
            "lineNumber": 967
          },
          {
            "text": "Ê†πÊìöÊñá‰ª∂ÔºåÊáâÁ∑®ËºØ &#96;.env.development&#96;Ôºö",
            "lineNumber": 968
          },
          {
            "lineNumber": 969
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 970
          },
          {
            "text": "VITE_BASE_URL=/api",
            "lineNumber": 971
          },
          {
            "text": "VITE_PROXY_URL=http://localhost:3001",
            "lineNumber": 972
          }
        ]
      },
      "score": 0.3514576852321625
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\GETTING_STARTED.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 103
          }
        },
        "contents": "# ÈñãÁôºÁí∞Â¢ÉË®≠ÁΩÆÊåáÂçó\n\n&gt; Êú¨Êñá‰ª∂Ë™™ÊòéÂ¶Ç‰ΩïË®≠ÁΩÆ Eigent ÁöÑÊú¨Âú∞ÈñãÁôºÁí∞Â¢É„ÄÇ\n\n## Á≥ªÁµ±ÈúÄÊ±Ç\n\n| È†ÖÁõÆ | ÁâàÊú¨Ë¶ÅÊ±Ç |\n|-----|---------|\n| Node.js | 18.x - 22.x |\n| Python | 3.12.x |\n| Docker Desktop | ÊúÄÊñ∞Áâà (ÂÉÖÊú¨Âú∞ÈÉ®ÁΩ≤ÈúÄË¶Å) |\n| ‰ΩúÊ•≠Á≥ªÁµ± | Windows 10+, macOS 10.15+, Linux |\n\n---\n\n## Âø´ÈÄüÈñãÂßã\n\n### 1. Cloud-Connected Ê®°ÂºèÔºàÊé®Ëñ¶Êñ∞ÊâãÔºâ\n\nÊ≠§Ê®°ÂºèÈÄ£Êé• Eigent Èõ≤Á´ØÊúçÂãôÔºåÁÑ°ÈúÄË®≠ÂÆöË≥áÊñôÂ∫´„ÄÇ\n\n&#96;&#96;&#96;bash\n# Ë§áË£ΩÂ∞àÊ°à\ngit clone https://github.com/eigent-ai/eigent.git\ncd eigent\n\n# ÂÆâË£ù‰æùË≥¥\nnpm install\n\n# ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô®\nnpm run dev\n&#96;&#96;&#96;\n\n**Â∏≥ËôüÂèñÂæó**ÔºöÂâçÂæÄ [eigent.ai/signup](https://www.eigent.ai/signup) Ë®ªÂÜä„ÄÇ\n\n---\n\n### 2. Local Deployment Ê®°ÂºèÔºàÂÆåÂÖ®Èõ¢Á∑öÔºâ\n\nÊ≠§Ê®°ÂºèÂÆåÂÖ®Âú®Êú¨Âú∞ÈÅãË°åÔºåË≥áÊñô‰∏çÊúÉ‰∏äÂÇ≥Èõ≤Á´Ø„ÄÇ\n\n#### Ê≠•È©ü 1ÔºöÂïüÂãïÊú¨Âú∞ÂæåÁ´Ø\n\n&#96;&#96;&#96;bash\ncd server\n\n# Ë§áË£ΩÁí∞Â¢ÉËÆäÊï∏ÁØÑÊú¨\ncp .env.example .env\n\n# ‰ΩøÁî® Docker ÂïüÂãïÂæåÁ´ØÊúçÂãô\ndocker compose up -d\n&#96;&#96;&#96;\n\nÊúçÂãôÂïüÂãïÂæåÔºö\n- API ÊúçÂãôÔºöhttp://localhost:3001\n- API Êñá‰ª∂Ôºöhttp://localhost:3001/docs\n- PostgreSQLÔºölocalhost:5432\n\n#### Ê≠•È©ü 2Ôºö‰øÆÊîπÂâçÁ´ØÁí∞Â¢ÉËÆäÊï∏\n\nÁ∑®ËºØ &#96;.env.development&#96;Ôºö\n\n&#96;&#96;&#96;bash\nVITE_BASE_URL=/api\nVITE_PROXY_URL=http://localhost:3001\nVITE_USE_LOCAL_PROXY=true\n&#96;&#96;&#96;\n\n#### Ê≠•È©ü 3ÔºöÂïüÂãïÂâçÁ´Ø\n\n&#96;&#96;&#96;bash\nnpm install\nnpm run dev\n&#96;&#96;&#96;\n\n#### Ê≠•È©ü 4ÔºöË®ªÂÜäÂ∏≥Ëôü\n\n1. ÊáâÁî®ÂïüÂãïÂæåÔºåÈªûÊìä„ÄåSign Up„Äç\n2. Â°´ÂØ´ Email ÂíåÂØÜÁ¢ºÔºàËá≥Â∞ë 8 Â≠óÂÖÉÔºâ\n3. ÂÆåÊàêË®ªÂÜäÂæåÁôªÂÖ•\n\n---\n\n## ÁôªÂÖ•ÊµÅÁ®ãË™™Êòé\n\n### ÊîØÊè¥ÁöÑÁôªÂÖ•ÊñπÂºè\n\n| Ê®°Âºè | Email + ÂØÜÁ¢º | Google OAuth | GitHub OAuth |\n|-----|:-----------:|:------------:|:------------:|\n| Cloud-Connected | ‚úÖ | ‚úÖ | ‚úÖ |\n| Local Deployment | ‚úÖ | ‚ùå | ‚ùå |\n\n### Á®ãÂºèÁ¢º‰ΩçÁΩÆ\n\n| ÂäüËÉΩ | Ê™îÊ°àË∑ØÂæë |\n|-----|---------|\n| ÁôªÂÖ•È†ÅÈù¢ | &#96;src/pages/Login.tsx&#96; |\n| Ë®ªÂÜäÈ†ÅÈù¢ | &#96;src/pages/SignUp.tsx&#96; |\n| HTTP Ë´ãÊ±Ç | &#96;src/api/http.ts&#96; |\n| Ë™çË≠âÁãÄÊÖã | &#96;src/store/authStore.ts&#96; |\n| Ë∑ØÁî±‰øùË≠∑ | &#96;src/routers/index.tsx&#96; |\n| Êú¨Âú∞ÁôªÂÖ• API | &#96;server/app/controller/user/login_controller.py&#96; |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# ÈñãÁôºÁí∞Â¢ÉË®≠ÁΩÆÊåáÂçó",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "&gt; Êú¨Êñá‰ª∂Ë™™ÊòéÂ¶Ç‰ΩïË®≠ÁΩÆ Eigent ÁöÑÊú¨Âú∞ÈñãÁôºÁí∞Â¢É„ÄÇ",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "## Á≥ªÁµ±ÈúÄÊ±Ç",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "| È†ÖÁõÆ | ÁâàÊú¨Ë¶ÅÊ±Ç |",
            "lineNumber": 7
          },
          {
            "text": "|-----|---------|",
            "lineNumber": 8
          },
          {
            "text": "| Node.js | 18.x - 22.x |",
            "lineNumber": 9
          },
          {
            "text": "| Python | 3.12.x |",
            "lineNumber": 10
          },
          {
            "text": "| Docker Desktop | ÊúÄÊñ∞Áâà (ÂÉÖÊú¨Âú∞ÈÉ®ÁΩ≤ÈúÄË¶Å) |",
            "lineNumber": 11
          },
          {
            "text": "| ‰ΩúÊ•≠Á≥ªÁµ± | Windows 10+, macOS 10.15+, Linux |",
            "lineNumber": 12
          },
          {
            "lineNumber": 13
          },
          {
            "text": "---",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "## Âø´ÈÄüÈñãÂßã",
            "lineNumber": 16
          },
          {
            "lineNumber": 17
          },
          {
            "text": "### 1. Cloud-Connected Ê®°ÂºèÔºàÊé®Ëñ¶Êñ∞ÊâãÔºâ",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "Ê≠§Ê®°ÂºèÈÄ£Êé• Eigent Èõ≤Á´ØÊúçÂãôÔºåÁÑ°ÈúÄË®≠ÂÆöË≥áÊñôÂ∫´„ÄÇ",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 22
          },
          {
            "text": "# Ë§áË£ΩÂ∞àÊ°à",
            "lineNumber": 23
          },
          {
            "text": "git clone https://github.com/eigent-ai/eigent.git",
            "lineNumber": 24
          },
          {
            "text": "cd eigent",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "# ÂÆâË£ù‰æùË≥¥",
            "lineNumber": 27
          },
          {
            "text": "npm install",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "# ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô®",
            "lineNumber": 30
          },
          {
            "text": "npm run dev",
            "lineNumber": 31
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 32
          },
          {
            "lineNumber": 33
          },
          {
            "text": "**Â∏≥ËôüÂèñÂæó**ÔºöÂâçÂæÄ [eigent.ai/signup](https://www.eigent.ai/signup) Ë®ªÂÜä„ÄÇ",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "---",
            "lineNumber": 36
          },
          {
            "lineNumber": 37
          },
          {
            "text": "### 2. Local Deployment Ê®°ÂºèÔºàÂÆåÂÖ®Èõ¢Á∑öÔºâ",
            "lineNumber": 38
          },
          {
            "lineNumber": 39
          },
          {
            "text": "Ê≠§Ê®°ÂºèÂÆåÂÖ®Âú®Êú¨Âú∞ÈÅãË°åÔºåË≥áÊñô‰∏çÊúÉ‰∏äÂÇ≥Èõ≤Á´Ø„ÄÇ",
            "lineNumber": 40
          },
          {
            "lineNumber": 41
          },
          {
            "text": "#### Ê≠•È©ü 1ÔºöÂïüÂãïÊú¨Âú∞ÂæåÁ´Ø",
            "lineNumber": 42
          },
          {
            "lineNumber": 43
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 44
          },
          {
            "text": "cd server",
            "lineNumber": 45
          },
          {
            "lineNumber": 46
          },
          {
            "text": "# Ë§áË£ΩÁí∞Â¢ÉËÆäÊï∏ÁØÑÊú¨",
            "lineNumber": 47
          },
          {
            "text": "cp .env.example .env",
            "lineNumber": 48
          },
          {
            "lineNumber": 49
          },
          {
            "text": "# ‰ΩøÁî® Docker ÂïüÂãïÂæåÁ´ØÊúçÂãô",
            "lineNumber": 50
          },
          {
            "text": "docker compose up -d",
            "lineNumber": 51
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "ÊúçÂãôÂïüÂãïÂæåÔºö",
            "lineNumber": 54
          },
          {
            "text": "- API ÊúçÂãôÔºöhttp://localhost:3001",
            "lineNumber": 55
          },
          {
            "text": "- API Êñá‰ª∂Ôºöhttp://localhost:3001/docs",
            "lineNumber": 56
          },
          {
            "text": "- PostgreSQLÔºölocalhost:5432",
            "lineNumber": 57
          },
          {
            "lineNumber": 58
          },
          {
            "text": "#### Ê≠•È©ü 2Ôºö‰øÆÊîπÂâçÁ´ØÁí∞Â¢ÉËÆäÊï∏",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "Á∑®ËºØ &#96;.env.development&#96;Ôºö",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 63
          },
          {
            "text": "VITE_BASE_URL=/api",
            "lineNumber": 64
          },
          {
            "text": "VITE_PROXY_URL=http://localhost:3001",
            "lineNumber": 65
          },
          {
            "text": "VITE_USE_LOCAL_PROXY=true",
            "lineNumber": 66
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "#### Ê≠•È©ü 3ÔºöÂïüÂãïÂâçÁ´Ø",
            "lineNumber": 69
          },
          {
            "lineNumber": 70
          },
          {
            "text": "&#96;&#96;&#96;bash",
            "lineNumber": 71
          },
          {
            "text": "npm install",
            "lineNumber": 72
          },
          {
            "text": "npm run dev",
            "lineNumber": 73
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 74
          },
          {
            "lineNumber": 75
          },
          {
            "text": "#### Ê≠•È©ü 4ÔºöË®ªÂÜäÂ∏≥Ëôü",
            "lineNumber": 76
          },
          {
            "lineNumber": 77
          },
          {
            "text": "1. ÊáâÁî®ÂïüÂãïÂæåÔºåÈªûÊìä„ÄåSign Up„Äç",
            "lineNumber": 78
          },
          {
            "text": "2. Â°´ÂØ´ Email ÂíåÂØÜÁ¢ºÔºàËá≥Â∞ë 8 Â≠óÂÖÉÔºâ",
            "lineNumber": 79
          },
          {
            "text": "3. ÂÆåÊàêË®ªÂÜäÂæåÁôªÂÖ•",
            "lineNumber": 80
          },
          {
            "lineNumber": 81
          },
          {
            "text": "---",
            "lineNumber": 82
          },
          {
            "lineNumber": 83
          },
          {
            "text": "## ÁôªÂÖ•ÊµÅÁ®ãË™™Êòé",
            "lineNumber": 84
          },
          {
            "lineNumber": 85
          },
          {
            "text": "### ÊîØÊè¥ÁöÑÁôªÂÖ•ÊñπÂºè",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "| Ê®°Âºè | Email + ÂØÜÁ¢º | Google OAuth | GitHub OAuth |",
            "lineNumber": 88
          },
          {
            "text": "|-----|:-----------:|:------------:|:------------:|",
            "lineNumber": 89
          },
          {
            "text": "| Cloud-Connected | ‚úÖ | ‚úÖ | ‚úÖ |",
            "lineNumber": 90
          },
          {
            "text": "| Local Deployment | ‚úÖ | ‚ùå | ‚ùå |",
            "lineNumber": 91
          },
          {
            "lineNumber": 92
          },
          {
            "text": "### Á®ãÂºèÁ¢º‰ΩçÁΩÆ",
            "lineNumber": 93
          },
          {
            "lineNumber": 94
          },
          {
            "text": "| ÂäüËÉΩ | Ê™îÊ°àË∑ØÂæë |",
            "lineNumber": 95
          },
          {
            "text": "|-----|---------|",
            "lineNumber": 96
          },
          {
            "text": "| ÁôªÂÖ•È†ÅÈù¢ | &#96;src/pages/Login.tsx&#96; |",
            "lineNumber": 97
          },
          {
            "text": "| Ë®ªÂÜäÈ†ÅÈù¢ | &#96;src/pages/SignUp.tsx&#96; |",
            "lineNumber": 98
          },
          {
            "text": "| HTTP Ë´ãÊ±Ç | &#96;src/api/http.ts&#96; |",
            "lineNumber": 99
          },
          {
            "text": "| Ë™çË≠âÁãÄÊÖã | &#96;src/store/authStore.ts&#96; |",
            "lineNumber": 100
          },
          {
            "text": "| Ë∑ØÁî±‰øùË≠∑ | &#96;src/routers/index.tsx&#96; |",
            "lineNumber": 101
          },
          {
            "text": "| Êú¨Âú∞ÁôªÂÖ• API | &#96;server/app/controller/user/login_controller.py&#96; |",
            "lineNumber": 102
          }
        ]
      },
      "score": 0.3513343930244446
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\pages\\Login.tsx",
        "range": {
          "startPosition": {
            "line": 20
          },
          "endPosition": {
            "line": 465,
            "column": 1
          }
        },
        "contents": "export default function Login() {\n\n\n  const handleReloadBtn = async (type: string) =&gt; {\n    if (!app) {\n      console.error('Stack app not initialized');\n      return;\n    }\n    console.log('handleReloadBtn1', type);\n    const cookies = document.cookie.split('; ');\n    cookies.forEach((cookie) =&gt; {\n      const [name] = cookie.split('=');\n      if (name.startsWith('stack-oauth-outer-')) {\n        document.cookie = &#96;${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/&#96;;\n      }\n    });\n    console.log('handleReloadBtn2', type);\n    await app.signInWithOAuth(type);\n  };\n\n  const handleGetToken = async (code: string) =&gt; {\n    const code_verifier = localStorage.getItem('stack-oauth-outer-');\n    const formData = new URLSearchParams();\n    console.log(\n      'import.meta.env.PROD',\n      import.meta.env.PROD\n        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;\n        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;\n    );\n    formData.append(\n      'redirect_uri',\n      import.meta.env.PROD\n        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;\n        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;\n    );\n    formData.append('code_verifier', code_verifier || '');\n    formData.append('code', code);\n    formData.append('grant_type', 'authorization_code');\n    formData.append('client_id', 'aa49cdd0-318e-46bd-a540-0f1e5f2b391f');\n    formData.append(\n      'client_secret',\n      'pck_t13egrd9ve57tz52kfcd2s4h1zwya5502z43kr5xv5cx8'\n    );\n\n    try {\n      const res = await fetch(\n        'https://api.stack-auth.com/api/v1/auth/oauth/token',\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',\n          },\n          body: formData,\n        }\n      );\n      const data = await res.json(); // parse response data\n      return data.access_token;\n    } catch (error) {\n      console.error(error);\n      setIsLoading(false);\n    }\n  };\n\n  const handleAuthCode = useCallback\n;\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 21,
                "column": 1
              },
              "endPosition": {
                "line": 21,
                "column": 16
              }
            },
            {
              "startPosition": {
                "line": 21,
                "column": 16
              },
              "endPosition": {
                "line": 22,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export default function Login() {",
            "lineNumber": 21,
            "isSignature": true
          },
          {
            "lineNumber": 180
          },
          {
            "lineNumber": 181
          },
          {
            "text": "  const handleReloadBtn = async (type: string) =&gt; {",
            "lineNumber": 182
          },
          {
            "text": "    if (!app) {",
            "lineNumber": 183
          },
          {
            "text": "      console.error('Stack app not initialized');",
            "lineNumber": 184
          },
          {
            "text": "      return;",
            "lineNumber": 185
          },
          {
            "text": "    }",
            "lineNumber": 186
          },
          {
            "text": "    console.log('handleReloadBtn1', type);",
            "lineNumber": 187
          },
          {
            "text": "    const cookies = document.cookie.split('; ');",
            "lineNumber": 188
          },
          {
            "text": "    cookies.forEach((cookie) =&gt; {",
            "lineNumber": 189
          },
          {
            "text": "      const [name] = cookie.split('=');",
            "lineNumber": 190
          },
          {
            "text": "      if (name.startsWith('stack-oauth-outer-')) {",
            "lineNumber": 191
          },
          {
            "text": "        document.cookie = &#96;${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/&#96;;",
            "lineNumber": 192
          },
          {
            "text": "      }",
            "lineNumber": 193
          },
          {
            "text": "    });",
            "lineNumber": 194
          },
          {
            "text": "    console.log('handleReloadBtn2', type);",
            "lineNumber": 195
          },
          {
            "text": "    await app.signInWithOAuth(type);",
            "lineNumber": 196
          },
          {
            "text": "  };",
            "lineNumber": 197
          },
          {
            "lineNumber": 198
          },
          {
            "text": "  const handleGetToken = async (code: string) =&gt; {",
            "lineNumber": 199
          },
          {
            "text": "    const code_verifier = localStorage.getItem('stack-oauth-outer-');",
            "lineNumber": 200
          },
          {
            "text": "    const formData = new URLSearchParams();",
            "lineNumber": 201
          },
          {
            "text": "    console.log(",
            "lineNumber": 202
          },
          {
            "text": "      'import.meta.env.PROD',",
            "lineNumber": 203
          },
          {
            "text": "      import.meta.env.PROD",
            "lineNumber": 204
          },
          {
            "text": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;",
            "lineNumber": 205
          },
          {
            "text": "        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;",
            "lineNumber": 206
          },
          {
            "text": "    );",
            "lineNumber": 207
          },
          {
            "text": "    formData.append(",
            "lineNumber": 208
          },
          {
            "text": "      'redirect_uri',",
            "lineNumber": 209
          },
          {
            "text": "      import.meta.env.PROD",
            "lineNumber": 210
          },
          {
            "text": "        ? &#96;${import.meta.env.VITE_BASE_URL}/api/redirect/callback&#96;",
            "lineNumber": 211
          },
          {
            "text": "        : &#96;${import.meta.env.VITE_PROXY_URL}/api/redirect/callback&#96;",
            "lineNumber": 212
          },
          {
            "text": "    );",
            "lineNumber": 213
          },
          {
            "text": "    formData.append('code_verifier', code_verifier || '');",
            "lineNumber": 214
          },
          {
            "text": "    formData.append('code', code);",
            "lineNumber": 215
          },
          {
            "text": "    formData.append('grant_type', 'authorization_code');",
            "lineNumber": 216
          },
          {
            "text": "    formData.append('client_id', 'aa49cdd0-318e-46bd-a540-0f1e5f2b391f');",
            "lineNumber": 217
          },
          {
            "text": "    formData.append(",
            "lineNumber": 218
          },
          {
            "text": "      'client_secret',",
            "lineNumber": 219
          },
          {
            "text": "      'pck_t13egrd9ve57tz52kfcd2s4h1zwya5502z43kr5xv5cx8'",
            "lineNumber": 220
          },
          {
            "text": "    );",
            "lineNumber": 221
          },
          {
            "lineNumber": 222
          },
          {
            "text": "    try {",
            "lineNumber": 223
          },
          {
            "text": "      const res = await fetch(",
            "lineNumber": 224
          },
          {
            "text": "        'https://api.stack-auth.com/api/v1/auth/oauth/token',",
            "lineNumber": 225
          },
          {
            "text": "        {",
            "lineNumber": 226
          },
          {
            "text": "          method: 'POST',",
            "lineNumber": 227
          },
          {
            "text": "          headers: {",
            "lineNumber": 228
          },
          {
            "text": "            'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',",
            "lineNumber": 229
          },
          {
            "text": "          },",
            "lineNumber": 230
          },
          {
            "text": "          body: formData,",
            "lineNumber": 231
          },
          {
            "text": "        }",
            "lineNumber": 232
          },
          {
            "text": "      );",
            "lineNumber": 233
          },
          {
            "text": "      const data = await res.json(); // parse response data",
            "lineNumber": 234
          },
          {
            "text": "      return data.access_token;",
            "lineNumber": 235
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 236
          },
          {
            "text": "      console.error(error);",
            "lineNumber": 237
          },
          {
            "text": "      setIsLoading(false);",
            "lineNumber": 238
          },
          {
            "text": "    }",
            "lineNumber": 239
          },
          {
            "text": "  };",
            "lineNumber": 240
          },
          {
            "lineNumber": 241
          },
          {
            "text": "  const handleAuthCode = useCallback",
            "lineNumber": 242
          },
          {
            "text": ";",
            "lineNumber": 255
          },
          {
            "text": "}",
            "lineNumber": 466,
            "isSignature": true
          }
        ]
      },
      "score": 0.3486059904098511
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nconsole.log('start fastapi')\n    const uv_path = await getBinaryPath('uv')\n    const backendPath = getBackendPath()\n    const userData = app.getPath('userData');\n    const currentVersion = app.getVersion();\n    const venvPath = getVenvPath(currentVersion);\n    console.log('userData', userData)\n    console.log('Using venv path:', venvPath)\n    // Try to find an available port, with aggressive cleanup if needed\n    let port: number;\n    const portFile = path.join(userData, 'port.txt');\n    if (fs.existsSync(portFile)) {\n        port = parseInt(fs.readFileSync(portFile, 'utf-8'));\n        log.info(&#96;Found port from file: ${port}&#96;);\n        await killProcessOnPort(port);\n    }\n    try {\n        port = await findAvailablePort(5001);\n        fs.writeFileSync(portFile, port.toString());\n        log.info(&#96;Found available port: ${port}&#96;);\n    } catch (error) {\n        log.error('Failed to find available port, attempting cleanup...');\n\n        // Last resort: try to kill all processes in the range\n        for (let p = 5001; p &lt;= 5050; p++) {\n            await killProcessOnPort(p);\n        }\n\n        // Try once more\n        port = await findAvailablePort(5001);\n    }\n\n    if (setPort) {\n        setPort(port);\n    }\n\n    const npmCacheDir = path.join(venvPath, '.npm-cache');\n    if (!fs.existsSync(npmCacheDir)) {\n        fs.mkdirSync(npmCacheDir, { recursive: true });\n    }\n\n    const uvEnv = getUvEnv(currentVersion);\n    const env = {\n        ...process.env,\n        ...uvEnv,\n        SERVER_URL: \"https://dev.eigent.ai/api\",\n        PYTHONIOENCODING: 'utf-8',\n        PYTHONUNBUFFERED: '1',\n        npm_config_cache: npmCacheDir,\n    }\n\n    const displayFilteredLogs = (data: String) =&gt;\n\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "console.log('start fastapi')",
            "lineNumber": 121
          },
          {
            "text": "    const uv_path = await getBinaryPath('uv')",
            "lineNumber": 122
          },
          {
            "text": "    const backendPath = getBackendPath()",
            "lineNumber": 123
          },
          {
            "text": "    const userData = app.getPath('userData');",
            "lineNumber": 124
          },
          {
            "text": "    const currentVersion = app.getVersion();",
            "lineNumber": 125
          },
          {
            "text": "    const venvPath = getVenvPath(currentVersion);",
            "lineNumber": 126
          },
          {
            "text": "    console.log('userData', userData)",
            "lineNumber": 127
          },
          {
            "text": "    console.log('Using venv path:', venvPath)",
            "lineNumber": 128
          },
          {
            "text": "    // Try to find an available port, with aggressive cleanup if needed",
            "lineNumber": 129
          },
          {
            "text": "    let port: number;",
            "lineNumber": 130
          },
          {
            "text": "    const portFile = path.join(userData, 'port.txt');",
            "lineNumber": 131
          },
          {
            "text": "    if (fs.existsSync(portFile)) {",
            "lineNumber": 132
          },
          {
            "text": "        port = parseInt(fs.readFileSync(portFile, 'utf-8'));",
            "lineNumber": 133
          },
          {
            "text": "        log.info(&#96;Found port from file: ${port}&#96;);",
            "lineNumber": 134
          },
          {
            "text": "        await killProcessOnPort(port);",
            "lineNumber": 135
          },
          {
            "text": "    }",
            "lineNumber": 136
          },
          {
            "text": "    try {",
            "lineNumber": 137
          },
          {
            "text": "        port = await findAvailablePort(5001);",
            "lineNumber": 138
          },
          {
            "text": "        fs.writeFileSync(portFile, port.toString());",
            "lineNumber": 139
          },
          {
            "text": "        log.info(&#96;Found available port: ${port}&#96;);",
            "lineNumber": 140
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 141
          },
          {
            "text": "        log.error('Failed to find available port, attempting cleanup...');",
            "lineNumber": 142
          },
          {
            "lineNumber": 143
          },
          {
            "text": "        // Last resort: try to kill all processes in the range",
            "lineNumber": 144
          },
          {
            "text": "        for (let p = 5001; p &lt;= 5050; p++) {",
            "lineNumber": 145
          },
          {
            "text": "            await killProcessOnPort(p);",
            "lineNumber": 146
          },
          {
            "text": "        }",
            "lineNumber": 147
          },
          {
            "lineNumber": 148
          },
          {
            "text": "        // Try once more",
            "lineNumber": 149
          },
          {
            "text": "        port = await findAvailablePort(5001);",
            "lineNumber": 150
          },
          {
            "text": "    }",
            "lineNumber": 151
          },
          {
            "lineNumber": 152
          },
          {
            "text": "    if (setPort) {",
            "lineNumber": 153
          },
          {
            "text": "        setPort(port);",
            "lineNumber": 154
          },
          {
            "text": "    }",
            "lineNumber": 155
          },
          {
            "lineNumber": 156
          },
          {
            "text": "    const npmCacheDir = path.join(venvPath, '.npm-cache');",
            "lineNumber": 157
          },
          {
            "text": "    if (!fs.existsSync(npmCacheDir)) {",
            "lineNumber": 158
          },
          {
            "text": "        fs.mkdirSync(npmCacheDir, { recursive: true });",
            "lineNumber": 159
          },
          {
            "text": "    }",
            "lineNumber": 160
          },
          {
            "lineNumber": 161
          },
          {
            "text": "    const uvEnv = getUvEnv(currentVersion);",
            "lineNumber": 162
          },
          {
            "text": "    const env = {",
            "lineNumber": 163
          },
          {
            "text": "        ...process.env,",
            "lineNumber": 164
          },
          {
            "text": "        ...uvEnv,",
            "lineNumber": 165
          },
          {
            "text": "        SERVER_URL: \"https://dev.eigent.ai/api\",",
            "lineNumber": 166
          },
          {
            "text": "        PYTHONIOENCODING: 'utf-8',",
            "lineNumber": 167
          },
          {
            "text": "        PYTHONUNBUFFERED: '1',",
            "lineNumber": 168
          },
          {
            "text": "        npm_config_cache: npmCacheDir,",
            "lineNumber": 169
          },
          {
            "text": "    }",
            "lineNumber": 170
          },
          {
            "lineNumber": 171
          },
          {
            "text": "    const displayFilteredLogs = (data: String) =&gt;",
            "lineNumber": 172
          },
          {
            "lineNumber": 190
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.3369826078414917
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\nasync (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n // Default to current store\n\t\t\t/**\n\t\t\t * Replay creates its own chatStore for each task with replayProject\n\t\t\t */\n\t\t\tif (project_id &amp;&amp; type !== \"replay\") {\n\t\t\t\tconsole.log(\"Creating a new Chat Instance for current project on end\")\n\t\t\t\tconst newChatResult = projectStore.appendInitChatStore(project_id);\n\n\t\t\t\tif (newChatResult) {\n\t\t\t\t\tnewTaskId = newChatResult.taskId;\n\t\t\t\t\ttargetChatStore = newChatResult.chatStore;\n\t\t\t\t\ttargetChatStore.getState().setIsPending(newTaskId, true);\n\n\t\t\t\t\t//From handleSend if message is given\n\t\t\t\t\t// Add the message to the new chatStore if provided\n\t\t\t\t\tif (messageContent) {\n\t\t\t\t\t\ttargetChatStore.getState().addMessages(newTaskId, {\n\t\t\t\t\t\t\tid: generateUniqueId(),\n\t\t\t\t\t\t\trole: \"user\",\n\t\t\t\t\t\t\tcontent: messageContent,\n\t\t\t\t\t\t\tattaches: messageAttaches || [],\n\t\t\t\t\t\t});\n\t\t\t\t\t\ttargetChatStore.getState().setHasMessages(newTaskId, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst base_Url = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL\n\t\t\tconst api = type == 'share' ?\n\t\t\t\t&#96;${base_Url}/api/chat/share/playback/${shareToken}?delay_time=${delayTime}&#96;\n\t\t\t\t: type == 'replay' ?\n\t\t\t\t\t&#96;${base_Url}/api/chat/steps/playback/${newTaskId}?delay_time=${delayTime}&#96;\n\t\t\t\t\t: &#96;${baseURL}/chat&#96;\n\n\t\t\tconst { tasks } = get()\n\t\t\tlet historyId: string | null = projectStore.getHistoryId(project_id);\n\t\t\tlet snapshots: any = [];\n\t\t\tlet skipFirstConfirm = true;\n\n\t\t\t// replay or share request\n\t\t\tif (type) {\n\t\t\t\tconst res = await proxyFetchGet(&#96;/api/chat/snapshots&#96;, {\n\t\t\t\t\tapi_task_id: taskId\n\t\t\t\t});\n\t\t\t\tif (res) {\n\t\t\t\t\tsnapshots = [...new Map(res.map((item: any) =&gt; [item.camel_task_id, item])).values()];\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// get current model\n\t\t\tlet apiModel = {\n\t\t\t\tapi_key: '',\n\t\t\t\tmodel_type: '',\n\t\t\t\tmodel_platform: '',\n\t\t\t\tapi_url: '',\n\t\t\t\textra_params: {}\n\t\t\t}\n\t\t\tif (modelType === 'custom' || modelType === 'local') {\n\t\t\t\tconst res = await proxyFetchGet('/api/providers', {\n\t\t\t\t\tprefer: true\n\t\t\t\t});\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            },
            {
              "startPosition": {
                "line": 331,
                "column": 14
              },
              "endPosition": {
                "line": 332,
                "column": 4
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": "async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "text": " // Default to current store",
            "lineNumber": 368
          },
          {
            "text": "\t\t\t/**",
            "lineNumber": 369
          },
          {
            "text": "\t\t\t * Replay creates its own chatStore for each task with replayProject",
            "lineNumber": 370
          },
          {
            "text": "\t\t\t */",
            "lineNumber": 371
          },
          {
            "text": "\t\t\tif (project_id &amp;&amp; type !== \"replay\") {",
            "lineNumber": 372
          },
          {
            "text": "\t\t\t\tconsole.log(\"Creating a new Chat Instance for current project on end\")",
            "lineNumber": 373
          },
          {
            "text": "\t\t\t\tconst newChatResult = projectStore.appendInitChatStore(project_id);",
            "lineNumber": 374
          },
          {
            "lineNumber": 375
          },
          {
            "text": "\t\t\t\tif (newChatResult) {",
            "lineNumber": 376
          },
          {
            "text": "\t\t\t\t\tnewTaskId = newChatResult.taskId;",
            "lineNumber": 377
          },
          {
            "text": "\t\t\t\t\ttargetChatStore = newChatResult.chatStore;",
            "lineNumber": 378
          },
          {
            "text": "\t\t\t\t\ttargetChatStore.getState().setIsPending(newTaskId, true);",
            "lineNumber": 379
          },
          {
            "lineNumber": 380
          },
          {
            "text": "\t\t\t\t\t//From handleSend if message is given",
            "lineNumber": 381
          },
          {
            "text": "\t\t\t\t\t// Add the message to the new chatStore if provided",
            "lineNumber": 382
          },
          {
            "text": "\t\t\t\t\tif (messageContent) {",
            "lineNumber": 383
          },
          {
            "text": "\t\t\t\t\t\ttargetChatStore.getState().addMessages(newTaskId, {",
            "lineNumber": 384
          },
          {
            "text": "\t\t\t\t\t\t\tid: generateUniqueId(),",
            "lineNumber": 385
          },
          {
            "text": "\t\t\t\t\t\t\trole: \"user\",",
            "lineNumber": 386
          },
          {
            "text": "\t\t\t\t\t\t\tcontent: messageContent,",
            "lineNumber": 387
          },
          {
            "text": "\t\t\t\t\t\t\tattaches: messageAttaches || [],",
            "lineNumber": 388
          },
          {
            "text": "\t\t\t\t\t\t});",
            "lineNumber": 389
          },
          {
            "text": "\t\t\t\t\t\ttargetChatStore.getState().setHasMessages(newTaskId, true);",
            "lineNumber": 390
          },
          {
            "text": "\t\t\t\t\t}",
            "lineNumber": 391
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 392
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 393
          },
          {
            "lineNumber": 394
          },
          {
            "text": "\t\t\tconst base_Url = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL",
            "lineNumber": 395
          },
          {
            "text": "\t\t\tconst api = type == 'share' ?",
            "lineNumber": 396
          },
          {
            "text": "\t\t\t\t&#96;${base_Url}/api/chat/share/playback/${shareToken}?delay_time=${delayTime}&#96;",
            "lineNumber": 397
          },
          {
            "text": "\t\t\t\t: type == 'replay' ?",
            "lineNumber": 398
          },
          {
            "text": "\t\t\t\t\t&#96;${base_Url}/api/chat/steps/playback/${newTaskId}?delay_time=${delayTime}&#96;",
            "lineNumber": 399
          },
          {
            "text": "\t\t\t\t\t: &#96;${baseURL}/chat&#96;",
            "lineNumber": 400
          },
          {
            "lineNumber": 401
          },
          {
            "text": "\t\t\tconst { tasks } = get()",
            "lineNumber": 402
          },
          {
            "text": "\t\t\tlet historyId: string | null = projectStore.getHistoryId(project_id);",
            "lineNumber": 403
          },
          {
            "text": "\t\t\tlet snapshots: any = [];",
            "lineNumber": 404
          },
          {
            "text": "\t\t\tlet skipFirstConfirm = true;",
            "lineNumber": 405
          },
          {
            "lineNumber": 406
          },
          {
            "text": "\t\t\t// replay or share request",
            "lineNumber": 407
          },
          {
            "text": "\t\t\tif (type) {",
            "lineNumber": 408
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet(&#96;/api/chat/snapshots&#96;, {",
            "lineNumber": 409
          },
          {
            "text": "\t\t\t\t\tapi_task_id: taskId",
            "lineNumber": 410
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 411
          },
          {
            "text": "\t\t\t\tif (res) {",
            "lineNumber": 412
          },
          {
            "text": "\t\t\t\t\tsnapshots = [...new Map(res.map((item: any) =&gt; [item.camel_task_id, item])).values()];",
            "lineNumber": 413
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 414
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 415
          },
          {
            "lineNumber": 416
          },
          {
            "lineNumber": 417
          },
          {
            "text": "\t\t\t// get current model",
            "lineNumber": 418
          },
          {
            "text": "\t\t\tlet apiModel = {",
            "lineNumber": 419
          },
          {
            "text": "\t\t\t\tapi_key: '',",
            "lineNumber": 420
          },
          {
            "text": "\t\t\t\tmodel_type: '',",
            "lineNumber": 421
          },
          {
            "text": "\t\t\t\tmodel_platform: '',",
            "lineNumber": 422
          },
          {
            "text": "\t\t\t\tapi_url: '',",
            "lineNumber": 423
          },
          {
            "text": "\t\t\t\textra_params: {}",
            "lineNumber": 424
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 425
          },
          {
            "text": "\t\t\tif (modelType === 'custom' || modelType === 'local') {",
            "lineNumber": 426
          },
          {
            "text": "\t\t\t\tconst res = await proxyFetchGet('/api/providers', {",
            "lineNumber": 427
          },
          {
            "text": "\t\t\t\t\tprefer: true",
            "lineNumber": 428
          },
          {
            "text": "\t\t\t\t});",
            "lineNumber": 429
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.3302411139011383
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\lib\\index.ts",
        "range": {
          "startPosition": {
            "line": 63,
            "column": 59
          },
          "endPosition": {
            "line": 81,
            "column": 1
          }
        },
        "contents": "export async function uploadLog(taskId: string, type?: string | undefined) {\n\tif (import.meta.env.VITE_USE_LOCAL_PROXY !== \"true\" &amp;&amp; !type) {\n\t\ttry {\n\t\t\tconst { email, token } = getAuthStore()\n\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL\n\t\t\t\n\t\t\tawait window.electronAPI.uploadLog(\n\t\t\t\temail,\n\t\t\t\ttaskId,\n\t\t\t\tbaseUrl,\n\t\t\t\ttoken\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to upload log:', error);\n\t\t}\n\t}\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export async function uploadLog(taskId: string, type?: string | undefined) {",
            "lineNumber": 66,
            "isSignature": true
          },
          {
            "text": "\tif (import.meta.env.VITE_USE_LOCAL_PROXY !== \"true\" &amp;&amp; !type) {",
            "lineNumber": 67
          },
          {
            "text": "\t\ttry {",
            "lineNumber": 68
          },
          {
            "text": "\t\t\tconst { email, token } = getAuthStore()",
            "lineNumber": 69
          },
          {
            "text": "\t\t\tconst baseUrl = import.meta.env.DEV ? import.meta.env.VITE_PROXY_URL : import.meta.env.VITE_BASE_URL",
            "lineNumber": 70
          },
          {
            "text": "\t\t\t",
            "lineNumber": 71
          },
          {
            "text": "\t\t\tawait window.electronAPI.uploadLog(",
            "lineNumber": 72
          },
          {
            "text": "\t\t\t\temail,",
            "lineNumber": 73
          },
          {
            "text": "\t\t\t\ttaskId,",
            "lineNumber": 74
          },
          {
            "text": "\t\t\t\tbaseUrl,",
            "lineNumber": 75
          },
          {
            "text": "\t\t\t\ttoken",
            "lineNumber": 76
          },
          {
            "text": "\t\t\t);",
            "lineNumber": 77
          },
          {
            "text": "\t\t} catch (error) {",
            "lineNumber": 78
          },
          {
            "text": "\t\t\tconsole.error('Failed to upload log:', error);",
            "lineNumber": 79
          },
          {
            "text": "\t\t}",
            "lineNumber": 80
          },
          {
            "text": "\t}",
            "lineNumber": 81
          },
          {
            "text": "}",
            "lineNumber": 82,
            "isSignature": true
          }
        ]
      },
      "score": 0.32604241371154785
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 231,
            "column": 49
          },
          "endPosition": {
            "line": 274,
            "column": 3
          }
        },
        "contents": "// File upload function with FormData\nexport async function uploadFile(url: string, formData: FormData, headers?: Record&lt;string, string&gt;): Promise&lt;any&gt; {\n  const baseURL = await getProxyBaseURL()\n  const fullUrl = &#96;${baseURL}${url}&#96;\n  const { token } = getAuthStore()\n\n  const requestHeaders: Record&lt;string, string&gt; = {\n    ...headers,\n  }\n\n  // Remove Content-Type header to let browser set it with boundary for FormData\n  if (requestHeaders['Content-Type']) {\n    delete requestHeaders['Content-Type']\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header\n  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      requestHeaders['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: formData,\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\n// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// File upload function with FormData",
            "lineNumber": 234
          },
          {
            "text": "export async function uploadFile(url: string, formData: FormData, headers?: Record&lt;string, string&gt;): Promise&lt;any&gt; {",
            "lineNumber": 235,
            "isSignature": true
          },
          {
            "text": "  const baseURL = await getProxyBaseURL()",
            "lineNumber": 236
          },
          {
            "text": "  const fullUrl = &#96;${baseURL}${url}&#96;",
            "lineNumber": 237
          },
          {
            "text": "  const { token } = getAuthStore()",
            "lineNumber": 238
          },
          {
            "lineNumber": 239
          },
          {
            "text": "  const requestHeaders: Record&lt;string, string&gt; = {",
            "lineNumber": 240
          },
          {
            "text": "    ...headers,",
            "lineNumber": 241
          },
          {
            "text": "  }",
            "lineNumber": 242
          },
          {
            "lineNumber": 243
          },
          {
            "text": "  // Remove Content-Type header to let browser set it with boundary for FormData",
            "lineNumber": 244
          },
          {
            "text": "  if (requestHeaders['Content-Type']) {",
            "lineNumber": 245
          },
          {
            "text": "    delete requestHeaders['Content-Type']",
            "lineNumber": 246
          },
          {
            "text": "  }",
            "lineNumber": 247
          },
          {
            "lineNumber": 248
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 249
          },
          {
            "text": "    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 250
          },
          {
            "text": "  }",
            "lineNumber": 251
          },
          {
            "lineNumber": 252
          },
          {
            "text": "  // Âè™ÊúâÂú®‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÊôÇÊâçË®≠ÂÆö X-Proxy-Target header",
            "lineNumber": 253
          },
          {
            "text": "  if (import.meta.env.DEV &amp;&amp; import.meta.env.VITE_USE_LOCAL_PROXY !== 'true') {",
            "lineNumber": 254
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 255
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 256
          },
          {
            "text": "      requestHeaders['X-Proxy-Target'] = targetUrl",
            "lineNumber": 257
          },
          {
            "text": "    }",
            "lineNumber": 258
          },
          {
            "text": "  }",
            "lineNumber": 259
          },
          {
            "lineNumber": 260
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 261
          },
          {
            "text": "    method: 'POST',",
            "lineNumber": 262
          },
          {
            "text": "    headers: requestHeaders,",
            "lineNumber": 263
          },
          {
            "text": "    body: formData,",
            "lineNumber": 264
          },
          {
            "text": "  }",
            "lineNumber": 265
          },
          {
            "lineNumber": 266
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 267
          },
          {
            "text": "}",
            "lineNumber": 268,
            "isSignature": true
          },
          {
            "lineNumber": 269
          },
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 270
          },
          {
            "lineNumber": 271
          },
          {
            "text": "/**",
            "lineNumber": 272
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 273
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 274
          },
          {
            "text": " */",
            "lineNumber": 275
          }
        ]
      },
      "score": 0.32312530279159546
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** ‚Ä¢ Searched codebase "undefined" ‚Ä¢ **3** results in **1** directory</summary>

Directory: **undefined** (3 files)

| File |
|------|
| `.\.env.development` |
| `.\.env` |
| `.\server\.env.example` |

</details>
</tool-use>

---


Ê™¢Êü•Áí∞Â¢ÉËÆäÊï∏Ê™îÊ°àÂÖßÂÆπÔºö


---

Path 'd:\_Code\_GitHub\eigent-260119\.env.development' exists but is filtered out by globalignore

---

Path 'd:\_Code\_GitHub\eigent-260119\.env' exists but is filtered out by globalignore

---


ÂàÜÊûê `VITE_BASE_URL=/api` ÁöÑÂΩ±ÈüøÔºö


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** ‚Ä¢ Read file: d:\_Code\_GitHub\eigent-260119\src\api\http.ts</summary>

</details>
</tool-use>

---


Ë™™Êòé `VITE_BASE_URL=/api` ÁöÑÂΩ±ÈüøÔºö

- Â∞çÂÅ•Â∫∑Ê™¢Êü•ÁÑ°‰ΩúÁî®Ôºö`checkBackendHealth()` ‰ΩøÁî® `getBaseURL()`ÔºàÂæû IPC ÂèñÂæóÂæåÁ´ØÁ´ØÂè£ÔºâÔºå‰∏çÊúÉËÆÄÂèñ `VITE_BASE_URL`„ÄÇ
- Â∞ç‰ª£ÁêÜË´ãÊ±ÇÊúâÂïèÈ°åÔºö`VITE_BASE_URL` Áî®Êñº `getProxyBaseURL()`ÔºåÊáâÁÇ∫ÂÆåÊï¥Âü∫Á§é URLÔºàÂ¶Ç `https://dev.eigent.ai`ÔºâÔºå‰∏çÊáâÊòØ `/api`„ÄÇËã•Ë®≠ÁÇ∫ `/api`Ôºå‰ª£ÁêÜË´ãÊ±ÇÊúÉËÆäÊàê `/api/api/...`ÔºåÂ∞éËá¥ÈåØË™§„ÄÇ

‰øÆÊ≠£Ôºö
1. Â∞áÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÊîπÁÇ∫ `/api/health`ÔºàÂõ†ÁÇ∫‰Ω†Â∑≤ÈÇÑÂéüÁÇ∫ `/health`Ôºâ„ÄÇ
2. Ë™™Êòé `VITE_BASE_URL` ÁöÑÊ≠£Á¢∫Áî®Ê≥ï„ÄÇ


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** ‚Ä¢ Edit file: d:\_Code\_GitHub\eigent-260119\src\api\http.ts</summary>

</details>

</tool-use>

---


**Á∏ΩÁµêÔºö**

1. `VITE_BASE_URL=/api` Â∞çÂÅ•Â∫∑Ê™¢Êü•Ê≤íÊúâ‰ΩúÁî®
   - ÂÅ•Â∫∑Ê™¢Êü•‰ΩøÁî® `getBaseURL()`ÔºåÁõ¥Êé•Âæû IPC ÂèñÂæóÂæåÁ´ØÁ´ØÂè£
   - ‰∏çÊúÉËÆÄÂèñ `VITE_BASE_URL`

2. `VITE_BASE_URL` ÁöÑÊ≠£Á¢∫Áî®Ê≥ï
   - ÊáâÁÇ∫ÂÆåÊï¥ÁöÑÂü∫Á§é URLÔºå‰æãÂ¶ÇÔºö
     - `VITE_BASE_URL=https://dev.eigent.ai`ÔºàÁîüÁî¢Áí∞Â¢ÉÔºâ
     - `VITE_BASE_URL=http://localhost:3001`ÔºàÊú¨Âú∞ÈñãÁôºÔºâ
   - ‰∏çÊáâÂåÖÂê´ `/api` ÂâçÁ∂¥ÔºåÂõ†ÁÇ∫ÊâÄÊúâ API Ë´ãÊ±ÇÁöÑ URL Â∑≤ÂåÖÂê´ `/api`ÔºàÂ¶Ç `/api/chat/history`Ôºâ

3. Â¶ÇÊûúË®≠ÂÆöÁÇ∫ `VITE_BASE_URL=/api`ÔºåÊúÉÂ∞éËá¥Ôºö
   - ‰ª£ÁêÜË´ãÊ±ÇËÆäÊàê `/api/api/chat/history`ÔºàÈáçË§áÂâçÁ∂¥Ôºâ
   - OAuth callback ËÆäÊàê `/api/api/redirect/callback`ÔºàÈåØË™§Ë∑ØÂæëÔºâ

**Âª∫Ë≠∞Ôºö**
- Â∞á `VITE_BASE_URL` Ë®≠ÁÇ∫ÂÆåÊï¥ÁöÑÂü∫Á§é URLÔºà‰∏çÂê´ `/api`Ôºâ
- ÂÅ•Â∫∑Ê™¢Êü•Â∑≤‰øÆÊ≠£ÁÇ∫‰ΩøÁî® `/api/health`ÔºåËàáÂæåÁ´ØË∑ØÁî±‰∏ÄËá¥

ÂÅ•Â∫∑Ê™¢Êü•ÁèæÂú®ÊáâÂèØÊ≠£Â∏∏ÈÅã‰Ωú„ÄÇ

---

_**User**_

@esbuild (2-314) 

---

_**Agent (model default, mode Agent)**_


ÁµÇÁ´ØÈ°ØÁ§∫‰ªçÂú®‰ΩøÁî® `/health`Ôºå‰ΩÜÂæåÁ´ØË∑ØÁî±ÂâçÁ∂¥ÁÇ∫ `/api`„ÄÇÊ™¢Êü•ÊòØÂê¶ÊúâÂÖ∂‰ªñÂú∞ÊñπÂú®Ë™øÁî®ÂÅ•Â∫∑Ê™¢Êü•ÔºåÊàñÊòØÂê¶ÊúâÁ∑©Â≠òÂïèÈ°åÔºö


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** ‚Ä¢ Read file: d:\_Code\_GitHub\eigent-260119\src\api\http.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "checkBackendHealth|waitForBackendReady|/health",
  "path": "src",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "checkBackendHealth|waitForBackendReady|/health",
    "path": "src",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": "src\\api\\http.ts",
              "matches": [
                {
                  "lineNumber": 276,
                  "content": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {"
                },
                {
                  "lineNumber": 282,
                  "content": "    const res = await fetch(&#96;${baseURL}/api/health&#96;, {"
                },
                {
                  "lineNumber": 301,
                  "content": "export async function waitForBackendReady("
                },
                {
                  "lineNumber": 309,
                  "content": "    const isReady = await checkBackendHealth();"
                }
              ]
            },
            {
              "file": "src\\store\\chatStore.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "import { fetchPost, fetchPut, getBaseURL, proxyFetchPost, proxyFetchPut, proxyFetchGet, uploadFile, fetchDelete, waitForBackendReady } from '@/api/http';"
                },
                {
                  "lineNumber": 335,
                  "content": "\t\t\t\tconst isBackendReady = await waitForBackendReady(15000, 500); // Wait up to 15 seconds"
                }
              ]
            },
            {
              "file": "src\\hooks\\useInstallationSetup.ts",
              "matches": [
                {
                  "lineNumber": 53,
                  "content": "            &#96;http://localhost:${backendPort}/health&#96;"
                },
                {
                  "lineNumber": 99,
                  "content": "              &#96;http://localhost:${backendPort}/health&#96;"
                }
              ]
            }
          ],
          "totalLines": 8,
          "totalMatchedLines": 8
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "where is checkBackendHealth or waitForBackendReady function called",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 292,
            "column": 1
          },
          "endPosition": {
            "line": 321,
            "column": 1
          }
        },
        "contents": "/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */\nexport async function waitForBackendReady(\n  maxWaitMs: number = 10000,\n  retryIntervalMs: number = 500\n): Promise&lt;boolean&gt; {\n  const startTime = Date.now();\n  console.log('[Backend Health Check] Waiting for backend to be ready...');\n\n  while (Date.now() - startTime &lt; maxWaitMs) {\n    const isReady = await checkBackendHealth();\n\n    if (isReady) {\n      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);\n    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));\n  }\n\n  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);\n  return false;\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 295
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 296
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 297
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 298
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 299
          },
          {
            "text": " */",
            "lineNumber": 300
          },
          {
            "text": "export async function waitForBackendReady(",
            "lineNumber": 301,
            "isSignature": true
          },
          {
            "text": "  maxWaitMs: number = 10000,",
            "lineNumber": 302,
            "isSignature": true
          },
          {
            "text": "  retryIntervalMs: number = 500",
            "lineNumber": 303,
            "isSignature": true
          },
          {
            "text": "): Promise&lt;boolean&gt; {",
            "lineNumber": 304,
            "isSignature": true
          },
          {
            "text": "  const startTime = Date.now();",
            "lineNumber": 305
          },
          {
            "text": "  console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 306
          },
          {
            "lineNumber": 307
          },
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 308
          },
          {
            "text": "    const isReady = await checkBackendHealth();",
            "lineNumber": 309
          },
          {
            "lineNumber": 310
          },
          {
            "text": "    if (isReady) {",
            "lineNumber": 311
          },
          {
            "text": "      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 312
          },
          {
            "text": "      return true;",
            "lineNumber": 313
          },
          {
            "text": "    }",
            "lineNumber": 314
          },
          {
            "lineNumber": 315
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 316
          },
          {
            "text": "    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));",
            "lineNumber": 317
          },
          {
            "text": "  }",
            "lineNumber": 318
          },
          {
            "lineNumber": 319
          },
          {
            "text": "  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);",
            "lineNumber": 320
          },
          {
            "text": "  return false;",
            "lineNumber": 321
          },
          {
            "text": "}",
            "lineNumber": 322,
            "isSignature": true
          }
        ]
      },
      "score": 0.44029560685157776
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\index.ts",
        "range": {
          "startPosition": {
            "line": 1655,
            "column": 2
          },
          "endPosition": {
            "line": 1781,
            "column": 1
          }
        },
        "contents": "// ==================== check and start backend ====================\nconst checkAndStartBackend = async () =&gt; {\n  log.info('Checking and starting backend service...');\n  try {\n    // Clean up any existing backend process before starting new one\n    if (python_process &amp;&amp; !python_process.killed) {\n      log.info('Cleaning up existing backend process before restart...');\n      await cleanupPythonProcess();\n      python_process = null;\n    }\n\n    const isToolInstalled = await checkToolInstalled();\n    if (isToolInstalled.success) {\n      log.info('Tool installed, starting backend service...');\n\n      // Start backend and wait for health check to pass\n      python_process = await startBackend((port) =&gt; {\n        backendPort = port;\n        log.info('Backend service started successfully', { port });\n      });\n\n      // Notify frontend that backend is ready\n      if (win &amp;&amp; !win.isDestroyed()) {\n        log.info('Backend is ready, notifying frontend...');\n        win.webContents.send('backend-ready', {\n          success: true,\n          port: backendPort,\n        });\n      }\n\n      python_process?.on('exit', (code, signal) =&gt; {\n        log.info('Python process exited', { code, signal });\n      });\n    } else {\n      log.warn('Tool not installed, cannot start backend service');\n      // Notify frontend that backend cannot start\n      if (win &amp;&amp; !win.isDestroyed()) {\n        win.webContents.send('backend-ready', {\n          success: false,\n          error: 'Tools not installed',\n        });\n      }\n    }\n  } catch (error) {\n    log.error('Failed to start backend:', error);\n    // Notify frontend of backend startup failure\n    if (win &amp;&amp; !win.isDestroyed()) {\n      win.webContents.send('backend-ready', {\n        success: false,\n        error: String(error),\n      });\n    }\n  }\n};\n\n// ==================== process cleanup ====================\nconst cleanupPythonProcess = async ()\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// ==================== check and start backend ====================",
            "lineNumber": 1658
          },
          {
            "text": "const checkAndStartBackend = async () =&gt; {",
            "lineNumber": 1659
          },
          {
            "text": "  log.info('Checking and starting backend service...');",
            "lineNumber": 1660
          },
          {
            "text": "  try {",
            "lineNumber": 1661
          },
          {
            "text": "    // Clean up any existing backend process before starting new one",
            "lineNumber": 1662
          },
          {
            "text": "    if (python_process &amp;&amp; !python_process.killed) {",
            "lineNumber": 1663
          },
          {
            "text": "      log.info('Cleaning up existing backend process before restart...');",
            "lineNumber": 1664
          },
          {
            "text": "      await cleanupPythonProcess();",
            "lineNumber": 1665
          },
          {
            "text": "      python_process = null;",
            "lineNumber": 1666
          },
          {
            "text": "    }",
            "lineNumber": 1667
          },
          {
            "lineNumber": 1668
          },
          {
            "text": "    const isToolInstalled = await checkToolInstalled();",
            "lineNumber": 1669
          },
          {
            "text": "    if (isToolInstalled.success) {",
            "lineNumber": 1670
          },
          {
            "text": "      log.info('Tool installed, starting backend service...');",
            "lineNumber": 1671
          },
          {
            "lineNumber": 1672
          },
          {
            "text": "      // Start backend and wait for health check to pass",
            "lineNumber": 1673
          },
          {
            "text": "      python_process = await startBackend((port) =&gt; {",
            "lineNumber": 1674
          },
          {
            "text": "        backendPort = port;",
            "lineNumber": 1675
          },
          {
            "text": "        log.info('Backend service started successfully', { port });",
            "lineNumber": 1676
          },
          {
            "text": "      });",
            "lineNumber": 1677
          },
          {
            "lineNumber": 1678
          },
          {
            "text": "      // Notify frontend that backend is ready",
            "lineNumber": 1679
          },
          {
            "text": "      if (win &amp;&amp; !win.isDestroyed()) {",
            "lineNumber": 1680
          },
          {
            "text": "        log.info('Backend is ready, notifying frontend...');",
            "lineNumber": 1681
          },
          {
            "text": "        win.webContents.send('backend-ready', {",
            "lineNumber": 1682
          },
          {
            "text": "          success: true,",
            "lineNumber": 1683
          },
          {
            "text": "          port: backendPort,",
            "lineNumber": 1684
          },
          {
            "text": "        });",
            "lineNumber": 1685
          },
          {
            "text": "      }",
            "lineNumber": 1686
          },
          {
            "lineNumber": 1687
          },
          {
            "text": "      python_process?.on('exit', (code, signal) =&gt; {",
            "lineNumber": 1688
          },
          {
            "text": "        log.info('Python process exited', { code, signal });",
            "lineNumber": 1689
          },
          {
            "text": "      });",
            "lineNumber": 1690
          },
          {
            "text": "    } else {",
            "lineNumber": 1691
          },
          {
            "text": "      log.warn('Tool not installed, cannot start backend service');",
            "lineNumber": 1692
          },
          {
            "text": "      // Notify frontend that backend cannot start",
            "lineNumber": 1693
          },
          {
            "text": "      if (win &amp;&amp; !win.isDestroyed()) {",
            "lineNumber": 1694
          },
          {
            "text": "        win.webContents.send('backend-ready', {",
            "lineNumber": 1695
          },
          {
            "text": "          success: false,",
            "lineNumber": 1696
          },
          {
            "text": "          error: 'Tools not installed',",
            "lineNumber": 1697
          },
          {
            "text": "        });",
            "lineNumber": 1698
          },
          {
            "text": "      }",
            "lineNumber": 1699
          },
          {
            "text": "    }",
            "lineNumber": 1700
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 1701
          },
          {
            "text": "    log.error('Failed to start backend:', error);",
            "lineNumber": 1702
          },
          {
            "text": "    // Notify frontend of backend startup failure",
            "lineNumber": 1703
          },
          {
            "text": "    if (win &amp;&amp; !win.isDestroyed()) {",
            "lineNumber": 1704
          },
          {
            "text": "      win.webContents.send('backend-ready', {",
            "lineNumber": 1705
          },
          {
            "text": "        success: false,",
            "lineNumber": 1706
          },
          {
            "text": "        error: String(error),",
            "lineNumber": 1707
          },
          {
            "text": "      });",
            "lineNumber": 1708
          },
          {
            "text": "    }",
            "lineNumber": 1709
          },
          {
            "text": "  }",
            "lineNumber": 1710
          },
          {
            "text": "};",
            "lineNumber": 1711
          },
          {
            "lineNumber": 1712
          },
          {
            "text": "// ==================== process cleanup ====================",
            "lineNumber": 1713
          },
          {
            "text": "const cleanupPythonProcess = async ()",
            "lineNumber": 1714
          },
          {
            "text": ";",
            "lineNumber": 1782
          }
        ]
      },
      "score": 0.4241749048233032
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\hooks\\useInstallationSetup.ts",
        "range": {
          "startPosition": {
            "line": 8
          },
          "endPosition": {
            "line": 322,
            "column": 1
          }
        },
        "contents": "export const useInstallationSetup = \nconst startBackendPolling = () =&gt; {\nconst \n;\n\n    // Check immediately, then start polling if needed\n    checkBackendStatus().then((isReady) =&gt; {\n      if (isReady) {\n        console.log(\n          \"[useInstallationSetup] Backend already ready, skipping polling\"\n        );\n        return;\n      }\n\n      console.log(\"[useInstallationSetup] Backend not ready, starting polling\");\n\n      // Poll backend status every 2 seconds to ensure we catch when it's ready\n      // This is a fallback in case the backend-ready event is missed\n      const pollInterval = setInterval(async () =&gt; {\n        try {\n          const backendPort = await window.electronAPI.getBackendPort();\n          if (backendPort &amp;&amp; backendPort &gt; 0) {\n            console.log(\n              \"[useInstallationSetup] Backend poll detected ready on port:\",\n              backendPort\n            );\n\n            // Verify backend is actually responding\n            const response = await fetch(\n              &#96;http://localhost:${backendPort}/health&#96;\n            ).catch(() =&gt; null);\n            if (response &amp;&amp; response.ok) {\n              console.log(\"[useInstallationSetup] Backend health check passed\");\n              clearInterval(pollInterval);\n\n              if (!backendReady.current) {\n                backendReady.current = true;\n                setSuccess();\n                setInitState(\"done\");\n                // Clear the flag after backend is ready\n                setNeedsBackendRestart(false);\n              }\n            }\n          }\n        } catch (error) {\n          console.log(\n            \"[useInstallationSetup] Backend poll check failed:\",\n            error\n          );\n        }\n      }, 2000);\n\n      // Clear polling after 30 seconds to prevent infinite polling\n      setTimeout(() =&gt; {\n        clearInterval(pollInterval);\n      }, 30000);\n    });\n  }, [setSuccess, setInitState, setNeedsBackendRestart]);\n\n  // Monitor for backend restart after logout\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 9,
                "column": 1
              },
              "endPosition": {
                "line": 9,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 8
              },
              "endPosition": {
                "line": 9,
                "column": 14
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 14
              },
              "endPosition": {
                "line": 9,
                "column": 37
              }
            },
            {
              "startPosition": {
                "line": 38,
                "column": 3
              },
              "endPosition": {
                "line": 38,
                "column": 9
              }
            },
            {
              "startPosition": {
                "line": 38,
                "column": 9
              },
              "endPosition": {
                "line": 38,
                "column": 31
              }
            },
            {
              "startPosition": {
                "line": 38,
                "column": 43
              },
              "endPosition": {
                "line": 39,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export const useInstallationSetup = ",
            "lineNumber": 9
          },
          {
            "text": "const startBackendPolling = () =&gt; {",
            "lineNumber": 38
          },
          {
            "text": "const ",
            "lineNumber": 42
          },
          {
            "text": ";",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "    // Check immediately, then start polling if needed",
            "lineNumber": 75
          },
          {
            "text": "    checkBackendStatus().then((isReady) =&gt; {",
            "lineNumber": 76
          },
          {
            "text": "      if (isReady) {",
            "lineNumber": 77
          },
          {
            "text": "        console.log(",
            "lineNumber": 78
          },
          {
            "text": "          \"[useInstallationSetup] Backend already ready, skipping polling\"",
            "lineNumber": 79
          },
          {
            "text": "        );",
            "lineNumber": 80
          },
          {
            "text": "        return;",
            "lineNumber": 81
          },
          {
            "text": "      }",
            "lineNumber": 82
          },
          {
            "lineNumber": 83
          },
          {
            "text": "      console.log(\"[useInstallationSetup] Backend not ready, starting polling\");",
            "lineNumber": 84
          },
          {
            "lineNumber": 85
          },
          {
            "text": "      // Poll backend status every 2 seconds to ensure we catch when it's ready",
            "lineNumber": 86
          },
          {
            "text": "      // This is a fallback in case the backend-ready event is missed",
            "lineNumber": 87
          },
          {
            "text": "      const pollInterval = setInterval(async () =&gt; {",
            "lineNumber": 88
          },
          {
            "text": "        try {",
            "lineNumber": 89
          },
          {
            "text": "          const backendPort = await window.electronAPI.getBackendPort();",
            "lineNumber": 90
          },
          {
            "text": "          if (backendPort &amp;&amp; backendPort &gt; 0) {",
            "lineNumber": 91
          },
          {
            "text": "            console.log(",
            "lineNumber": 92
          },
          {
            "text": "              \"[useInstallationSetup] Backend poll detected ready on port:\",",
            "lineNumber": 93
          },
          {
            "text": "              backendPort",
            "lineNumber": 94
          },
          {
            "text": "            );",
            "lineNumber": 95
          },
          {
            "lineNumber": 96
          },
          {
            "text": "            // Verify backend is actually responding",
            "lineNumber": 97
          },
          {
            "text": "            const response = await fetch(",
            "lineNumber": 98
          },
          {
            "text": "              &#96;http://localhost:${backendPort}/health&#96;",
            "lineNumber": 99
          },
          {
            "text": "            ).catch(() =&gt; null);",
            "lineNumber": 100
          },
          {
            "text": "            if (response &amp;&amp; response.ok) {",
            "lineNumber": 101
          },
          {
            "text": "              console.log(\"[useInstallationSetup] Backend health check passed\");",
            "lineNumber": 102
          },
          {
            "text": "              clearInterval(pollInterval);",
            "lineNumber": 103
          },
          {
            "lineNumber": 104
          },
          {
            "text": "              if (!backendReady.current) {",
            "lineNumber": 105
          },
          {
            "text": "                backendReady.current = true;",
            "lineNumber": 106
          },
          {
            "text": "                setSuccess();",
            "lineNumber": 107
          },
          {
            "text": "                setInitState(\"done\");",
            "lineNumber": 108
          },
          {
            "text": "                // Clear the flag after backend is ready",
            "lineNumber": 109
          },
          {
            "text": "                setNeedsBackendRestart(false);",
            "lineNumber": 110
          },
          {
            "text": "              }",
            "lineNumber": 111
          },
          {
            "text": "            }",
            "lineNumber": 112
          },
          {
            "text": "          }",
            "lineNumber": 113
          },
          {
            "text": "        } catch (error) {",
            "lineNumber": 114
          },
          {
            "text": "          console.log(",
            "lineNumber": 115
          },
          {
            "text": "            \"[useInstallationSetup] Backend poll check failed:\",",
            "lineNumber": 116
          },
          {
            "text": "            error",
            "lineNumber": 117
          },
          {
            "text": "          );",
            "lineNumber": 118
          },
          {
            "text": "        }",
            "lineNumber": 119
          },
          {
            "text": "      }, 2000);",
            "lineNumber": 120
          },
          {
            "lineNumber": 121
          },
          {
            "text": "      // Clear polling after 30 seconds to prevent infinite polling",
            "lineNumber": 122
          },
          {
            "text": "      setTimeout(() =&gt; {",
            "lineNumber": 123
          },
          {
            "text": "        clearInterval(pollInterval);",
            "lineNumber": 124
          },
          {
            "text": "      }, 30000);",
            "lineNumber": 125
          },
          {
            "text": "    });",
            "lineNumber": 126
          },
          {
            "text": "  }, [setSuccess, setInitState, setNeedsBackendRestart]);",
            "lineNumber": 127
          },
          {
            "lineNumber": 128
          },
          {
            "text": "  // Monitor for backend restart after logout",
            "lineNumber": 129
          },
          {
            "text": ";",
            "lineNumber": 323
          }
        ]
      },
      "score": 0.4019298553466797
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 283,
            "column": 4
          },
          "endPosition": {
            "line": 353
          }
        },
        "contents": "delete requestHeaders['Content-Type']\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  if (import.meta.env.DEV) {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      requestHeaders['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: formData,\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\n// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */\nexport async function checkBackendHealth(): Promise&lt;boolean&gt; {\n  try {\n    const baseURL = await getBaseURL();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n\n    const res = await fetch(&#96;${baseURL}/health&#96;, {\n      signal: controller.signal,\n      method: 'GET',\n    });\n\n    clearTimeout(timeoutId);\n    return res.ok;\n  } catch (error) {\n    console.log('[Backend Health Check] Not ready:', error);\n    return false;\n  }\n}\n\n/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */\nexport async function waitForBackendReady(\n  maxWaitMs: number = 10000,\n  retryIntervalMs: number = 500\n): Promise&lt;boolean&gt; {\n  const startTime = Date.now();\n  console.log('[Backend Health Check] Waiting for backend to be ready...');\n\n  while (Date.now() - startTime &lt; maxWaitMs) {\n    const isReady = await checkBackendHealth();\n\n    if (isReady) {\n      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
        "signatures": {},
        "detailedLines": [
          {
            "text": "delete requestHeaders['Content-Type']",
            "lineNumber": 284
          },
          {
            "text": "  }",
            "lineNumber": 285
          },
          {
            "lineNumber": 286
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 287
          },
          {
            "text": "    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 288
          },
          {
            "text": "  }",
            "lineNumber": 289
          },
          {
            "lineNumber": 290
          },
          {
            "text": "  if (import.meta.env.DEV) {",
            "lineNumber": 291
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 292
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 293
          },
          {
            "text": "      requestHeaders['X-Proxy-Target'] = targetUrl",
            "lineNumber": 294
          },
          {
            "text": "    }",
            "lineNumber": 295
          },
          {
            "text": "  }",
            "lineNumber": 296
          },
          {
            "lineNumber": 297
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 298
          },
          {
            "text": "    method: 'POST',",
            "lineNumber": 299
          },
          {
            "text": "    headers: requestHeaders,",
            "lineNumber": 300
          },
          {
            "text": "    body: formData,",
            "lineNumber": 301
          },
          {
            "text": "  }",
            "lineNumber": 302
          },
          {
            "lineNumber": 303
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 304
          },
          {
            "text": "}",
            "lineNumber": 305
          },
          {
            "lineNumber": 306
          },
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 307
          },
          {
            "lineNumber": 308
          },
          {
            "text": "/**",
            "lineNumber": 309
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 310
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 311
          },
          {
            "text": " */",
            "lineNumber": 312
          },
          {
            "text": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {",
            "lineNumber": 313
          },
          {
            "text": "  try {",
            "lineNumber": 314
          },
          {
            "text": "    const baseURL = await getBaseURL();",
            "lineNumber": 315
          },
          {
            "text": "    const controller = new AbortController();",
            "lineNumber": 316
          },
          {
            "text": "    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 317
          },
          {
            "lineNumber": 318
          },
          {
            "text": "    const res = await fetch(&#96;${baseURL}/health&#96;, {",
            "lineNumber": 319
          },
          {
            "text": "      signal: controller.signal,",
            "lineNumber": 320
          },
          {
            "text": "      method: 'GET',",
            "lineNumber": 321
          },
          {
            "text": "    });",
            "lineNumber": 322
          },
          {
            "lineNumber": 323
          },
          {
            "text": "    clearTimeout(timeoutId);",
            "lineNumber": 324
          },
          {
            "text": "    return res.ok;",
            "lineNumber": 325
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 326
          },
          {
            "text": "    console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 327
          },
          {
            "text": "    return false;",
            "lineNumber": 328
          },
          {
            "text": "  }",
            "lineNumber": 329
          },
          {
            "text": "}",
            "lineNumber": 330
          },
          {
            "lineNumber": 331
          },
          {
            "text": "/**",
            "lineNumber": 332
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 333
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 334
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 335
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 336
          },
          {
            "text": " */",
            "lineNumber": 337
          },
          {
            "text": "export async function waitForBackendReady(",
            "lineNumber": 338
          },
          {
            "text": "  maxWaitMs: number = 10000,",
            "lineNumber": 339
          },
          {
            "text": "  retryIntervalMs: number = 500",
            "lineNumber": 340
          },
          {
            "text": "): Promise&lt;boolean&gt; {",
            "lineNumber": 341
          },
          {
            "text": "  const startTime = Date.now();",
            "lineNumber": 342
          },
          {
            "text": "  console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 343
          },
          {
            "lineNumber": 344
          },
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 345
          },
          {
            "text": "    const isReady = await checkBackendHealth();",
            "lineNumber": 346
          },
          {
            "lineNumber": 347
          },
          {
            "text": "    if (isReady) {",
            "lineNumber": 348
          },
          {
            "text": "      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 349
          },
          {
            "text": "      return true;",
            "lineNumber": 350
          },
          {
            "text": "    }",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 353
          }
        ]
      },
      "score": 0.39281004667282104
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 700,
            "column": 4
          },
          "endPosition": {
            "line": 767,
            "column": 4
          }
        },
        "contents": "...headers,\n  }\n\n  // Remove Content-Type header to let browser set it with boundary for FormData\n  if (requestHeaders['Content-Type']) {\n    delete requestHeaders['Content-Type']\n  }\n\n  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {\n    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;\n  }\n\n  if (import.meta.env.DEV) {\n    const targetUrl = import.meta.env.VITE_BASE_URL\n    if (targetUrl) {\n      requestHeaders['X-Proxy-Target'] = targetUrl\n    }\n  }\n\n  const options: RequestInit = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: formData,\n  }\n\n  return handleResponse(fetch(fullUrl, options))\n}\n\n// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */\nexport async function checkBackendHealth(): Promise&lt;boolean&gt; {\n  try {\n    const baseURL = await getBaseURL();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n\n    const res = await fetch(&#96;${baseURL}/health&#96;, {\n      signal: controller.signal,\n      method: 'GET',\n    });\n\n    clearTimeout(timeoutId);\n    return res.ok;\n  } catch (error) {\n    console.log('[Backend Health Check] Not ready:', error);\n    return false;\n  }\n}\n\n/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */\nexport async function waitForBackendReady(\n  maxWaitMs: number = 10000,\n  retryIntervalMs: number = 500\n): Promise&lt;boolean&gt; {\n  const startTime = Date.now();\n  console.log('[Backend Health Check] Waiting for backend to be ready...');\n\n  while (Date.now() - startTime &lt; maxWaitMs) {\n    ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "...headers,",
            "lineNumber": 701
          },
          {
            "text": "  }",
            "lineNumber": 702
          },
          {
            "lineNumber": 703
          },
          {
            "text": "  // Remove Content-Type header to let browser set it with boundary for FormData",
            "lineNumber": 704
          },
          {
            "text": "  if (requestHeaders['Content-Type']) {",
            "lineNumber": 705
          },
          {
            "text": "    delete requestHeaders['Content-Type']",
            "lineNumber": 706
          },
          {
            "text": "  }",
            "lineNumber": 707
          },
          {
            "lineNumber": 708
          },
          {
            "text": "  if (!url.includes('http://') &amp;&amp; !url.includes('https://') &amp;&amp; token) {",
            "lineNumber": 709
          },
          {
            "text": "    requestHeaders['Authorization'] = &#96;Bearer ${token}&#96;",
            "lineNumber": 710
          },
          {
            "text": "  }",
            "lineNumber": 711
          },
          {
            "lineNumber": 712
          },
          {
            "text": "  if (import.meta.env.DEV) {",
            "lineNumber": 713
          },
          {
            "text": "    const targetUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 714
          },
          {
            "text": "    if (targetUrl) {",
            "lineNumber": 715
          },
          {
            "text": "      requestHeaders['X-Proxy-Target'] = targetUrl",
            "lineNumber": 716
          },
          {
            "text": "    }",
            "lineNumber": 717
          },
          {
            "text": "  }",
            "lineNumber": 718
          },
          {
            "lineNumber": 719
          },
          {
            "text": "  const options: RequestInit = {",
            "lineNumber": 720
          },
          {
            "text": "    method: 'POST',",
            "lineNumber": 721
          },
          {
            "text": "    headers: requestHeaders,",
            "lineNumber": 722
          },
          {
            "text": "    body: formData,",
            "lineNumber": 723
          },
          {
            "text": "  }",
            "lineNumber": 724
          },
          {
            "lineNumber": 725
          },
          {
            "text": "  return handleResponse(fetch(fullUrl, options))",
            "lineNumber": 726
          },
          {
            "text": "}",
            "lineNumber": 727
          },
          {
            "lineNumber": 728
          },
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 729
          },
          {
            "lineNumber": 730
          },
          {
            "text": "/**",
            "lineNumber": 731
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 732
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 733
          },
          {
            "text": " */",
            "lineNumber": 734
          },
          {
            "text": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {",
            "lineNumber": 735
          },
          {
            "text": "  try {",
            "lineNumber": 736
          },
          {
            "text": "    const baseURL = await getBaseURL();",
            "lineNumber": 737
          },
          {
            "text": "    const controller = new AbortController();",
            "lineNumber": 738
          },
          {
            "text": "    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 739
          },
          {
            "lineNumber": 740
          },
          {
            "text": "    const res = await fetch(&#96;${baseURL}/health&#96;, {",
            "lineNumber": 741
          },
          {
            "text": "      signal: controller.signal,",
            "lineNumber": 742
          },
          {
            "text": "      method: 'GET',",
            "lineNumber": 743
          },
          {
            "text": "    });",
            "lineNumber": 744
          },
          {
            "lineNumber": 745
          },
          {
            "text": "    clearTimeout(timeoutId);",
            "lineNumber": 746
          },
          {
            "text": "    return res.ok;",
            "lineNumber": 747
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 748
          },
          {
            "text": "    console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 749
          },
          {
            "text": "    return false;",
            "lineNumber": 750
          },
          {
            "text": "  }",
            "lineNumber": 751
          },
          {
            "text": "}",
            "lineNumber": 752
          },
          {
            "lineNumber": 753
          },
          {
            "text": "/**",
            "lineNumber": 754
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 755
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 756
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 757
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 758
          },
          {
            "text": " */",
            "lineNumber": 759
          },
          {
            "text": "export async function waitForBackendReady(",
            "lineNumber": 760
          },
          {
            "text": "  maxWaitMs: number = 10000,",
            "lineNumber": 761
          },
          {
            "text": "  retryIntervalMs: number = 500",
            "lineNumber": 762
          },
          {
            "text": "): Promise&lt;boolean&gt; {",
            "lineNumber": 763
          },
          {
            "text": "  const startTime = Date.now();",
            "lineNumber": 764
          },
          {
            "text": "  console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 765
          },
          {
            "lineNumber": 766
          },
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 767
          },
          {
            "text": "    ",
            "lineNumber": 768
          }
        ]
      },
      "score": 0.3761720061302185
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\hooks\\useInstallationSetup.ts",
        "range": {
          "startPosition": {
            "line": 8
          },
          "endPosition": {
            "line": 322,
            "column": 1
          }
        },
        "contents": "export const useInstallationSetup = \n\n\n  // Shared function to poll backend status\n  const startBackendPolling = useCallback(() =&gt; {\n    console.log(\"[useInstallationSetup] Starting backend polling\");\n\n    // Immediately check backend status once\n    const checkBackendStatus = async () =&gt; {\n      try {\n        const backendPort = await window.electronAPI.getBackendPort();\n        if (backendPort &amp;&amp; backendPort &gt; 0) {\n          console.log(\n            \"[useInstallationSetup] Backend immediately detected on port:\",\n            backendPort\n          );\n\n          // Verify backend is actually responding\n          const response = await fetch(\n            &#96;http://localhost:${backendPort}/health&#96;\n          ).catch(() =&gt; null);\n          if (response &amp;&amp; response.ok) {\n            console.log(\n              \"[useInstallationSetup] Backend health check passed immediately\"\n            );\n            backendReady.current = true;\n            setSuccess();\n            setInitState(\"done\");\n            setNeedsBackendRestart(false);\n            return true; // Backend is ready, no need to poll\n          }\n        }\n      } catch (error) {\n        console.log(\n          \"[useInstallationSetup] Initial backend check failed:\",\n          error\n        );\n      }\n      return false; // Backend not ready, need to poll\n    };\n\n    // Check immediately, then start polling if needed\n    checkBackendStatus().then\n\n  };\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 9,
                "column": 1
              },
              "endPosition": {
                "line": 9,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 8
              },
              "endPosition": {
                "line": 9,
                "column": 14
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 14
              },
              "endPosition": {
                "line": 9,
                "column": 37
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export const useInstallationSetup = ",
            "lineNumber": 9
          },
          {
            "lineNumber": 35
          },
          {
            "lineNumber": 36
          },
          {
            "text": "  // Shared function to poll backend status",
            "lineNumber": 37
          },
          {
            "text": "  const startBackendPolling = useCallback(() =&gt; {",
            "lineNumber": 38
          },
          {
            "text": "    console.log(\"[useInstallationSetup] Starting backend polling\");",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "    // Immediately check backend status once",
            "lineNumber": 41
          },
          {
            "text": "    const checkBackendStatus = async () =&gt; {",
            "lineNumber": 42
          },
          {
            "text": "      try {",
            "lineNumber": 43
          },
          {
            "text": "        const backendPort = await window.electronAPI.getBackendPort();",
            "lineNumber": 44
          },
          {
            "text": "        if (backendPort &amp;&amp; backendPort &gt; 0) {",
            "lineNumber": 45
          },
          {
            "text": "          console.log(",
            "lineNumber": 46
          },
          {
            "text": "            \"[useInstallationSetup] Backend immediately detected on port:\",",
            "lineNumber": 47
          },
          {
            "text": "            backendPort",
            "lineNumber": 48
          },
          {
            "text": "          );",
            "lineNumber": 49
          },
          {
            "lineNumber": 50
          },
          {
            "text": "          // Verify backend is actually responding",
            "lineNumber": 51
          },
          {
            "text": "          const response = await fetch(",
            "lineNumber": 52
          },
          {
            "text": "            &#96;http://localhost:${backendPort}/health&#96;",
            "lineNumber": 53
          },
          {
            "text": "          ).catch(() =&gt; null);",
            "lineNumber": 54
          },
          {
            "text": "          if (response &amp;&amp; response.ok) {",
            "lineNumber": 55
          },
          {
            "text": "            console.log(",
            "lineNumber": 56
          },
          {
            "text": "              \"[useInstallationSetup] Backend health check passed immediately\"",
            "lineNumber": 57
          },
          {
            "text": "            );",
            "lineNumber": 58
          },
          {
            "text": "            backendReady.current = true;",
            "lineNumber": 59
          },
          {
            "text": "            setSuccess();",
            "lineNumber": 60
          },
          {
            "text": "            setInitState(\"done\");",
            "lineNumber": 61
          },
          {
            "text": "            setNeedsBackendRestart(false);",
            "lineNumber": 62
          },
          {
            "text": "            return true; // Backend is ready, no need to poll",
            "lineNumber": 63
          },
          {
            "text": "          }",
            "lineNumber": 64
          },
          {
            "text": "        }",
            "lineNumber": 65
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 66
          },
          {
            "text": "        console.log(",
            "lineNumber": 67
          },
          {
            "text": "          \"[useInstallationSetup] Initial backend check failed:\",",
            "lineNumber": 68
          },
          {
            "text": "          error",
            "lineNumber": 69
          },
          {
            "text": "        );",
            "lineNumber": 70
          },
          {
            "text": "      }",
            "lineNumber": 71
          },
          {
            "text": "      return false; // Backend not ready, need to poll",
            "lineNumber": 72
          },
          {
            "text": "    };",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "    // Check immediately, then start polling if needed",
            "lineNumber": 75
          },
          {
            "text": "    checkBackendStatus().then",
            "lineNumber": 76
          },
          {
            "lineNumber": 126
          },
          {
            "text": "  };",
            "lineNumber": 127
          },
          {
            "text": ";",
            "lineNumber": 323
          }
        ]
      },
      "score": 0.3725009858608246
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\api\\http.ts",
        "range": {
          "startPosition": {
            "line": 267,
            "column": 1
          },
          "endPosition": {
            "line": 299,
            "column": 3
          }
        },
        "contents": "// =============== Backend Health Check ===============\n\n/**\n * Check if backend is ready by checking the health endpoint\n * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise\n */\nexport async function checkBackendHealth(): Promise&lt;boolean&gt; {\n  try {\n    const baseURL = await getBaseURL();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n\n    const res = await fetch(&#96;${baseURL}/api/health&#96;, {\n      signal: controller.signal,\n      method: 'GET',\n    });\n\n    clearTimeout(timeoutId);\n    return res.ok;\n  } catch (error) {\n    console.log('[Backend Health Check] Not ready:', error);\n    return false;\n  }\n}\n\n/**\n * Simple backend health check with retries\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// =============== Backend Health Check ===============",
            "lineNumber": 270
          },
          {
            "lineNumber": 271
          },
          {
            "text": "/**",
            "lineNumber": 272
          },
          {
            "text": " * Check if backend is ready by checking the health endpoint",
            "lineNumber": 273
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend is ready, false otherwise",
            "lineNumber": 274
          },
          {
            "text": " */",
            "lineNumber": 275
          },
          {
            "text": "export async function checkBackendHealth(): Promise&lt;boolean&gt; {",
            "lineNumber": 276,
            "isSignature": true
          },
          {
            "text": "  try {",
            "lineNumber": 277
          },
          {
            "text": "    const baseURL = await getBaseURL();",
            "lineNumber": 278
          },
          {
            "text": "    const controller = new AbortController();",
            "lineNumber": 279
          },
          {
            "text": "    const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 280
          },
          {
            "lineNumber": 281
          },
          {
            "text": "    const res = await fetch(&#96;${baseURL}/api/health&#96;, {",
            "lineNumber": 282
          },
          {
            "text": "      signal: controller.signal,",
            "lineNumber": 283
          },
          {
            "text": "      method: 'GET',",
            "lineNumber": 284
          },
          {
            "text": "    });",
            "lineNumber": 285
          },
          {
            "lineNumber": 286
          },
          {
            "text": "    clearTimeout(timeoutId);",
            "lineNumber": 287
          },
          {
            "text": "    return res.ok;",
            "lineNumber": 288
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 289
          },
          {
            "text": "    console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 290
          },
          {
            "text": "    return false;",
            "lineNumber": 291
          },
          {
            "text": "  }",
            "lineNumber": 292
          },
          {
            "text": "}",
            "lineNumber": 293,
            "isSignature": true
          },
          {
            "lineNumber": 294
          },
          {
            "text": "/**",
            "lineNumber": 295
          },
          {
            "text": " * Simple backend health check with retries",
            "lineNumber": 296
          },
          {
            "text": " * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 297
          },
          {
            "text": " * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 298
          },
          {
            "text": " * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 299
          },
          {
            "text": " */",
            "lineNumber": 300
          }
        ]
      },
      "score": 0.36136001348495483
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nasync (resolve, reject) =&gt; {\nconst killBackendProcess = \n\n            }\n        };\n\n        const pollHealthEndpoint = (): void =&gt; {\n            let attempts = 0;\n            const maxAttempts = 240;\n            const intervalMs = 250;\n\n            healthCheckInterval = setInterval(() =&gt; {\n                attempts++;\n                const healthUrl = &#96;http://127.0.0.1:${port}/health&#96;;\n                log.debug(&#96;Health check attempt ${attempts}/${maxAttempts}: ${healthUrl}&#96;);\n\n                const req = http.get(healthUrl, { timeout: 1000 }, (res) =&gt; {\n                    if (res.statusCode === 200) {\n                        log.info(&#96;Backend health check passed after ${attempts} attempts&#96;);\n                        started = true;\n                        clearTimeout(startTimeout);\n                        if (healthCheckInterval) clearInterval(healthCheckInterval);\n                        resolve(node_process);\n                    } else {\n                        // Non-200 status (e.g., 404), continue polling unless max attempts reached\n                        if (attempts &gt;= maxAttempts) {\n                            log.error(&#96;Backend health check failed after ${attempts} attempts with status ${res.statusCode}&#96;);\n                            started = true;\n                            clearTimeout(startTimeout);\n                            if (healthCheckInterval) clearInterval(healthCheckInterval);\n                            killBackendProcess(node_process);\n                            reject(new Error(&#96;Backend health check failed: HTTP ${res.statusCode}&#96;));\n                        }\n                    }\n                });\n\n                req.on('error', () =&gt; {\n                    // Connection error - backend might not be ready yet, continue polling\n                }\n            }\n;\n    }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            },
            {
              "startPosition": {
                "line": 192,
                "column": 24
              },
              "endPosition": {
                "line": 193,
                "column": 9
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "const killBackendProcess = ",
            "lineNumber": 325
          },
          {
            "lineNumber": 346
          },
          {
            "text": "            }",
            "lineNumber": 347
          },
          {
            "text": "        };",
            "lineNumber": 348
          },
          {
            "lineNumber": 349
          },
          {
            "text": "        const pollHealthEndpoint = (): void =&gt; {",
            "lineNumber": 350
          },
          {
            "text": "            let attempts = 0;",
            "lineNumber": 351
          },
          {
            "text": "            const maxAttempts = 240;",
            "lineNumber": 352
          },
          {
            "text": "            const intervalMs = 250;",
            "lineNumber": 353
          },
          {
            "lineNumber": 354
          },
          {
            "text": "            healthCheckInterval = setInterval(() =&gt; {",
            "lineNumber": 355
          },
          {
            "text": "                attempts++;",
            "lineNumber": 356
          },
          {
            "text": "                const healthUrl = &#96;http://127.0.0.1:${port}/health&#96;;",
            "lineNumber": 357
          },
          {
            "text": "                log.debug(&#96;Health check attempt ${attempts}/${maxAttempts}: ${healthUrl}&#96;);",
            "lineNumber": 358
          },
          {
            "lineNumber": 359
          },
          {
            "text": "                const req = http.get(healthUrl, { timeout: 1000 }, (res) =&gt; {",
            "lineNumber": 360
          },
          {
            "text": "                    if (res.statusCode === 200) {",
            "lineNumber": 361
          },
          {
            "text": "                        log.info(&#96;Backend health check passed after ${attempts} attempts&#96;);",
            "lineNumber": 362
          },
          {
            "text": "                        started = true;",
            "lineNumber": 363
          },
          {
            "text": "                        clearTimeout(startTimeout);",
            "lineNumber": 364
          },
          {
            "text": "                        if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 365
          },
          {
            "text": "                        resolve(node_process);",
            "lineNumber": 366
          },
          {
            "text": "                    } else {",
            "lineNumber": 367
          },
          {
            "text": "                        // Non-200 status (e.g., 404), continue polling unless max attempts reached",
            "lineNumber": 368
          },
          {
            "text": "                        if (attempts &gt;= maxAttempts) {",
            "lineNumber": 369
          },
          {
            "text": "                            log.error(&#96;Backend health check failed after ${attempts} attempts with status ${res.statusCode}&#96;);",
            "lineNumber": 370
          },
          {
            "text": "                            started = true;",
            "lineNumber": 371
          },
          {
            "text": "                            clearTimeout(startTimeout);",
            "lineNumber": 372
          },
          {
            "text": "                            if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 373
          },
          {
            "text": "                            killBackendProcess(node_process);",
            "lineNumber": 374
          },
          {
            "text": "                            reject(new Error(&#96;Backend health check failed: HTTP ${res.statusCode}&#96;));",
            "lineNumber": 375
          },
          {
            "text": "                        }",
            "lineNumber": 376
          },
          {
            "text": "                    }",
            "lineNumber": 377
          },
          {
            "text": "                });",
            "lineNumber": 378
          },
          {
            "lineNumber": 379
          },
          {
            "text": "                req.on('error', () =&gt; {",
            "lineNumber": 380
          },
          {
            "text": "                    // Connection error - backend might not be ready yet, continue polling",
            "lineNumber": 381
          },
          {
            "text": "                }",
            "lineNumber": 390
          },
          {
            "text": "            }",
            "lineNumber": 403
          },
          {
            "text": ";",
            "lineNumber": 404
          },
          {
            "text": "    }",
            "lineNumber": 451
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.35831761360168457
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\index.ts",
        "range": {
          "startPosition": {
            "line": 1227
          },
          "endPosition": {
            "line": 1569,
            "column": 1
          }
        },
        "contents": "async function createWindow() {\n() =&gt; {\n\n(err) =&gt; {\n\n        });\n    });\n  } else {\n    // The proper flow is now handled by useInstallationSetup.ts with dual-check mechanism:\n    // 1. Installation complete event ‚Üí installationCompleted.current = true\n    // 2. Backend ready event ‚Üí backendReady.current = true\n    // 3. Only when BOTH are true ‚Üí setInitState('done')\n    //\n    // This ensures frontend never shows before backend is ready.\n    log.info(\n      'Installation already complete - letting useInstallationSetup handle state transitions'\n    );\n  }\n\n  // Load content\n  if (VITE_DEV_SERVER_URL) {\n    win.loadURL(VITE_DEV_SERVER_URL);\n    win.webContents.openDevTools();\n  } else {\n    win.loadFile(indexHtml);\n  }\n\n  // Wait for window to be ready\n  await new Promise&lt;void&gt;((resolve) =&gt; {\n    win!.webContents.once('did-finish-load', () =&gt; {\n      log.info(\n        'Window content loaded, starting dependency check immediately...'\n      );\n      resolve();\n    });\n  });\n\n  // Mark window as ready and process any queued protocol URLs\n  isWindowReady = true;\n  log.info('Window is ready, processing queued protocol URLs...');\n  processQueuedProtocolUrls();\n\n  // Wait for React components to mount and register event listeners\n  await new Promise((resolve) =&gt; setTimeout(resolve, 500));\n\n  // Now check and install dependencies\n  let res: PromiseReturnType = await checkAndInstallDepsOnUpdate({ win });\n  if (!res.success) {\n    log.info('[DEPS INSTALL] Dependency Error: ', res.message);\n    // Note: install-dependencies-complete failure event is already sent by installDependencies function\n    // in install-deps.ts, so we don't send it again here to avoid duplicate events\n    return;\n  }\n  log.info('[DEPS INSTALL] Dependency Success: ', res.message);\n\n  // IMPORTANT: Wait a bit to ensure React components have mounted and registered event listeners\n  // This prevents race condition where events are sent before listeners are ready\n  await new Promise((resolve) =&gt; setTimeout(resolve, 500));\n\n  // IMPORTANT: Always send install-dependencies-complete event when installation check succeeds\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 1228,
                "column": 1
              },
              "endPosition": {
                "line": 1229,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "async function createWindow() {",
            "lineNumber": 1228,
            "isSignature": true
          },
          {
            "text": "() =&gt; {",
            "lineNumber": 1443
          },
          {
            "lineNumber": 1453
          },
          {
            "text": "(err) =&gt; {",
            "lineNumber": 1499
          },
          {
            "lineNumber": 1500
          },
          {
            "text": "        });",
            "lineNumber": 1501
          },
          {
            "text": "    });",
            "lineNumber": 1502
          },
          {
            "text": "  } else {",
            "lineNumber": 1503
          },
          {
            "text": "    // The proper flow is now handled by useInstallationSetup.ts with dual-check mechanism:",
            "lineNumber": 1504
          },
          {
            "text": "    // 1. Installation complete event ‚Üí installationCompleted.current = true",
            "lineNumber": 1505
          },
          {
            "text": "    // 2. Backend ready event ‚Üí backendReady.current = true",
            "lineNumber": 1506
          },
          {
            "text": "    // 3. Only when BOTH are true ‚Üí setInitState('done')",
            "lineNumber": 1507
          },
          {
            "text": "    //",
            "lineNumber": 1508
          },
          {
            "text": "    // This ensures frontend never shows before backend is ready.",
            "lineNumber": 1509
          },
          {
            "text": "    log.info(",
            "lineNumber": 1510
          },
          {
            "text": "      'Installation already complete - letting useInstallationSetup handle state transitions'",
            "lineNumber": 1511
          },
          {
            "text": "    );",
            "lineNumber": 1512
          },
          {
            "text": "  }",
            "lineNumber": 1513
          },
          {
            "lineNumber": 1514
          },
          {
            "text": "  // Load content",
            "lineNumber": 1515
          },
          {
            "text": "  if (VITE_DEV_SERVER_URL) {",
            "lineNumber": 1516
          },
          {
            "text": "    win.loadURL(VITE_DEV_SERVER_URL);",
            "lineNumber": 1517
          },
          {
            "text": "    win.webContents.openDevTools();",
            "lineNumber": 1518
          },
          {
            "text": "  } else {",
            "lineNumber": 1519
          },
          {
            "text": "    win.loadFile(indexHtml);",
            "lineNumber": 1520
          },
          {
            "text": "  }",
            "lineNumber": 1521
          },
          {
            "lineNumber": 1522
          },
          {
            "text": "  // Wait for window to be ready",
            "lineNumber": 1523
          },
          {
            "text": "  await new Promise&lt;void&gt;((resolve) =&gt; {",
            "lineNumber": 1524
          },
          {
            "text": "    win!.webContents.once('did-finish-load', () =&gt; {",
            "lineNumber": 1525
          },
          {
            "text": "      log.info(",
            "lineNumber": 1526
          },
          {
            "text": "        'Window content loaded, starting dependency check immediately...'",
            "lineNumber": 1527
          },
          {
            "text": "      );",
            "lineNumber": 1528
          },
          {
            "text": "      resolve();",
            "lineNumber": 1529
          },
          {
            "text": "    });",
            "lineNumber": 1530
          },
          {
            "text": "  });",
            "lineNumber": 1531
          },
          {
            "lineNumber": 1532
          },
          {
            "text": "  // Mark window as ready and process any queued protocol URLs",
            "lineNumber": 1533
          },
          {
            "text": "  isWindowReady = true;",
            "lineNumber": 1534
          },
          {
            "text": "  log.info('Window is ready, processing queued protocol URLs...');",
            "lineNumber": 1535
          },
          {
            "text": "  processQueuedProtocolUrls();",
            "lineNumber": 1536
          },
          {
            "lineNumber": 1537
          },
          {
            "text": "  // Wait for React components to mount and register event listeners",
            "lineNumber": 1538
          },
          {
            "text": "  await new Promise((resolve) =&gt; setTimeout(resolve, 500));",
            "lineNumber": 1539
          },
          {
            "lineNumber": 1540
          },
          {
            "text": "  // Now check and install dependencies",
            "lineNumber": 1541
          },
          {
            "text": "  let res: PromiseReturnType = await checkAndInstallDepsOnUpdate({ win });",
            "lineNumber": 1542
          },
          {
            "text": "  if (!res.success) {",
            "lineNumber": 1543
          },
          {
            "text": "    log.info('[DEPS INSTALL] Dependency Error: ', res.message);",
            "lineNumber": 1544
          },
          {
            "text": "    // Note: install-dependencies-complete failure event is already sent by installDependencies function",
            "lineNumber": 1545
          },
          {
            "text": "    // in install-deps.ts, so we don't send it again here to avoid duplicate events",
            "lineNumber": 1546
          },
          {
            "text": "    return;",
            "lineNumber": 1547
          },
          {
            "text": "  }",
            "lineNumber": 1548
          },
          {
            "text": "  log.info('[DEPS INSTALL] Dependency Success: ', res.message);",
            "lineNumber": 1549
          },
          {
            "lineNumber": 1550
          },
          {
            "text": "  // IMPORTANT: Wait a bit to ensure React components have mounted and registered event listeners",
            "lineNumber": 1551
          },
          {
            "text": "  // This prevents race condition where events are sent before listeners are ready",
            "lineNumber": 1552
          },
          {
            "text": "  await new Promise((resolve) =&gt; setTimeout(resolve, 500));",
            "lineNumber": 1553
          },
          {
            "lineNumber": 1554
          },
          {
            "text": "  // IMPORTANT: Always send install-dependencies-complete event when installation check succeeds",
            "lineNumber": 1555
          },
          {
            "text": "}",
            "lineNumber": 1570,
            "isSignature": true
          }
        ]
      },
      "score": 0.351682186126709
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 7293
          },
          "endPosition": {
            "line": 7356
          }
        },
        "contents": "00265|     const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);\n00266| \n00267|     const res = await fetch(&#96;${baseURL}/health&#96;, {\n00268|       signal: controller.signal,\n00269|       method: 'GET',\n00270|     });\n00271| \n00272|     clearTimeout(timeoutId);\n00273|     return res.ok;\n00274|   } catch (error) {\n00275|     console.log('[Backend Health Check] Not ready:', error);\n00276|     return false;\n00277|   }\n00278| }\n00279| \n00280| /**\n00281|  * Simple backend health check with retries\n00282|  * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\n00283|  * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\n00284|  * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout\n00285|  */\n00286| export async function waitForBackendReady(\n00287|   maxWaitMs: number = 10000,\n00288|   retryIntervalMs: number = 500\n00289| ): Promise&lt;boolean&gt; {\n00290|   const startTime = Date.now();\n00291|   console.log('[Backend Health Check] Waiting for backend to be ready...');\n00292| \n00293|   while (Date.now() - startTime &lt; maxWaitMs) {\n00294|     const isReady = await checkBackendHealth();\n00295| \n00296|     if (isReady) {\n00297|       console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n00298|       return true;\n00299|     }\n00300| \n00301|     console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);\n00302|     await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));\n00303|   }\n00304| \n00305|   console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);\n00306|   return false;\n00307| }\n00308| \n\n(End of file - total 308 lines)\n&lt;/file&gt;\n&#96;&#96;&#96;\n&#96;&#96;&#96;\n\n---\n\n## Assistant (Sisyphus ¬∑ antigravity-claude-opus-4-5-thinking ¬∑ 20.6s)\n\nÁèæÂú®ËÆÄÂèñ &#96;.env.development&#96; Ê™îÊ°à‰ª•‰∫ÜËß£Áí∞Â¢ÉÈÖçÁΩÆÔºå‰∏¶Êü•Áúã server Á´ØÁöÑÁôªÂÖ• APIÔºö\n\n&#96;&#96;&#96;\nTool: read\n\n**Input:**\n&#96;&#96;&#96;json\n{\n  \"filePath\": \"D:\\\\_Code\\\\_GitHub\\\\eigent-260119\\\\.env.development\"",
        "signatures": {},
        "detailedLines": [
          {
            "text": "00265|     const timeoutId = setTimeout(() =&gt; controller.abort(), 1000);",
            "lineNumber": 7294
          },
          {
            "text": "00266| ",
            "lineNumber": 7295
          },
          {
            "text": "00267|     const res = await fetch(&#96;${baseURL}/health&#96;, {",
            "lineNumber": 7296
          },
          {
            "text": "00268|       signal: controller.signal,",
            "lineNumber": 7297
          },
          {
            "text": "00269|       method: 'GET',",
            "lineNumber": 7298
          },
          {
            "text": "00270|     });",
            "lineNumber": 7299
          },
          {
            "text": "00271| ",
            "lineNumber": 7300
          },
          {
            "text": "00272|     clearTimeout(timeoutId);",
            "lineNumber": 7301
          },
          {
            "text": "00273|     return res.ok;",
            "lineNumber": 7302
          },
          {
            "text": "00274|   } catch (error) {",
            "lineNumber": 7303
          },
          {
            "text": "00275|     console.log('[Backend Health Check] Not ready:', error);",
            "lineNumber": 7304
          },
          {
            "text": "00276|     return false;",
            "lineNumber": 7305
          },
          {
            "text": "00277|   }",
            "lineNumber": 7306
          },
          {
            "text": "00278| }",
            "lineNumber": 7307
          },
          {
            "text": "00279| ",
            "lineNumber": 7308
          },
          {
            "text": "00280| /**",
            "lineNumber": 7309
          },
          {
            "text": "00281|  * Simple backend health check with retries",
            "lineNumber": 7310
          },
          {
            "text": "00282|  * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)",
            "lineNumber": 7311
          },
          {
            "text": "00283|  * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)",
            "lineNumber": 7312
          },
          {
            "text": "00284|  * @returns Promise&lt;boolean&gt; - true if backend becomes ready, false if timeout",
            "lineNumber": 7313
          },
          {
            "text": "00285|  */",
            "lineNumber": 7314
          },
          {
            "text": "00286| export async function waitForBackendReady(",
            "lineNumber": 7315
          },
          {
            "text": "00287|   maxWaitMs: number = 10000,",
            "lineNumber": 7316
          },
          {
            "text": "00288|   retryIntervalMs: number = 500",
            "lineNumber": 7317
          },
          {
            "text": "00289| ): Promise&lt;boolean&gt; {",
            "lineNumber": 7318
          },
          {
            "text": "00290|   const startTime = Date.now();",
            "lineNumber": 7319
          },
          {
            "text": "00291|   console.log('[Backend Health Check] Waiting for backend to be ready...');",
            "lineNumber": 7320
          },
          {
            "text": "00292| ",
            "lineNumber": 7321
          },
          {
            "text": "00293|   while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 7322
          },
          {
            "text": "00294|     const isReady = await checkBackendHealth();",
            "lineNumber": 7323
          },
          {
            "text": "00295| ",
            "lineNumber": 7324
          },
          {
            "text": "00296|     if (isReady) {",
            "lineNumber": 7325
          },
          {
            "text": "00297|       console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 7326
          },
          {
            "text": "00298|       return true;",
            "lineNumber": 7327
          },
          {
            "text": "00299|     }",
            "lineNumber": 7328
          },
          {
            "text": "00300| ",
            "lineNumber": 7329
          },
          {
            "text": "00301|     console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 7330
          },
          {
            "text": "00302|     await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));",
            "lineNumber": 7331
          },
          {
            "text": "00303|   }",
            "lineNumber": 7332
          },
          {
            "text": "00304| ",
            "lineNumber": 7333
          },
          {
            "text": "00305|   console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);",
            "lineNumber": 7334
          },
          {
            "text": "00306|   return false;",
            "lineNumber": 7335
          },
          {
            "text": "00307| }",
            "lineNumber": 7336
          },
          {
            "text": "00308| ",
            "lineNumber": 7337
          },
          {
            "lineNumber": 7338
          },
          {
            "text": "(End of file - total 308 lines)",
            "lineNumber": 7339
          },
          {
            "text": "&lt;/file&gt;",
            "lineNumber": 7340
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 7341
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 7342
          },
          {
            "lineNumber": 7343
          },
          {
            "text": "---",
            "lineNumber": 7344
          },
          {
            "lineNumber": 7345
          },
          {
            "text": "## Assistant (Sisyphus ¬∑ antigravity-claude-opus-4-5-thinking ¬∑ 20.6s)",
            "lineNumber": 7346
          },
          {
            "lineNumber": 7347
          },
          {
            "text": "ÁèæÂú®ËÆÄÂèñ &#96;.env.development&#96; Ê™îÊ°à‰ª•‰∫ÜËß£Áí∞Â¢ÉÈÖçÁΩÆÔºå‰∏¶Êü•Áúã server Á´ØÁöÑÁôªÂÖ• APIÔºö",
            "lineNumber": 7348
          },
          {
            "lineNumber": 7349
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 7350
          },
          {
            "text": "Tool: read",
            "lineNumber": 7351
          },
          {
            "lineNumber": 7352
          },
          {
            "text": "**Input:**",
            "lineNumber": 7353
          },
          {
            "text": "&#96;&#96;&#96;json",
            "lineNumber": 7354
          },
          {
            "text": "{",
            "lineNumber": 7355
          },
          {
            "text": "  \"filePath\": \"D:\\\\_Code\\\\_GitHub\\\\eigent-260119\\\\.env.development\"",
            "lineNumber": 7356
          }
        ]
      },
      "score": 0.3335874676704407
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\store\\chatStore.ts",
        "range": {
          "startPosition": {
            "line": 162
          },
          "endPosition": {
            "line": 2594,
            "column": 1
          }
        },
        "contents": "const chatStore = \n(set, get) =&gt; (\n,\n\t\tstartTask: async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n\t\t\t// ‚úÖ Wait for backend to be ready before starting task (except for replay/share)\n\t\t\tif (!type || type === 'normal') {\n\t\t\t\tconsole.log('[startTask] Checking if backend is ready...');\n\t\t\t\tconst isBackendReady = await waitForBackendReady(15000, 500); // Wait up to 15 seconds\n\n\t\t\t\tif (!isBackendReady) {\n\t\t\t\t\tconsole.error('[startTask] Backend is not ready, cannot start task');\n\t\t\t\t\tconst { addMessages } = get();\n\t\t\t\t\taddMessages(taskId, {\n\t\t\t\t\t\tid: generateUniqueId(),\n\t\t\t\t\t\trole: 'agent',\n\t\t\t\t\t\tcontent: '‚ùå Backend service is not ready. Please wait a moment and try again, or restart the application if the problem persists.',\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconsole.log('[startTask] Backend is ready, proceeding with task...');\n\t\t\t}\n\n\t\t\tconst { token, language, modelType, cloud_model_type, email } = getAuthStore()\n\t\t\tconst workerList = useWorkerList();\n\t\t\tconst { getLastUserMessage, setDelayTime, setType } = get();\n\t\t\tconst baseURL = await getBaseURL();\n\t\t\tlet systemLanguage = language\n\t\t\tif (language === 'system') {\n\t\t\t\tsystemLanguage = await window.ipcRenderer.invoke('get-system-language');\n\t\t\t}\n\t\t\tif (type === 'replay') {\n\t\t\t\tsetDelayTime(taskId, delayTime as number)\n\t\t\t\tsetType(taskId, type)\n\t\t\t}\n\n\t\t\t//ProjectStore must exist as chatStore is already\n\t\t\tconst projectStore = useProjectStore.getState();\n\t\t\tconst project_id = projectStore.activeProjectId;\n\t\t\t//Create a new chatStore on Start\n\t\t\tlet newTaskId = taskId;\n\t\t\tlet targetChatStore = { getState: () =&gt; get() }; // Default to current store\n\t\t\t/**\n\t\t\t * Replay creates its own chatStore for each task with replayProject\n\t\t\t */\n\t\t}\n)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 163,
                "column": 1
              },
              "endPosition": {
                "line": 163,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 7
              },
              "endPosition": {
                "line": 163,
                "column": 19
              }
            },
            {
              "startPosition": {
                "line": 163,
                "column": 53
              },
              "endPosition": {
                "line": 163,
                "column": 53
              }
            },
            {
              "startPosition": {
                "line": 164,
                "column": 2
              },
              "endPosition": {
                "line": 164,
                "column": 17
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const chatStore = ",
            "lineNumber": 163
          },
          {
            "text": "(set, get) =&gt; (",
            "lineNumber": 164
          },
          {
            "text": ",",
            "lineNumber": 330
          },
          {
            "text": "\t\tstartTask: async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 331
          },
          {
            "text": "\t\t\t// ‚úÖ Wait for backend to be ready before starting task (except for replay/share)",
            "lineNumber": 332
          },
          {
            "text": "\t\t\tif (!type || type === 'normal') {",
            "lineNumber": 333
          },
          {
            "text": "\t\t\t\tconsole.log('[startTask] Checking if backend is ready...');",
            "lineNumber": 334
          },
          {
            "text": "\t\t\t\tconst isBackendReady = await waitForBackendReady(15000, 500); // Wait up to 15 seconds",
            "lineNumber": 335
          },
          {
            "lineNumber": 336
          },
          {
            "text": "\t\t\t\tif (!isBackendReady) {",
            "lineNumber": 337
          },
          {
            "text": "\t\t\t\t\tconsole.error('[startTask] Backend is not ready, cannot start task');",
            "lineNumber": 338
          },
          {
            "text": "\t\t\t\t\tconst { addMessages } = get();",
            "lineNumber": 339
          },
          {
            "text": "\t\t\t\t\taddMessages(taskId, {",
            "lineNumber": 340
          },
          {
            "text": "\t\t\t\t\t\tid: generateUniqueId(),",
            "lineNumber": 341
          },
          {
            "text": "\t\t\t\t\t\trole: 'agent',",
            "lineNumber": 342
          },
          {
            "text": "\t\t\t\t\t\tcontent: '‚ùå Backend service is not ready. Please wait a moment and try again, or restart the application if the problem persists.',",
            "lineNumber": 343
          },
          {
            "text": "\t\t\t\t\t});",
            "lineNumber": 344
          },
          {
            "text": "\t\t\t\t\treturn;",
            "lineNumber": 345
          },
          {
            "text": "\t\t\t\t}",
            "lineNumber": 346
          },
          {
            "text": "\t\t\t\tconsole.log('[startTask] Backend is ready, proceeding with task...');",
            "lineNumber": 347
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 348
          },
          {
            "lineNumber": 349
          },
          {
            "text": "\t\t\tconst { token, language, modelType, cloud_model_type, email } = getAuthStore()",
            "lineNumber": 350
          },
          {
            "text": "\t\t\tconst workerList = useWorkerList();",
            "lineNumber": 351
          },
          {
            "text": "\t\t\tconst { getLastUserMessage, setDelayTime, setType } = get();",
            "lineNumber": 352
          },
          {
            "text": "\t\t\tconst baseURL = await getBaseURL();",
            "lineNumber": 353
          },
          {
            "text": "\t\t\tlet systemLanguage = language",
            "lineNumber": 354
          },
          {
            "text": "\t\t\tif (language === 'system') {",
            "lineNumber": 355
          },
          {
            "text": "\t\t\t\tsystemLanguage = await window.ipcRenderer.invoke('get-system-language');",
            "lineNumber": 356
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 357
          },
          {
            "text": "\t\t\tif (type === 'replay') {",
            "lineNumber": 358
          },
          {
            "text": "\t\t\t\tsetDelayTime(taskId, delayTime as number)",
            "lineNumber": 359
          },
          {
            "text": "\t\t\t\tsetType(taskId, type)",
            "lineNumber": 360
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 361
          },
          {
            "lineNumber": 362
          },
          {
            "text": "\t\t\t//ProjectStore must exist as chatStore is already",
            "lineNumber": 363
          },
          {
            "text": "\t\t\tconst projectStore = useProjectStore.getState();",
            "lineNumber": 364
          },
          {
            "text": "\t\t\tconst project_id = projectStore.activeProjectId;",
            "lineNumber": 365
          },
          {
            "text": "\t\t\t//Create a new chatStore on Start",
            "lineNumber": 366
          },
          {
            "text": "\t\t\tlet newTaskId = taskId;",
            "lineNumber": 367
          },
          {
            "text": "\t\t\tlet targetChatStore = { getState: () =&gt; get() }; // Default to current store",
            "lineNumber": 368
          },
          {
            "text": "\t\t\t/**",
            "lineNumber": 369
          },
          {
            "text": "\t\t\t * Replay creates its own chatStore for each task with replayProject",
            "lineNumber": 370
          },
          {
            "text": "\t\t\t */",
            "lineNumber": 371
          },
          {
            "text": "\t\t}",
            "lineNumber": 1888
          },
          {
            "text": ")",
            "lineNumber": 2594
          },
          {
            "text": ";",
            "lineNumber": 2595
          }
        ]
      },
      "score": 0.33282971382141113
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\hooks\\useInstallationSetup.ts",
        "range": {
          "startPosition": {
            "line": 8
          },
          "endPosition": {
            "line": 322,
            "column": 1
          }
        },
        "contents": "export const useInstallationSetup = \n() =&gt; {\n\n\n    hasCheckedOnMount.current = true;\n\n    const checkToolInstalled = async () =&gt; {\n      try {\n        const result = await window.ipcRenderer.invoke(\"check-tool-installed\");\n\n        if (result.success) {\n          if (result.isInstalled) {\n            console.log(\n              \"[useInstallationSetup] Tools already installed, waiting for backend\"\n            );\n            installationCompleted.current = true;\n            setWaitingBackend();\n\n            // Start polling for backend when tools are already installed\n            startBackendPolling();\n          }\n\n          if (initState !== \"done\") {\n            if (!result.isInstalled &amp;&amp; initState === \"permissions\") {\n              console.log(\n                \"[useInstallationSetup] Tools not installed and initState is permissions, setting to carousel\"\n              );\n              setInitState(\"carousel\");\n            }\n          }\n        }\n        return result;\n      } catch (error) {\n        console.error(\n          \"[useInstallationSetup] Tool installation check failed:\",\n          error\n        );\n        return { success: false, error };\n      }\n    };\n\n    const checkBackendStatus = async (toolResult?: any) =&gt; {\n      try {\n        const installationStatus =\n          await window.electronAPI.getInstallationStatus();\n\n        if (installationStatus.success &amp;&amp; installationStatus.isInstalling) {\n          startInstallation();\n        }\n      } catch (err) {\n        console.error(\n          \"[useInstallationSetup] Failed to check installation status:\",\n          err\n        );\n      }\n    };\n\n    const runInitialChecks = async () =&gt; {\n      const toolResult = await checkToolInstalled();\n      await checkBackendStatus(toolResult);\n    };\n\n    runInitialChecks();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() =&gt; {\n    const checkAndSetDone = () =&gt;\n;\n  }\n\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 9,
                "column": 1
              },
              "endPosition": {
                "line": 9,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 8
              },
              "endPosition": {
                "line": 9,
                "column": 14
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 14
              },
              "endPosition": {
                "line": 9,
                "column": 37
              }
            },
            {
              "startPosition": {
                "line": 150,
                "column": 3
              },
              "endPosition": {
                "line": 150,
                "column": 3
              }
            },
            {
              "startPosition": {
                "line": 150,
                "column": 13
              },
              "endPosition": {
                "line": 151,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export const useInstallationSetup = ",
            "lineNumber": 9
          },
          {
            "text": "() =&gt; {",
            "lineNumber": 150
          },
          {
            "lineNumber": 153
          },
          {
            "lineNumber": 154
          },
          {
            "text": "    hasCheckedOnMount.current = true;",
            "lineNumber": 155
          },
          {
            "lineNumber": 156
          },
          {
            "text": "    const checkToolInstalled = async () =&gt; {",
            "lineNumber": 157
          },
          {
            "text": "      try {",
            "lineNumber": 158
          },
          {
            "text": "        const result = await window.ipcRenderer.invoke(\"check-tool-installed\");",
            "lineNumber": 159
          },
          {
            "lineNumber": 160
          },
          {
            "text": "        if (result.success) {",
            "lineNumber": 161
          },
          {
            "text": "          if (result.isInstalled) {",
            "lineNumber": 162
          },
          {
            "text": "            console.log(",
            "lineNumber": 163
          },
          {
            "text": "              \"[useInstallationSetup] Tools already installed, waiting for backend\"",
            "lineNumber": 164
          },
          {
            "text": "            );",
            "lineNumber": 165
          },
          {
            "text": "            installationCompleted.current = true;",
            "lineNumber": 166
          },
          {
            "text": "            setWaitingBackend();",
            "lineNumber": 167
          },
          {
            "lineNumber": 168
          },
          {
            "text": "            // Start polling for backend when tools are already installed",
            "lineNumber": 169
          },
          {
            "text": "            startBackendPolling();",
            "lineNumber": 170
          },
          {
            "text": "          }",
            "lineNumber": 171
          },
          {
            "lineNumber": 172
          },
          {
            "text": "          if (initState !== \"done\") {",
            "lineNumber": 173
          },
          {
            "text": "            if (!result.isInstalled &amp;&amp; initState === \"permissions\") {",
            "lineNumber": 174
          },
          {
            "text": "              console.log(",
            "lineNumber": 175
          },
          {
            "text": "                \"[useInstallationSetup] Tools not installed and initState is permissions, setting to carousel\"",
            "lineNumber": 176
          },
          {
            "text": "              );",
            "lineNumber": 177
          },
          {
            "text": "              setInitState(\"carousel\");",
            "lineNumber": 178
          },
          {
            "text": "            }",
            "lineNumber": 179
          },
          {
            "text": "          }",
            "lineNumber": 180
          },
          {
            "text": "        }",
            "lineNumber": 181
          },
          {
            "text": "        return result;",
            "lineNumber": 182
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 183
          },
          {
            "text": "        console.error(",
            "lineNumber": 184
          },
          {
            "text": "          \"[useInstallationSetup] Tool installation check failed:\",",
            "lineNumber": 185
          },
          {
            "text": "          error",
            "lineNumber": 186
          },
          {
            "text": "        );",
            "lineNumber": 187
          },
          {
            "text": "        return { success: false, error };",
            "lineNumber": 188
          },
          {
            "text": "      }",
            "lineNumber": 189
          },
          {
            "text": "    };",
            "lineNumber": 190
          },
          {
            "lineNumber": 191
          },
          {
            "text": "    const checkBackendStatus = async (toolResult?: any) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "      try {",
            "lineNumber": 193
          },
          {
            "text": "        const installationStatus =",
            "lineNumber": 194
          },
          {
            "text": "          await window.electronAPI.getInstallationStatus();",
            "lineNumber": 195
          },
          {
            "lineNumber": 196
          },
          {
            "text": "        if (installationStatus.success &amp;&amp; installationStatus.isInstalling) {",
            "lineNumber": 197
          },
          {
            "text": "          startInstallation();",
            "lineNumber": 198
          },
          {
            "text": "        }",
            "lineNumber": 199
          },
          {
            "text": "      } catch (err) {",
            "lineNumber": 200
          },
          {
            "text": "        console.error(",
            "lineNumber": 201
          },
          {
            "text": "          \"[useInstallationSetup] Failed to check installation status:\",",
            "lineNumber": 202
          },
          {
            "text": "          err",
            "lineNumber": 203
          },
          {
            "text": "        );",
            "lineNumber": 204
          },
          {
            "text": "      }",
            "lineNumber": 205
          },
          {
            "text": "    };",
            "lineNumber": 206
          },
          {
            "lineNumber": 207
          },
          {
            "text": "    const runInitialChecks = async () =&gt; {",
            "lineNumber": 208
          },
          {
            "text": "      const toolResult = await checkToolInstalled();",
            "lineNumber": 209
          },
          {
            "text": "      await checkBackendStatus(toolResult);",
            "lineNumber": 210
          },
          {
            "text": "    };",
            "lineNumber": 211
          },
          {
            "lineNumber": 212
          },
          {
            "text": "    runInitialChecks();",
            "lineNumber": 213
          },
          {
            "text": "    // eslint-disable-next-line react-hooks/exhaustive-deps",
            "lineNumber": 214
          },
          {
            "text": "  }, []);",
            "lineNumber": 215
          },
          {
            "lineNumber": 216
          },
          {
            "text": "  useEffect(() =&gt; {",
            "lineNumber": 217
          },
          {
            "text": "    const checkAndSetDone = () =&gt;",
            "lineNumber": 218
          },
          {
            "text": ";",
            "lineNumber": 232
          },
          {
            "text": "  }",
            "lineNumber": 314
          },
          {
            "lineNumber": 322
          },
          {
            "text": ";",
            "lineNumber": 323
          }
        ]
      },
      "score": 0.32307499647140503
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nasync (resolve, reject) =&gt; {\n\n\n        setTimeout(() =&gt; {\n            if (node_process.killed) {\n                log.error('Backend process was killed immediately after spawn');\n            } else if (!node_process.pid) {\n                log.error('Backend process has no PID');\n            } else {\n                log.info(&#96;Backend process still running after 1s with PID ${node_process.pid}&#96;);\n            }\n        }, 1000);\n\n        let started = false;\n        let healthCheckInterval: NodeJS.Timeout | null = null;\n\n        const startTimeout = setTimeout(() =&gt; {\n            if (!started) {\n                if (healthCheckInterval) clearInterval(healthCheckInterval);\n                killBackendProcess(node_process);\n                reject(new Error('Backend failed to start within timeout'));\n            }\n        }, 65000);\n\n        const initialDelay = setTimeout(() =&gt; {\n            if (!started) {\n                log.info('Starting backend health check polling...');\n                pollHealthEndpoint();\n            }\n        }, 2000);\n\n        const killBackendProcess = (proc: any) =&gt;\n;\n    }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            },
            {
              "startPosition": {
                "line": 192,
                "column": 24
              },
              "endPosition": {
                "line": 193,
                "column": 9
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "lineNumber": 295
          },
          {
            "lineNumber": 296
          },
          {
            "text": "        setTimeout(() =&gt; {",
            "lineNumber": 297
          },
          {
            "text": "            if (node_process.killed) {",
            "lineNumber": 298
          },
          {
            "text": "                log.error('Backend process was killed immediately after spawn');",
            "lineNumber": 299
          },
          {
            "text": "            } else if (!node_process.pid) {",
            "lineNumber": 300
          },
          {
            "text": "                log.error('Backend process has no PID');",
            "lineNumber": 301
          },
          {
            "text": "            } else {",
            "lineNumber": 302
          },
          {
            "text": "                log.info(&#96;Backend process still running after 1s with PID ${node_process.pid}&#96;);",
            "lineNumber": 303
          },
          {
            "text": "            }",
            "lineNumber": 304
          },
          {
            "text": "        }, 1000);",
            "lineNumber": 305
          },
          {
            "lineNumber": 306
          },
          {
            "text": "        let started = false;",
            "lineNumber": 307
          },
          {
            "text": "        let healthCheckInterval: NodeJS.Timeout | null = null;",
            "lineNumber": 308
          },
          {
            "lineNumber": 309
          },
          {
            "text": "        const startTimeout = setTimeout(() =&gt; {",
            "lineNumber": 310
          },
          {
            "text": "            if (!started) {",
            "lineNumber": 311
          },
          {
            "text": "                if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 312
          },
          {
            "text": "                killBackendProcess(node_process);",
            "lineNumber": 313
          },
          {
            "text": "                reject(new Error('Backend failed to start within timeout'));",
            "lineNumber": 314
          },
          {
            "text": "            }",
            "lineNumber": 315
          },
          {
            "text": "        }, 65000);",
            "lineNumber": 316
          },
          {
            "lineNumber": 317
          },
          {
            "text": "        const initialDelay = setTimeout(() =&gt; {",
            "lineNumber": 318
          },
          {
            "text": "            if (!started) {",
            "lineNumber": 319
          },
          {
            "text": "                log.info('Starting backend health check polling...');",
            "lineNumber": 320
          },
          {
            "text": "                pollHealthEndpoint();",
            "lineNumber": 321
          },
          {
            "text": "            }",
            "lineNumber": 322
          },
          {
            "text": "        }, 2000);",
            "lineNumber": 323
          },
          {
            "lineNumber": 324
          },
          {
            "text": "        const killBackendProcess = (proc: any) =&gt;",
            "lineNumber": 325
          },
          {
            "text": ";",
            "lineNumber": 348
          },
          {
            "text": "    }",
            "lineNumber": 451
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.32047224044799805
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nasync (resolve, reject) =&gt; {\nconst pollHealthEndpoint = \n() =&gt; {\n\n\n                req.on('error', () =&gt; {\n                    // Connection error - backend might not be ready yet, continue polling\n                    if (attempts &gt;= maxAttempts) {\n                        log.error(&#96;Backend health check failed after ${attempts} attempts: unable to connect&#96;);\n                        started = true;\n                        clearTimeout(startTimeout);\n                        if (healthCheckInterval) clearInterval(healthCheckInterval);\n                        killBackendProcess(node_process);\n                        reject(new Error('Backend health check failed: unable to connect'));\n                    }\n                });\n\n                req.on('timeout', () =&gt; {\n                    req.destroy();\n                    if (attempts &gt;= maxAttempts) {\n                        log.error(&#96;Backend health check timed out after ${attempts} attempts&#96;);\n                        started = true;\n                        clearTimeout(startTimeout);\n                        if (healthCheckInterval) clearInterval(healthCheckInterval);\n                        killBackendProcess(node_process);\n                        reject(new Error('Backend health check timed out'));\n                    }\n                });\n            }, intervalMs);\n        };\n\n        node_process.stdout.on('data', (data) =&gt; {\n            log.debug(&#96;Backend stdout received ${data.length} bytes&#96;);\n            displayFilteredLogs(data);\n        });\n\n        node_process.stderr.on('data',\n\n    }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            },
            {
              "startPosition": {
                "line": 192,
                "column": 24
              },
              "endPosition": {
                "line": 193,
                "column": 9
              }
            },
            {
              "startPosition": {
                "line": 350,
                "column": 9
              },
              "endPosition": {
                "line": 350,
                "column": 15
              }
            },
            {
              "startPosition": {
                "line": 350,
                "column": 15
              },
              "endPosition": {
                "line": 350,
                "column": 36
              }
            },
            {
              "startPosition": {
                "line": 355,
                "column": 35
              },
              "endPosition": {
                "line": 355,
                "column": 35
              }
            },
            {
              "startPosition": {
                "line": 355,
                "column": 47
              },
              "endPosition": {
                "line": 356,
                "column": 17
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "const pollHealthEndpoint = ",
            "lineNumber": 350
          },
          {
            "text": "() =&gt; {",
            "lineNumber": 355
          },
          {
            "lineNumber": 378
          },
          {
            "lineNumber": 379
          },
          {
            "text": "                req.on('error', () =&gt; {",
            "lineNumber": 380
          },
          {
            "text": "                    // Connection error - backend might not be ready yet, continue polling",
            "lineNumber": 381
          },
          {
            "text": "                    if (attempts &gt;= maxAttempts) {",
            "lineNumber": 382
          },
          {
            "text": "                        log.error(&#96;Backend health check failed after ${attempts} attempts: unable to connect&#96;);",
            "lineNumber": 383
          },
          {
            "text": "                        started = true;",
            "lineNumber": 384
          },
          {
            "text": "                        clearTimeout(startTimeout);",
            "lineNumber": 385
          },
          {
            "text": "                        if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 386
          },
          {
            "text": "                        killBackendProcess(node_process);",
            "lineNumber": 387
          },
          {
            "text": "                        reject(new Error('Backend health check failed: unable to connect'));",
            "lineNumber": 388
          },
          {
            "text": "                    }",
            "lineNumber": 389
          },
          {
            "text": "                });",
            "lineNumber": 390
          },
          {
            "lineNumber": 391
          },
          {
            "text": "                req.on('timeout', () =&gt; {",
            "lineNumber": 392
          },
          {
            "text": "                    req.destroy();",
            "lineNumber": 393
          },
          {
            "text": "                    if (attempts &gt;= maxAttempts) {",
            "lineNumber": 394
          },
          {
            "text": "                        log.error(&#96;Backend health check timed out after ${attempts} attempts&#96;);",
            "lineNumber": 395
          },
          {
            "text": "                        started = true;",
            "lineNumber": 396
          },
          {
            "text": "                        clearTimeout(startTimeout);",
            "lineNumber": 397
          },
          {
            "text": "                        if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 398
          },
          {
            "text": "                        killBackendProcess(node_process);",
            "lineNumber": 399
          },
          {
            "text": "                        reject(new Error('Backend health check timed out'));",
            "lineNumber": 400
          },
          {
            "text": "                    }",
            "lineNumber": 401
          },
          {
            "text": "                });",
            "lineNumber": 402
          },
          {
            "text": "            }, intervalMs);",
            "lineNumber": 403
          },
          {
            "text": "        };",
            "lineNumber": 404
          },
          {
            "lineNumber": 405
          },
          {
            "text": "        node_process.stdout.on('data', (data) =&gt; {",
            "lineNumber": 406
          },
          {
            "text": "            log.debug(&#96;Backend stdout received ${data.length} bytes&#96;);",
            "lineNumber": 407
          },
          {
            "text": "            displayFilteredLogs(data);",
            "lineNumber": 408
          },
          {
            "text": "        });",
            "lineNumber": 409
          },
          {
            "lineNumber": 410
          },
          {
            "text": "        node_process.stderr.on('data',",
            "lineNumber": 411
          },
          {
            "lineNumber": 426
          },
          {
            "text": "    }",
            "lineNumber": 451
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.3202987015247345
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\hooks\\useInstallationSetup.ts",
        "range": {
          "startPosition": {
            "line": 8
          },
          "endPosition": {
            "line": 322,
            "column": 2
          }
        },
        "contents": "export const useInstallationSetup = \n() =&gt; {\n\n\n    const handleBackendReady = (data: {\n      success: boolean;\n      port?: number;\n      error?: string;\n    }) =&gt; {\n      console.log(\"[useInstallationSetup] Backend ready event received:\", data);\n\n      if (data.success &amp;&amp; data.port) {\n        console.log(\n          &#96;[useInstallationSetup] Backend is ready on port ${data.port}&#96;\n        );\n        backendReady.current = true;\n        // If backend is ready, installation must be complete (or satisfied enough)\n        // This handles race condition where install-complete event is missed or skipped\n        if (!installationCompleted.current) {\n          console.log(\n            \"[useInstallationSetup] Backend ready implies installation complete - setting flag\"\n          );\n          installationCompleted.current = true;\n        }\n        console.log(\"[useInstallationSetup] Backend marked as ready\");\n\n        setSuccess();\n        setNeedsBackendRestart(false);\n        checkAndSetDone();\n      } else {\n        console.error(\n          \"[useInstallationSetup] Backend failed to start:\",\n          data.error\n        );\n        setBackendError(data.error || \"Backend startup failed\");\n      }\n    };\n\n    window.electronAPI.onInstallDependenciesStart(handleInstallStart);\n    window.electronAPI.onInstallDependenciesLog(handleInstallLog);\n    window.electronAPI.onInstallDependenciesComplete(handleInstallComplete);\n    window.electronAPI.onBackendReady(handleBackendReady);\n\n    return () =&gt; {\n      window.electronAPI.removeAllListeners(\"install-dependencies-start\");\n      window.electronAPI.removeAllListeners(\"install-dependencies-log\");\n      window.electronAPI.removeAllListeners(\"install-dependencies-complete\");\n      window.electronAPI.removeAllListeners(\"backend-ready\");\n    };\n  }, [\n    startInstallation,\n    addLog,\n    setSuccess,\n    setError,\n    setBackendError,\n    setInitState,\n    setNeedsBackendRestart,\n  ]);\n};",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 9,
                "column": 1
              },
              "endPosition": {
                "line": 9,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 8
              },
              "endPosition": {
                "line": 9,
                "column": 14
              }
            },
            {
              "startPosition": {
                "line": 9,
                "column": 14
              },
              "endPosition": {
                "line": 9,
                "column": 37
              }
            },
            {
              "startPosition": {
                "line": 217,
                "column": 3
              },
              "endPosition": {
                "line": 217,
                "column": 3
              }
            },
            {
              "startPosition": {
                "line": 217,
                "column": 13
              },
              "endPosition": {
                "line": 218,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export const useInstallationSetup = ",
            "lineNumber": 9
          },
          {
            "text": "() =&gt; {",
            "lineNumber": 217
          },
          {
            "lineNumber": 267
          },
          {
            "lineNumber": 268
          },
          {
            "text": "    const handleBackendReady = (data: {",
            "lineNumber": 269
          },
          {
            "text": "      success: boolean;",
            "lineNumber": 270
          },
          {
            "text": "      port?: number;",
            "lineNumber": 271
          },
          {
            "text": "      error?: string;",
            "lineNumber": 272
          },
          {
            "text": "    }) =&gt; {",
            "lineNumber": 273
          },
          {
            "text": "      console.log(\"[useInstallationSetup] Backend ready event received:\", data);",
            "lineNumber": 274
          },
          {
            "lineNumber": 275
          },
          {
            "text": "      if (data.success &amp;&amp; data.port) {",
            "lineNumber": 276
          },
          {
            "text": "        console.log(",
            "lineNumber": 277
          },
          {
            "text": "          &#96;[useInstallationSetup] Backend is ready on port ${data.port}&#96;",
            "lineNumber": 278
          },
          {
            "text": "        );",
            "lineNumber": 279
          },
          {
            "text": "        backendReady.current = true;",
            "lineNumber": 280
          },
          {
            "text": "        // If backend is ready, installation must be complete (or satisfied enough)",
            "lineNumber": 281
          },
          {
            "text": "        // This handles race condition where install-complete event is missed or skipped",
            "lineNumber": 282
          },
          {
            "text": "        if (!installationCompleted.current) {",
            "lineNumber": 283
          },
          {
            "text": "          console.log(",
            "lineNumber": 284
          },
          {
            "text": "            \"[useInstallationSetup] Backend ready implies installation complete - setting flag\"",
            "lineNumber": 285
          },
          {
            "text": "          );",
            "lineNumber": 286
          },
          {
            "text": "          installationCompleted.current = true;",
            "lineNumber": 287
          },
          {
            "text": "        }",
            "lineNumber": 288
          },
          {
            "text": "        console.log(\"[useInstallationSetup] Backend marked as ready\");",
            "lineNumber": 289
          },
          {
            "lineNumber": 290
          },
          {
            "text": "        setSuccess();",
            "lineNumber": 291
          },
          {
            "text": "        setNeedsBackendRestart(false);",
            "lineNumber": 292
          },
          {
            "text": "        checkAndSetDone();",
            "lineNumber": 293
          },
          {
            "text": "      } else {",
            "lineNumber": 294
          },
          {
            "text": "        console.error(",
            "lineNumber": 295
          },
          {
            "text": "          \"[useInstallationSetup] Backend failed to start:\",",
            "lineNumber": 296
          },
          {
            "text": "          data.error",
            "lineNumber": 297
          },
          {
            "text": "        );",
            "lineNumber": 298
          },
          {
            "text": "        setBackendError(data.error || \"Backend startup failed\");",
            "lineNumber": 299
          },
          {
            "text": "      }",
            "lineNumber": 300
          },
          {
            "text": "    };",
            "lineNumber": 301
          },
          {
            "lineNumber": 302
          },
          {
            "text": "    window.electronAPI.onInstallDependenciesStart(handleInstallStart);",
            "lineNumber": 303
          },
          {
            "text": "    window.electronAPI.onInstallDependenciesLog(handleInstallLog);",
            "lineNumber": 304
          },
          {
            "text": "    window.electronAPI.onInstallDependenciesComplete(handleInstallComplete);",
            "lineNumber": 305
          },
          {
            "text": "    window.electronAPI.onBackendReady(handleBackendReady);",
            "lineNumber": 306
          },
          {
            "lineNumber": 307
          },
          {
            "text": "    return () =&gt; {",
            "lineNumber": 308
          },
          {
            "text": "      window.electronAPI.removeAllListeners(\"install-dependencies-start\");",
            "lineNumber": 309
          },
          {
            "text": "      window.electronAPI.removeAllListeners(\"install-dependencies-log\");",
            "lineNumber": 310
          },
          {
            "text": "      window.electronAPI.removeAllListeners(\"install-dependencies-complete\");",
            "lineNumber": 311
          },
          {
            "text": "      window.electronAPI.removeAllListeners(\"backend-ready\");",
            "lineNumber": 312
          },
          {
            "text": "    };",
            "lineNumber": 313
          },
          {
            "text": "  }, [",
            "lineNumber": 314
          },
          {
            "text": "    startInstallation,",
            "lineNumber": 315
          },
          {
            "text": "    addLog,",
            "lineNumber": 316
          },
          {
            "text": "    setSuccess,",
            "lineNumber": 317
          },
          {
            "text": "    setError,",
            "lineNumber": 318
          },
          {
            "text": "    setBackendError,",
            "lineNumber": 319
          },
          {
            "text": "    setInitState,",
            "lineNumber": 320
          },
          {
            "text": "    setNeedsBackendRestart,",
            "lineNumber": 321
          },
          {
            "text": "  ]);",
            "lineNumber": 322
          },
          {
            "text": "};",
            "lineNumber": 323
          }
        ]
      },
      "score": 0.3065091371536255
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\src\\components\\Layout\\index.tsx",
        "range": {
          "startPosition": {
            "line": 13,
            "column": 31
          },
          "endPosition": {
            "line": 105,
            "column": 1
          }
        },
        "contents": " \"@/hooks/useChatStoreAdapter\";\n\nconst Layout = () =&gt; {\n\tconst { initState, isFirstLaunch, setIsFirstLaunch, setInitState } = useAuthStore();\n\tconst [noticeOpen, setNoticeOpen] = useState(false);\n\n\t//Get Chatstore for the active project's task\n\tconst { chatStore } = useChatStoreAdapter();\n\tif (!chatStore) {\n\t\tconsole.log(chatStore);\n\n\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;\n\t}\n\n\tconst {\n\t\tinstallationState,\n\t\tlatestLog,\n\t\terror,\n\t\tbackendError,\n\t\tisInstalling,\n\t\tshouldShowInstallScreen,\n\t\tretryInstallation,\n\t\tretryBackend,\n\t} = useInstallationUI();\n\n\tuseInstallationSetup();\n\n\tuseEffect(() =&gt; {\n\t\tconst handleBeforeClose = () =&gt; {\n\t\t\tconst currentStatus = chatStore.tasks[chatStore.activeTaskId as string]?.status;\n\t\t\tif([\"running\", \"pause\"].includes(currentStatus)) {\n\t\t\t\tsetNoticeOpen(true);\n\t\t\t} else {\n\t\t\t\twindow.electronAPI.closeWindow(true);\n\t\t\t}\n\t\t};\n\n\t\twindow.ipcRenderer.on(\"before-close\", handleBeforeClose);\n\n\t\treturn () =&gt; {\n\t\t\twindow.ipcRenderer.removeAllListeners(\"before-close\");\n\t\t};\n\t}, [chatStore.tasks, chatStore.activeTaskId]);\n\n\t// Determine what to show based on states\n\tconst shouldShowOnboarding = initState === \"done\" &amp;&amp; isFirstLaunch &amp;&amp; !isInstalling;\n\n\tconst actualShouldShowInstallScreen = shouldShowInstallScreen || initState !== 'done' || installationState === 'waiting-backend';\n\tconst shouldShowMainContent = !actualShouldShowInstallScreen;\n\n\treturn (\n\t\t&lt;div className=\"h-full flex flex-col relative overflow-hidden\"&gt;\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": " \"@/hooks/useChatStoreAdapter\";",
            "lineNumber": 14
          },
          {
            "lineNumber": 15
          },
          {
            "text": "const Layout = () =&gt; {",
            "lineNumber": 16
          },
          {
            "text": "\tconst { initState, isFirstLaunch, setIsFirstLaunch, setInitState } = useAuthStore();",
            "lineNumber": 17
          },
          {
            "text": "\tconst [noticeOpen, setNoticeOpen] = useState(false);",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "\t//Get Chatstore for the active project's task",
            "lineNumber": 20
          },
          {
            "text": "\tconst { chatStore } = useChatStoreAdapter();",
            "lineNumber": 21
          },
          {
            "text": "\tif (!chatStore) {",
            "lineNumber": 22
          },
          {
            "text": "\t\tconsole.log(chatStore);",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "\t\treturn &lt;div&gt;Loading...&lt;/div&gt;;",
            "lineNumber": 25
          },
          {
            "text": "\t}",
            "lineNumber": 26
          },
          {
            "lineNumber": 27
          },
          {
            "text": "\tconst {",
            "lineNumber": 28
          },
          {
            "text": "\t\tinstallationState,",
            "lineNumber": 29
          },
          {
            "text": "\t\tlatestLog,",
            "lineNumber": 30
          },
          {
            "text": "\t\terror,",
            "lineNumber": 31
          },
          {
            "text": "\t\tbackendError,",
            "lineNumber": 32
          },
          {
            "text": "\t\tisInstalling,",
            "lineNumber": 33
          },
          {
            "text": "\t\tshouldShowInstallScreen,",
            "lineNumber": 34
          },
          {
            "text": "\t\tretryInstallation,",
            "lineNumber": 35
          },
          {
            "text": "\t\tretryBackend,",
            "lineNumber": 36
          },
          {
            "text": "\t} = useInstallationUI();",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "\tuseInstallationSetup();",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "\tuseEffect(() =&gt; {",
            "lineNumber": 41
          },
          {
            "text": "\t\tconst handleBeforeClose = () =&gt; {",
            "lineNumber": 42
          },
          {
            "text": "\t\t\tconst currentStatus = chatStore.tasks[chatStore.activeTaskId as string]?.status;",
            "lineNumber": 43
          },
          {
            "text": "\t\t\tif([\"running\", \"pause\"].includes(currentStatus)) {",
            "lineNumber": 44
          },
          {
            "text": "\t\t\t\tsetNoticeOpen(true);",
            "lineNumber": 45
          },
          {
            "text": "\t\t\t} else {",
            "lineNumber": 46
          },
          {
            "text": "\t\t\t\twindow.electronAPI.closeWindow(true);",
            "lineNumber": 47
          },
          {
            "text": "\t\t\t}",
            "lineNumber": 48
          },
          {
            "text": "\t\t};",
            "lineNumber": 49
          },
          {
            "lineNumber": 50
          },
          {
            "text": "\t\twindow.ipcRenderer.on(\"before-close\", handleBeforeClose);",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "\t\treturn () =&gt; {",
            "lineNumber": 53
          },
          {
            "text": "\t\t\twindow.ipcRenderer.removeAllListeners(\"before-close\");",
            "lineNumber": 54
          },
          {
            "text": "\t\t};",
            "lineNumber": 55
          },
          {
            "text": "\t}, [chatStore.tasks, chatStore.activeTaskId]);",
            "lineNumber": 56
          },
          {
            "lineNumber": 57
          },
          {
            "text": "\t// Determine what to show based on states",
            "lineNumber": 58
          },
          {
            "text": "\tconst shouldShowOnboarding = initState === \"done\" &amp;&amp; isFirstLaunch &amp;&amp; !isInstalling;",
            "lineNumber": 59
          },
          {
            "lineNumber": 60
          },
          {
            "text": "\tconst actualShouldShowInstallScreen = shouldShowInstallScreen || initState !== 'done' || installationState === 'waiting-backend';",
            "lineNumber": 61
          },
          {
            "text": "\tconst shouldShowMainContent = !actualShouldShowInstallScreen;",
            "lineNumber": 62
          },
          {
            "lineNumber": 63
          },
          {
            "text": "\treturn (",
            "lineNumber": 64
          },
          {
            "text": "\t\t&lt;div className=\"h-full flex flex-col relative overflow-hidden\"&gt;",
            "lineNumber": 65
          },
          {
            "text": ";",
            "lineNumber": 106
          }
        ]
      },
      "score": 0.2952784299850464
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nasync (resolve, reject) =&gt; {\nconst ;\n                const proxyArgs = timezone === 'Asia/Shanghai'\n                    ? [\n                        '--default-index', 'https://mirrors.aliyun.com/pypi/simple/',\n                        '--index', 'https://pypi.org/simple/'\n                    ]\n                    : [];\n\n                // Step 1: Ensure Python is installed (fixes corrupted/missing Python)\n                log.info(\"Step 1: Ensuring Python is installed...\");\n                await execAsync(&#96;${uv_path} python install 3.10&#96;, { cwd: backendPath, env: env });\n\n                // Step 2: Sync dependencies\n                log.info(\"Step 2: Syncing dependencies...\");\n                const syncArgs = ['sync', '--no-dev', ...proxyArgs];\n                await execAsync(&#96;${uv_path} ${syncArgs.join(' ')}&#96;, { cwd: backendPath, env: env });\n\n                // Retry the check\n                const { stdout: pythonTest } = await execAsync(\n                    &#96;${uv_path} run python -c \"print('Python OK')\"&#96;,\n                    { cwd: backendPath, env: env }\n                );\n                log.info(&#96;Python test output after repair: ${pythonTest.trim()}&#96;);\n            } catch (repairErr) {\n                log.error(&#96;Repair failed: ${repairErr}&#96;);\n                reject(new Error(&#96;Backend environment check failed: ${testErr}\\nRepair failed: ${repairErr}&#96;));\n                return;\n            }\n        }\n\n        const node_process = spawn(\n            uv_path,\n            [\"run\", \"uvicorn\", \"main:api\", \"--port\", port.toString(), \"--loop\", \"asyncio\"],\n            {\n                cwd: backendPath,\n                env: env,\n                detached: process.platform !== 'win32',\n                stdio: ['ignore', 'pipe', 'pipe']\n            }\n        );\n\n        // NOTE: Do NOT use unref() - we need to maintain the process reference\n        // to properly capture stdout/stderr and manage the process lifecycle\n\n        log.info(&#96;Backend process spawned with PID: ${node_process.pid}&#96;);\n\n        setTimeout(() =&gt; {\n            if (node_process.killed)\n        }\n    }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            },
            {
              "startPosition": {
                "line": 192,
                "column": 24
              },
              "endPosition": {
                "line": 193,
                "column": 9
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "const ;",
            "lineNumber": 251
          },
          {
            "text": "                const proxyArgs = timezone === 'Asia/Shanghai'",
            "lineNumber": 252
          },
          {
            "text": "                    ? [",
            "lineNumber": 253
          },
          {
            "text": "                        '--default-index', 'https://mirrors.aliyun.com/pypi/simple/',",
            "lineNumber": 254
          },
          {
            "text": "                        '--index', 'https://pypi.org/simple/'",
            "lineNumber": 255
          },
          {
            "text": "                    ]",
            "lineNumber": 256
          },
          {
            "text": "                    : [];",
            "lineNumber": 257
          },
          {
            "lineNumber": 258
          },
          {
            "text": "                // Step 1: Ensure Python is installed (fixes corrupted/missing Python)",
            "lineNumber": 259
          },
          {
            "text": "                log.info(\"Step 1: Ensuring Python is installed...\");",
            "lineNumber": 260
          },
          {
            "text": "                await execAsync(&#96;${uv_path} python install 3.10&#96;, { cwd: backendPath, env: env });",
            "lineNumber": 261
          },
          {
            "lineNumber": 262
          },
          {
            "text": "                // Step 2: Sync dependencies",
            "lineNumber": 263
          },
          {
            "text": "                log.info(\"Step 2: Syncing dependencies...\");",
            "lineNumber": 264
          },
          {
            "text": "                const syncArgs = ['sync', '--no-dev', ...proxyArgs];",
            "lineNumber": 265
          },
          {
            "text": "                await execAsync(&#96;${uv_path} ${syncArgs.join(' ')}&#96;, { cwd: backendPath, env: env });",
            "lineNumber": 266
          },
          {
            "lineNumber": 267
          },
          {
            "text": "                // Retry the check",
            "lineNumber": 268
          },
          {
            "text": "                const { stdout: pythonTest } = await execAsync(",
            "lineNumber": 269
          },
          {
            "text": "                    &#96;${uv_path} run python -c \"print('Python OK')\"&#96;,",
            "lineNumber": 270
          },
          {
            "text": "                    { cwd: backendPath, env: env }",
            "lineNumber": 271
          },
          {
            "text": "                );",
            "lineNumber": 272
          },
          {
            "text": "                log.info(&#96;Python test output after repair: ${pythonTest.trim()}&#96;);",
            "lineNumber": 273
          },
          {
            "text": "            } catch (repairErr) {",
            "lineNumber": 274
          },
          {
            "text": "                log.error(&#96;Repair failed: ${repairErr}&#96;);",
            "lineNumber": 275
          },
          {
            "text": "                reject(new Error(&#96;Backend environment check failed: ${testErr}\\nRepair failed: ${repairErr}&#96;));",
            "lineNumber": 276
          },
          {
            "text": "                return;",
            "lineNumber": 277
          },
          {
            "text": "            }",
            "lineNumber": 278
          },
          {
            "text": "        }",
            "lineNumber": 279
          },
          {
            "lineNumber": 280
          },
          {
            "text": "        const node_process = spawn(",
            "lineNumber": 281
          },
          {
            "text": "            uv_path,",
            "lineNumber": 282
          },
          {
            "text": "            [\"run\", \"uvicorn\", \"main:api\", \"--port\", port.toString(), \"--loop\", \"asyncio\"],",
            "lineNumber": 283
          },
          {
            "text": "            {",
            "lineNumber": 284
          },
          {
            "text": "                cwd: backendPath,",
            "lineNumber": 285
          },
          {
            "text": "                env: env,",
            "lineNumber": 286
          },
          {
            "text": "                detached: process.platform !== 'win32',",
            "lineNumber": 287
          },
          {
            "text": "                stdio: ['ignore', 'pipe', 'pipe']",
            "lineNumber": 288
          },
          {
            "text": "            }",
            "lineNumber": 289
          },
          {
            "text": "        );",
            "lineNumber": 290
          },
          {
            "lineNumber": 291
          },
          {
            "text": "        // NOTE: Do NOT use unref() - we need to maintain the process reference",
            "lineNumber": 292
          },
          {
            "text": "        // to properly capture stdout/stderr and manage the process lifecycle",
            "lineNumber": 293
          },
          {
            "lineNumber": 294
          },
          {
            "text": "        log.info(&#96;Backend process spawned with PID: ${node_process.pid}&#96;);",
            "lineNumber": 295
          },
          {
            "lineNumber": 296
          },
          {
            "text": "        setTimeout(() =&gt; {",
            "lineNumber": 297
          },
          {
            "text": "            if (node_process.killed)",
            "lineNumber": 298
          },
          {
            "text": "        }",
            "lineNumber": 305
          },
          {
            "text": "    }",
            "lineNumber": 451
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.28828001022338867
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\index.ts",
        "range": {
          "startPosition": {
            "line": 318,
            "column": 2
          },
          "endPosition": {
            "line": 1184,
            "column": 1
          }
        },
        "contents": "function registerIpcHandlers() {\n  // ==================== basic info handler ====================\n  ipcMain.handle('get-browser-port', () =&gt; {\n    log.info('Getting browser port');\n    return browser_port;\n  });\n  ipcMain.handle('get-app-version', () =&gt; app.getVersion());\n  ipcMain.handle('get-backend-port', () =&gt; backendPort);\n\n  // ==================== restart app handler ====================\n  ipcMain.handle('restart-app', async () =&gt; {\n    log.info('[RESTART] Restarting app to apply user profile changes');\n\n    // Clean up Python process first\n    await cleanupPythonProcess();\n\n    // Schedule relaunch after a short delay\n    setTimeout(() =&gt; {\n      app.relaunch();\n      app.quit();\n    }, 100);\n  });\n\n  ipcMain.handle('restart-backend', async () =&gt; {\n    try {\n      if (backendPort) {\n        log.info('Restarting backend service...');\n        await cleanupPythonProcess();\n        await checkAndStartBackend();\n        log.info('Backend restart completed successfully');\n        return { success: true };\n      } else {\n        log.warn('No backend port found, starting fresh backend');\n        await checkAndStartBackend();\n        return { success: true };\n      }\n    } catch (error) {\n      log.error('Failed to restart backend:', error);\n      return { success: false, error: String(error) };\n    }\n  });\n  ipcMain.handle('get-system-language', getSystemLanguage);\n  ipcMain.handle('is-fullscreen', () =&gt; win?.isFullScreen() || false);\n  ipcMain.handle('get-home-dir', () =&gt; {\n    const platform = process.platform;\n    return platform === 'win32' ? process.env.USERPROFILE : process.env.HOME;\n  });\n\n  // ==================== command execution handler ====================\n  ipcMain.handle('get-email-folder-path', async (event, email: string) =&gt; {\n    return getEmailFolderPath(email);\n  });\n  ipcMain.handle(\n    'execute-command',\n\n}",
        "signatures": {},
        "detailedLines": [
          {
            "text": "function registerIpcHandlers() {",
            "lineNumber": 321,
            "isSignature": true
          },
          {
            "text": "  // ==================== basic info handler ====================",
            "lineNumber": 322
          },
          {
            "text": "  ipcMain.handle('get-browser-port', () =&gt; {",
            "lineNumber": 323
          },
          {
            "text": "    log.info('Getting browser port');",
            "lineNumber": 324
          },
          {
            "text": "    return browser_port;",
            "lineNumber": 325
          },
          {
            "text": "  });",
            "lineNumber": 326
          },
          {
            "text": "  ipcMain.handle('get-app-version', () =&gt; app.getVersion());",
            "lineNumber": 327
          },
          {
            "text": "  ipcMain.handle('get-backend-port', () =&gt; backendPort);",
            "lineNumber": 328
          },
          {
            "lineNumber": 329
          },
          {
            "text": "  // ==================== restart app handler ====================",
            "lineNumber": 330
          },
          {
            "text": "  ipcMain.handle('restart-app', async () =&gt; {",
            "lineNumber": 331
          },
          {
            "text": "    log.info('[RESTART] Restarting app to apply user profile changes');",
            "lineNumber": 332
          },
          {
            "lineNumber": 333
          },
          {
            "text": "    // Clean up Python process first",
            "lineNumber": 334
          },
          {
            "text": "    await cleanupPythonProcess();",
            "lineNumber": 335
          },
          {
            "lineNumber": 336
          },
          {
            "text": "    // Schedule relaunch after a short delay",
            "lineNumber": 337
          },
          {
            "text": "    setTimeout(() =&gt; {",
            "lineNumber": 338
          },
          {
            "text": "      app.relaunch();",
            "lineNumber": 339
          },
          {
            "text": "      app.quit();",
            "lineNumber": 340
          },
          {
            "text": "    }, 100);",
            "lineNumber": 341
          },
          {
            "text": "  });",
            "lineNumber": 342
          },
          {
            "lineNumber": 343
          },
          {
            "text": "  ipcMain.handle('restart-backend', async () =&gt; {",
            "lineNumber": 344
          },
          {
            "text": "    try {",
            "lineNumber": 345
          },
          {
            "text": "      if (backendPort) {",
            "lineNumber": 346
          },
          {
            "text": "        log.info('Restarting backend service...');",
            "lineNumber": 347
          },
          {
            "text": "        await cleanupPythonProcess();",
            "lineNumber": 348
          },
          {
            "text": "        await checkAndStartBackend();",
            "lineNumber": 349
          },
          {
            "text": "        log.info('Backend restart completed successfully');",
            "lineNumber": 350
          },
          {
            "text": "        return { success: true };",
            "lineNumber": 351
          },
          {
            "text": "      } else {",
            "lineNumber": 352
          },
          {
            "text": "        log.warn('No backend port found, starting fresh backend');",
            "lineNumber": 353
          },
          {
            "text": "        await checkAndStartBackend();",
            "lineNumber": 354
          },
          {
            "text": "        return { success: true };",
            "lineNumber": 355
          },
          {
            "text": "      }",
            "lineNumber": 356
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 357
          },
          {
            "text": "      log.error('Failed to restart backend:', error);",
            "lineNumber": 358
          },
          {
            "text": "      return { success: false, error: String(error) };",
            "lineNumber": 359
          },
          {
            "text": "    }",
            "lineNumber": 360
          },
          {
            "text": "  });",
            "lineNumber": 361
          },
          {
            "text": "  ipcMain.handle('get-system-language', getSystemLanguage);",
            "lineNumber": 362
          },
          {
            "text": "  ipcMain.handle('is-fullscreen', () =&gt; win?.isFullScreen() || false);",
            "lineNumber": 363
          },
          {
            "text": "  ipcMain.handle('get-home-dir', () =&gt; {",
            "lineNumber": 364
          },
          {
            "text": "    const platform = process.platform;",
            "lineNumber": 365
          },
          {
            "text": "    return platform === 'win32' ? process.env.USERPROFILE : process.env.HOME;",
            "lineNumber": 366
          },
          {
            "text": "  });",
            "lineNumber": 367
          },
          {
            "lineNumber": 368
          },
          {
            "text": "  // ==================== command execution handler ====================",
            "lineNumber": 369
          },
          {
            "text": "  ipcMain.handle('get-email-folder-path', async (event, email: string) =&gt; {",
            "lineNumber": 370
          },
          {
            "text": "    return getEmailFolderPath(email);",
            "lineNumber": 371
          },
          {
            "text": "  });",
            "lineNumber": 372
          },
          {
            "text": "  ipcMain.handle(",
            "lineNumber": 373
          },
          {
            "text": "    'execute-command',",
            "lineNumber": 374
          },
          {
            "lineNumber": 453
          },
          {
            "text": "}",
            "lineNumber": 1185,
            "isSignature": true
          }
        ]
      },
      "score": 0.28805243968963623
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\session-ses_42ad-260119-01.md",
        "range": {
          "startPosition": {
            "line": 4950
          },
          "endPosition": {
            "line": 4994
          }
        },
        "contents": "00329| \t\t\t}\n00330| \t\t},\n00331| \t\tstartTask: async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {\n00332| \t\t\t// ‚úÖ Wait for backend to be ready before starting task (except for replay/share)\n00333| \t\t\tif (!type || type === 'normal') {\n00334| \t\t\t\tconsole.log('[startTask] Checking if backend is ready...');\n00335| \t\t\t\tconst isBackendReady = await waitForBackendReady(15000, 500); // Wait up to 15 seconds\n00336| \n00337| \t\t\t\tif (!isBackendReady) {\n00338| \t\t\t\t\tconsole.error('[startTask] Backend is not ready, cannot start task');\n00339| \t\t\t\t\tconst { addMessages } = get();\n00340| \t\t\t\t\taddMessages(taskId, {\n00341| \t\t\t\t\t\tid: generateUniqueId(),\n00342| \t\t\t\t\t\trole: 'agent',\n00343| \t\t\t\t\t\tcontent: '‚ùå Backend service is not ready. Please wait a moment and try again, or restart the application if the problem persists.',\n00344| \t\t\t\t\t});\n00345| \t\t\t\t\treturn;\n00346| \t\t\t\t}\n00347| \t\t\t\tconsole.log('[startTask] Backend is ready, proceeding with task...');\n00348| \t\t\t}\n00349| \n00350| \t\t\tconst { token, language, modelType, cloud_model_type, email } = getAuthStore()\n00351| \t\t\tconst workerList = useWorkerList();\n00352| \t\t\tconst { getLastUserMessage, setDelayTime, setType } = get();\n00353| \t\t\tconst baseURL = await getBaseURL();\n00354| \t\t\tlet systemLanguage = language\n00355| \t\t\tif (language === 'system') {\n00356| \t\t\t\tsystemLanguage = await window.ipcRenderer.invoke('get-system-language');\n00357| \t\t\t}\n00358| \t\t\tif (type === 'replay') {\n00359| \t\t\t\tsetDelayTime(taskId, delayTime as number)\n00360| \t\t\t\tsetType(taskId, type)\n00361| \t\t\t}\n00362| \n00363| \t\t\t//ProjectStore must exist as chatStore is already\n00364| \t\t\tconst projectStore = useProjectStore.getState();\n00365| \t\t\tconst project_id = projectStore.activeProjectId;\n00366| \t\t\t//Create a new chatStore on Start\n00367| \t\t\tlet newTaskId = taskId;\n00368| \t\t\tlet targetChatStore = { getState: () =&gt; get() }; // Default to current store\n00369| \t\t\t/**\n00370| \t\t\t * Replay creates its own chatStore for each task with replayProject\n00371| \t\t\t */\n00372| \t\t\tif (project_id &amp;&amp; type !== \"replay\") {",
        "signatures": {},
        "detailedLines": [
          {
            "text": "00329| \t\t\t}",
            "lineNumber": 4951
          },
          {
            "text": "00330| \t\t},",
            "lineNumber": 4952
          },
          {
            "text": "00331| \t\tstartTask: async (taskId: string, type?: string, shareToken?: string, delayTime?: number, messageContent?: string, messageAttaches?: File[]) =&gt; {",
            "lineNumber": 4953
          },
          {
            "text": "00332| \t\t\t// ‚úÖ Wait for backend to be ready before starting task (except for replay/share)",
            "lineNumber": 4954
          },
          {
            "text": "00333| \t\t\tif (!type || type === 'normal') {",
            "lineNumber": 4955
          },
          {
            "text": "00334| \t\t\t\tconsole.log('[startTask] Checking if backend is ready...');",
            "lineNumber": 4956
          },
          {
            "text": "00335| \t\t\t\tconst isBackendReady = await waitForBackendReady(15000, 500); // Wait up to 15 seconds",
            "lineNumber": 4957
          },
          {
            "text": "00336| ",
            "lineNumber": 4958
          },
          {
            "text": "00337| \t\t\t\tif (!isBackendReady) {",
            "lineNumber": 4959
          },
          {
            "text": "00338| \t\t\t\t\tconsole.error('[startTask] Backend is not ready, cannot start task');",
            "lineNumber": 4960
          },
          {
            "text": "00339| \t\t\t\t\tconst { addMessages } = get();",
            "lineNumber": 4961
          },
          {
            "text": "00340| \t\t\t\t\taddMessages(taskId, {",
            "lineNumber": 4962
          },
          {
            "text": "00341| \t\t\t\t\t\tid: generateUniqueId(),",
            "lineNumber": 4963
          },
          {
            "text": "00342| \t\t\t\t\t\trole: 'agent',",
            "lineNumber": 4964
          },
          {
            "text": "00343| \t\t\t\t\t\tcontent: '‚ùå Backend service is not ready. Please wait a moment and try again, or restart the application if the problem persists.',",
            "lineNumber": 4965
          },
          {
            "text": "00344| \t\t\t\t\t});",
            "lineNumber": 4966
          },
          {
            "text": "00345| \t\t\t\t\treturn;",
            "lineNumber": 4967
          },
          {
            "text": "00346| \t\t\t\t}",
            "lineNumber": 4968
          },
          {
            "text": "00347| \t\t\t\tconsole.log('[startTask] Backend is ready, proceeding with task...');",
            "lineNumber": 4969
          },
          {
            "text": "00348| \t\t\t}",
            "lineNumber": 4970
          },
          {
            "text": "00349| ",
            "lineNumber": 4971
          },
          {
            "text": "00350| \t\t\tconst { token, language, modelType, cloud_model_type, email } = getAuthStore()",
            "lineNumber": 4972
          },
          {
            "text": "00351| \t\t\tconst workerList = useWorkerList();",
            "lineNumber": 4973
          },
          {
            "text": "00352| \t\t\tconst { getLastUserMessage, setDelayTime, setType } = get();",
            "lineNumber": 4974
          },
          {
            "text": "00353| \t\t\tconst baseURL = await getBaseURL();",
            "lineNumber": 4975
          },
          {
            "text": "00354| \t\t\tlet systemLanguage = language",
            "lineNumber": 4976
          },
          {
            "text": "00355| \t\t\tif (language === 'system') {",
            "lineNumber": 4977
          },
          {
            "text": "00356| \t\t\t\tsystemLanguage = await window.ipcRenderer.invoke('get-system-language');",
            "lineNumber": 4978
          },
          {
            "text": "00357| \t\t\t}",
            "lineNumber": 4979
          },
          {
            "text": "00358| \t\t\tif (type === 'replay') {",
            "lineNumber": 4980
          },
          {
            "text": "00359| \t\t\t\tsetDelayTime(taskId, delayTime as number)",
            "lineNumber": 4981
          },
          {
            "text": "00360| \t\t\t\tsetType(taskId, type)",
            "lineNumber": 4982
          },
          {
            "text": "00361| \t\t\t}",
            "lineNumber": 4983
          },
          {
            "text": "00362| ",
            "lineNumber": 4984
          },
          {
            "text": "00363| \t\t\t//ProjectStore must exist as chatStore is already",
            "lineNumber": 4985
          },
          {
            "text": "00364| \t\t\tconst projectStore = useProjectStore.getState();",
            "lineNumber": 4986
          },
          {
            "text": "00365| \t\t\tconst project_id = projectStore.activeProjectId;",
            "lineNumber": 4987
          },
          {
            "text": "00366| \t\t\t//Create a new chatStore on Start",
            "lineNumber": 4988
          },
          {
            "text": "00367| \t\t\tlet newTaskId = taskId;",
            "lineNumber": 4989
          },
          {
            "text": "00368| \t\t\tlet targetChatStore = { getState: () =&gt; get() }; // Default to current store",
            "lineNumber": 4990
          },
          {
            "text": "00369| \t\t\t/**",
            "lineNumber": 4991
          },
          {
            "text": "00370| \t\t\t * Replay creates its own chatStore for each task with replayProject",
            "lineNumber": 4992
          },
          {
            "text": "00371| \t\t\t */",
            "lineNumber": 4993
          },
          {
            "text": "00372| \t\t\tif (project_id &amp;&amp; type !== \"replay\") {",
            "lineNumber": 4994
          }
        ]
      },
      "score": 0.2849918603897095
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\index.ts",
        "range": {
          "startPosition": {
            "line": 1205,
            "column": 2
          },
          "endPosition": {
            "line": 1220,
            "column": 37
          }
        },
        "contents": "// ==================== Shared backend startup logic ====================\n// Starts backend after installation completes\n// Used by both initial startup and retry flows\nconst startBackendAfterInstall = async () =&gt; {\n  log.info('[DEPS INSTALL] Starting backend...');\n\n  // Add a small delay to ensure any previous processes are fully cleaned up\n  await new Promise((resolve) =&gt; setTimeout(resolve, 500));\n\n  await checkAndStartBackend();\n};\n\n// ==================== installation lock ====================\nlet isInstallationInProgress = false;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "// ==================== Shared backend startup logic ====================",
            "lineNumber": 1208
          },
          {
            "text": "// Starts backend after installation completes",
            "lineNumber": 1209
          },
          {
            "text": "// Used by both initial startup and retry flows",
            "lineNumber": 1210
          },
          {
            "text": "const startBackendAfterInstall = async () =&gt; {",
            "lineNumber": 1211
          },
          {
            "text": "  log.info('[DEPS INSTALL] Starting backend...');",
            "lineNumber": 1212
          },
          {
            "lineNumber": 1213
          },
          {
            "text": "  // Add a small delay to ensure any previous processes are fully cleaned up",
            "lineNumber": 1214
          },
          {
            "text": "  await new Promise((resolve) =&gt; setTimeout(resolve, 500));",
            "lineNumber": 1215
          },
          {
            "lineNumber": 1216
          },
          {
            "text": "  await checkAndStartBackend();",
            "lineNumber": 1217
          },
          {
            "text": "};",
            "lineNumber": 1218
          },
          {
            "lineNumber": 1219
          },
          {
            "text": "// ==================== installation lock ====================",
            "lineNumber": 1220
          },
          {
            "text": "let isInstallationInProgress = false;",
            "lineNumber": 1221
          }
        ]
      },
      "score": 0.2827189862728119
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\main.py",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 56,
            "column": 47
          }
        },
        "contents": "import os\nimport sys\nimport pathlib\nimport signal\nimport asyncio\nimport atexit\n\n# Add project root to Python path to import shared utils\n_project_root = pathlib.Path(__file__).parent.parent\nif str(_project_root) not in sys.path:\n    sys.path.insert(0, str(_project_root))\n\n# 1) Load env and init traceroot BEFORE importing modules that get a logger\nfrom utils import traceroot_wrapper as traceroot\nfrom app import api\n\n# Only initialize traceroot if enabled\nif traceroot.is_enabled():\n    from traceroot.integrations.fastapi import connect_fastapi\n    connect_fastapi(api)\n\n# 2) Now safe to import modules that use traceroot.get_logger() at import-time\nfrom app.component.environment import env\nfrom app.router import register_routers\n\n\nos.environ[\"PYTHONIOENCODING\"] = \"utf-8\"\n\napp_logger = traceroot.get_logger(\"main\")\n\n# Log application startup\napp_logger.info(\"Starting Eigent Multi-Agent System API\")\napp_logger.info(f\"Python encoding: {os.environ.get('PYTHONIOENCODING')}\")\napp_logger.info(f\"Environment: {os.environ.get('ENVIRONMENT', 'development')}\")\n\nprefix = env(\"url_prefix\", \"\")\napp_logger.info(f\"Loading routers with prefix: '{prefix}'\")\nregister_routers(api, prefix)\napp_logger.info(\"All routers loaded successfully\")\n\n# Check if debug mode is enabled via environment variable\nif os.environ.get('ENABLE_PYTHON_DEBUG') == 'true':\n    try:\n        import debugpy\n        DEBUG_PORT = int(os.environ.get('DEBUG_PORT', '5678'))\n        app_logger.info(f\"Debug mode enabled - Starting debugpy server on port {DEBUG_PORT}\")\n        debugpy.listen((\"localhost\", DEBUG_PORT))\n        app_logger.info(f\"Debugger ready for attachment on localhost:{DEBUG_PORT}\")\n        #üìù In VS Code: Run 'Debug Python Backend (Attach)' configuration\n        # Don't wait for client automatically - let it attach when ready\n    except ImportError:\n        app_logger.warning(\"debugpy not available, install with: uv add debugpy\")\n    except Exception as e:\n        app_logger.error(f\"Failed to start debugpy: {e}\")\n\n\ndir = pathlib.Path(__file__).parent / \"runtime\"",
        "signatures": {},
        "detailedLines": [
          {
            "text": "import os",
            "lineNumber": 1
          },
          {
            "text": "import sys",
            "lineNumber": 2
          },
          {
            "text": "import pathlib",
            "lineNumber": 3
          },
          {
            "text": "import signal",
            "lineNumber": 4
          },
          {
            "text": "import asyncio",
            "lineNumber": 5
          },
          {
            "text": "import atexit",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "# Add project root to Python path to import shared utils",
            "lineNumber": 8
          },
          {
            "text": "_project_root = pathlib.Path(__file__).parent.parent",
            "lineNumber": 9
          },
          {
            "text": "if str(_project_root) not in sys.path:",
            "lineNumber": 10
          },
          {
            "text": "    sys.path.insert(0, str(_project_root))",
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "# 1) Load env and init traceroot BEFORE importing modules that get a logger",
            "lineNumber": 13
          },
          {
            "text": "from utils import traceroot_wrapper as traceroot",
            "lineNumber": 14
          },
          {
            "text": "from app import api",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "# Only initialize traceroot if enabled",
            "lineNumber": 17
          },
          {
            "text": "if traceroot.is_enabled():",
            "lineNumber": 18
          },
          {
            "text": "    from traceroot.integrations.fastapi import connect_fastapi",
            "lineNumber": 19
          },
          {
            "text": "    connect_fastapi(api)",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "text": "# 2) Now safe to import modules that use traceroot.get_logger() at import-time",
            "lineNumber": 22
          },
          {
            "text": "from app.component.environment import env",
            "lineNumber": 23
          },
          {
            "text": "from app.router import register_routers",
            "lineNumber": 24
          },
          {
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "os.environ[\"PYTHONIOENCODING\"] = \"utf-8\"",
            "lineNumber": 27
          },
          {
            "lineNumber": 28
          },
          {
            "text": "app_logger = traceroot.get_logger(\"main\")",
            "lineNumber": 29
          },
          {
            "lineNumber": 30
          },
          {
            "text": "# Log application startup",
            "lineNumber": 31
          },
          {
            "text": "app_logger.info(\"Starting Eigent Multi-Agent System API\")",
            "lineNumber": 32
          },
          {
            "text": "app_logger.info(f\"Python encoding: {os.environ.get('PYTHONIOENCODING')}\")",
            "lineNumber": 33
          },
          {
            "text": "app_logger.info(f\"Environment: {os.environ.get('ENVIRONMENT', 'development')}\")",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "prefix = env(\"url_prefix\", \"\")",
            "lineNumber": 36
          },
          {
            "text": "app_logger.info(f\"Loading routers with prefix: '{prefix}'\")",
            "lineNumber": 37
          },
          {
            "text": "register_routers(api, prefix)",
            "lineNumber": 38
          },
          {
            "text": "app_logger.info(\"All routers loaded successfully\")",
            "lineNumber": 39
          },
          {
            "lineNumber": 40
          },
          {
            "text": "# Check if debug mode is enabled via environment variable",
            "lineNumber": 41
          },
          {
            "text": "if os.environ.get('ENABLE_PYTHON_DEBUG') == 'true':",
            "lineNumber": 42
          },
          {
            "text": "    try:",
            "lineNumber": 43
          },
          {
            "text": "        import debugpy",
            "lineNumber": 44
          },
          {
            "text": "        DEBUG_PORT = int(os.environ.get('DEBUG_PORT', '5678'))",
            "lineNumber": 45
          },
          {
            "text": "        app_logger.info(f\"Debug mode enabled - Starting debugpy server on port {DEBUG_PORT}\")",
            "lineNumber": 46
          },
          {
            "text": "        debugpy.listen((\"localhost\", DEBUG_PORT))",
            "lineNumber": 47
          },
          {
            "text": "        app_logger.info(f\"Debugger ready for attachment on localhost:{DEBUG_PORT}\")",
            "lineNumber": 48
          },
          {
            "text": "        #üìù In VS Code: Run 'Debug Python Backend (Attach)' configuration",
            "lineNumber": 49
          },
          {
            "text": "        # Don't wait for client automatically - let it attach when ready",
            "lineNumber": 50
          },
          {
            "text": "    except ImportError:",
            "lineNumber": 51
          },
          {
            "text": "        app_logger.warning(\"debugpy not available, install with: uv add debugpy\")",
            "lineNumber": 52
          },
          {
            "text": "    except Exception as e:",
            "lineNumber": 53
          },
          {
            "text": "        app_logger.error(f\"Failed to start debugpy: {e}\")",
            "lineNumber": 54
          },
          {
            "lineNumber": 55
          },
          {
            "lineNumber": 56
          },
          {
            "text": "dir = pathlib.Path(__file__).parent / \"runtime\"",
            "lineNumber": 57
          }
        ]
      },
      "score": 0.27695369720458984
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
        "range": {
          "startPosition": {
            "line": 765
          },
          "endPosition": {
            "line": 833
          }
        },
        "contents": "  while (Date.now() - startTime &lt; maxWaitMs) {\n    const isReady = await checkBackendHealth();\n\n    if (isReady) {\n      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);\n      return true;\n    }\n\n    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);\n    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));\n  }\n\n  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);\n  return false;\n}\n\n&#96;&#96;&#96;\n\n&#96;&#96;&#96;typescript\nimport { getAuthStore } from \"@/store/authStore\"\n\nexport function getProxyBaseURL() {\n\tconst isDev = import.meta.env.DEV\n\tconst useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'\n\n\tif (isDev) {\n\t\t// Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø\n\t\tif (useLocalProxy) {\n\t\t\t// Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n\t\t\treturn import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'\n\t\t} else {\n\t\t\t// ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº\n\t\t\treturn import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'\n\t\t}\n\t} else {\n\t\t// ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL\n\t\tconst baseUrl = import.meta.env.VITE_BASE_URL\n\t\tif (!baseUrl) {\n\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");\n\t\t}\n\t\treturn baseUrl;\n\t}\n}\n\nexport function generateUniqueId(): string {\n\tconst timestamp = Date.now();\n\tconst random = Math.floor(Math.random() * 10000);\n\treturn &#96;${timestamp}-${random}&#96;;\n}\n\nexport function debounce&lt;T extends (...args: any[]) =&gt; void&gt;(\n\tfunc: T,\n\twait: number,\n\timmediate: boolean = false\n): (...args: Parameters&lt;T&gt;) =&gt; void {\n\tlet timeout: NodeJS.Timeout | null = null;\n\n\treturn function (this: any, ...args: Parameters&lt;T&gt;) {\n\t\tconst context = this;\n\n\t\tconst later = () =&gt; {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\n\t\tconst callNow = immediate &amp;&amp; !timeout;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "  while (Date.now() - startTime &lt; maxWaitMs) {",
            "lineNumber": 767
          },
          {
            "text": "    const isReady = await checkBackendHealth();",
            "lineNumber": 768
          },
          {
            "lineNumber": 769
          },
          {
            "text": "    if (isReady) {",
            "lineNumber": 770
          },
          {
            "text": "      console.log(&#96;[Backend Health Check] Backend is ready after ${Date.now() - startTime}ms&#96;);",
            "lineNumber": 771
          },
          {
            "text": "      return true;",
            "lineNumber": 772
          },
          {
            "text": "    }",
            "lineNumber": 773
          },
          {
            "lineNumber": 774
          },
          {
            "text": "    console.log(&#96;[Backend Health Check] Backend not ready, retrying... (${Date.now() - startTime}ms elapsed)&#96;);",
            "lineNumber": 775
          },
          {
            "text": "    await new Promise(resolve =&gt; setTimeout(resolve, retryIntervalMs));",
            "lineNumber": 776
          },
          {
            "text": "  }",
            "lineNumber": 777
          },
          {
            "lineNumber": 778
          },
          {
            "text": "  console.error(&#96;[Backend Health Check] Backend failed to start within ${maxWaitMs}ms&#96;);",
            "lineNumber": 779
          },
          {
            "text": "  return false;",
            "lineNumber": 780
          },
          {
            "text": "}",
            "lineNumber": 781
          },
          {
            "lineNumber": 782
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 783
          },
          {
            "lineNumber": 784
          },
          {
            "text": "&#96;&#96;&#96;typescript",
            "lineNumber": 785
          },
          {
            "text": "import { getAuthStore } from \"@/store/authStore\"",
            "lineNumber": 786
          },
          {
            "lineNumber": 787
          },
          {
            "text": "export function getProxyBaseURL() {",
            "lineNumber": 788
          },
          {
            "text": "\tconst isDev = import.meta.env.DEV",
            "lineNumber": 789
          },
          {
            "text": "\tconst useLocalProxy = import.meta.env.VITE_USE_LOCAL_PROXY === 'true'",
            "lineNumber": 790
          },
          {
            "lineNumber": 791
          },
          {
            "text": "\tif (isDev) {",
            "lineNumber": 792
          },
          {
            "text": "\t\t// Âú®ÈñãÁôºÊ®°Âºè‰∏ãÔºåÊ†πÊìö VITE_USE_LOCAL_PROXY Ê±∫ÂÆö‰ΩøÁî®Êú¨Âú∞ÊàñÈõ≤Á´Ø",
            "lineNumber": 793
          },
          {
            "text": "\t\tif (useLocalProxy) {",
            "lineNumber": 794
          },
          {
            "text": "\t\t\t// Âº∑Âà∂‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 795
          },
          {
            "text": "\t\t\treturn import.meta.env.VITE_PROXY_URL || 'http://localhost:3001'",
            "lineNumber": 796
          },
          {
            "text": "\t\t} else {",
            "lineNumber": 797
          },
          {
            "text": "\t\t\t// ‰ΩøÁî®Èõ≤Á´Ø‰ª£ÁêÜÔºåÂÑ™ÂÖà‰ΩøÁî® VITE_PROXY_URLÔºåÂê¶Ââá‰ΩøÁî®È†êË®≠ÂÄº",
            "lineNumber": 798
          },
          {
            "text": "\t\t\treturn import.meta.env.VITE_PROXY_URL || 'https://dev.eigent.ai'",
            "lineNumber": 799
          },
          {
            "text": "\t\t}",
            "lineNumber": 800
          },
          {
            "text": "\t} else {",
            "lineNumber": 801
          },
          {
            "text": "\t\t// ÁîüÁî¢Ê®°Âºè‰ΩøÁî® VITE_BASE_URL",
            "lineNumber": 802
          },
          {
            "text": "\t\tconst baseUrl = import.meta.env.VITE_BASE_URL",
            "lineNumber": 803
          },
          {
            "text": "\t\tif (!baseUrl) {",
            "lineNumber": 804
          },
          {
            "text": "\t\t\tthrow new Error(\"VITE_BASE_URL is not configured\");",
            "lineNumber": 805
          },
          {
            "text": "\t\t}",
            "lineNumber": 806
          },
          {
            "text": "\t\treturn baseUrl;",
            "lineNumber": 807
          },
          {
            "text": "\t}",
            "lineNumber": 808
          },
          {
            "text": "}",
            "lineNumber": 809
          },
          {
            "lineNumber": 810
          },
          {
            "text": "export function generateUniqueId(): string {",
            "lineNumber": 811
          },
          {
            "text": "\tconst timestamp = Date.now();",
            "lineNumber": 812
          },
          {
            "text": "\tconst random = Math.floor(Math.random() * 10000);",
            "lineNumber": 813
          },
          {
            "text": "\treturn &#96;${timestamp}-${random}&#96;;",
            "lineNumber": 814
          },
          {
            "text": "}",
            "lineNumber": 815
          },
          {
            "lineNumber": 816
          },
          {
            "text": "export function debounce&lt;T extends (...args: any[]) =&gt; void&gt;(",
            "lineNumber": 817
          },
          {
            "text": "\tfunc: T,",
            "lineNumber": 818
          },
          {
            "text": "\twait: number,",
            "lineNumber": 819
          },
          {
            "text": "\timmediate: boolean = false",
            "lineNumber": 820
          },
          {
            "text": "): (...args: Parameters&lt;T&gt;) =&gt; void {",
            "lineNumber": 821
          },
          {
            "text": "\tlet timeout: NodeJS.Timeout | null = null;",
            "lineNumber": 822
          },
          {
            "lineNumber": 823
          },
          {
            "text": "\treturn function (this: any, ...args: Parameters&lt;T&gt;) {",
            "lineNumber": 824
          },
          {
            "text": "\t\tconst context = this;",
            "lineNumber": 825
          },
          {
            "lineNumber": 826
          },
          {
            "text": "\t\tconst later = () =&gt; {",
            "lineNumber": 827
          },
          {
            "text": "\t\t\ttimeout = null;",
            "lineNumber": 828
          },
          {
            "text": "\t\t\tif (!immediate) func.apply(context, args);",
            "lineNumber": 829
          },
          {
            "text": "\t\t};",
            "lineNumber": 830
          },
          {
            "lineNumber": 831
          },
          {
            "text": "\t\tconst callNow = immediate &amp;&amp; !timeout;",
            "lineNumber": 832
          }
        ]
      },
      "score": 0.2738616466522217
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 526,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\nasync (resolve, reject) =&gt; {\n(data) =&gt; {\n\n        });\n\n        node_process.stderr.on('data', (data) =&gt; {\n            log.debug(&#96;Backend stderr received ${data.length} bytes&#96;);\n            displayFilteredLogs(data);\n\n            if (data.toString().includes(\"Address already in use\") ||\n                data.toString().includes(\"bind() failed\")) {\n                if (!started) {\n                    started = true;\n                    clearTimeout(startTimeout);\n                    clearTimeout(initialDelay);\n                    if (healthCheckInterval) clearInterval(healthCheckInterval);\n                    killBackendProcess(node_process);\n                    reject(new Error(&#96;Port ${port} is already in use&#96;));\n                }\n            }\n        });\n\n        node_process.on('error', (err) =&gt; {\n            log.error(&#96;Backend process error: ${err.message}&#96;);\n            if (!started) {\n                started = true;\n                clearTimeout(startTimeout);\n                clearTimeout(initialDelay);\n                if (healthCheckInterval) clearInterval(healthCheckInterval);\n                reject(new Error(&#96;Failed to spawn backend process: ${err.message}&#96;));\n            }\n        });\n\n        node_process.on('close', async (code, signal) =&gt; {\n            log.info(&#96;Backend process closed with code ${code}, signal ${signal}&#96;);\n            clearTimeout(startTimeout);\n            clearTimeout(initialDelay);\n            if (healthCheckInterval) clearInterval(healthCheckInterval);\n\n            if (!started) {\n                log.info(&#96;Backend exited before ready, cleaning up port ${port}...&#96;);\n                await killProcessOnPort(port);\n                reject(new Error(&#96;Backend exited prematurely with code ${code}&#96;));\n            }\n        });\n    });\n    // const node_process = spawn(\n    //     uv_path,\n    //     [\"run\", \"uvicorn\", \"main:api\", \"--port\", port.toString(), \"--loop\", \"asyncio\"],\n    //     { cwd: backendPath, env: env, detached: false }\n    // );\n\n    // node_process.stdout.on('data', (data) =&gt; {\n    //     log.info(&#96;fastapi output: ${data}&#96;)\n    // })\n\n    // node_process.stderr.on('data', (data) =&gt; {\n    //     log.error(&#96;fastapi stderr output: ${data}&#96;)\n    // })\n\n    // node_process.on('close', (code) =&gt; {\n    //     if (code === 0) {\n    //         log.info('fastapi start success')\n    //     } else {\n    //         log.error(&#96;fastapi exited with code ${code}&#96;)\n\n    //     }\n    // })\n    // return node_process\n}\n\nfunction checkPortAvailable(port: number): Promise&lt;boolean&gt; {\n    return\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            },
            {
              "startPosition": {
                "line": 192,
                "column": 24
              },
              "endPosition": {
                "line": 193,
                "column": 9
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "text": "async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "(data) =&gt; {",
            "lineNumber": 406
          },
          {
            "lineNumber": 408
          },
          {
            "text": "        });",
            "lineNumber": 409
          },
          {
            "lineNumber": 410
          },
          {
            "text": "        node_process.stderr.on('data', (data) =&gt; {",
            "lineNumber": 411
          },
          {
            "text": "            log.debug(&#96;Backend stderr received ${data.length} bytes&#96;);",
            "lineNumber": 412
          },
          {
            "text": "            displayFilteredLogs(data);",
            "lineNumber": 413
          },
          {
            "lineNumber": 414
          },
          {
            "text": "            if (data.toString().includes(\"Address already in use\") ||",
            "lineNumber": 415
          },
          {
            "text": "                data.toString().includes(\"bind() failed\")) {",
            "lineNumber": 416
          },
          {
            "text": "                if (!started) {",
            "lineNumber": 417
          },
          {
            "text": "                    started = true;",
            "lineNumber": 418
          },
          {
            "text": "                    clearTimeout(startTimeout);",
            "lineNumber": 419
          },
          {
            "text": "                    clearTimeout(initialDelay);",
            "lineNumber": 420
          },
          {
            "text": "                    if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 421
          },
          {
            "text": "                    killBackendProcess(node_process);",
            "lineNumber": 422
          },
          {
            "text": "                    reject(new Error(&#96;Port ${port} is already in use&#96;));",
            "lineNumber": 423
          },
          {
            "text": "                }",
            "lineNumber": 424
          },
          {
            "text": "            }",
            "lineNumber": 425
          },
          {
            "text": "        });",
            "lineNumber": 426
          },
          {
            "lineNumber": 427
          },
          {
            "text": "        node_process.on('error', (err) =&gt; {",
            "lineNumber": 428
          },
          {
            "text": "            log.error(&#96;Backend process error: ${err.message}&#96;);",
            "lineNumber": 429
          },
          {
            "text": "            if (!started) {",
            "lineNumber": 430
          },
          {
            "text": "                started = true;",
            "lineNumber": 431
          },
          {
            "text": "                clearTimeout(startTimeout);",
            "lineNumber": 432
          },
          {
            "text": "                clearTimeout(initialDelay);",
            "lineNumber": 433
          },
          {
            "text": "                if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 434
          },
          {
            "text": "                reject(new Error(&#96;Failed to spawn backend process: ${err.message}&#96;));",
            "lineNumber": 435
          },
          {
            "text": "            }",
            "lineNumber": 436
          },
          {
            "text": "        });",
            "lineNumber": 437
          },
          {
            "lineNumber": 438
          },
          {
            "text": "        node_process.on('close', async (code, signal) =&gt; {",
            "lineNumber": 439
          },
          {
            "text": "            log.info(&#96;Backend process closed with code ${code}, signal ${signal}&#96;);",
            "lineNumber": 440
          },
          {
            "text": "            clearTimeout(startTimeout);",
            "lineNumber": 441
          },
          {
            "text": "            clearTimeout(initialDelay);",
            "lineNumber": 442
          },
          {
            "text": "            if (healthCheckInterval) clearInterval(healthCheckInterval);",
            "lineNumber": 443
          },
          {
            "lineNumber": 444
          },
          {
            "text": "            if (!started) {",
            "lineNumber": 445
          },
          {
            "text": "                log.info(&#96;Backend exited before ready, cleaning up port ${port}...&#96;);",
            "lineNumber": 446
          },
          {
            "text": "                await killProcessOnPort(port);",
            "lineNumber": 447
          },
          {
            "text": "                reject(new Error(&#96;Backend exited prematurely with code ${code}&#96;));",
            "lineNumber": 448
          },
          {
            "text": "            }",
            "lineNumber": 449
          },
          {
            "text": "        });",
            "lineNumber": 450
          },
          {
            "text": "    });",
            "lineNumber": 451
          },
          {
            "text": "    // const node_process = spawn(",
            "lineNumber": 452
          },
          {
            "text": "    //     uv_path,",
            "lineNumber": 453
          },
          {
            "text": "    //     [\"run\", \"uvicorn\", \"main:api\", \"--port\", port.toString(), \"--loop\", \"asyncio\"],",
            "lineNumber": 454
          },
          {
            "text": "    //     { cwd: backendPath, env: env, detached: false }",
            "lineNumber": 455
          },
          {
            "text": "    // );",
            "lineNumber": 456
          },
          {
            "lineNumber": 457
          },
          {
            "text": "    // node_process.stdout.on('data', (data) =&gt; {",
            "lineNumber": 458
          },
          {
            "text": "    //     log.info(&#96;fastapi output: ${data}&#96;)",
            "lineNumber": 459
          },
          {
            "text": "    // })",
            "lineNumber": 460
          },
          {
            "lineNumber": 461
          },
          {
            "text": "    // node_process.stderr.on('data', (data) =&gt; {",
            "lineNumber": 462
          },
          {
            "text": "    //     log.error(&#96;fastapi stderr output: ${data}&#96;)",
            "lineNumber": 463
          },
          {
            "text": "    // })",
            "lineNumber": 464
          },
          {
            "lineNumber": 465
          },
          {
            "text": "    // node_process.on('close', (code) =&gt; {",
            "lineNumber": 466
          },
          {
            "text": "    //     if (code === 0) {",
            "lineNumber": 467
          },
          {
            "text": "    //         log.info('fastapi start success')",
            "lineNumber": 468
          },
          {
            "text": "    //     } else {",
            "lineNumber": 469
          },
          {
            "text": "    //         log.error(&#96;fastapi exited with code ${code}&#96;)",
            "lineNumber": 470
          },
          {
            "lineNumber": 471
          },
          {
            "text": "    //     }",
            "lineNumber": 472
          },
          {
            "text": "    // })",
            "lineNumber": 473
          },
          {
            "text": "    // return node_process",
            "lineNumber": 474
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          },
          {
            "lineNumber": 476
          },
          {
            "text": "function checkPortAvailable(port: number): Promise&lt;boolean&gt; {",
            "lineNumber": 477,
            "isSignature": true
          },
          {
            "text": "    return",
            "lineNumber": 478
          },
          {
            "text": "}",
            "lineNumber": 527,
            "isSignature": true
          }
        ]
      },
      "score": 0.27362319827079773
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\index.ts",
        "range": {
          "startPosition": {
            "line": 1227
          },
          "endPosition": {
            "line": 1577,
            "column": 1
          }
        },
        "contents": "async function createWindow() {\n\n\n  // IMPORTANT: Always send install-dependencies-complete event when installation check succeeds\n  // This includes both cases: actual installation completed AND installation was skipped (already installed)\n  // The frontend needs this event to properly transition from installation screen to main app\n  if (!win.isDestroyed()) {\n    win.webContents.send('install-dependencies-complete', {\n      success: true,\n      code: 0,\n    });\n    log.info(\n      '[DEPS INSTALL] Sent install-dependencies-complete event to frontend'\n    );\n  }\n\n  // Start backend after dependencies are ready\n  await startBackendAfterInstall();\n}\n\n// ==================== window event listeners ====================\nconst setupWindowEventListeners = ()\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 1228,
                "column": 1
              },
              "endPosition": {
                "line": 1229,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "async function createWindow() {",
            "lineNumber": 1228,
            "isSignature": true
          },
          {
            "lineNumber": 1553
          },
          {
            "lineNumber": 1554
          },
          {
            "text": "  // IMPORTANT: Always send install-dependencies-complete event when installation check succeeds",
            "lineNumber": 1555
          },
          {
            "text": "  // This includes both cases: actual installation completed AND installation was skipped (already installed)",
            "lineNumber": 1556
          },
          {
            "text": "  // The frontend needs this event to properly transition from installation screen to main app",
            "lineNumber": 1557
          },
          {
            "text": "  if (!win.isDestroyed()) {",
            "lineNumber": 1558
          },
          {
            "text": "    win.webContents.send('install-dependencies-complete', {",
            "lineNumber": 1559
          },
          {
            "text": "      success: true,",
            "lineNumber": 1560
          },
          {
            "text": "      code: 0,",
            "lineNumber": 1561
          },
          {
            "text": "    });",
            "lineNumber": 1562
          },
          {
            "text": "    log.info(",
            "lineNumber": 1563
          },
          {
            "text": "      '[DEPS INSTALL] Sent install-dependencies-complete event to frontend'",
            "lineNumber": 1564
          },
          {
            "text": "    );",
            "lineNumber": 1565
          },
          {
            "text": "  }",
            "lineNumber": 1566
          },
          {
            "lineNumber": 1567
          },
          {
            "text": "  // Start backend after dependencies are ready",
            "lineNumber": 1568
          },
          {
            "text": "  await startBackendAfterInstall();",
            "lineNumber": 1569
          },
          {
            "text": "}",
            "lineNumber": 1570,
            "isSignature": true
          },
          {
            "lineNumber": 1571
          },
          {
            "text": "// ==================== window event listeners ====================",
            "lineNumber": 1572
          },
          {
            "text": "const setupWindowEventListeners = ()",
            "lineNumber": 1573
          },
          {
            "text": ";",
            "lineNumber": 1578
          }
        ]
      },
      "score": 0.27256259322166443
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\electron\\main\\init.ts",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 474,
            "column": 1
          }
        },
        "contents": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {\n\n\n    return new Promise(async (resolve, reject) =&gt; {\n        log.info(&#96;Spawning backend process: ${uv_path} run uvicorn main:api --port ${port} --loop asyncio&#96;);\n        log.info(&#96;Backend working directory: ${backendPath}&#96;);\n        log.info(&#96;Using venv: ${venvPath}&#96;);\n\n        try {\n            const { stdout: uvVersion } = await execAsync(&#96;${uv_path} --version&#96;);\n            log.info(&#96;UV version check: ${uvVersion.trim()}&#96;);\n\n            const { stdout: pythonTest } = await execAsync(\n                &#96;${uv_path} run python -c \"print('Python OK')\"&#96;,\n                { cwd: backendPath, env: env }\n            );\n            log.info(&#96;Python test output: ${pythonTest.trim()}&#96;);\n        } catch (testErr: any) {\n            log.warn(&#96;Pre-flight check failed, attempting repair: ${testErr}&#96;);\n\n            try {\n                // Attempt to repair the environment\n                log.info(\"Attempting to repair environment...\");\n    }\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 120,
                "column": 1
              },
              "endPosition": {
                "line": 120,
                "column": 8
              }
            },
            {
              "startPosition": {
                "line": 120,
                "column": 8
              },
              "endPosition": {
                "line": 121,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "export async function startBackend(setPort?: (port: number) =&gt; void): Promise&lt;any&gt; {",
            "lineNumber": 120,
            "isSignature": true
          },
          {
            "lineNumber": 190
          },
          {
            "lineNumber": 191
          },
          {
            "text": "    return new Promise(async (resolve, reject) =&gt; {",
            "lineNumber": 192
          },
          {
            "text": "        log.info(&#96;Spawning backend process: ${uv_path} run uvicorn main:api --port ${port} --loop asyncio&#96;);",
            "lineNumber": 193
          },
          {
            "text": "        log.info(&#96;Backend working directory: ${backendPath}&#96;);",
            "lineNumber": 194
          },
          {
            "text": "        log.info(&#96;Using venv: ${venvPath}&#96;);",
            "lineNumber": 195
          },
          {
            "lineNumber": 196
          },
          {
            "text": "        try {",
            "lineNumber": 197
          },
          {
            "text": "            const { stdout: uvVersion } = await execAsync(&#96;${uv_path} --version&#96;);",
            "lineNumber": 198
          },
          {
            "text": "            log.info(&#96;UV version check: ${uvVersion.trim()}&#96;);",
            "lineNumber": 199
          },
          {
            "lineNumber": 200
          },
          {
            "text": "            const { stdout: pythonTest } = await execAsync(",
            "lineNumber": 201
          },
          {
            "text": "                &#96;${uv_path} run python -c \"print('Python OK')\"&#96;,",
            "lineNumber": 202
          },
          {
            "text": "                { cwd: backendPath, env: env }",
            "lineNumber": 203
          },
          {
            "text": "            );",
            "lineNumber": 204
          },
          {
            "text": "            log.info(&#96;Python test output: ${pythonTest.trim()}&#96;);",
            "lineNumber": 205
          },
          {
            "text": "        } catch (testErr: any) {",
            "lineNumber": 206
          },
          {
            "text": "            log.warn(&#96;Pre-flight check failed, attempting repair: ${testErr}&#96;);",
            "lineNumber": 207
          },
          {
            "lineNumber": 208
          },
          {
            "text": "            try {",
            "lineNumber": 209
          },
          {
            "text": "                // Attempt to repair the environment",
            "lineNumber": 210
          },
          {
            "text": "                log.info(\"Attempting to repair environment...\");",
            "lineNumber": 211
          },
          {
            "text": "    }",
            "lineNumber": 451
          },
          {
            "text": "}",
            "lineNumber": 475,
            "isSignature": true
          }
        ]
      },
      "score": 0.2698310613632202
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---


Âú® `useInstallationSetup.ts` ‰∏≠ÊúâÂÖ©ËôïÁõ¥Êé•‰ΩøÁî® `/health`ÔºåÈúÄË¶ÅÊîπÁÇ∫ `/api/health`„ÄÇ‰øÆÊ≠£ÈÄô‰∫õ‰ΩçÁΩÆÔºö


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** ‚Ä¢ Read file: d:\_Code\_GitHub\eigent-260119\src\hooks\useInstallationSetup.ts</summary>

</details>
</tool-use>

---


‰øÆÊ≠£ `useInstallationSetup.ts` ‰∏≠ÁöÑÂÖ©ËôïÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÔºö


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** ‚Ä¢ Edit file: d:\_Code\_GitHub\eigent-260119\src\hooks\useInstallationSetup.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** ‚Ä¢ Edit file: d:\_Code\_GitHub\eigent-260119\src\hooks\useInstallationSetup.ts</summary>

</details>

</tool-use>

---


Â∑≤‰øÆÊ≠£ÊâÄÊúâÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªû„ÄÇÊ™¢Êü•ÊòØÂê¶ÈÇÑÊúâÂÖ∂‰ªñÂú∞ÊñπÈúÄË¶Å‰øÆÊ≠£Ôºö


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "/health",
  "path": "src",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "/health",
    "path": "src",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": "src\\hooks\\useInstallationSetup.ts",
              "matches": [
                {
                  "lineNumber": 53,
                  "content": "            &#96;http://localhost:${backendPort}/api/health&#96;"
                },
                {
                  "lineNumber": 99,
                  "content": "              &#96;http://localhost:${backendPort}/api/health&#96;"
                }
              ]
            },
            {
              "file": "src\\api\\http.ts",
              "matches": [
                {
                  "lineNumber": 282,
                  "content": "    const res = await fetch(&#96;${baseURL}/api/health&#96;, {"
                }
              ]
            }
          ],
          "totalLines": 3,
          "totalMatchedLines": 3
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "/health",
  "path": "electron",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "/health",
    "path": "electron",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": "electron\\main\\init.ts",
              "matches": [
                {
                  "lineNumber": 357,
                  "content": "                const healthUrl = &#96;http://127.0.0.1:${port}/health&#96;;"
                }
              ]
            }
          ],
          "totalLines": 1,
          "totalMatchedLines": 1
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


‰øÆÊ≠£ `electron/main/init.ts` ‰∏≠ÁöÑÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÔºö


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** ‚Ä¢ Read file: d:\_Code\_GitHub\eigent-260119\electron\main\init.ts</summary>

</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** ‚Ä¢ Edit file: d:\_Code\_GitHub\eigent-260119\electron\main\init.ts</summary>

</details>

</tool-use>

---


Â∑≤‰øÆÊ≠£ÊâÄÊúâÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªû„ÄÇÁ¢∫Ë™çÊòØÂê¶ÈÇÑÊúâÂÖ∂‰ªñÂú∞ÊñπÈúÄË¶Å‰øÆÊ≠£Ôºö


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "/health[^/]",
  "path": ".",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "/health[^/]",
    "path": ".",
    "outputMode": "content",
    "workspaceResults": {
      "d:\\_Code\\_GitHub\\eigent-260119": {
        "content": {
          "matches": [
            {
              "file": ".\\electron\\main\\init.ts",
              "matches": [
                {
                  "lineNumber": 357,
                  "content": "                const healthUrl = &#96;http://127.0.0.1:${port}/api/health&#96;;"
                }
              ]
            },
            {
              "file": ".\\src\\hooks\\useInstallationSetup.ts",
              "matches": [
                {
                  "lineNumber": 53,
                  "content": "            &#96;http://localhost:${backendPort}/api/health&#96;"
                },
                {
                  "lineNumber": 99,
                  "content": "              &#96;http://localhost:${backendPort}/api/health&#96;"
                }
              ]
            },
            {
              "file": ".\\.specstory\\history\\2026-01-19_09-07Z-esbuild-45-377-reference.md",
              "matches": [
                {
                  "lineNumber": 287,
                  "content": "        \"contents\": \"@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\\nasync def health_check():\\n    \\\"\\\"\\\"Health check endpoint for verifying backend is ready to accept requests.\\\"\\\"\\\"\\n    logger.debug(\\\"Health check requested\\\")\\n    response = HealthResponse(status=\\\"ok\\\", service=\\\"eigent\\\")\\n    logger.debug(\\\"Health check completed\\\", extra={\\\"status\\\": response.status, \\\"service\\\": response.service})\\n    return response\","
                },
                {
                  "lineNumber": 291,
                  "content": "            \"text\": \"@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\","
                },
                {
                  "lineNumber": 337,
                  "content": "        \"contents\": \"@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\\nasync def health_check():\\n    \\\"\\\"\\\"Health check endpoint for monitoring and container orchestration.\\\"\\\"\\\"\\n    return HealthResponse(status=\\\"ok\\\", service=\\\"eigent-server\\\")\","
                },
                {
                  "lineNumber": 341,
                  "content": "            \"text\": \"@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\","
                },
                {
                  "lineNumber": 1280,
                  "content": "        \"contents\": \"from fastapi import APIRouter\\nfrom pydantic import BaseModel\\nfrom utils import traceroot_wrapper as traceroot\\n\\nlogger = traceroot.get_logger(\\\"health_controller\\\")\\n\\nrouter = APIRouter(tags=[\\\"Health\\\"])\\n\\n\\nclass HealthResponse(BaseModel):\\n    status: str\\n    service: str\\n\\n\\n@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\\nasync def health_check():\\n    \\\"\\\"\\\"Health check endpoint for verifying backend is ready to accept requests.\\\"\\\"\\\"\","
                },
                {
                  "lineNumber": 1336,
                  "content": "            \"text\": \"@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\","
                },
                {
                  "lineNumber": 1361,
                  "content": "        \"contents\": \"from fastapi import APIRouter\\nfrom pydantic import BaseModel\\n\\nrouter = APIRouter(tags=[\\\"Health\\\"])\\n\\n\\nclass HealthResponse(BaseModel):\\n    status: str\\n    service: str\\n\\n\\n@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\\nasync def health_check():\\n    \\\"\\\"\\\"Health check endpoint for monitoring and container orchestration.\\\"\\\"\\\"\","
                },
                {
                  "lineNumber": 1406,
                  "content": "            \"text\": \"@router.get(\\\"/health\\\", name=\\\"health check\\\", response_model=HealthResponse)\","
                },
                {
                  "lineNumber": 1435,
                  "content": "        \"contents\": \"// =============== Backend Health Check ===============\\n\\n/**\\n * Check if backend is ready by checking the health endpoint\\n * @returns Promise&amp;lt;boolean&amp;gt; - true if backend is ready, false otherwise\\n */\\nexport async function checkBackendHealth(): Promise&amp;lt;boolean&amp;gt; {\\n  try {\\n    const baseURL = await getBaseURL();\\n    const controller = new AbortController();\\n    const timeoutId = setTimeout(() =&amp;gt; controller.abort(), 1000);\\n\\n    const res = await fetch(&amp;#96;${baseURL}/health&amp;#96;, {\\n      signal: controller.signal,\\n      method: 'GET',\\n    });\\n\\n    clearTimeout(timeoutId);\\n    return res.ok;\\n  } catch (error) {\\n    console.log('[Backend Health Check] Not ready:', error);\\n    return false;\\n  }\\n}\\n\\n/**\\n * Simple backend health check with retries\\n * @param maxWaitMs - Maximum time to wait in milliseconds (default: 10000ms)\\n * @param retryIntervalMs - Interval between retries in milliseconds (default: 500ms)\\n * @returns Promise&amp;lt;b [... omitted end of long line]"
                },
                {
                  "lineNumber": 1486,
                  "content": "            \"text\": \"    const res = await fetch(&amp;#96;${baseURL}/health&amp;#96;, {\","
                },
                {
                  "lineNumber": 1902,
                  "content": "        \"contents\": \"&amp;lt;/answer&amp;gt;\\n\\n&amp;lt;next_steps&amp;gt;\\nReady to proceed - no follow-up needed.\\n&amp;lt;/next_steps&amp;gt;\\n&amp;lt;/results&amp;gt;\\n&amp;#96;&amp;#96;&amp;#96;\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n&amp;#96;&amp;#96;&amp;#96;\\nTool: background_output\\n\\n**Input:**\\n&amp;#96;&amp;#96;&amp;#96;json\\n{\\n  \\\"task_id\\\": \\\"bg_5f70142e\\\"\\n}\\n&amp;#96;&amp;#96;&amp;#96;\\n**Output:**\\n&amp;#96;&amp;#96;&amp;#96;\\nTask Result\\n\\nTask ID: bg_5f70142e\\nDescription: Analyze backend Python API\\nDuration: 48s\\nSession ID: ses_42acbf34dffe0uEaCdoLgVoFxT\\n\\n---\\n\\nÊú¨Â†±ÂëäÈáùÂ∞ç‰ΩçÊñº &amp;#96;D:\\\\_Code\\\\_GitHub\\\\eigent-260119&amp;#96; ÁöÑ Eigent Â∞àÊ°àÂæåÁ´Ø Python API ÈÄ≤Ë°å‰∫ÜÊ∑±Â∫¶ÂàÜÊûê„ÄÇË©≤ÂæåÁ´ØÊé°Áî® **FastAPI** Ê°ÜÊû∂Ôºå‰∏¶Ëàá **CAMEL-AI** Â§öÊô∫ËÉΩÈ´îÊ°ÜÊû∂Ê∑±Â∫¶Êï¥ÂêàÔºåÂêåÊôÇÊîØÊè¥ **Model Context Protocol (MCP)** Â∑•ÂÖ∑„ÄÇ\\n\\n---\\n\\n### 1. API Á´ØÈªû (API Endpoints)\\nÁ≥ªÁµ±Ë∑ØÁî±‰∏ªË¶ÅÂÆöÁæ©Âú® &amp;#96;backend/app/router.py&amp;#96; ‰∏≠Ôºå‰∏¶ÈÄèÈÅé &amp;#96;register_routers&amp;#96; Áµ±‰∏ÄË®ªÂÜä„ÄÇAPI ‰∏ªË¶Å‰ΩøÁî® **SSE (Server-Sent Events)** ÈÄ≤Ë°åÂç≥ÊôÇÈÄöË®äÔºå‰ª•‰æøÂêëÂâçÁ´ØÂõûÂÇ≥Â§öÊô∫ËÉΩÈ´îÂçî‰ΩúÁöÑÁãÄÊÖã„ÄÇ\\n\\n#### ‰∏ªË¶ÅË∑ØÁî± (Routers)\\n- **Chat Controller (&amp;#96;/chat&amp;#96;)**: ÁÆ°ÁêÜËÅäÂ§©ÊúÉË©±Ëàá‰ªªÂãôÂïüÂãï„ÄÇ\\n  - &amp;#96;POST /chat&amp;#96;: ÂïüÂãïÊñ∞‰ªªÂãôÔºåÂàùÂßãÂåñ &amp;#96;TaskLock&amp;#96; ‰∏¶ÈñãÂßã &amp;#96;step_solve&amp;#96 [... omitted end of long line]"
                },
                {
                  "lineNumber": 2101,
                  "content": "            \"text\": \"- **Health Controller (&amp;#96;/health&amp;#96;)**: ÊúçÂãôÂÅ•Â∫∑Ê™¢Êü•„ÄÇ\","
                },
                {
                  "lineNumber": 2146,
                  "content": "        \"contents\": \"services:\\n  # PostgreSQL Database\\n  postgres:\\n    image: postgres:15\\n    container_name: eigent_postgres\\n    restart: unless-stopped\\n    environment:\\n      POSTGRES_DB: eigent\\n      POSTGRES_USER: postgres\\n      POSTGRES_PASSWORD: 123456\\n      POSTGRES_INITDB_ARGS: \\\"--encoding=UTF-8 --lc-collate=C --lc-ctype=C\\\"\\n    ports:\\n      - \\\"5432:5432\\\"\\n    volumes:\\n      - postgres_data:/var/lib/postgresql/data\\n      #- ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql:ro\\n    networks:\\n      - eigent_network\\n    healthcheck:\\n      test: [ \\\"CMD-SHELL\\\", \\\"pg_isready -U postgres -d eigent\\\" ]\\n      interval: 10s\\n      timeout: 5s\\n      retries: 5\\n\\n  # FastAPI Application\\n  api:\\n    build:\\n      context: ..\\n      dockerfile: server/Dockerfile\\n      args:\\n        database_url: postgresql://postgres:123456@postgres:5432/eigent\\n    container_name: eigent_api\\n    restart: unless-stopped\\n    ports:\\n      - \\\"3001:5678\\\"\\n    environment:\\n   [... omitted end of long line]"
                },
                {
                  "lineNumber": 2349,
                  "content": "            \"text\": \"      test: [ \\\"CMD\\\", \\\"curl\\\", \\\"-f\\\", \\\"http://localhost:5678/health\\\" ]\","
                },
                {
                  "lineNumber": 2599,
                  "content": "        \"contents\": \"ÂèñÂæóÂ∑≤ÂÆâË£ùÁöÑ MCP Â∑•ÂÖ∑Ê∏ÖÂñÆ„ÄÇ\\n\\n---\\n\\n### POST /api/mcp/install\\n\\nÂÆâË£ù MCP Â∑•ÂÖ∑„ÄÇ\\n\\n**Ë´ãÊ±Ç**Ôºö\\n&amp;#96;&amp;#96;&amp;#96;json\\n{\\n  \\\"name\\\": \\\"notion\\\",\\n  \\\"command\\\": \\\"npx\\\",\\n  \\\"args\\\": [\\\"-y\\\", \\\"@modelcontextprotocol/server-notion\\\"],\\n  \\\"env\\\": {\\n    \\\"NOTION_TOKEN\\\": \\\"xxx\\\"\\n  }\\n}\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n---\\n\\n## ÂÅ•Â∫∑Ê™¢Êü•\\n\\n### GET /health\\n\\nÊ™¢Êü•ÊúçÂãôÊòØÂê¶Ê≠£Â∏∏ÈÅãË°å„ÄÇ\\n\\n**ÂõûÊáâ**Ôºö\\n&amp;#96;&amp;#96;&amp;#96;json\\n{\\n  \\\"status\\\": \\\"healthy\\\"\\n}\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n---\\n\\n## SSE ‰∫ã‰ª∂È°ûÂûã\\n\\n| ‰∫ã‰ª∂ | Ë™™Êòé |\\n|------|------|\\n| &amp;#96;decompose_text&amp;#96; | ‰ªªÂãôÂàÜËß£ÈÅéÁ®ã‰∏≠ÁöÑ‰∏≤ÊµÅÊñáÂ≠ó |\\n| &amp;#96;to_sub_tasks&amp;#96; | Â≠ê‰ªªÂãôÊ∏ÖÂñÆÂ∑≤ÁîüÊàê |\\n| &amp;#96;confirmed&amp;#96; | ‰ΩøÁî®ËÄÖÁ¢∫Ë™ç‰ªªÂãôÂàÜËß£ |\\n| &amp;#96;create_agent&amp;#96; | Êñ∞ Agent Ë¢´Âª∫Á´ã |\\n| &amp;#96;assign_task&amp;#96; | ‰ªªÂãôË¢´ÂàÜÈÖçÁµ¶ Agent |\\n| &amp;#96;activate_agent&amp;#96; | Agent ÈñãÂßãÂ∑•‰Ωú |\\n| &amp;#96;deactivate_agent&amp;#96; | Agent ÂÆåÊàêÂ∑•‰Ωú |\\n| &amp;#96;activate_toolkit&amp;#96; | Â∑•ÂÖ∑Ë¢´Ë™øÁî® |\\n| &amp;#96;task_state&amp;#96; | Â≠ê‰ªªÂãôÁãÄÊÖãËÆäÊõ¥ (DONE/FAILED) |\\n| &amp;#96;wait_confirm&amp;#96; | ÈúÄË¶Å‰∫∫È°ûÁ¢∫Ë™ç |\\n| &amp;#96;end&amp;#96; | ‰ªªÂãôÂÆåÊàê |\\n\\n---\\n\\n## ÈåØË™§Á¢º\\n\\n| Code | Ë™™Êòé |\\n|------|------|\\n| 0 | Êàê [... omitted end of long line]"
                },
                {
                  "lineNumber": 2692,
                  "content": "            \"text\": \"### GET /health\","
                },
                {
                  "lineNumber": 2903,
                  "content": "        \"contents\": \"# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô®\\ndocker compose down\\n\\n# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô® + Ë≥áÊñôÂç∑ (ÊÖéÁî®ÔºÅÊúÉÂà™Èô§Ë≥áÊñô)\\ndocker compose down -v\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n---\\n\\n## Git Â∑•‰ΩúÊµÅÁ®ã\\n\\n### Â∏∏Áî®Êåá‰ª§\\n\\n&amp;#96;&amp;#96;&amp;#96;bash\\n# Êü•ÁúãÁãÄÊÖã\\ngit status\\n\\n# Êü•ÁúãËÆäÊõ¥\\ngit diff\\n\\n# Êèê‰∫§ËÆäÊõ¥\\ngit add .\\ngit commit -m \\\"feat: Êñ∞Â¢ûÂäüËÉΩÊèèËø∞\\\"\\n\\n# Êé®ÈÄÅÂà∞ÈÅ†Á´Ø\\ngit push origin feature-branch\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n### Commit Ë®äÊÅØË¶èÁØÑ\\n\\n| È°ûÂûã | Ë™™Êòé |\\n|-----|------|\\n| &amp;#96;feat:&amp;#96; | Êñ∞ÂäüËÉΩ |\\n| &amp;#96;fix:&amp;#96; | ÈåØË™§‰øÆÂæ© |\\n| &amp;#96;docs:&amp;#96; | Êñá‰ª∂Êõ¥Êñ∞ |\\n| &amp;#96;style:&amp;#96; | Á®ãÂºèÁ¢ºÊ†ºÂºèË™øÊï¥ |\\n| &amp;#96;refactor:&amp;#96; | ÈáçÊßã |\\n| &amp;#96;test:&amp;#96; | Ê∏¨Ë©¶Áõ∏Èóú |\\n| &amp;#96;chore:&amp;#96; | Âª∫ÁΩÆ/Â∑•ÂÖ∑Áõ∏Èóú |\\n\\n---\\n\\n## Áí∞Â¢ÉËÆäÊï∏\\n\\n### ÂâçÁ´Ø (.env.development)\\n\\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\\n|---------|------|--------|\\n| &amp;#96;VITE_BASE_URL&amp;#96; | API Âü∫Á§éË∑ØÂæë | &amp;#96;/api&amp;#96; |\\n| &amp;#96;VITE_PROXY_URL&amp;#96; | ‰ª£ÁêÜÁõÆÊ®ô URL | &amp;#96;https://dev.eigent.ai&amp;#96; |\\n| &amp;#96;VITE_USE_LOCAL_PROXY&amp;#96; | ÊòØÂê¶‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ | &amp;#96;true&amp;#96; / &amp;#96;false&amp;#96; |\\n\\n### ÂæåÁ´Ø (server/.env)\\n\\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\\n|---------|------|--------|\\n| &amp;#96;database_url&amp;#96 [... omitted end of long line]"
                },
                {
                  "lineNumber": 3173,
                  "content": "            \"text\": \"curl http://localhost:5001/health\","
                },
                {
                  "lineNumber": 3247,
                  "content": "        \"contents\": \"export async function startBackend(setPort?: (port: number) =&amp;gt; void): Promise&amp;lt;any&amp;gt; {\\nasync (resolve, reject) =&amp;gt; {\\nconst killBackendProcess = \\n\\n            }\\n        };\\n\\n        const pollHealthEndpoint = (): void =&amp;gt; {\\n            let attempts = 0;\\n            const maxAttempts = 240;\\n            const intervalMs = 250;\\n\\n            healthCheckInterval = setInterval(() =&amp;gt; {\\n                attempts++;\\n                const healthUrl = &amp;#96;http://127.0.0.1:${port}/health&amp;#96;;\\n                log.debug(&amp;#96;Health check attempt ${attempts}/${maxAttempts}: ${healthUrl}&amp;#96;);\\n\\n                const req = http.get(healthUrl, { timeout: 1000 }, (res) =&amp;gt; {\\n                    if (res.statusCode === 200) {\\n                        log.info(&amp;#96;Backend health check passed after ${attempts} attempts&amp;#96;);\\n                        started = true;\\n                        clearTimeout(startTimeout);\\n                        if (health [... omitted end of long line]"
                },
                {
                  "lineNumber": 3338,
                  "content": "            \"text\": \"                const healthUrl = &amp;#96;http://127.0.0.1:${port}/health&amp;#96;;\","
                },
                {
                  "lineNumber": 3605,
                  "content": "        \"contents\": \"delete requestHeaders['Content-Type']\\n  }\\n\\n  if (!url.includes('http://') &amp;amp;&amp;amp; !url.includes('https://') &amp;amp;&amp;amp; token) {\\n    requestHeaders['Authorization'] = &amp;#96;Bearer ${token}&amp;#96;\\n  }\\n\\n  if (import.meta.env.DEV) {\\n    const targetUrl = import.meta.env.VITE_BASE_URL\\n    if (targetUrl) {\\n      requestHeaders['X-Proxy-Target'] = targetUrl\\n    }\\n  }\\n\\n  const options: RequestInit = {\\n    method: 'POST',\\n    headers: requestHeaders,\\n    body: formData,\\n  }\\n\\n  return handleResponse(fetch(fullUrl, options))\\n}\\n\\n// =============== Backend Health Check ===============\\n\\n/**\\n * Check if backend is ready by checking the health endpoint\\n * @returns Promise&amp;lt;boolean&amp;gt; - true if backend is ready, false otherwise\\n */\\nexport async function checkBackendHealth(): Promise&amp;lt;boolean&amp;gt; {\\n  try {\\n    const baseURL = await getBaseURL();\\n    const controller = new AbortController();\\n    const timeoutId = setTimeout(() =&amp;gt; controller.ab [... omitted end of long line]"
                },
                {
                  "lineNumber": 3742,
                  "content": "            \"text\": \"    const res = await fetch(&amp;#96;${baseURL}/health&amp;#96;, {\","
                },
                {
                  "lineNumber": 3948,
                  "content": "        \"contents\": \"...headers,\\n  }\\n\\n  // Remove Content-Type header to let browser set it with boundary for FormData\\n  if (requestHeaders['Content-Type']) {\\n    delete requestHeaders['Content-Type']\\n  }\\n\\n  if (!url.includes('http://') &amp;amp;&amp;amp; !url.includes('https://') &amp;amp;&amp;amp; token) {\\n    requestHeaders['Authorization'] = &amp;#96;Bearer ${token}&amp;#96;\\n  }\\n\\n  if (import.meta.env.DEV) {\\n    const targetUrl = import.meta.env.VITE_BASE_URL\\n    if (targetUrl) {\\n      requestHeaders['X-Proxy-Target'] = targetUrl\\n    }\\n  }\\n\\n  const options: RequestInit = {\\n    method: 'POST',\\n    headers: requestHeaders,\\n    body: formData,\\n  }\\n\\n  return handleResponse(fetch(fullUrl, options))\\n}\\n\\n// =============== Backend Health Check ===============\\n\\n/**\\n * Check if backend is ready by checking the health endpoint\\n * @returns Promise&amp;lt;boolean&amp;gt; - true if backend is ready, false otherwise\\n */\\nexport async function checkBackendHealth(): Promise&amp;lt;boolean&amp;gt; {\\n  try [... omitted end of long line]"
                },
                {
                  "lineNumber": 4104,
                  "content": "            \"text\": \"    const res = await fetch(&amp;#96;${baseURL}/health&amp;#96;, {\","
                },
                {
                  "lineNumber": 4817,
                  "content": "ÂïèÈ°åÔºöÂæåÁ´ØË∑ØÁî±‰ΩøÁî® &#96;/api&#96; ÂâçÁ∂¥ÔºåÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÂØ¶ÈöõÂú® &#96;/api/health&#96;Ôºå‰ΩÜÂâçÁ´ØÂëºÂè´ &#96;/health&#96;„ÄÇ‰øÆÊ≠£ÂâçÁ´ØÔºåÊîπÁÇ∫ÂëºÂè´ &#96;/api/health&#96;„ÄÇ"
                },
                {
                  "lineNumber": 11690,
                  "content": "‰øÆÊ≠£ÂâçÁ´ØÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÔºöÂ∞á &#96;/health&#96; ÊîπÁÇ∫ &#96;/api/health&#96;„ÄÇ"
                },
                {
                  "lineNumber": 11706,
                  "content": "Â∑≤‰øÆÊ≠£ÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûË∑ØÂæë„ÄÇÂâçÁ´ØÁèæÂú®ÊúÉÂëºÂè´ &#96;/api/health&#96;ÔºåËàáÂæåÁ´ØË∑ØÁî±‰∏ÄËá¥„ÄÇ"
                },
                {
                  "lineNumber": 11709,
                  "content": "- Â∞á &#96;checkBackendHealth()&#96; ‰∏≠ÁöÑÁ´ØÈªûÂæû &#96;/health&#96; ÊîπÁÇ∫ &#96;/api/health&#96;"
                },
                {
                  "lineNumber": 15715,
                  "content": "        \"contents\": \"# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô®\\ndocker compose down\\n\\n# ÂÅúÊ≠¢‰∏¶ÁßªÈô§ÂÆπÂô® + Ë≥áÊñôÂç∑ (ÊÖéÁî®ÔºÅÊúÉÂà™Èô§Ë≥áÊñô)\\ndocker compose down -v\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n---\\n\\n## Git Â∑•‰ΩúÊµÅÁ®ã\\n\\n### Â∏∏Áî®Êåá‰ª§\\n\\n&amp;#96;&amp;#96;&amp;#96;bash\\n# Êü•ÁúãÁãÄÊÖã\\ngit status\\n\\n# Êü•ÁúãËÆäÊõ¥\\ngit diff\\n\\n# Êèê‰∫§ËÆäÊõ¥\\ngit add .\\ngit commit -m \\\"feat: Êñ∞Â¢ûÂäüËÉΩÊèèËø∞\\\"\\n\\n# Êé®ÈÄÅÂà∞ÈÅ†Á´Ø\\ngit push origin feature-branch\\n&amp;#96;&amp;#96;&amp;#96;\\n\\n### Commit Ë®äÊÅØË¶èÁØÑ\\n\\n| È°ûÂûã | Ë™™Êòé |\\n|-----|------|\\n| &amp;#96;feat:&amp;#96; | Êñ∞ÂäüËÉΩ |\\n| &amp;#96;fix:&amp;#96; | ÈåØË™§‰øÆÂæ© |\\n| &amp;#96;docs:&amp;#96; | Êñá‰ª∂Êõ¥Êñ∞ |\\n| &amp;#96;style:&amp;#96; | Á®ãÂºèÁ¢ºÊ†ºÂºèË™øÊï¥ |\\n| &amp;#96;refactor:&amp;#96; | ÈáçÊßã |\\n| &amp;#96;test:&amp;#96; | Ê∏¨Ë©¶Áõ∏Èóú |\\n| &amp;#96;chore:&amp;#96; | Âª∫ÁΩÆ/Â∑•ÂÖ∑Áõ∏Èóú |\\n\\n---\\n\\n## Áí∞Â¢ÉËÆäÊï∏\\n\\n### ÂâçÁ´Ø (.env.development)\\n\\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\\n|---------|------|--------|\\n| &amp;#96;VITE_BASE_URL&amp;#96; | API Âü∫Á§éË∑ØÂæë | &amp;#96;/api&amp;#96; |\\n| &amp;#96;VITE_PROXY_URL&amp;#96; | ‰ª£ÁêÜÁõÆÊ®ô URL | &amp;#96;https://dev.eigent.ai&amp;#96; |\\n| &amp;#96;VITE_USE_LOCAL_PROXY&amp;#96; | ÊòØÂê¶‰ΩøÁî®Êú¨Âú∞‰ª£ÁêÜ | &amp;#96;true&amp;#96; / &amp;#96;false&amp;#96; |\\n\\n### ÂæåÁ´Ø (server/.env)\\n\\n| ËÆäÊï∏ÂêçÁ®± | Ë™™Êòé | ÁØÑ‰æãÂÄº |\\n|---------|------|--------|\\n| &amp;#96;database_url&amp;#96 [... omitted end of long line]"
                },
                {
                  "lineNumber": 15985,
                  "content": "            \"text\": \"curl http://localhost:5001/health\","
                },
                {
                  "lineNumber": 18205,
                  "content": "1. Â∞áÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÊîπÁÇ∫ &#96;/api/health&#96;ÔºàÂõ†ÁÇ∫‰Ω†Â∑≤ÈÇÑÂéüÁÇ∫ &#96;/health&#96;Ôºâ„ÄÇ"
                },
                {
                  "lineNumber": 18240,
                  "content": "- ÂÅ•Â∫∑Ê™¢Êü•Â∑≤‰øÆÊ≠£ÁÇ∫‰ΩøÁî® &#96;/api/health&#96;ÔºåËàáÂæåÁ´ØË∑ØÁî±‰∏ÄËá¥"
                }
              ]
            },
            {
              "file": ".\\src\\api\\http.ts",
              "matches": [
                {
                  "lineNumber": 282,
                  "content": "    const res = await fetch(&#96;${baseURL}/api/health&#96;, {"
                }
              ]
            },
            {
              "file": ".\\2026-01-19_cursor_ÁôªÂÖ•Â∞éÂêëÈñãÁôº‰º∫ÊúçÂô®.md",
              "matches": [
                {
                  "lineNumber": 319,
                  "content": "    const res = await fetch(&#96;${baseURL}/health&#96;, {"
                },
                {
                  "lineNumber": 741,
                  "content": "    const res = await fetch(&#96;${baseURL}/health&#96;, {"
                }
              ]
            },
            {
              "file": ".\\session-ses_42ad-260119-01.md",
              "matches": [
                {
                  "lineNumber": 4314,
                  "content": "- **Health Controller (&#96;/health&#96;)**: ÊúçÂãôÂÅ•Â∫∑Ê™¢Êü•„ÄÇ"
                },
                {
                  "lineNumber": 7296,
                  "content": "00267|     const res = await fetch(&#96;${baseURL}/health&#96;, {"
                },
                {
                  "lineNumber": 8084,
                  "content": "  \"content\": \"# ÈñãÁôºÊåá‰ª§ÈÄüÊü•Ë°®\\n\\n&gt; Êú¨Êñá‰ª∂ÂàóÂá∫ Eigent Â∞àÊ°àÂ∏∏Áî®ÁöÑÈñãÁôºÊåá‰ª§„ÄÇ\\n\\n## ÂâçÁ´ØÊåá‰ª§ (npm)\\n\\n### ÈñãÁôºËàáÂª∫ÁΩÆ\\n\\n| Êåá‰ª§ | Ë™™Êòé |\\n|-----|------|\\n| &#96;npm install&#96; | ÂÆâË£ù‰æùË≥¥Â•ó‰ª∂ |\\n| &#96;npm run dev&#96; | ÂïüÂãïÈñãÁôº‰º∫ÊúçÂô® (Âê´ Electron) |\\n| &#96;npm run build&#96; | Âª∫ÁΩÆÁîüÁî¢ÁâàÊú¨‰∏¶ÊâìÂåÖ |\\n| &#96;npm run build:win&#96; | Âª∫ÁΩÆ Windows ÂÆâË£ùÊ™î |\\n| &#96;npm run build:mac&#96; | Âª∫ÁΩÆ macOS ÂÆâË£ùÊ™î |\\n| &#96;npm run preview&#96; | È†êË¶ΩÂª∫ÁΩÆÁµêÊûú |\\n\\n### Ê∏¨Ë©¶\\n\\n| Êåá‰ª§ | Ë™™Êòé |\\n|-----|------|\\n| &#96;npm run test&#96; | Âü∑Ë°åÂñÆÂÖÉÊ∏¨Ë©¶ |\\n| &#96;npm run test:watch&#96; | Áõ£ËÅΩÊ®°ÂºèÂü∑Ë°åÊ∏¨Ë©¶ |\\n| &#96;npm run test:e2e&#96; | Âü∑Ë°åÁ´ØÂ∞çÁ´ØÊ∏¨Ë©¶ |\\n| &#96;npm run test:coverage&#96; | Áî¢ÁîüÊ∏¨Ë©¶Ë¶ÜËìãÁéáÂ†±Âëä |\\n\\n### Á®ãÂºèÁ¢ºÂìÅË≥™\\n\\n| Êåá‰ª§ | Ë™™Êòé |\\n|-----|------|\\n| &#96;npm run type-check&#96; | TypeScript ÂûãÂà•Ê™¢Êü• |\\n\\n---\\n\\n## ÂæåÁ´ØÊåá‰ª§ (Python/uv)\\n\\n### Êú¨Âú∞ÈñãÁôº\\n\\n&#96;&#96;&#96;bash\\n# ÈÄ≤ÂÖ• backend ÁõÆÈåÑ\\ncd backend\\n\\n# ÂïüÂãïÂæåÁ´ØÊúçÂãô (‰ΩøÁî® uv)\\nuv run uvicorn main:api --port 5001 --reload\\n\\n# ÊàñÊåáÂÆöË≥áÊñôÂ∫´ÈÄ£Á∑ö\\nexport database_url=postgresql://postgres:123456@localhost:5432/eigent\\nuv run uvicorn main:api --reload --port 3001 --host 0.0.0.0\\n&#96;&#96;&#96;\\n\\n### Ë≥áÊñôÂ∫´ÈÅ∑Áßª\\n\\n&#96;&#96;&#96;bash\\n# Âü∑Ë°åÈÅ∑Áßª\\nuv run alembic upgrade head\\n\\n# Áî¢ÁîüÊñ∞ÈÅ∑Áßª\\nuv run alembic revision -- [... omitted end of long line]"
                },
                {
                  "lineNumber": 8187,
                  "content": "  \"content\": \"# ÂæåÁ´Ø API ÂèÉËÄÉ\\n\\n&gt; Êú¨Êñá‰ª∂Ë™™Êòé Eigent ÂæåÁ´Ø API ÁöÑÁ´ØÈªû„ÄÅË´ãÊ±ÇÊ†ºÂºèËàáÂõûÊáâÁµêÊßã„ÄÇ\\n\\n## API Ê¶ÇËø∞\\n\\nEigent ÊúâÂÖ©Â•óÂæåÁ´ØÔºö\\n\\n| ÂæåÁ´Ø | ‰ΩçÁΩÆ | Áî®ÈÄî | Ë™çË≠âÊñπÂºè |\\n|-----|------|------|---------|\\n| **ÂµåÂÖ•ÂºèÂæåÁ´Ø** | &#96;backend/&#96; | Â§öÊô∫ËÉΩÈ´îÂü∑Ë°åÂºïÊìé | ÁÑ°ÔºàÊú¨Âú∞ÈÄöË®äÔºâ |\\n| **Êú¨Âú∞ÈÉ®ÁΩ≤ÂæåÁ´Ø** | &#96;server/&#96; | ÂÆåÊï¥ APIÔºàÂê´Áî®Êà∂ÁÆ°ÁêÜÔºâ | JWT Bearer Token |\\n\\n---\\n\\n## Ë™çË≠â API\\n\\n### POST /api/login\\n\\n‰ΩøÁî® Email ÂíåÂØÜÁ¢ºÁôªÂÖ•„ÄÇ\\n\\n**Ë´ãÊ±Ç**Ôºö\\n&#96;&#96;&#96;json\\n{\\n  \\\"email\\\": \\\"user@example.com\\\",\\n  \\\"password\\\": \\\"your_password\\\"\\n}\\n&#96;&#96;&#96;\\n\\n**ÂõûÊáâ**Ôºö\\n&#96;&#96;&#96;json\\n{\\n  \\\"token\\\": \\\"eyJhbGciOiJIUzI1NiIs...\\\",\\n  \\\"email\\\": \\\"user@example.com\\\",\\n  \\\"username\\\": \\\"user\\\",\\n  \\\"user_id\\\": 1\\n}\\n&#96;&#96;&#96;\\n\\n**ÈåØË™§Á¢º**Ôºö\\n- &#96;code: 10&#96; - Â∏≥ËôüÊàñÂØÜÁ¢ºÈåØË™§\\n\\n---\\n\\n### POST /api/register\\n\\nË®ªÂÜäÊñ∞Â∏≥ËôüÔºàÂÉÖÊú¨Âú∞ÈÉ®ÁΩ≤Ê®°ÂºèÔºâ„ÄÇ\\n\\n**Ë´ãÊ±Ç**Ôºö\\n&#96;&#96;&#96;json\\n{\\n  \\\"email\\\": \\\"user@example.com\\\",\\n  \\\"password\\\": \\\"your_password\\\",\\n  \\\"invite_code\\\": \\\"\\\"\\n}\\n&#96;&#96;&#96;\\n\\n**ÂõûÊáâ**Ôºö\\n&#96;&#96;&#96;json\\n{\\n  \\\"status\\\": \\\"success\\\"\\n}\\n&#96;&#96;&#96;\\n\\n**ÈåØË™§Á¢º**Ôºö\\n- &#96;code: 10&#96; - Email Â∑≤Ë¢´Ë®ªÂÜä\\n\\n---\\n\\n### POST /api/login-by_stack\\n\\n‰ΩøÁî® Stack Auth OAuth Token ÁôªÂÖ•„ÄÇ\\n\\n**Ë´ãÊ±Ç**Ôºö\\n&#96;&#96;&#96;\\nPOST /api/l [... omitted end of long line]"
                }
              ]
            },
            {
              "file": ".\\server\\docker-compose.yml",
              "matches": [
                {
                  "lineNumber": 51,
                  "content": "      test: [ \"CMD\", \"curl\", \"-f\", \"http://localhost:5678/health\" ]"
                }
              ]
            },
            {
              "file": ".\\server\\app\\controller\\health_controller.py",
              "matches": [
                {
                  "lineNumber": 12,
                  "content": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)"
                }
              ]
            },
            {
              "file": ".\\package\\@stackframe\\stack-shared\\dist\\interface\\clientInterface.js.map",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "{\"version\":3,\"sources\":[\"../../src/interface/clientInterface.ts\",\"../../../../node_modules/.pnpm/oauth4webapi@2.10.4/node_modules/oauth4webapi/build/index.js\"],\"sourcesContent\":[\"import * as oauth from 'oauth4webapi';\\n\\nimport * as yup from 'yup';\\nimport { KnownError, KnownErrors } from '../known-errors';\\nimport { AccessToken, InternalSession, RefreshToken } from '../sessions';\\nimport { generateSecureRandomString } from '../utils/crypto';\\nimport { StackAssertionError, throwErr } from '../utils/errors';\\nimport { globalVar } from '../utils/globals';\\nimport { HTTP_METHODS, HttpMethod } from '../utils/http';\\nimport { ReadonlyJson } from '../utils/json';\\nimport { filterUndefined, filterUndefinedOrNull } from '../utils/objects';\\nimport { AuthenticationResponseJSON, PublicKeyCredentialCreationOptionsJSON, PublicKeyCredentialRequestOptionsJSON, RegistrationResponseJSON } from '../utils/passkey';\\nimport { wait } from '../utils/promises';\\nimport { Result } from \\\"../utils/results\\\";\\ [... omitted end of long line]"
                }
              ]
            },
            {
              "file": ".\\package\\@stackframe\\stack-shared\\dist\\interface\\clientInterface.js",
              "matches": [
                {
                  "lineNumber": 904,
                  "content": "      const res = await fetch(new URL(\"/health\", this.getApiUrl()));"
                },
                {
                  "lineNumber": 910,
                  "content": "      const res = await fetch(\"https://app.stack-auth.com/health\");"
                },
                {
                  "lineNumber": 916,
                  "content": "      const res = await fetch(\"https://api.stack-auth.com/health\");"
                }
              ]
            },
            {
              "file": ".\\package\\@stackframe\\stack-shared\\dist\\esm\\interface\\clientInterface.js.map",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "{\"version\":3,\"sources\":[\"../../../../../node_modules/.pnpm/oauth4webapi@2.10.4/node_modules/oauth4webapi/build/index.js\",\"../../../src/interface/clientInterface.ts\"],\"sourcesContent\":[\"let USER_AGENT;\\nif (typeof navigator === 'undefined' || !navigator.userAgent?.startsWith?.('Mozilla/5.0 ')) {\\n    const NAME = 'oauth4webapi';\\n    const VERSION = 'v2.10.4';\\n    USER_AGENT = &#96;${NAME}/${VERSION}&#96;;\\n}\\nfunction looseInstanceOf(input, expected) {\\n    if (input == null) {\\n        return false;\\n    }\\n    try {\\n        return (input instanceof expected ||\\n            Object.getPrototypeOf(input)[Symbol.toStringTag] === expected.prototype[Symbol.toStringTag]);\\n    }\\n    catch {\\n        return false;\\n    }\\n}\\nexport const clockSkew = Symbol();\\nexport const clockTolerance = Symbol();\\nexport const customFetch = Symbol();\\nexport const useMtlsAlias = Symbol();\\nconst encoder = new TextEncoder();\\nconst decoder = new TextDecoder();\\nfunction buf(input) {\\n    if (typeof input === 's [... omitted end of long line]"
                }
              ]
            },
            {
              "file": ".\\package\\@stackframe\\stack-shared\\dist\\esm\\interface\\clientInterface.js",
              "matches": [
                {
                  "lineNumber": 878,
                  "content": "      const res = await fetch(new URL(\"/health\", this.getApiUrl()));"
                },
                {
                  "lineNumber": 884,
                  "content": "      const res = await fetch(\"https://app.stack-auth.com/health\");"
                },
                {
                  "lineNumber": 890,
                  "content": "      const res = await fetch(\"https://api.stack-auth.com/health\");"
                }
              ]
            },
            {
              "file": ".\\backend\\app\\controller\\health_controller.py",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "@router.get(\"/health\", name=\"health check\", response_model=HealthResponse)"
                }
              ]
            }
          ],
          "totalLines": 53,
          "totalMatchedLines": 53
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


Â∑≤‰øÆÊ≠£ÊâÄÊúâÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªû„ÄÇ‰øÆÊ≠£ÊëòË¶ÅÔºö

## ‰øÆÊ≠£ÊëòË¶Å

Â∑≤Â∞áÊâÄÊúâÂÅ•Â∫∑Ê™¢Êü•Á´ØÈªûÂæû `/health` ÊîπÁÇ∫ `/api/health`ÔºåËàáÂæåÁ´ØË∑ØÁî±ÂâçÁ∂¥‰∏ÄËá¥Ôºö

1. **`src/api/http.ts`** (Á¨¨ 282 Ë°å)
   - `checkBackendHealth()` ÂáΩÊï∏‰∏≠ÁöÑÁ´ØÈªû

2. **`src/hooks/useInstallationSetup.ts`** (Á¨¨ 53„ÄÅ99 Ë°å)
   - ÂÖ©ËôïÁõ¥Êé•‰ΩøÁî® `fetch` ÁöÑÂÅ•Â∫∑Ê™¢Êü•

3. **`electron/main/init.ts`** (Á¨¨ 357 Ë°å)
   - ÂæåÁ´ØÂïüÂãïÊôÇÁöÑËº™Ë©¢ÂÅ•Â∫∑Ê™¢Êü•

## ÁµêÊûú

ÈáçÊñ∞ÂïüÂãïÊáâÁî®ÂæåÔºåÊâÄÊúâÂÅ•Â∫∑Ê™¢Êü•Ë´ãÊ±ÇÊúÉ‰ΩøÁî® `/api/health`ÔºåËàáÂæåÁ´ØË∑ØÁî±‰∏ÄËá¥Ôºå‰∏çÂÜçÂá∫Áèæ 404 ÈåØË™§„ÄÇ

**Ê≥®ÊÑèÔºö** ÂÖ∂‰ªñÊâæÂà∞ÁöÑ `/health` Âá∫ÁèæÂú®Êñá‰ª∂ÊàñÊ≠∑Âè≤Ë®òÈåÑ‰∏≠Ôºà`.md`, `.specstory`ÔºâÔºå‰∏çÂΩ±ÈüøÂäüËÉΩÔºåÁÑ°ÈúÄ‰øÆÊ≠£„ÄÇ

---

_**User**_

@esbuild (418-432) 

---

